var tC=Object.defineProperty;var rC=(t,e,r)=>e in t?tC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var O=(t,e,r)=>rC(t,typeof e!="symbol"?e+"":e,r);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var nC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ww={exports:{}},bc={},Zw={exports:{}},$e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var po=Symbol.for("react.element"),sC=Symbol.for("react.portal"),iC=Symbol.for("react.fragment"),aC=Symbol.for("react.strict_mode"),oC=Symbol.for("react.profiler"),lC=Symbol.for("react.provider"),cC=Symbol.for("react.context"),uC=Symbol.for("react.forward_ref"),dC=Symbol.for("react.suspense"),hC=Symbol.for("react.memo"),fC=Symbol.for("react.lazy"),ap=Symbol.iterator;function mC(t){return t===null||typeof t!="object"?null:(t=ap&&t[ap]||t["@@iterator"],typeof t=="function"?t:null)}var Kw={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Gw=Object.assign,Yw={};function Hi(t,e,r){this.props=t,this.context=e,this.refs=Yw,this.updater=r||Kw}Hi.prototype.isReactComponent={};Hi.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Hi.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Jw(){}Jw.prototype=Hi.prototype;function Sh(t,e,r){this.props=t,this.context=e,this.refs=Yw,this.updater=r||Kw}var Ch=Sh.prototype=new Jw;Ch.constructor=Sh;Gw(Ch,Hi.prototype);Ch.isPureReactComponent=!0;var op=Array.isArray,Xw=Object.prototype.hasOwnProperty,Ph={current:null},eb={key:!0,ref:!0,__self:!0,__source:!0};function tb(t,e,r){var n,a={},o=null,c=null;if(e!=null)for(n in e.ref!==void 0&&(c=e.ref),e.key!==void 0&&(o=""+e.key),e)Xw.call(e,n)&&!eb.hasOwnProperty(n)&&(a[n]=e[n]);var u=arguments.length-2;if(u===1)a.children=r;else if(1<u){for(var h=Array(u),f=0;f<u;f++)h[f]=arguments[f+2];a.children=h}if(t&&t.defaultProps)for(n in u=t.defaultProps,u)a[n]===void 0&&(a[n]=u[n]);return{$$typeof:po,type:t,key:o,ref:c,props:a,_owner:Ph.current}}function pC(t,e){return{$$typeof:po,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function kh(t){return typeof t=="object"&&t!==null&&t.$$typeof===po}function gC(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return e[r]})}var lp=/\/+/g;function Tu(t,e){return typeof t=="object"&&t!==null&&t.key!=null?gC(""+t.key):e.toString(36)}function yl(t,e,r,n,a){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var c=!1;if(t===null)c=!0;else switch(o){case"string":case"number":c=!0;break;case"object":switch(t.$$typeof){case po:case sC:c=!0}}if(c)return c=t,a=a(c),t=n===""?"."+Tu(c,0):n,op(a)?(r="",t!=null&&(r=t.replace(lp,"$&/")+"/"),yl(a,e,r,"",function(f){return f})):a!=null&&(kh(a)&&(a=pC(a,r+(!a.key||c&&c.key===a.key?"":(""+a.key).replace(lp,"$&/")+"/")+t)),e.push(a)),1;if(c=0,n=n===""?".":n+":",op(t))for(var u=0;u<t.length;u++){o=t[u];var h=n+Tu(o,u);c+=yl(o,e,r,h,a)}else if(h=mC(t),typeof h=="function")for(t=h.call(t),u=0;!(o=t.next()).done;)o=o.value,h=n+Tu(o,u++),c+=yl(o,e,r,h,a);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return c}function Zo(t,e,r){if(t==null)return t;var n=[],a=0;return yl(t,n,"","",function(o){return e.call(r,o,a++)}),n}function yC(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var er={current:null},xl={transition:null},xC={ReactCurrentDispatcher:er,ReactCurrentBatchConfig:xl,ReactCurrentOwner:Ph};function rb(){throw Error("act(...) is not supported in production builds of React.")}$e.Children={map:Zo,forEach:function(t,e,r){Zo(t,function(){e.apply(this,arguments)},r)},count:function(t){var e=0;return Zo(t,function(){e++}),e},toArray:function(t){return Zo(t,function(e){return e})||[]},only:function(t){if(!kh(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};$e.Component=Hi;$e.Fragment=iC;$e.Profiler=oC;$e.PureComponent=Sh;$e.StrictMode=aC;$e.Suspense=dC;$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xC;$e.act=rb;$e.cloneElement=function(t,e,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Gw({},t.props),a=t.key,o=t.ref,c=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,c=Ph.current),e.key!==void 0&&(a=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(h in e)Xw.call(e,h)&&!eb.hasOwnProperty(h)&&(n[h]=e[h]===void 0&&u!==void 0?u[h]:e[h])}var h=arguments.length-2;if(h===1)n.children=r;else if(1<h){u=Array(h);for(var f=0;f<h;f++)u[f]=arguments[f+2];n.children=u}return{$$typeof:po,type:t.type,key:a,ref:o,props:n,_owner:c}};$e.createContext=function(t){return t={$$typeof:cC,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:lC,_context:t},t.Consumer=t};$e.createElement=tb;$e.createFactory=function(t){var e=tb.bind(null,t);return e.type=t,e};$e.createRef=function(){return{current:null}};$e.forwardRef=function(t){return{$$typeof:uC,render:t}};$e.isValidElement=kh;$e.lazy=function(t){return{$$typeof:fC,_payload:{_status:-1,_result:t},_init:yC}};$e.memo=function(t,e){return{$$typeof:hC,type:t,compare:e===void 0?null:e}};$e.startTransition=function(t){var e=xl.transition;xl.transition={};try{t()}finally{xl.transition=e}};$e.unstable_act=rb;$e.useCallback=function(t,e){return er.current.useCallback(t,e)};$e.useContext=function(t){return er.current.useContext(t)};$e.useDebugValue=function(){};$e.useDeferredValue=function(t){return er.current.useDeferredValue(t)};$e.useEffect=function(t,e){return er.current.useEffect(t,e)};$e.useId=function(){return er.current.useId()};$e.useImperativeHandle=function(t,e,r){return er.current.useImperativeHandle(t,e,r)};$e.useInsertionEffect=function(t,e){return er.current.useInsertionEffect(t,e)};$e.useLayoutEffect=function(t,e){return er.current.useLayoutEffect(t,e)};$e.useMemo=function(t,e){return er.current.useMemo(t,e)};$e.useReducer=function(t,e,r){return er.current.useReducer(t,e,r)};$e.useRef=function(t){return er.current.useRef(t)};$e.useState=function(t){return er.current.useState(t)};$e.useSyncExternalStore=function(t,e,r){return er.current.useSyncExternalStore(t,e,r)};$e.useTransition=function(){return er.current.useTransition()};$e.version="18.3.1";Zw.exports=$e;var R=Zw.exports;const Qa=Qw(R);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vC=R,wC=Symbol.for("react.element"),bC=Symbol.for("react.fragment"),_C=Object.prototype.hasOwnProperty,NC=vC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,jC={key:!0,ref:!0,__self:!0,__source:!0};function nb(t,e,r){var n,a={},o=null,c=null;r!==void 0&&(o=""+r),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(c=e.ref);for(n in e)_C.call(e,n)&&!jC.hasOwnProperty(n)&&(a[n]=e[n]);if(t&&t.defaultProps)for(n in e=t.defaultProps,e)a[n]===void 0&&(a[n]=e[n]);return{$$typeof:wC,type:t,key:o,ref:c,props:a,_owner:NC.current}}bc.Fragment=bC;bc.jsx=nb;bc.jsxs=nb;Ww.exports=bc;var s=Ww.exports,sb={exports:{}},_r={},ib={exports:{}},ab={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,ne){var ie=Z.length;Z.push(ne);e:for(;0<ie;){var K=ie-1>>>1,fe=Z[K];if(0<a(fe,ne))Z[K]=ne,Z[ie]=fe,ie=K;else break e}}function r(Z){return Z.length===0?null:Z[0]}function n(Z){if(Z.length===0)return null;var ne=Z[0],ie=Z.pop();if(ie!==ne){Z[0]=ie;e:for(var K=0,fe=Z.length,Ae=fe>>>1;K<Ae;){var ee=2*(K+1)-1,ue=Z[ee],ae=ee+1,pe=Z[ae];if(0>a(ue,ie))ae<fe&&0>a(pe,ue)?(Z[K]=pe,Z[ae]=ie,K=ae):(Z[K]=ue,Z[ee]=ie,K=ee);else if(ae<fe&&0>a(pe,ie))Z[K]=pe,Z[ae]=ie,K=ae;else break e}}return ne}function a(Z,ne){var ie=Z.sortIndex-ne.sortIndex;return ie!==0?ie:Z.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var h=[],f=[],m=1,v=null,w=3,N=!1,g=!1,y=!1,j=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(Z){for(var ne=r(f);ne!==null;){if(ne.callback===null)n(f);else if(ne.startTime<=Z)n(f),ne.sortIndex=ne.expirationTime,e(h,ne);else break;ne=r(f)}}function B(Z){if(y=!1,P(Z),!g)if(r(h)!==null)g=!0,de($);else{var ne=r(f);ne!==null&&re(B,ne.startTime-Z)}}function $(Z,ne){g=!1,y&&(y=!1,_(T),T=-1),N=!0;var ie=w;try{for(P(ne),v=r(h);v!==null&&(!(v.expirationTime>ne)||Z&&!V());){var K=v.callback;if(typeof K=="function"){v.callback=null,w=v.priorityLevel;var fe=K(v.expirationTime<=ne);ne=t.unstable_now(),typeof fe=="function"?v.callback=fe:v===r(h)&&n(h),P(ne)}else n(h);v=r(h)}if(v!==null)var Ae=!0;else{var ee=r(f);ee!==null&&re(B,ee.startTime-ne),Ae=!1}return Ae}finally{v=null,w=ie,N=!1}}var k=!1,I=null,T=-1,D=5,U=-1;function V(){return!(t.unstable_now()-U<D)}function z(){if(I!==null){var Z=t.unstable_now();U=Z;var ne=!0;try{ne=I(!0,Z)}finally{ne?q():(k=!1,I=null)}}else k=!1}var q;if(typeof b=="function")q=function(){b(z)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,te=Q.port2;Q.port1.onmessage=z,q=function(){te.postMessage(null)}}else q=function(){j(z,0)};function de(Z){I=Z,k||(k=!0,q())}function re(Z,ne){T=j(function(){Z(t.unstable_now())},ne)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){g||N||(g=!0,de($))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return w},t.unstable_getFirstCallbackNode=function(){return r(h)},t.unstable_next=function(Z){switch(w){case 1:case 2:case 3:var ne=3;break;default:ne=w}var ie=w;w=ne;try{return Z()}finally{w=ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,ne){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ie=w;w=Z;try{return ne()}finally{w=ie}},t.unstable_scheduleCallback=function(Z,ne,ie){var K=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?K+ie:K):ie=K,Z){case 1:var fe=-1;break;case 2:fe=250;break;case 5:fe=1073741823;break;case 4:fe=1e4;break;default:fe=5e3}return fe=ie+fe,Z={id:m++,callback:ne,priorityLevel:Z,startTime:ie,expirationTime:fe,sortIndex:-1},ie>K?(Z.sortIndex=ie,e(f,Z),r(h)===null&&Z===r(f)&&(y?(_(T),T=-1):y=!0,re(B,ie-K))):(Z.sortIndex=fe,e(h,Z),g||N||(g=!0,de($))),Z},t.unstable_shouldYield=V,t.unstable_wrapCallback=function(Z){var ne=w;return function(){var ie=w;w=ne;try{return Z.apply(this,arguments)}finally{w=ie}}}})(ab);ib.exports=ab;var SC=ib.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CC=R,vr=SC;function he(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)e+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ob=new Set,Wa={};function Ks(t,e){Oi(t,e),Oi(t+"Capture",e)}function Oi(t,e){for(Wa[t]=e,t=0;t<e.length;t++)ob.add(e[t])}var Ln=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),dd=Object.prototype.hasOwnProperty,PC=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cp={},up={};function kC(t){return dd.call(up,t)?!0:dd.call(cp,t)?!1:PC.test(t)?up[t]=!0:(cp[t]=!0,!1)}function TC(t,e,r,n){if(r!==null&&r.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function EC(t,e,r,n){if(e===null||typeof e>"u"||TC(t,e,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function tr(t,e,r,n,a,o,c){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=c}var Rt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Rt[t]=new tr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Rt[e]=new tr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Rt[t]=new tr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Rt[t]=new tr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Rt[t]=new tr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Rt[t]=new tr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Rt[t]=new tr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Rt[t]=new tr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Rt[t]=new tr(t,5,!1,t.toLowerCase(),null,!1,!1)});var Th=/[\-:]([a-z])/g;function Eh(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Th,Eh);Rt[e]=new tr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Th,Eh);Rt[e]=new tr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Th,Eh);Rt[e]=new tr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Rt[t]=new tr(t,1,!1,t.toLowerCase(),null,!1,!1)});Rt.xlinkHref=new tr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Rt[t]=new tr(t,1,!1,t.toLowerCase(),null,!0,!0)});function Lh(t,e,r,n){var a=Rt.hasOwnProperty(e)?Rt[e]:null;(a!==null?a.type!==0:n||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(EC(e,r,a,n)&&(r=null),n||a===null?kC(e)&&(r===null?t.removeAttribute(e):t.setAttribute(e,""+r)):a.mustUseProperty?t[a.propertyName]=r===null?a.type===3?!1:"":r:(e=a.attributeName,n=a.attributeNamespace,r===null?t.removeAttribute(e):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?t.setAttributeNS(n,e,r):t.setAttribute(e,r))))}var zn=CC.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ko=Symbol.for("react.element"),mi=Symbol.for("react.portal"),pi=Symbol.for("react.fragment"),Ah=Symbol.for("react.strict_mode"),hd=Symbol.for("react.profiler"),lb=Symbol.for("react.provider"),cb=Symbol.for("react.context"),Mh=Symbol.for("react.forward_ref"),fd=Symbol.for("react.suspense"),md=Symbol.for("react.suspense_list"),Ih=Symbol.for("react.memo"),Qn=Symbol.for("react.lazy"),ub=Symbol.for("react.offscreen"),dp=Symbol.iterator;function pa(t){return t===null||typeof t!="object"?null:(t=dp&&t[dp]||t["@@iterator"],typeof t=="function"?t:null)}var ot=Object.assign,Eu;function ka(t){if(Eu===void 0)try{throw Error()}catch(r){var e=r.stack.trim().match(/\n( *(at )?)/);Eu=e&&e[1]||""}return`
`+Eu+t}var Lu=!1;function Au(t,e){if(!t||Lu)return"";Lu=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(f){var n=f}Reflect.construct(t,[],e)}else{try{e.call()}catch(f){n=f}t.call(e.prototype)}else{try{throw Error()}catch(f){n=f}t()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var a=f.stack.split(`
`),o=n.stack.split(`
`),c=a.length-1,u=o.length-1;1<=c&&0<=u&&a[c]!==o[u];)u--;for(;1<=c&&0<=u;c--,u--)if(a[c]!==o[u]){if(c!==1||u!==1)do if(c--,u--,0>u||a[c]!==o[u]){var h=`
`+a[c].replace(" at new "," at ");return t.displayName&&h.includes("<anonymous>")&&(h=h.replace("<anonymous>",t.displayName)),h}while(1<=c&&0<=u);break}}}finally{Lu=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?ka(t):""}function LC(t){switch(t.tag){case 5:return ka(t.type);case 16:return ka("Lazy");case 13:return ka("Suspense");case 19:return ka("SuspenseList");case 0:case 2:case 15:return t=Au(t.type,!1),t;case 11:return t=Au(t.type.render,!1),t;case 1:return t=Au(t.type,!0),t;default:return""}}function pd(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case pi:return"Fragment";case mi:return"Portal";case hd:return"Profiler";case Ah:return"StrictMode";case fd:return"Suspense";case md:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case cb:return(t.displayName||"Context")+".Consumer";case lb:return(t._context.displayName||"Context")+".Provider";case Mh:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ih:return e=t.displayName||null,e!==null?e:pd(t.type)||"Memo";case Qn:e=t._payload,t=t._init;try{return pd(t(e))}catch{}}return null}function AC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return pd(e);case 8:return e===Ah?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ds(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function db(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function MC(t){var e=db(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),n=""+t[e];if(!t.hasOwnProperty(e)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,o=r.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return a.call(this)},set:function(c){n=""+c,o.call(this,c)}}),Object.defineProperty(t,e,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(c){n=""+c},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Go(t){t._valueTracker||(t._valueTracker=MC(t))}function hb(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var r=e.getValue(),n="";return t&&(n=db(t)?t.checked?"true":"false":t.value),t=n,t!==r?(e.setValue(t),!0):!1}function Ol(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function gd(t,e){var r=e.checked;return ot({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function hp(t,e){var r=e.defaultValue==null?"":e.defaultValue,n=e.checked!=null?e.checked:e.defaultChecked;r=ds(e.value!=null?e.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function fb(t,e){e=e.checked,e!=null&&Lh(t,"checked",e,!1)}function yd(t,e){fb(t,e);var r=ds(e.value),n=e.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?xd(t,e.type,r):e.hasOwnProperty("defaultValue")&&xd(t,e.type,ds(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function fp(t,e,r){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var n=e.type;if(!(n!=="submit"&&n!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,r||e===t.value||(t.value=e),t.defaultValue=e}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function xd(t,e,r){(e!=="number"||Ol(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Ta=Array.isArray;function Pi(t,e,r,n){if(t=t.options,e){e={};for(var a=0;a<r.length;a++)e["$"+r[a]]=!0;for(r=0;r<t.length;r++)a=e.hasOwnProperty("$"+t[r].value),t[r].selected!==a&&(t[r].selected=a),a&&n&&(t[r].defaultSelected=!0)}else{for(r=""+ds(r),e=null,a=0;a<t.length;a++){if(t[a].value===r){t[a].selected=!0,n&&(t[a].defaultSelected=!0);return}e!==null||t[a].disabled||(e=t[a])}e!==null&&(e.selected=!0)}}function vd(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(he(91));return ot({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function mp(t,e){var r=e.value;if(r==null){if(r=e.children,e=e.defaultValue,r!=null){if(e!=null)throw Error(he(92));if(Ta(r)){if(1<r.length)throw Error(he(93));r=r[0]}e=r}e==null&&(e=""),r=e}t._wrapperState={initialValue:ds(r)}}function mb(t,e){var r=ds(e.value),n=ds(e.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),e.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function pp(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function pb(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function wd(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?pb(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Yo,gb=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,r,n,a){MSApp.execUnsafeLocalFunction(function(){return t(e,r,n,a)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Yo=Yo||document.createElement("div"),Yo.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Yo.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Za(t,e){if(e){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=e;return}}t.textContent=e}var Ma={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},IC=["Webkit","ms","Moz","O"];Object.keys(Ma).forEach(function(t){IC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ma[e]=Ma[t]})});function yb(t,e,r){return e==null||typeof e=="boolean"||e===""?"":r||typeof e!="number"||e===0||Ma.hasOwnProperty(t)&&Ma[t]?(""+e).trim():e+"px"}function xb(t,e){t=t.style;for(var r in e)if(e.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=yb(r,e[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,a):t[r]=a}}var DC=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bd(t,e){if(e){if(DC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(he(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(he(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(he(61))}if(e.style!=null&&typeof e.style!="object")throw Error(he(62))}}function _d(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Nd=null;function Dh(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var jd=null,ki=null,Ti=null;function gp(t){if(t=xo(t)){if(typeof jd!="function")throw Error(he(280));var e=t.stateNode;e&&(e=Cc(e),jd(t.stateNode,t.type,e))}}function vb(t){ki?Ti?Ti.push(t):Ti=[t]:ki=t}function wb(){if(ki){var t=ki,e=Ti;if(Ti=ki=null,gp(t),e)for(t=0;t<e.length;t++)gp(e[t])}}function bb(t,e){return t(e)}function _b(){}var Mu=!1;function Nb(t,e,r){if(Mu)return t(e,r);Mu=!0;try{return bb(t,e,r)}finally{Mu=!1,(ki!==null||Ti!==null)&&(_b(),wb())}}function Ka(t,e){var r=t.stateNode;if(r===null)return null;var n=Cc(r);if(n===null)return null;r=n[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(he(231,e,typeof r));return r}var Sd=!1;if(Ln)try{var ga={};Object.defineProperty(ga,"passive",{get:function(){Sd=!0}}),window.addEventListener("test",ga,ga),window.removeEventListener("test",ga,ga)}catch{Sd=!1}function OC(t,e,r,n,a,o,c,u,h){var f=Array.prototype.slice.call(arguments,3);try{e.apply(r,f)}catch(m){this.onError(m)}}var Ia=!1,Rl=null,Bl=!1,Cd=null,RC={onError:function(t){Ia=!0,Rl=t}};function BC(t,e,r,n,a,o,c,u,h){Ia=!1,Rl=null,OC.apply(RC,arguments)}function $C(t,e,r,n,a,o,c,u,h){if(BC.apply(this,arguments),Ia){if(Ia){var f=Rl;Ia=!1,Rl=null}else throw Error(he(198));Bl||(Bl=!0,Cd=f)}}function Gs(t){var e=t,r=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(r=e.return),t=e.return;while(t)}return e.tag===3?r:null}function jb(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function yp(t){if(Gs(t)!==t)throw Error(he(188))}function zC(t){var e=t.alternate;if(!e){if(e=Gs(t),e===null)throw Error(he(188));return e!==t?null:t}for(var r=t,n=e;;){var a=r.return;if(a===null)break;var o=a.alternate;if(o===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===r)return yp(a),t;if(o===n)return yp(a),e;o=o.sibling}throw Error(he(188))}if(r.return!==n.return)r=a,n=o;else{for(var c=!1,u=a.child;u;){if(u===r){c=!0,r=a,n=o;break}if(u===n){c=!0,n=a,r=o;break}u=u.sibling}if(!c){for(u=o.child;u;){if(u===r){c=!0,r=o,n=a;break}if(u===n){c=!0,n=o,r=a;break}u=u.sibling}if(!c)throw Error(he(189))}}if(r.alternate!==n)throw Error(he(190))}if(r.tag!==3)throw Error(he(188));return r.stateNode.current===r?t:e}function Sb(t){return t=zC(t),t!==null?Cb(t):null}function Cb(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Cb(t);if(e!==null)return e;t=t.sibling}return null}var Pb=vr.unstable_scheduleCallback,xp=vr.unstable_cancelCallback,FC=vr.unstable_shouldYield,UC=vr.unstable_requestPaint,ft=vr.unstable_now,qC=vr.unstable_getCurrentPriorityLevel,Oh=vr.unstable_ImmediatePriority,kb=vr.unstable_UserBlockingPriority,$l=vr.unstable_NormalPriority,HC=vr.unstable_LowPriority,Tb=vr.unstable_IdlePriority,_c=null,ln=null;function VC(t){if(ln&&typeof ln.onCommitFiberRoot=="function")try{ln.onCommitFiberRoot(_c,t,void 0,(t.current.flags&128)===128)}catch{}}var Wr=Math.clz32?Math.clz32:ZC,QC=Math.log,WC=Math.LN2;function ZC(t){return t>>>=0,t===0?32:31-(QC(t)/WC|0)|0}var Jo=64,Xo=4194304;function Ea(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function zl(t,e){var r=t.pendingLanes;if(r===0)return 0;var n=0,a=t.suspendedLanes,o=t.pingedLanes,c=r&268435455;if(c!==0){var u=c&~a;u!==0?n=Ea(u):(o&=c,o!==0&&(n=Ea(o)))}else c=r&~a,c!==0?n=Ea(c):o!==0&&(n=Ea(o));if(n===0)return 0;if(e!==0&&e!==n&&!(e&a)&&(a=n&-n,o=e&-e,a>=o||a===16&&(o&4194240)!==0))return e;if(n&4&&(n|=r&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=n;0<e;)r=31-Wr(e),a=1<<r,n|=t[r],e&=~a;return n}function KC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GC(t,e){for(var r=t.suspendedLanes,n=t.pingedLanes,a=t.expirationTimes,o=t.pendingLanes;0<o;){var c=31-Wr(o),u=1<<c,h=a[c];h===-1?(!(u&r)||u&n)&&(a[c]=KC(u,e)):h<=e&&(t.expiredLanes|=u),o&=~u}}function Pd(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Eb(){var t=Jo;return Jo<<=1,!(Jo&4194240)&&(Jo=64),t}function Iu(t){for(var e=[],r=0;31>r;r++)e.push(t);return e}function go(t,e,r){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Wr(e),t[e]=r}function YC(t,e){var r=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var a=31-Wr(r),o=1<<a;e[a]=0,n[a]=-1,t[a]=-1,r&=~o}}function Rh(t,e){var r=t.entangledLanes|=e;for(t=t.entanglements;r;){var n=31-Wr(r),a=1<<n;a&e|t[n]&e&&(t[n]|=e),r&=~a}}var We=0;function Lb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Ab,Bh,Mb,Ib,Db,kd=!1,el=[],ts=null,rs=null,ns=null,Ga=new Map,Ya=new Map,Gn=[],JC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vp(t,e){switch(t){case"focusin":case"focusout":ts=null;break;case"dragenter":case"dragleave":rs=null;break;case"mouseover":case"mouseout":ns=null;break;case"pointerover":case"pointerout":Ga.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ya.delete(e.pointerId)}}function ya(t,e,r,n,a,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[a]},e!==null&&(e=xo(e),e!==null&&Bh(e)),t):(t.eventSystemFlags|=n,e=t.targetContainers,a!==null&&e.indexOf(a)===-1&&e.push(a),t)}function XC(t,e,r,n,a){switch(e){case"focusin":return ts=ya(ts,t,e,r,n,a),!0;case"dragenter":return rs=ya(rs,t,e,r,n,a),!0;case"mouseover":return ns=ya(ns,t,e,r,n,a),!0;case"pointerover":var o=a.pointerId;return Ga.set(o,ya(Ga.get(o)||null,t,e,r,n,a)),!0;case"gotpointercapture":return o=a.pointerId,Ya.set(o,ya(Ya.get(o)||null,t,e,r,n,a)),!0}return!1}function Ob(t){var e=Is(t.target);if(e!==null){var r=Gs(e);if(r!==null){if(e=r.tag,e===13){if(e=jb(r),e!==null){t.blockedOn=e,Db(t.priority,function(){Mb(r)});return}}else if(e===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function vl(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var r=Td(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);Nd=n,r.target.dispatchEvent(n),Nd=null}else return e=xo(r),e!==null&&Bh(e),t.blockedOn=r,!1;e.shift()}return!0}function wp(t,e,r){vl(t)&&r.delete(e)}function eP(){kd=!1,ts!==null&&vl(ts)&&(ts=null),rs!==null&&vl(rs)&&(rs=null),ns!==null&&vl(ns)&&(ns=null),Ga.forEach(wp),Ya.forEach(wp)}function xa(t,e){t.blockedOn===e&&(t.blockedOn=null,kd||(kd=!0,vr.unstable_scheduleCallback(vr.unstable_NormalPriority,eP)))}function Ja(t){function e(a){return xa(a,t)}if(0<el.length){xa(el[0],t);for(var r=1;r<el.length;r++){var n=el[r];n.blockedOn===t&&(n.blockedOn=null)}}for(ts!==null&&xa(ts,t),rs!==null&&xa(rs,t),ns!==null&&xa(ns,t),Ga.forEach(e),Ya.forEach(e),r=0;r<Gn.length;r++)n=Gn[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<Gn.length&&(r=Gn[0],r.blockedOn===null);)Ob(r),r.blockedOn===null&&Gn.shift()}var Ei=zn.ReactCurrentBatchConfig,Fl=!0;function tP(t,e,r,n){var a=We,o=Ei.transition;Ei.transition=null;try{We=1,$h(t,e,r,n)}finally{We=a,Ei.transition=o}}function rP(t,e,r,n){var a=We,o=Ei.transition;Ei.transition=null;try{We=4,$h(t,e,r,n)}finally{We=a,Ei.transition=o}}function $h(t,e,r,n){if(Fl){var a=Td(t,e,r,n);if(a===null)Hu(t,e,n,Ul,r),vp(t,n);else if(XC(a,t,e,r,n))n.stopPropagation();else if(vp(t,n),e&4&&-1<JC.indexOf(t)){for(;a!==null;){var o=xo(a);if(o!==null&&Ab(o),o=Td(t,e,r,n),o===null&&Hu(t,e,n,Ul,r),o===a)break;a=o}a!==null&&n.stopPropagation()}else Hu(t,e,n,null,r)}}var Ul=null;function Td(t,e,r,n){if(Ul=null,t=Dh(n),t=Is(t),t!==null)if(e=Gs(t),e===null)t=null;else if(r=e.tag,r===13){if(t=jb(e),t!==null)return t;t=null}else if(r===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ul=t,null}function Rb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qC()){case Oh:return 1;case kb:return 4;case $l:case HC:return 16;case Tb:return 536870912;default:return 16}default:return 16}}var Xn=null,zh=null,wl=null;function Bb(){if(wl)return wl;var t,e=zh,r=e.length,n,a="value"in Xn?Xn.value:Xn.textContent,o=a.length;for(t=0;t<r&&e[t]===a[t];t++);var c=r-t;for(n=1;n<=c&&e[r-n]===a[o-n];n++);return wl=a.slice(t,1<n?1-n:void 0)}function bl(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function tl(){return!0}function bp(){return!1}function Nr(t){function e(r,n,a,o,c){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=o,this.target=c,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(r=t[u],this[u]=r?r(o):o[u]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?tl:bp,this.isPropagationStopped=bp,this}return ot(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=tl)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=tl)},persist:function(){},isPersistent:tl}),e}var Vi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Fh=Nr(Vi),yo=ot({},Vi,{view:0,detail:0}),nP=Nr(yo),Du,Ou,va,Nc=ot({},yo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Uh,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==va&&(va&&t.type==="mousemove"?(Du=t.screenX-va.screenX,Ou=t.screenY-va.screenY):Ou=Du=0,va=t),Du)},movementY:function(t){return"movementY"in t?t.movementY:Ou}}),_p=Nr(Nc),sP=ot({},Nc,{dataTransfer:0}),iP=Nr(sP),aP=ot({},yo,{relatedTarget:0}),Ru=Nr(aP),oP=ot({},Vi,{animationName:0,elapsedTime:0,pseudoElement:0}),lP=Nr(oP),cP=ot({},Vi,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),uP=Nr(cP),dP=ot({},Vi,{data:0}),Np=Nr(dP),hP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=mP[t])?!!e[t]:!1}function Uh(){return pP}var gP=ot({},yo,{key:function(t){if(t.key){var e=hP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=bl(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?fP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Uh,charCode:function(t){return t.type==="keypress"?bl(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?bl(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),yP=Nr(gP),xP=ot({},Nc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jp=Nr(xP),vP=ot({},yo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Uh}),wP=Nr(vP),bP=ot({},Vi,{propertyName:0,elapsedTime:0,pseudoElement:0}),_P=Nr(bP),NP=ot({},Nc,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),jP=Nr(NP),SP=[9,13,27,32],qh=Ln&&"CompositionEvent"in window,Da=null;Ln&&"documentMode"in document&&(Da=document.documentMode);var CP=Ln&&"TextEvent"in window&&!Da,$b=Ln&&(!qh||Da&&8<Da&&11>=Da),Sp=" ",Cp=!1;function zb(t,e){switch(t){case"keyup":return SP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var gi=!1;function PP(t,e){switch(t){case"compositionend":return Fb(e);case"keypress":return e.which!==32?null:(Cp=!0,Sp);case"textInput":return t=e.data,t===Sp&&Cp?null:t;default:return null}}function kP(t,e){if(gi)return t==="compositionend"||!qh&&zb(t,e)?(t=Bb(),wl=zh=Xn=null,gi=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return $b&&e.locale!=="ko"?null:e.data;default:return null}}var TP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Pp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!TP[t.type]:e==="textarea"}function Ub(t,e,r,n){vb(n),e=ql(e,"onChange"),0<e.length&&(r=new Fh("onChange","change",null,r,n),t.push({event:r,listeners:e}))}var Oa=null,Xa=null;function EP(t){Xb(t,0)}function jc(t){var e=vi(t);if(hb(e))return t}function LP(t,e){if(t==="change")return e}var qb=!1;if(Ln){var Bu;if(Ln){var $u="oninput"in document;if(!$u){var kp=document.createElement("div");kp.setAttribute("oninput","return;"),$u=typeof kp.oninput=="function"}Bu=$u}else Bu=!1;qb=Bu&&(!document.documentMode||9<document.documentMode)}function Tp(){Oa&&(Oa.detachEvent("onpropertychange",Hb),Xa=Oa=null)}function Hb(t){if(t.propertyName==="value"&&jc(Xa)){var e=[];Ub(e,Xa,t,Dh(t)),Nb(EP,e)}}function AP(t,e,r){t==="focusin"?(Tp(),Oa=e,Xa=r,Oa.attachEvent("onpropertychange",Hb)):t==="focusout"&&Tp()}function MP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jc(Xa)}function IP(t,e){if(t==="click")return jc(e)}function DP(t,e){if(t==="input"||t==="change")return jc(e)}function OP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Kr=typeof Object.is=="function"?Object.is:OP;function eo(t,e){if(Kr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!dd.call(e,a)||!Kr(t[a],e[a]))return!1}return!0}function Ep(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Lp(t,e){var r=Ep(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=e&&n>=e)return{node:r,offset:e-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Ep(r)}}function Vb(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Vb(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Qb(){for(var t=window,e=Ol();e instanceof t.HTMLIFrameElement;){try{var r=typeof e.contentWindow.location.href=="string"}catch{r=!1}if(r)t=e.contentWindow;else break;e=Ol(t.document)}return e}function Hh(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function RP(t){var e=Qb(),r=t.focusedElem,n=t.selectionRange;if(e!==r&&r&&r.ownerDocument&&Vb(r.ownerDocument.documentElement,r)){if(n!==null&&Hh(r)){if(e=n.start,t=n.end,t===void 0&&(t=e),"selectionStart"in r)r.selectionStart=e,r.selectionEnd=Math.min(t,r.value.length);else if(t=(e=r.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var a=r.textContent.length,o=Math.min(n.start,a);n=n.end===void 0?o:Math.min(n.end,a),!t.extend&&o>n&&(a=n,n=o,o=a),a=Lp(r,o);var c=Lp(r,n);a&&c&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==c.node||t.focusOffset!==c.offset)&&(e=e.createRange(),e.setStart(a.node,a.offset),t.removeAllRanges(),o>n?(t.addRange(e),t.extend(c.node,c.offset)):(e.setEnd(c.node,c.offset),t.addRange(e)))}}for(e=[],t=r;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<e.length;r++)t=e[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var BP=Ln&&"documentMode"in document&&11>=document.documentMode,yi=null,Ed=null,Ra=null,Ld=!1;function Ap(t,e,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Ld||yi==null||yi!==Ol(n)||(n=yi,"selectionStart"in n&&Hh(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Ra&&eo(Ra,n)||(Ra=n,n=ql(Ed,"onSelect"),0<n.length&&(e=new Fh("onSelect","select",null,e,r),t.push({event:e,listeners:n}),e.target=yi)))}function rl(t,e){var r={};return r[t.toLowerCase()]=e.toLowerCase(),r["Webkit"+t]="webkit"+e,r["Moz"+t]="moz"+e,r}var xi={animationend:rl("Animation","AnimationEnd"),animationiteration:rl("Animation","AnimationIteration"),animationstart:rl("Animation","AnimationStart"),transitionend:rl("Transition","TransitionEnd")},zu={},Wb={};Ln&&(Wb=document.createElement("div").style,"AnimationEvent"in window||(delete xi.animationend.animation,delete xi.animationiteration.animation,delete xi.animationstart.animation),"TransitionEvent"in window||delete xi.transitionend.transition);function Sc(t){if(zu[t])return zu[t];if(!xi[t])return t;var e=xi[t],r;for(r in e)if(e.hasOwnProperty(r)&&r in Wb)return zu[t]=e[r];return t}var Zb=Sc("animationend"),Kb=Sc("animationiteration"),Gb=Sc("animationstart"),Yb=Sc("transitionend"),Jb=new Map,Mp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ms(t,e){Jb.set(t,e),Ks(e,[t])}for(var Fu=0;Fu<Mp.length;Fu++){var Uu=Mp[Fu],$P=Uu.toLowerCase(),zP=Uu[0].toUpperCase()+Uu.slice(1);ms($P,"on"+zP)}ms(Zb,"onAnimationEnd");ms(Kb,"onAnimationIteration");ms(Gb,"onAnimationStart");ms("dblclick","onDoubleClick");ms("focusin","onFocus");ms("focusout","onBlur");ms(Yb,"onTransitionEnd");Oi("onMouseEnter",["mouseout","mouseover"]);Oi("onMouseLeave",["mouseout","mouseover"]);Oi("onPointerEnter",["pointerout","pointerover"]);Oi("onPointerLeave",["pointerout","pointerover"]);Ks("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ks("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ks("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ks("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ks("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ks("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var La="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FP=new Set("cancel close invalid load scroll toggle".split(" ").concat(La));function Ip(t,e,r){var n=t.type||"unknown-event";t.currentTarget=r,$C(n,e,void 0,t),t.currentTarget=null}function Xb(t,e){e=(e&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],a=n.event;n=n.listeners;e:{var o=void 0;if(e)for(var c=n.length-1;0<=c;c--){var u=n[c],h=u.instance,f=u.currentTarget;if(u=u.listener,h!==o&&a.isPropagationStopped())break e;Ip(a,u,f),o=h}else for(c=0;c<n.length;c++){if(u=n[c],h=u.instance,f=u.currentTarget,u=u.listener,h!==o&&a.isPropagationStopped())break e;Ip(a,u,f),o=h}}}if(Bl)throw t=Cd,Bl=!1,Cd=null,t}function Xe(t,e){var r=e[Od];r===void 0&&(r=e[Od]=new Set);var n=t+"__bubble";r.has(n)||(e1(e,t,2,!1),r.add(n))}function qu(t,e,r){var n=0;e&&(n|=4),e1(r,t,n,e)}var nl="_reactListening"+Math.random().toString(36).slice(2);function to(t){if(!t[nl]){t[nl]=!0,ob.forEach(function(r){r!=="selectionchange"&&(FP.has(r)||qu(r,!1,t),qu(r,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[nl]||(e[nl]=!0,qu("selectionchange",!1,e))}}function e1(t,e,r,n){switch(Rb(e)){case 1:var a=tP;break;case 4:a=rP;break;default:a=$h}r=a.bind(null,e,r,t),a=void 0,!Sd||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(a=!0),n?a!==void 0?t.addEventListener(e,r,{capture:!0,passive:a}):t.addEventListener(e,r,!0):a!==void 0?t.addEventListener(e,r,{passive:a}):t.addEventListener(e,r,!1)}function Hu(t,e,r,n,a){var o=n;if(!(e&1)&&!(e&2)&&n!==null)e:for(;;){if(n===null)return;var c=n.tag;if(c===3||c===4){var u=n.stateNode.containerInfo;if(u===a||u.nodeType===8&&u.parentNode===a)break;if(c===4)for(c=n.return;c!==null;){var h=c.tag;if((h===3||h===4)&&(h=c.stateNode.containerInfo,h===a||h.nodeType===8&&h.parentNode===a))return;c=c.return}for(;u!==null;){if(c=Is(u),c===null)return;if(h=c.tag,h===5||h===6){n=o=c;continue e}u=u.parentNode}}n=n.return}Nb(function(){var f=o,m=Dh(r),v=[];e:{var w=Jb.get(t);if(w!==void 0){var N=Fh,g=t;switch(t){case"keypress":if(bl(r)===0)break e;case"keydown":case"keyup":N=yP;break;case"focusin":g="focus",N=Ru;break;case"focusout":g="blur",N=Ru;break;case"beforeblur":case"afterblur":N=Ru;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":N=_p;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":N=iP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":N=wP;break;case Zb:case Kb:case Gb:N=lP;break;case Yb:N=_P;break;case"scroll":N=nP;break;case"wheel":N=jP;break;case"copy":case"cut":case"paste":N=uP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":N=jp}var y=(e&4)!==0,j=!y&&t==="scroll",_=y?w!==null?w+"Capture":null:w;y=[];for(var b=f,P;b!==null;){P=b;var B=P.stateNode;if(P.tag===5&&B!==null&&(P=B,_!==null&&(B=Ka(b,_),B!=null&&y.push(ro(b,B,P)))),j)break;b=b.return}0<y.length&&(w=new N(w,g,null,r,m),v.push({event:w,listeners:y}))}}if(!(e&7)){e:{if(w=t==="mouseover"||t==="pointerover",N=t==="mouseout"||t==="pointerout",w&&r!==Nd&&(g=r.relatedTarget||r.fromElement)&&(Is(g)||g[An]))break e;if((N||w)&&(w=m.window===m?m:(w=m.ownerDocument)?w.defaultView||w.parentWindow:window,N?(g=r.relatedTarget||r.toElement,N=f,g=g?Is(g):null,g!==null&&(j=Gs(g),g!==j||g.tag!==5&&g.tag!==6)&&(g=null)):(N=null,g=f),N!==g)){if(y=_p,B="onMouseLeave",_="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(y=jp,B="onPointerLeave",_="onPointerEnter",b="pointer"),j=N==null?w:vi(N),P=g==null?w:vi(g),w=new y(B,b+"leave",N,r,m),w.target=j,w.relatedTarget=P,B=null,Is(m)===f&&(y=new y(_,b+"enter",g,r,m),y.target=P,y.relatedTarget=j,B=y),j=B,N&&g)t:{for(y=N,_=g,b=0,P=y;P;P=ui(P))b++;for(P=0,B=_;B;B=ui(B))P++;for(;0<b-P;)y=ui(y),b--;for(;0<P-b;)_=ui(_),P--;for(;b--;){if(y===_||_!==null&&y===_.alternate)break t;y=ui(y),_=ui(_)}y=null}else y=null;N!==null&&Dp(v,w,N,y,!1),g!==null&&j!==null&&Dp(v,j,g,y,!0)}}e:{if(w=f?vi(f):window,N=w.nodeName&&w.nodeName.toLowerCase(),N==="select"||N==="input"&&w.type==="file")var $=LP;else if(Pp(w))if(qb)$=DP;else{$=MP;var k=AP}else(N=w.nodeName)&&N.toLowerCase()==="input"&&(w.type==="checkbox"||w.type==="radio")&&($=IP);if($&&($=$(t,f))){Ub(v,$,r,m);break e}k&&k(t,w,f),t==="focusout"&&(k=w._wrapperState)&&k.controlled&&w.type==="number"&&xd(w,"number",w.value)}switch(k=f?vi(f):window,t){case"focusin":(Pp(k)||k.contentEditable==="true")&&(yi=k,Ed=f,Ra=null);break;case"focusout":Ra=Ed=yi=null;break;case"mousedown":Ld=!0;break;case"contextmenu":case"mouseup":case"dragend":Ld=!1,Ap(v,r,m);break;case"selectionchange":if(BP)break;case"keydown":case"keyup":Ap(v,r,m)}var I;if(qh)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else gi?zb(t,r)&&(T="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(T="onCompositionStart");T&&($b&&r.locale!=="ko"&&(gi||T!=="onCompositionStart"?T==="onCompositionEnd"&&gi&&(I=Bb()):(Xn=m,zh="value"in Xn?Xn.value:Xn.textContent,gi=!0)),k=ql(f,T),0<k.length&&(T=new Np(T,t,null,r,m),v.push({event:T,listeners:k}),I?T.data=I:(I=Fb(r),I!==null&&(T.data=I)))),(I=CP?PP(t,r):kP(t,r))&&(f=ql(f,"onBeforeInput"),0<f.length&&(m=new Np("onBeforeInput","beforeinput",null,r,m),v.push({event:m,listeners:f}),m.data=I))}Xb(v,e)})}function ro(t,e,r){return{instance:t,listener:e,currentTarget:r}}function ql(t,e){for(var r=e+"Capture",n=[];t!==null;){var a=t,o=a.stateNode;a.tag===5&&o!==null&&(a=o,o=Ka(t,r),o!=null&&n.unshift(ro(t,o,a)),o=Ka(t,e),o!=null&&n.push(ro(t,o,a))),t=t.return}return n}function ui(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Dp(t,e,r,n,a){for(var o=e._reactName,c=[];r!==null&&r!==n;){var u=r,h=u.alternate,f=u.stateNode;if(h!==null&&h===n)break;u.tag===5&&f!==null&&(u=f,a?(h=Ka(r,o),h!=null&&c.unshift(ro(r,h,u))):a||(h=Ka(r,o),h!=null&&c.push(ro(r,h,u)))),r=r.return}c.length!==0&&t.push({event:e,listeners:c})}var UP=/\r\n?/g,qP=/\u0000|\uFFFD/g;function Op(t){return(typeof t=="string"?t:""+t).replace(UP,`
`).replace(qP,"")}function sl(t,e,r){if(e=Op(e),Op(t)!==e&&r)throw Error(he(425))}function Hl(){}var Ad=null,Md=null;function Id(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Dd=typeof setTimeout=="function"?setTimeout:void 0,HP=typeof clearTimeout=="function"?clearTimeout:void 0,Rp=typeof Promise=="function"?Promise:void 0,VP=typeof queueMicrotask=="function"?queueMicrotask:typeof Rp<"u"?function(t){return Rp.resolve(null).then(t).catch(QP)}:Dd;function QP(t){setTimeout(function(){throw t})}function Vu(t,e){var r=e,n=0;do{var a=r.nextSibling;if(t.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){t.removeChild(a),Ja(e);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);Ja(e)}function ss(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Bp(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(e===0)return t;e--}else r==="/$"&&e++}t=t.previousSibling}return null}var Qi=Math.random().toString(36).slice(2),an="__reactFiber$"+Qi,no="__reactProps$"+Qi,An="__reactContainer$"+Qi,Od="__reactEvents$"+Qi,WP="__reactListeners$"+Qi,ZP="__reactHandles$"+Qi;function Is(t){var e=t[an];if(e)return e;for(var r=t.parentNode;r;){if(e=r[An]||r[an]){if(r=e.alternate,e.child!==null||r!==null&&r.child!==null)for(t=Bp(t);t!==null;){if(r=t[an])return r;t=Bp(t)}return e}t=r,r=t.parentNode}return null}function xo(t){return t=t[an]||t[An],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function vi(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(he(33))}function Cc(t){return t[no]||null}var Rd=[],wi=-1;function ps(t){return{current:t}}function et(t){0>wi||(t.current=Rd[wi],Rd[wi]=null,wi--)}function Je(t,e){wi++,Rd[wi]=t.current,t.current=e}var hs={},Qt=ps(hs),ar=ps(!1),zs=hs;function Ri(t,e){var r=t.type.contextTypes;if(!r)return hs;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===e)return n.__reactInternalMemoizedMaskedChildContext;var a={},o;for(o in r)a[o]=e[o];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=a),a}function or(t){return t=t.childContextTypes,t!=null}function Vl(){et(ar),et(Qt)}function $p(t,e,r){if(Qt.current!==hs)throw Error(he(168));Je(Qt,e),Je(ar,r)}function t1(t,e,r){var n=t.stateNode;if(e=e.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in e))throw Error(he(108,AC(t)||"Unknown",a));return ot({},r,n)}function Ql(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||hs,zs=Qt.current,Je(Qt,t),Je(ar,ar.current),!0}function zp(t,e,r){var n=t.stateNode;if(!n)throw Error(he(169));r?(t=t1(t,e,zs),n.__reactInternalMemoizedMergedChildContext=t,et(ar),et(Qt),Je(Qt,t)):et(ar),Je(ar,r)}var Nn=null,Pc=!1,Qu=!1;function r1(t){Nn===null?Nn=[t]:Nn.push(t)}function KP(t){Pc=!0,r1(t)}function gs(){if(!Qu&&Nn!==null){Qu=!0;var t=0,e=We;try{var r=Nn;for(We=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}Nn=null,Pc=!1}catch(a){throw Nn!==null&&(Nn=Nn.slice(t+1)),Pb(Oh,gs),a}finally{We=e,Qu=!1}}return null}var bi=[],_i=0,Wl=null,Zl=0,Lr=[],Ar=0,Fs=null,Sn=1,Cn="";function ks(t,e){bi[_i++]=Zl,bi[_i++]=Wl,Wl=t,Zl=e}function n1(t,e,r){Lr[Ar++]=Sn,Lr[Ar++]=Cn,Lr[Ar++]=Fs,Fs=t;var n=Sn;t=Cn;var a=32-Wr(n)-1;n&=~(1<<a),r+=1;var o=32-Wr(e)+a;if(30<o){var c=a-a%5;o=(n&(1<<c)-1).toString(32),n>>=c,a-=c,Sn=1<<32-Wr(e)+a|r<<a|n,Cn=o+t}else Sn=1<<o|r<<a|n,Cn=t}function Vh(t){t.return!==null&&(ks(t,1),n1(t,1,0))}function Qh(t){for(;t===Wl;)Wl=bi[--_i],bi[_i]=null,Zl=bi[--_i],bi[_i]=null;for(;t===Fs;)Fs=Lr[--Ar],Lr[Ar]=null,Cn=Lr[--Ar],Lr[Ar]=null,Sn=Lr[--Ar],Lr[Ar]=null}var xr=null,yr=null,rt=!1,Vr=null;function s1(t,e){var r=Mr(5,null,null,0);r.elementType="DELETED",r.stateNode=e,r.return=t,e=t.deletions,e===null?(t.deletions=[r],t.flags|=16):e.push(r)}function Fp(t,e){switch(t.tag){case 5:var r=t.type;return e=e.nodeType!==1||r.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,xr=t,yr=ss(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,xr=t,yr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(r=Fs!==null?{id:Sn,overflow:Cn}:null,t.memoizedState={dehydrated:e,treeContext:r,retryLane:1073741824},r=Mr(18,null,null,0),r.stateNode=e,r.return=t,t.child=r,xr=t,yr=null,!0):!1;default:return!1}}function Bd(t){return(t.mode&1)!==0&&(t.flags&128)===0}function $d(t){if(rt){var e=yr;if(e){var r=e;if(!Fp(t,e)){if(Bd(t))throw Error(he(418));e=ss(r.nextSibling);var n=xr;e&&Fp(t,e)?s1(n,r):(t.flags=t.flags&-4097|2,rt=!1,xr=t)}}else{if(Bd(t))throw Error(he(418));t.flags=t.flags&-4097|2,rt=!1,xr=t}}}function Up(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;xr=t}function il(t){if(t!==xr)return!1;if(!rt)return Up(t),rt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Id(t.type,t.memoizedProps)),e&&(e=yr)){if(Bd(t))throw i1(),Error(he(418));for(;e;)s1(t,e),e=ss(e.nextSibling)}if(Up(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(he(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(e===0){yr=ss(t.nextSibling);break e}e--}else r!=="$"&&r!=="$!"&&r!=="$?"||e++}t=t.nextSibling}yr=null}}else yr=xr?ss(t.stateNode.nextSibling):null;return!0}function i1(){for(var t=yr;t;)t=ss(t.nextSibling)}function Bi(){yr=xr=null,rt=!1}function Wh(t){Vr===null?Vr=[t]:Vr.push(t)}var GP=zn.ReactCurrentBatchConfig;function wa(t,e,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(he(309));var n=r.stateNode}if(!n)throw Error(he(147,t));var a=n,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(c){var u=a.refs;c===null?delete u[o]:u[o]=c},e._stringRef=o,e)}if(typeof t!="string")throw Error(he(284));if(!r._owner)throw Error(he(290,t))}return t}function al(t,e){throw t=Object.prototype.toString.call(e),Error(he(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function qp(t){var e=t._init;return e(t._payload)}function a1(t){function e(_,b){if(t){var P=_.deletions;P===null?(_.deletions=[b],_.flags|=16):P.push(b)}}function r(_,b){if(!t)return null;for(;b!==null;)e(_,b),b=b.sibling;return null}function n(_,b){for(_=new Map;b!==null;)b.key!==null?_.set(b.key,b):_.set(b.index,b),b=b.sibling;return _}function a(_,b){return _=ls(_,b),_.index=0,_.sibling=null,_}function o(_,b,P){return _.index=P,t?(P=_.alternate,P!==null?(P=P.index,P<b?(_.flags|=2,b):P):(_.flags|=2,b)):(_.flags|=1048576,b)}function c(_){return t&&_.alternate===null&&(_.flags|=2),_}function u(_,b,P,B){return b===null||b.tag!==6?(b=Xu(P,_.mode,B),b.return=_,b):(b=a(b,P),b.return=_,b)}function h(_,b,P,B){var $=P.type;return $===pi?m(_,b,P.props.children,B,P.key):b!==null&&(b.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Qn&&qp($)===b.type)?(B=a(b,P.props),B.ref=wa(_,b,P),B.return=_,B):(B=kl(P.type,P.key,P.props,null,_.mode,B),B.ref=wa(_,b,P),B.return=_,B)}function f(_,b,P,B){return b===null||b.tag!==4||b.stateNode.containerInfo!==P.containerInfo||b.stateNode.implementation!==P.implementation?(b=ed(P,_.mode,B),b.return=_,b):(b=a(b,P.children||[]),b.return=_,b)}function m(_,b,P,B,$){return b===null||b.tag!==7?(b=$s(P,_.mode,B,$),b.return=_,b):(b=a(b,P),b.return=_,b)}function v(_,b,P){if(typeof b=="string"&&b!==""||typeof b=="number")return b=Xu(""+b,_.mode,P),b.return=_,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ko:return P=kl(b.type,b.key,b.props,null,_.mode,P),P.ref=wa(_,null,b),P.return=_,P;case mi:return b=ed(b,_.mode,P),b.return=_,b;case Qn:var B=b._init;return v(_,B(b._payload),P)}if(Ta(b)||pa(b))return b=$s(b,_.mode,P,null),b.return=_,b;al(_,b)}return null}function w(_,b,P,B){var $=b!==null?b.key:null;if(typeof P=="string"&&P!==""||typeof P=="number")return $!==null?null:u(_,b,""+P,B);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case Ko:return P.key===$?h(_,b,P,B):null;case mi:return P.key===$?f(_,b,P,B):null;case Qn:return $=P._init,w(_,b,$(P._payload),B)}if(Ta(P)||pa(P))return $!==null?null:m(_,b,P,B,null);al(_,P)}return null}function N(_,b,P,B,$){if(typeof B=="string"&&B!==""||typeof B=="number")return _=_.get(P)||null,u(b,_,""+B,$);if(typeof B=="object"&&B!==null){switch(B.$$typeof){case Ko:return _=_.get(B.key===null?P:B.key)||null,h(b,_,B,$);case mi:return _=_.get(B.key===null?P:B.key)||null,f(b,_,B,$);case Qn:var k=B._init;return N(_,b,P,k(B._payload),$)}if(Ta(B)||pa(B))return _=_.get(P)||null,m(b,_,B,$,null);al(b,B)}return null}function g(_,b,P,B){for(var $=null,k=null,I=b,T=b=0,D=null;I!==null&&T<P.length;T++){I.index>T?(D=I,I=null):D=I.sibling;var U=w(_,I,P[T],B);if(U===null){I===null&&(I=D);break}t&&I&&U.alternate===null&&e(_,I),b=o(U,b,T),k===null?$=U:k.sibling=U,k=U,I=D}if(T===P.length)return r(_,I),rt&&ks(_,T),$;if(I===null){for(;T<P.length;T++)I=v(_,P[T],B),I!==null&&(b=o(I,b,T),k===null?$=I:k.sibling=I,k=I);return rt&&ks(_,T),$}for(I=n(_,I);T<P.length;T++)D=N(I,_,T,P[T],B),D!==null&&(t&&D.alternate!==null&&I.delete(D.key===null?T:D.key),b=o(D,b,T),k===null?$=D:k.sibling=D,k=D);return t&&I.forEach(function(V){return e(_,V)}),rt&&ks(_,T),$}function y(_,b,P,B){var $=pa(P);if(typeof $!="function")throw Error(he(150));if(P=$.call(P),P==null)throw Error(he(151));for(var k=$=null,I=b,T=b=0,D=null,U=P.next();I!==null&&!U.done;T++,U=P.next()){I.index>T?(D=I,I=null):D=I.sibling;var V=w(_,I,U.value,B);if(V===null){I===null&&(I=D);break}t&&I&&V.alternate===null&&e(_,I),b=o(V,b,T),k===null?$=V:k.sibling=V,k=V,I=D}if(U.done)return r(_,I),rt&&ks(_,T),$;if(I===null){for(;!U.done;T++,U=P.next())U=v(_,U.value,B),U!==null&&(b=o(U,b,T),k===null?$=U:k.sibling=U,k=U);return rt&&ks(_,T),$}for(I=n(_,I);!U.done;T++,U=P.next())U=N(I,_,T,U.value,B),U!==null&&(t&&U.alternate!==null&&I.delete(U.key===null?T:U.key),b=o(U,b,T),k===null?$=U:k.sibling=U,k=U);return t&&I.forEach(function(z){return e(_,z)}),rt&&ks(_,T),$}function j(_,b,P,B){if(typeof P=="object"&&P!==null&&P.type===pi&&P.key===null&&(P=P.props.children),typeof P=="object"&&P!==null){switch(P.$$typeof){case Ko:e:{for(var $=P.key,k=b;k!==null;){if(k.key===$){if($=P.type,$===pi){if(k.tag===7){r(_,k.sibling),b=a(k,P.props.children),b.return=_,_=b;break e}}else if(k.elementType===$||typeof $=="object"&&$!==null&&$.$$typeof===Qn&&qp($)===k.type){r(_,k.sibling),b=a(k,P.props),b.ref=wa(_,k,P),b.return=_,_=b;break e}r(_,k);break}else e(_,k);k=k.sibling}P.type===pi?(b=$s(P.props.children,_.mode,B,P.key),b.return=_,_=b):(B=kl(P.type,P.key,P.props,null,_.mode,B),B.ref=wa(_,b,P),B.return=_,_=B)}return c(_);case mi:e:{for(k=P.key;b!==null;){if(b.key===k)if(b.tag===4&&b.stateNode.containerInfo===P.containerInfo&&b.stateNode.implementation===P.implementation){r(_,b.sibling),b=a(b,P.children||[]),b.return=_,_=b;break e}else{r(_,b);break}else e(_,b);b=b.sibling}b=ed(P,_.mode,B),b.return=_,_=b}return c(_);case Qn:return k=P._init,j(_,b,k(P._payload),B)}if(Ta(P))return g(_,b,P,B);if(pa(P))return y(_,b,P,B);al(_,P)}return typeof P=="string"&&P!==""||typeof P=="number"?(P=""+P,b!==null&&b.tag===6?(r(_,b.sibling),b=a(b,P),b.return=_,_=b):(r(_,b),b=Xu(P,_.mode,B),b.return=_,_=b),c(_)):r(_,b)}return j}var $i=a1(!0),o1=a1(!1),Kl=ps(null),Gl=null,Ni=null,Zh=null;function Kh(){Zh=Ni=Gl=null}function Gh(t){var e=Kl.current;et(Kl),t._currentValue=e}function zd(t,e,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,n!==null&&(n.childLanes|=e)):n!==null&&(n.childLanes&e)!==e&&(n.childLanes|=e),t===r)break;t=t.return}}function Li(t,e){Gl=t,Zh=Ni=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ir=!0),t.firstContext=null)}function Dr(t){var e=t._currentValue;if(Zh!==t)if(t={context:t,memoizedValue:e,next:null},Ni===null){if(Gl===null)throw Error(he(308));Ni=t,Gl.dependencies={lanes:0,firstContext:t}}else Ni=Ni.next=t;return e}var Ds=null;function Yh(t){Ds===null?Ds=[t]:Ds.push(t)}function l1(t,e,r,n){var a=e.interleaved;return a===null?(r.next=r,Yh(e)):(r.next=a.next,a.next=r),e.interleaved=r,Mn(t,n)}function Mn(t,e){t.lanes|=e;var r=t.alternate;for(r!==null&&(r.lanes|=e),r=t,t=t.return;t!==null;)t.childLanes|=e,r=t.alternate,r!==null&&(r.childLanes|=e),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Wn=!1;function Jh(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function c1(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Tn(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function is(t,e,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,qe&2){var a=n.pending;return a===null?e.next=e:(e.next=a.next,a.next=e),n.pending=e,Mn(t,r)}return a=n.interleaved,a===null?(e.next=e,Yh(n)):(e.next=a.next,a.next=e),n.interleaved=e,Mn(t,r)}function _l(t,e,r){if(e=e.updateQueue,e!==null&&(e=e.shared,(r&4194240)!==0)){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Rh(t,r)}}function Hp(t,e){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,o=null;if(r=r.firstBaseUpdate,r!==null){do{var c={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};o===null?a=o=c:o=o.next=c,r=r.next}while(r!==null);o===null?a=o=e:o=o.next=e}else a=o=e;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=e:t.next=e,r.lastBaseUpdate=e}function Yl(t,e,r,n){var a=t.updateQueue;Wn=!1;var o=a.firstBaseUpdate,c=a.lastBaseUpdate,u=a.shared.pending;if(u!==null){a.shared.pending=null;var h=u,f=h.next;h.next=null,c===null?o=f:c.next=f,c=h;var m=t.alternate;m!==null&&(m=m.updateQueue,u=m.lastBaseUpdate,u!==c&&(u===null?m.firstBaseUpdate=f:u.next=f,m.lastBaseUpdate=h))}if(o!==null){var v=a.baseState;c=0,m=f=h=null,u=o;do{var w=u.lane,N=u.eventTime;if((n&w)===w){m!==null&&(m=m.next={eventTime:N,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var g=t,y=u;switch(w=e,N=r,y.tag){case 1:if(g=y.payload,typeof g=="function"){v=g.call(N,v,w);break e}v=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=y.payload,w=typeof g=="function"?g.call(N,v,w):g,w==null)break e;v=ot({},v,w);break e;case 2:Wn=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,w=a.effects,w===null?a.effects=[u]:w.push(u))}else N={eventTime:N,lane:w,tag:u.tag,payload:u.payload,callback:u.callback,next:null},m===null?(f=m=N,h=v):m=m.next=N,c|=w;if(u=u.next,u===null){if(u=a.shared.pending,u===null)break;w=u,u=w.next,w.next=null,a.lastBaseUpdate=w,a.shared.pending=null}}while(!0);if(m===null&&(h=v),a.baseState=h,a.firstBaseUpdate=f,a.lastBaseUpdate=m,e=a.shared.interleaved,e!==null){a=e;do c|=a.lane,a=a.next;while(a!==e)}else o===null&&(a.shared.lanes=0);qs|=c,t.lanes=c,t.memoizedState=v}}function Vp(t,e,r){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var n=t[e],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(he(191,a));a.call(n)}}}var vo={},cn=ps(vo),so=ps(vo),io=ps(vo);function Os(t){if(t===vo)throw Error(he(174));return t}function Xh(t,e){switch(Je(io,e),Je(so,t),Je(cn,vo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:wd(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=wd(e,t)}et(cn),Je(cn,e)}function zi(){et(cn),et(so),et(io)}function u1(t){Os(io.current);var e=Os(cn.current),r=wd(e,t.type);e!==r&&(Je(so,t),Je(cn,r))}function ef(t){so.current===t&&(et(cn),et(so))}var it=ps(0);function Jl(t){for(var e=t;e!==null;){if(e.tag===13){var r=e.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Wu=[];function tf(){for(var t=0;t<Wu.length;t++)Wu[t]._workInProgressVersionPrimary=null;Wu.length=0}var Nl=zn.ReactCurrentDispatcher,Zu=zn.ReactCurrentBatchConfig,Us=0,at=null,bt=null,Pt=null,Xl=!1,Ba=!1,ao=0,YP=0;function zt(){throw Error(he(321))}function rf(t,e){if(e===null)return!1;for(var r=0;r<e.length&&r<t.length;r++)if(!Kr(t[r],e[r]))return!1;return!0}function nf(t,e,r,n,a,o){if(Us=o,at=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Nl.current=t===null||t.memoizedState===null?t4:r4,t=r(n,a),Ba){o=0;do{if(Ba=!1,ao=0,25<=o)throw Error(he(301));o+=1,Pt=bt=null,e.updateQueue=null,Nl.current=n4,t=r(n,a)}while(Ba)}if(Nl.current=ec,e=bt!==null&&bt.next!==null,Us=0,Pt=bt=at=null,Xl=!1,e)throw Error(he(300));return t}function sf(){var t=ao!==0;return ao=0,t}function sn(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Pt===null?at.memoizedState=Pt=t:Pt=Pt.next=t,Pt}function Or(){if(bt===null){var t=at.alternate;t=t!==null?t.memoizedState:null}else t=bt.next;var e=Pt===null?at.memoizedState:Pt.next;if(e!==null)Pt=e,bt=t;else{if(t===null)throw Error(he(310));bt=t,t={memoizedState:bt.memoizedState,baseState:bt.baseState,baseQueue:bt.baseQueue,queue:bt.queue,next:null},Pt===null?at.memoizedState=Pt=t:Pt=Pt.next=t}return Pt}function oo(t,e){return typeof e=="function"?e(t):e}function Ku(t){var e=Or(),r=e.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=t;var n=bt,a=n.baseQueue,o=r.pending;if(o!==null){if(a!==null){var c=a.next;a.next=o.next,o.next=c}n.baseQueue=a=o,r.pending=null}if(a!==null){o=a.next,n=n.baseState;var u=c=null,h=null,f=o;do{var m=f.lane;if((Us&m)===m)h!==null&&(h=h.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:t(n,f.action);else{var v={lane:m,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};h===null?(u=h=v,c=n):h=h.next=v,at.lanes|=m,qs|=m}f=f.next}while(f!==null&&f!==o);h===null?c=n:h.next=u,Kr(n,e.memoizedState)||(ir=!0),e.memoizedState=n,e.baseState=c,e.baseQueue=h,r.lastRenderedState=n}if(t=r.interleaved,t!==null){a=t;do o=a.lane,at.lanes|=o,qs|=o,a=a.next;while(a!==t)}else a===null&&(r.lanes=0);return[e.memoizedState,r.dispatch]}function Gu(t){var e=Or(),r=e.queue;if(r===null)throw Error(he(311));r.lastRenderedReducer=t;var n=r.dispatch,a=r.pending,o=e.memoizedState;if(a!==null){r.pending=null;var c=a=a.next;do o=t(o,c.action),c=c.next;while(c!==a);Kr(o,e.memoizedState)||(ir=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),r.lastRenderedState=o}return[o,n]}function d1(){}function h1(t,e){var r=at,n=Or(),a=e(),o=!Kr(n.memoizedState,a);if(o&&(n.memoizedState=a,ir=!0),n=n.queue,af(p1.bind(null,r,n,t),[t]),n.getSnapshot!==e||o||Pt!==null&&Pt.memoizedState.tag&1){if(r.flags|=2048,lo(9,m1.bind(null,r,n,a,e),void 0,null),Tt===null)throw Error(he(349));Us&30||f1(r,e,a)}return a}function f1(t,e,r){t.flags|=16384,t={getSnapshot:e,value:r},e=at.updateQueue,e===null?(e={lastEffect:null,stores:null},at.updateQueue=e,e.stores=[t]):(r=e.stores,r===null?e.stores=[t]:r.push(t))}function m1(t,e,r,n){e.value=r,e.getSnapshot=n,g1(e)&&y1(t)}function p1(t,e,r){return r(function(){g1(e)&&y1(t)})}function g1(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Kr(t,r)}catch{return!0}}function y1(t){var e=Mn(t,1);e!==null&&Zr(e,t,1,-1)}function Qp(t){var e=sn();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:oo,lastRenderedState:t},e.queue=t,t=t.dispatch=e4.bind(null,at,t),[e.memoizedState,t]}function lo(t,e,r,n){return t={tag:t,create:e,destroy:r,deps:n,next:null},e=at.updateQueue,e===null?(e={lastEffect:null,stores:null},at.updateQueue=e,e.lastEffect=t.next=t):(r=e.lastEffect,r===null?e.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,e.lastEffect=t)),t}function x1(){return Or().memoizedState}function jl(t,e,r,n){var a=sn();at.flags|=t,a.memoizedState=lo(1|e,r,void 0,n===void 0?null:n)}function kc(t,e,r,n){var a=Or();n=n===void 0?null:n;var o=void 0;if(bt!==null){var c=bt.memoizedState;if(o=c.destroy,n!==null&&rf(n,c.deps)){a.memoizedState=lo(e,r,o,n);return}}at.flags|=t,a.memoizedState=lo(1|e,r,o,n)}function Wp(t,e){return jl(8390656,8,t,e)}function af(t,e){return kc(2048,8,t,e)}function v1(t,e){return kc(4,2,t,e)}function w1(t,e){return kc(4,4,t,e)}function b1(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function _1(t,e,r){return r=r!=null?r.concat([t]):null,kc(4,4,b1.bind(null,e,t),r)}function of(){}function N1(t,e){var r=Or();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&rf(e,n[1])?n[0]:(r.memoizedState=[t,e],t)}function j1(t,e){var r=Or();e=e===void 0?null:e;var n=r.memoizedState;return n!==null&&e!==null&&rf(e,n[1])?n[0]:(t=t(),r.memoizedState=[t,e],t)}function S1(t,e,r){return Us&21?(Kr(r,e)||(r=Eb(),at.lanes|=r,qs|=r,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ir=!0),t.memoizedState=r)}function JP(t,e){var r=We;We=r!==0&&4>r?r:4,t(!0);var n=Zu.transition;Zu.transition={};try{t(!1),e()}finally{We=r,Zu.transition=n}}function C1(){return Or().memoizedState}function XP(t,e,r){var n=os(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},P1(t))k1(e,r);else if(r=l1(t,e,r,n),r!==null){var a=Jt();Zr(r,t,n,a),T1(r,e,n)}}function e4(t,e,r){var n=os(t),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(P1(t))k1(e,a);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var c=e.lastRenderedState,u=o(c,r);if(a.hasEagerState=!0,a.eagerState=u,Kr(u,c)){var h=e.interleaved;h===null?(a.next=a,Yh(e)):(a.next=h.next,h.next=a),e.interleaved=a;return}}catch{}finally{}r=l1(t,e,a,n),r!==null&&(a=Jt(),Zr(r,t,n,a),T1(r,e,n))}}function P1(t){var e=t.alternate;return t===at||e!==null&&e===at}function k1(t,e){Ba=Xl=!0;var r=t.pending;r===null?e.next=e:(e.next=r.next,r.next=e),t.pending=e}function T1(t,e,r){if(r&4194240){var n=e.lanes;n&=t.pendingLanes,r|=n,e.lanes=r,Rh(t,r)}}var ec={readContext:Dr,useCallback:zt,useContext:zt,useEffect:zt,useImperativeHandle:zt,useInsertionEffect:zt,useLayoutEffect:zt,useMemo:zt,useReducer:zt,useRef:zt,useState:zt,useDebugValue:zt,useDeferredValue:zt,useTransition:zt,useMutableSource:zt,useSyncExternalStore:zt,useId:zt,unstable_isNewReconciler:!1},t4={readContext:Dr,useCallback:function(t,e){return sn().memoizedState=[t,e===void 0?null:e],t},useContext:Dr,useEffect:Wp,useImperativeHandle:function(t,e,r){return r=r!=null?r.concat([t]):null,jl(4194308,4,b1.bind(null,e,t),r)},useLayoutEffect:function(t,e){return jl(4194308,4,t,e)},useInsertionEffect:function(t,e){return jl(4,2,t,e)},useMemo:function(t,e){var r=sn();return e=e===void 0?null:e,t=t(),r.memoizedState=[t,e],t},useReducer:function(t,e,r){var n=sn();return e=r!==void 0?r(e):e,n.memoizedState=n.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},n.queue=t,t=t.dispatch=XP.bind(null,at,t),[n.memoizedState,t]},useRef:function(t){var e=sn();return t={current:t},e.memoizedState=t},useState:Qp,useDebugValue:of,useDeferredValue:function(t){return sn().memoizedState=t},useTransition:function(){var t=Qp(!1),e=t[0];return t=JP.bind(null,t[1]),sn().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,r){var n=at,a=sn();if(rt){if(r===void 0)throw Error(he(407));r=r()}else{if(r=e(),Tt===null)throw Error(he(349));Us&30||f1(n,e,r)}a.memoizedState=r;var o={value:r,getSnapshot:e};return a.queue=o,Wp(p1.bind(null,n,o,t),[t]),n.flags|=2048,lo(9,m1.bind(null,n,o,r,e),void 0,null),r},useId:function(){var t=sn(),e=Tt.identifierPrefix;if(rt){var r=Cn,n=Sn;r=(n&~(1<<32-Wr(n)-1)).toString(32)+r,e=":"+e+"R"+r,r=ao++,0<r&&(e+="H"+r.toString(32)),e+=":"}else r=YP++,e=":"+e+"r"+r.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},r4={readContext:Dr,useCallback:N1,useContext:Dr,useEffect:af,useImperativeHandle:_1,useInsertionEffect:v1,useLayoutEffect:w1,useMemo:j1,useReducer:Ku,useRef:x1,useState:function(){return Ku(oo)},useDebugValue:of,useDeferredValue:function(t){var e=Or();return S1(e,bt.memoizedState,t)},useTransition:function(){var t=Ku(oo)[0],e=Or().memoizedState;return[t,e]},useMutableSource:d1,useSyncExternalStore:h1,useId:C1,unstable_isNewReconciler:!1},n4={readContext:Dr,useCallback:N1,useContext:Dr,useEffect:af,useImperativeHandle:_1,useInsertionEffect:v1,useLayoutEffect:w1,useMemo:j1,useReducer:Gu,useRef:x1,useState:function(){return Gu(oo)},useDebugValue:of,useDeferredValue:function(t){var e=Or();return bt===null?e.memoizedState=t:S1(e,bt.memoizedState,t)},useTransition:function(){var t=Gu(oo)[0],e=Or().memoizedState;return[t,e]},useMutableSource:d1,useSyncExternalStore:h1,useId:C1,unstable_isNewReconciler:!1};function qr(t,e){if(t&&t.defaultProps){e=ot({},e),t=t.defaultProps;for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}return e}function Fd(t,e,r,n){e=t.memoizedState,r=r(n,e),r=r==null?e:ot({},e,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var Tc={isMounted:function(t){return(t=t._reactInternals)?Gs(t)===t:!1},enqueueSetState:function(t,e,r){t=t._reactInternals;var n=Jt(),a=os(t),o=Tn(n,a);o.payload=e,r!=null&&(o.callback=r),e=is(t,o,a),e!==null&&(Zr(e,t,a,n),_l(e,t,a))},enqueueReplaceState:function(t,e,r){t=t._reactInternals;var n=Jt(),a=os(t),o=Tn(n,a);o.tag=1,o.payload=e,r!=null&&(o.callback=r),e=is(t,o,a),e!==null&&(Zr(e,t,a,n),_l(e,t,a))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var r=Jt(),n=os(t),a=Tn(r,n);a.tag=2,e!=null&&(a.callback=e),e=is(t,a,n),e!==null&&(Zr(e,t,n,r),_l(e,t,n))}};function Zp(t,e,r,n,a,o,c){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,o,c):e.prototype&&e.prototype.isPureReactComponent?!eo(r,n)||!eo(a,o):!0}function E1(t,e,r){var n=!1,a=hs,o=e.contextType;return typeof o=="object"&&o!==null?o=Dr(o):(a=or(e)?zs:Qt.current,n=e.contextTypes,o=(n=n!=null)?Ri(t,a):hs),e=new e(r,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Tc,t.stateNode=e,e._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=o),e}function Kp(t,e,r,n){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(r,n),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(r,n),e.state!==t&&Tc.enqueueReplaceState(e,e.state,null)}function Ud(t,e,r,n){var a=t.stateNode;a.props=r,a.state=t.memoizedState,a.refs={},Jh(t);var o=e.contextType;typeof o=="object"&&o!==null?a.context=Dr(o):(o=or(e)?zs:Qt.current,a.context=Ri(t,o)),a.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Fd(t,e,o,r),a.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(e=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),e!==a.state&&Tc.enqueueReplaceState(a,a.state,null),Yl(t,r,a,n),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function Fi(t,e){try{var r="",n=e;do r+=LC(n),n=n.return;while(n);var a=r}catch(o){a=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:a,digest:null}}function Yu(t,e,r){return{value:t,source:null,stack:r??null,digest:e??null}}function qd(t,e){try{console.error(e.value)}catch(r){setTimeout(function(){throw r})}}var s4=typeof WeakMap=="function"?WeakMap:Map;function L1(t,e,r){r=Tn(-1,r),r.tag=3,r.payload={element:null};var n=e.value;return r.callback=function(){rc||(rc=!0,Xd=n),qd(t,e)},r}function A1(t,e,r){r=Tn(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var a=e.value;r.payload=function(){return n(a)},r.callback=function(){qd(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(r.callback=function(){qd(t,e),typeof n!="function"&&(as===null?as=new Set([this]):as.add(this));var c=e.stack;this.componentDidCatch(e.value,{componentStack:c!==null?c:""})}),r}function Gp(t,e,r){var n=t.pingCache;if(n===null){n=t.pingCache=new s4;var a=new Set;n.set(e,a)}else a=n.get(e),a===void 0&&(a=new Set,n.set(e,a));a.has(r)||(a.add(r),t=x4.bind(null,t,e,r),e.then(t,t))}function Yp(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Jp(t,e,r,n,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===e?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(e=Tn(-1,1),e.tag=2,is(r,e,1))),r.lanes|=1),t)}var i4=zn.ReactCurrentOwner,ir=!1;function Kt(t,e,r,n){e.child=t===null?o1(e,null,r,n):$i(e,t.child,r,n)}function Xp(t,e,r,n,a){r=r.render;var o=e.ref;return Li(e,a),n=nf(t,e,r,n,o,a),r=sf(),t!==null&&!ir?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,In(t,e,a)):(rt&&r&&Vh(e),e.flags|=1,Kt(t,e,n,a),e.child)}function eg(t,e,r,n,a){if(t===null){var o=r.type;return typeof o=="function"&&!pf(o)&&o.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(e.tag=15,e.type=o,M1(t,e,o,n,a)):(t=kl(r.type,null,n,e,e.mode,a),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&a)){var c=o.memoizedProps;if(r=r.compare,r=r!==null?r:eo,r(c,n)&&t.ref===e.ref)return In(t,e,a)}return e.flags|=1,t=ls(o,n),t.ref=e.ref,t.return=e,e.child=t}function M1(t,e,r,n,a){if(t!==null){var o=t.memoizedProps;if(eo(o,n)&&t.ref===e.ref)if(ir=!1,e.pendingProps=n=o,(t.lanes&a)!==0)t.flags&131072&&(ir=!0);else return e.lanes=t.lanes,In(t,e,a)}return Hd(t,e,r,n,a)}function I1(t,e,r){var n=e.pendingProps,a=n.children,o=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(Si,pr),pr|=r;else{if(!(r&1073741824))return t=o!==null?o.baseLanes|r:r,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Je(Si,pr),pr|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=o!==null?o.baseLanes:r,Je(Si,pr),pr|=n}else o!==null?(n=o.baseLanes|r,e.memoizedState=null):n=r,Je(Si,pr),pr|=n;return Kt(t,e,a,r),e.child}function D1(t,e){var r=e.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(e.flags|=512,e.flags|=2097152)}function Hd(t,e,r,n,a){var o=or(r)?zs:Qt.current;return o=Ri(e,o),Li(e,a),r=nf(t,e,r,n,o,a),n=sf(),t!==null&&!ir?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~a,In(t,e,a)):(rt&&n&&Vh(e),e.flags|=1,Kt(t,e,r,a),e.child)}function tg(t,e,r,n,a){if(or(r)){var o=!0;Ql(e)}else o=!1;if(Li(e,a),e.stateNode===null)Sl(t,e),E1(e,r,n),Ud(e,r,n,a),n=!0;else if(t===null){var c=e.stateNode,u=e.memoizedProps;c.props=u;var h=c.context,f=r.contextType;typeof f=="object"&&f!==null?f=Dr(f):(f=or(r)?zs:Qt.current,f=Ri(e,f));var m=r.getDerivedStateFromProps,v=typeof m=="function"||typeof c.getSnapshotBeforeUpdate=="function";v||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(u!==n||h!==f)&&Kp(e,c,n,f),Wn=!1;var w=e.memoizedState;c.state=w,Yl(e,n,c,a),h=e.memoizedState,u!==n||w!==h||ar.current||Wn?(typeof m=="function"&&(Fd(e,r,m,n),h=e.memoizedState),(u=Wn||Zp(e,r,u,n,w,h,f))?(v||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(e.flags|=4194308)):(typeof c.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=n,e.memoizedState=h),c.props=n,c.state=h,c.context=f,n=u):(typeof c.componentDidMount=="function"&&(e.flags|=4194308),n=!1)}else{c=e.stateNode,c1(t,e),u=e.memoizedProps,f=e.type===e.elementType?u:qr(e.type,u),c.props=f,v=e.pendingProps,w=c.context,h=r.contextType,typeof h=="object"&&h!==null?h=Dr(h):(h=or(r)?zs:Qt.current,h=Ri(e,h));var N=r.getDerivedStateFromProps;(m=typeof N=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(u!==v||w!==h)&&Kp(e,c,n,h),Wn=!1,w=e.memoizedState,c.state=w,Yl(e,n,c,a);var g=e.memoizedState;u!==v||w!==g||ar.current||Wn?(typeof N=="function"&&(Fd(e,r,N,n),g=e.memoizedState),(f=Wn||Zp(e,r,f,n,w,g,h)||!1)?(m||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(n,g,h),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(n,g,h)),typeof c.componentDidUpdate=="function"&&(e.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof c.componentDidUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),e.memoizedProps=n,e.memoizedState=g),c.props=n,c.state=g,c.context=h,n=f):(typeof c.componentDidUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&w===t.memoizedState||(e.flags|=1024),n=!1)}return Vd(t,e,r,n,o,a)}function Vd(t,e,r,n,a,o){D1(t,e);var c=(e.flags&128)!==0;if(!n&&!c)return a&&zp(e,r,!1),In(t,e,o);n=e.stateNode,i4.current=e;var u=c&&typeof r.getDerivedStateFromError!="function"?null:n.render();return e.flags|=1,t!==null&&c?(e.child=$i(e,t.child,null,o),e.child=$i(e,null,u,o)):Kt(t,e,u,o),e.memoizedState=n.state,a&&zp(e,r,!0),e.child}function O1(t){var e=t.stateNode;e.pendingContext?$p(t,e.pendingContext,e.pendingContext!==e.context):e.context&&$p(t,e.context,!1),Xh(t,e.containerInfo)}function rg(t,e,r,n,a){return Bi(),Wh(a),e.flags|=256,Kt(t,e,r,n),e.child}var Qd={dehydrated:null,treeContext:null,retryLane:0};function Wd(t){return{baseLanes:t,cachePool:null,transitions:null}}function R1(t,e,r){var n=e.pendingProps,a=it.current,o=!1,c=(e.flags&128)!==0,u;if((u=c)||(u=t!==null&&t.memoizedState===null?!1:(a&2)!==0),u?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),Je(it,a&1),t===null)return $d(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(c=n.children,t=n.fallback,o?(n=e.mode,o=e.child,c={mode:"hidden",children:c},!(n&1)&&o!==null?(o.childLanes=0,o.pendingProps=c):o=Ac(c,n,0,null),t=$s(t,n,r,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Wd(r),e.memoizedState=Qd,t):lf(e,c));if(a=t.memoizedState,a!==null&&(u=a.dehydrated,u!==null))return a4(t,e,c,n,u,a,r);if(o){o=n.fallback,c=e.mode,a=t.child,u=a.sibling;var h={mode:"hidden",children:n.children};return!(c&1)&&e.child!==a?(n=e.child,n.childLanes=0,n.pendingProps=h,e.deletions=null):(n=ls(a,h),n.subtreeFlags=a.subtreeFlags&14680064),u!==null?o=ls(u,o):(o=$s(o,c,r,null),o.flags|=2),o.return=e,n.return=e,n.sibling=o,e.child=n,n=o,o=e.child,c=t.child.memoizedState,c=c===null?Wd(r):{baseLanes:c.baseLanes|r,cachePool:null,transitions:c.transitions},o.memoizedState=c,o.childLanes=t.childLanes&~r,e.memoizedState=Qd,n}return o=t.child,t=o.sibling,n=ls(o,{mode:"visible",children:n.children}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n,e.memoizedState=null,n}function lf(t,e){return e=Ac({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ol(t,e,r,n){return n!==null&&Wh(n),$i(e,t.child,null,r),t=lf(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function a4(t,e,r,n,a,o,c){if(r)return e.flags&256?(e.flags&=-257,n=Yu(Error(he(422))),ol(t,e,c,n)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=n.fallback,a=e.mode,n=Ac({mode:"visible",children:n.children},a,0,null),o=$s(o,a,c,null),o.flags|=2,n.return=e,o.return=e,n.sibling=o,e.child=n,e.mode&1&&$i(e,t.child,null,c),e.child.memoizedState=Wd(c),e.memoizedState=Qd,o);if(!(e.mode&1))return ol(t,e,c,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var u=n.dgst;return n=u,o=Error(he(419)),n=Yu(o,n,void 0),ol(t,e,c,n)}if(u=(c&t.childLanes)!==0,ir||u){if(n=Tt,n!==null){switch(c&-c){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|c)?0:a,a!==0&&a!==o.retryLane&&(o.retryLane=a,Mn(t,a),Zr(n,t,a,-1))}return mf(),n=Yu(Error(he(421))),ol(t,e,c,n)}return a.data==="$?"?(e.flags|=128,e.child=t.child,e=v4.bind(null,t),a._reactRetry=e,null):(t=o.treeContext,yr=ss(a.nextSibling),xr=e,rt=!0,Vr=null,t!==null&&(Lr[Ar++]=Sn,Lr[Ar++]=Cn,Lr[Ar++]=Fs,Sn=t.id,Cn=t.overflow,Fs=e),e=lf(e,n.children),e.flags|=4096,e)}function ng(t,e,r){t.lanes|=e;var n=t.alternate;n!==null&&(n.lanes|=e),zd(t.return,e,r)}function Ju(t,e,r,n,a){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=a)}function B1(t,e,r){var n=e.pendingProps,a=n.revealOrder,o=n.tail;if(Kt(t,e,n.children,r),n=it.current,n&2)n=n&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ng(t,r,e);else if(t.tag===19)ng(t,r,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Je(it,n),!(e.mode&1))e.memoizedState=null;else switch(a){case"forwards":for(r=e.child,a=null;r!==null;)t=r.alternate,t!==null&&Jl(t)===null&&(a=r),r=r.sibling;r=a,r===null?(a=e.child,e.child=null):(a=r.sibling,r.sibling=null),Ju(e,!1,a,r,o);break;case"backwards":for(r=null,a=e.child,e.child=null;a!==null;){if(t=a.alternate,t!==null&&Jl(t)===null){e.child=a;break}t=a.sibling,a.sibling=r,r=a,a=t}Ju(e,!0,r,null,o);break;case"together":Ju(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sl(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function In(t,e,r){if(t!==null&&(e.dependencies=t.dependencies),qs|=e.lanes,!(r&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(he(153));if(e.child!==null){for(t=e.child,r=ls(t,t.pendingProps),e.child=r,r.return=e;t.sibling!==null;)t=t.sibling,r=r.sibling=ls(t,t.pendingProps),r.return=e;r.sibling=null}return e.child}function o4(t,e,r){switch(e.tag){case 3:O1(e),Bi();break;case 5:u1(e);break;case 1:or(e.type)&&Ql(e);break;case 4:Xh(e,e.stateNode.containerInfo);break;case 10:var n=e.type._context,a=e.memoizedProps.value;Je(Kl,n._currentValue),n._currentValue=a;break;case 13:if(n=e.memoizedState,n!==null)return n.dehydrated!==null?(Je(it,it.current&1),e.flags|=128,null):r&e.child.childLanes?R1(t,e,r):(Je(it,it.current&1),t=In(t,e,r),t!==null?t.sibling:null);Je(it,it.current&1);break;case 19:if(n=(r&e.childLanes)!==0,t.flags&128){if(n)return B1(t,e,r);e.flags|=128}if(a=e.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Je(it,it.current),n)break;return null;case 22:case 23:return e.lanes=0,I1(t,e,r)}return In(t,e,r)}var $1,Zd,z1,F1;$1=function(t,e){for(var r=e.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Zd=function(){};z1=function(t,e,r,n){var a=t.memoizedProps;if(a!==n){t=e.stateNode,Os(cn.current);var o=null;switch(r){case"input":a=gd(t,a),n=gd(t,n),o=[];break;case"select":a=ot({},a,{value:void 0}),n=ot({},n,{value:void 0}),o=[];break;case"textarea":a=vd(t,a),n=vd(t,n),o=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=Hl)}bd(r,n);var c;r=null;for(f in a)if(!n.hasOwnProperty(f)&&a.hasOwnProperty(f)&&a[f]!=null)if(f==="style"){var u=a[f];for(c in u)u.hasOwnProperty(c)&&(r||(r={}),r[c]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Wa.hasOwnProperty(f)?o||(o=[]):(o=o||[]).push(f,null));for(f in n){var h=n[f];if(u=a!=null?a[f]:void 0,n.hasOwnProperty(f)&&h!==u&&(h!=null||u!=null))if(f==="style")if(u){for(c in u)!u.hasOwnProperty(c)||h&&h.hasOwnProperty(c)||(r||(r={}),r[c]="");for(c in h)h.hasOwnProperty(c)&&u[c]!==h[c]&&(r||(r={}),r[c]=h[c])}else r||(o||(o=[]),o.push(f,r)),r=h;else f==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,u=u?u.__html:void 0,h!=null&&u!==h&&(o=o||[]).push(f,h)):f==="children"?typeof h!="string"&&typeof h!="number"||(o=o||[]).push(f,""+h):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Wa.hasOwnProperty(f)?(h!=null&&f==="onScroll"&&Xe("scroll",t),o||u===h||(o=[])):(o=o||[]).push(f,h))}r&&(o=o||[]).push("style",r);var f=o;(e.updateQueue=f)&&(e.flags|=4)}};F1=function(t,e,r,n){r!==n&&(e.flags|=4)};function ba(t,e){if(!rt)switch(t.tailMode){case"hidden":e=t.tail;for(var r=null;e!==null;)e.alternate!==null&&(r=e),e=e.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Ft(t){var e=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(e)for(var a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=n,t.childLanes=r,e}function l4(t,e,r){var n=e.pendingProps;switch(Qh(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ft(e),null;case 1:return or(e.type)&&Vl(),Ft(e),null;case 3:return n=e.stateNode,zi(),et(ar),et(Qt),tf(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(il(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Vr!==null&&(rh(Vr),Vr=null))),Zd(t,e),Ft(e),null;case 5:ef(e);var a=Os(io.current);if(r=e.type,t!==null&&e.stateNode!=null)z1(t,e,r,n,a),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!n){if(e.stateNode===null)throw Error(he(166));return Ft(e),null}if(t=Os(cn.current),il(e)){n=e.stateNode,r=e.type;var o=e.memoizedProps;switch(n[an]=e,n[no]=o,t=(e.mode&1)!==0,r){case"dialog":Xe("cancel",n),Xe("close",n);break;case"iframe":case"object":case"embed":Xe("load",n);break;case"video":case"audio":for(a=0;a<La.length;a++)Xe(La[a],n);break;case"source":Xe("error",n);break;case"img":case"image":case"link":Xe("error",n),Xe("load",n);break;case"details":Xe("toggle",n);break;case"input":hp(n,o),Xe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!o.multiple},Xe("invalid",n);break;case"textarea":mp(n,o),Xe("invalid",n)}bd(r,o),a=null;for(var c in o)if(o.hasOwnProperty(c)){var u=o[c];c==="children"?typeof u=="string"?n.textContent!==u&&(o.suppressHydrationWarning!==!0&&sl(n.textContent,u,t),a=["children",u]):typeof u=="number"&&n.textContent!==""+u&&(o.suppressHydrationWarning!==!0&&sl(n.textContent,u,t),a=["children",""+u]):Wa.hasOwnProperty(c)&&u!=null&&c==="onScroll"&&Xe("scroll",n)}switch(r){case"input":Go(n),fp(n,o,!0);break;case"textarea":Go(n),pp(n);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(n.onclick=Hl)}n=a,e.updateQueue=n,n!==null&&(e.flags|=4)}else{c=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=pb(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=c.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=c.createElement(r,{is:n.is}):(t=c.createElement(r),r==="select"&&(c=t,n.multiple?c.multiple=!0:n.size&&(c.size=n.size))):t=c.createElementNS(t,r),t[an]=e,t[no]=n,$1(t,e,!1,!1),e.stateNode=t;e:{switch(c=_d(r,n),r){case"dialog":Xe("cancel",t),Xe("close",t),a=n;break;case"iframe":case"object":case"embed":Xe("load",t),a=n;break;case"video":case"audio":for(a=0;a<La.length;a++)Xe(La[a],t);a=n;break;case"source":Xe("error",t),a=n;break;case"img":case"image":case"link":Xe("error",t),Xe("load",t),a=n;break;case"details":Xe("toggle",t),a=n;break;case"input":hp(t,n),a=gd(t,n),Xe("invalid",t);break;case"option":a=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=ot({},n,{value:void 0}),Xe("invalid",t);break;case"textarea":mp(t,n),a=vd(t,n),Xe("invalid",t);break;default:a=n}bd(r,a),u=a;for(o in u)if(u.hasOwnProperty(o)){var h=u[o];o==="style"?xb(t,h):o==="dangerouslySetInnerHTML"?(h=h?h.__html:void 0,h!=null&&gb(t,h)):o==="children"?typeof h=="string"?(r!=="textarea"||h!=="")&&Za(t,h):typeof h=="number"&&Za(t,""+h):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Wa.hasOwnProperty(o)?h!=null&&o==="onScroll"&&Xe("scroll",t):h!=null&&Lh(t,o,h,c))}switch(r){case"input":Go(t),fp(t,n,!1);break;case"textarea":Go(t),pp(t);break;case"option":n.value!=null&&t.setAttribute("value",""+ds(n.value));break;case"select":t.multiple=!!n.multiple,o=n.value,o!=null?Pi(t,!!n.multiple,o,!1):n.defaultValue!=null&&Pi(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=Hl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ft(e),null;case 6:if(t&&e.stateNode!=null)F1(t,e,t.memoizedProps,n);else{if(typeof n!="string"&&e.stateNode===null)throw Error(he(166));if(r=Os(io.current),Os(cn.current),il(e)){if(n=e.stateNode,r=e.memoizedProps,n[an]=e,(o=n.nodeValue!==r)&&(t=xr,t!==null))switch(t.tag){case 3:sl(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&sl(n.nodeValue,r,(t.mode&1)!==0)}o&&(e.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[an]=e,e.stateNode=n}return Ft(e),null;case 13:if(et(it),n=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(rt&&yr!==null&&e.mode&1&&!(e.flags&128))i1(),Bi(),e.flags|=98560,o=!1;else if(o=il(e),n!==null&&n.dehydrated!==null){if(t===null){if(!o)throw Error(he(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(he(317));o[an]=e}else Bi(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ft(e),o=!1}else Vr!==null&&(rh(Vr),Vr=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=r,e):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(e.child.flags|=8192,e.mode&1&&(t===null||it.current&1?Nt===0&&(Nt=3):mf())),e.updateQueue!==null&&(e.flags|=4),Ft(e),null);case 4:return zi(),Zd(t,e),t===null&&to(e.stateNode.containerInfo),Ft(e),null;case 10:return Gh(e.type._context),Ft(e),null;case 17:return or(e.type)&&Vl(),Ft(e),null;case 19:if(et(it),o=e.memoizedState,o===null)return Ft(e),null;if(n=(e.flags&128)!==0,c=o.rendering,c===null)if(n)ba(o,!1);else{if(Nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(c=Jl(t),c!==null){for(e.flags|=128,ba(o,!1),n=c.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),e.subtreeFlags=0,n=r,r=e.child;r!==null;)o=r,t=n,o.flags&=14680066,c=o.alternate,c===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=c.childLanes,o.lanes=c.lanes,o.child=c.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=c.memoizedProps,o.memoizedState=c.memoizedState,o.updateQueue=c.updateQueue,o.type=c.type,t=c.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Je(it,it.current&1|2),e.child}t=t.sibling}o.tail!==null&&ft()>Ui&&(e.flags|=128,n=!0,ba(o,!1),e.lanes=4194304)}else{if(!n)if(t=Jl(c),t!==null){if(e.flags|=128,n=!0,r=t.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),ba(o,!0),o.tail===null&&o.tailMode==="hidden"&&!c.alternate&&!rt)return Ft(e),null}else 2*ft()-o.renderingStartTime>Ui&&r!==1073741824&&(e.flags|=128,n=!0,ba(o,!1),e.lanes=4194304);o.isBackwards?(c.sibling=e.child,e.child=c):(r=o.last,r!==null?r.sibling=c:e.child=c,o.last=c)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=ft(),e.sibling=null,r=it.current,Je(it,n?r&1|2:r&1),e):(Ft(e),null);case 22:case 23:return ff(),n=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(e.flags|=8192),n&&e.mode&1?pr&1073741824&&(Ft(e),e.subtreeFlags&6&&(e.flags|=8192)):Ft(e),null;case 24:return null;case 25:return null}throw Error(he(156,e.tag))}function c4(t,e){switch(Qh(e),e.tag){case 1:return or(e.type)&&Vl(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return zi(),et(ar),et(Qt),tf(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return ef(e),null;case 13:if(et(it),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(he(340));Bi()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return et(it),null;case 4:return zi(),null;case 10:return Gh(e.type._context),null;case 22:case 23:return ff(),null;case 24:return null;default:return null}}var ll=!1,Ht=!1,u4=typeof WeakSet=="function"?WeakSet:Set,we=null;function ji(t,e){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){ut(t,e,n)}else r.current=null}function Kd(t,e,r){try{r()}catch(n){ut(t,e,n)}}var sg=!1;function d4(t,e){if(Ad=Fl,t=Qb(),Hh(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,o=n.focusNode;n=n.focusOffset;try{r.nodeType,o.nodeType}catch{r=null;break e}var c=0,u=-1,h=-1,f=0,m=0,v=t,w=null;t:for(;;){for(var N;v!==r||a!==0&&v.nodeType!==3||(u=c+a),v!==o||n!==0&&v.nodeType!==3||(h=c+n),v.nodeType===3&&(c+=v.nodeValue.length),(N=v.firstChild)!==null;)w=v,v=N;for(;;){if(v===t)break t;if(w===r&&++f===a&&(u=c),w===o&&++m===n&&(h=c),(N=v.nextSibling)!==null)break;v=w,w=v.parentNode}v=N}r=u===-1||h===-1?null:{start:u,end:h}}else r=null}r=r||{start:0,end:0}}else r=null;for(Md={focusedElem:t,selectionRange:r},Fl=!1,we=e;we!==null;)if(e=we,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,we=t;else for(;we!==null;){e=we;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var y=g.memoizedProps,j=g.memoizedState,_=e.stateNode,b=_.getSnapshotBeforeUpdate(e.elementType===e.type?y:qr(e.type,y),j);_.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var P=e.stateNode.containerInfo;P.nodeType===1?P.textContent="":P.nodeType===9&&P.documentElement&&P.removeChild(P.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(he(163))}}catch(B){ut(e,e.return,B)}if(t=e.sibling,t!==null){t.return=e.return,we=t;break}we=e.return}return g=sg,sg=!1,g}function $a(t,e,r){var n=e.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var o=a.destroy;a.destroy=void 0,o!==void 0&&Kd(e,r,o)}a=a.next}while(a!==n)}}function Ec(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var r=e=e.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==e)}}function Gd(t){var e=t.ref;if(e!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof e=="function"?e(t):e.current=t}}function U1(t){var e=t.alternate;e!==null&&(t.alternate=null,U1(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[an],delete e[no],delete e[Od],delete e[WP],delete e[ZP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function q1(t){return t.tag===5||t.tag===3||t.tag===4}function ig(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||q1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Yd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.nodeType===8?r.parentNode.insertBefore(t,e):r.insertBefore(t,e):(r.nodeType===8?(e=r.parentNode,e.insertBefore(t,r)):(e=r,e.appendChild(t)),r=r._reactRootContainer,r!=null||e.onclick!==null||(e.onclick=Hl));else if(n!==4&&(t=t.child,t!==null))for(Yd(t,e,r),t=t.sibling;t!==null;)Yd(t,e,r),t=t.sibling}function Jd(t,e,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,e?r.insertBefore(t,e):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Jd(t,e,r),t=t.sibling;t!==null;)Jd(t,e,r),t=t.sibling}var It=null,Hr=!1;function Vn(t,e,r){for(r=r.child;r!==null;)H1(t,e,r),r=r.sibling}function H1(t,e,r){if(ln&&typeof ln.onCommitFiberUnmount=="function")try{ln.onCommitFiberUnmount(_c,r)}catch{}switch(r.tag){case 5:Ht||ji(r,e);case 6:var n=It,a=Hr;It=null,Vn(t,e,r),It=n,Hr=a,It!==null&&(Hr?(t=It,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):It.removeChild(r.stateNode));break;case 18:It!==null&&(Hr?(t=It,r=r.stateNode,t.nodeType===8?Vu(t.parentNode,r):t.nodeType===1&&Vu(t,r),Ja(t)):Vu(It,r.stateNode));break;case 4:n=It,a=Hr,It=r.stateNode.containerInfo,Hr=!0,Vn(t,e,r),It=n,Hr=a;break;case 0:case 11:case 14:case 15:if(!Ht&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var o=a,c=o.destroy;o=o.tag,c!==void 0&&(o&2||o&4)&&Kd(r,e,c),a=a.next}while(a!==n)}Vn(t,e,r);break;case 1:if(!Ht&&(ji(r,e),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(u){ut(r,e,u)}Vn(t,e,r);break;case 21:Vn(t,e,r);break;case 22:r.mode&1?(Ht=(n=Ht)||r.memoizedState!==null,Vn(t,e,r),Ht=n):Vn(t,e,r);break;default:Vn(t,e,r)}}function ag(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new u4),e.forEach(function(n){var a=w4.bind(null,t,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Ur(t,e){var r=e.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var o=t,c=e,u=c;e:for(;u!==null;){switch(u.tag){case 5:It=u.stateNode,Hr=!1;break e;case 3:It=u.stateNode.containerInfo,Hr=!0;break e;case 4:It=u.stateNode.containerInfo,Hr=!0;break e}u=u.return}if(It===null)throw Error(he(160));H1(o,c,a),It=null,Hr=!1;var h=a.alternate;h!==null&&(h.return=null),a.return=null}catch(f){ut(a,e,f)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)V1(e,t),e=e.sibling}function V1(t,e){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ur(e,t),nn(t),n&4){try{$a(3,t,t.return),Ec(3,t)}catch(y){ut(t,t.return,y)}try{$a(5,t,t.return)}catch(y){ut(t,t.return,y)}}break;case 1:Ur(e,t),nn(t),n&512&&r!==null&&ji(r,r.return);break;case 5:if(Ur(e,t),nn(t),n&512&&r!==null&&ji(r,r.return),t.flags&32){var a=t.stateNode;try{Za(a,"")}catch(y){ut(t,t.return,y)}}if(n&4&&(a=t.stateNode,a!=null)){var o=t.memoizedProps,c=r!==null?r.memoizedProps:o,u=t.type,h=t.updateQueue;if(t.updateQueue=null,h!==null)try{u==="input"&&o.type==="radio"&&o.name!=null&&fb(a,o),_d(u,c);var f=_d(u,o);for(c=0;c<h.length;c+=2){var m=h[c],v=h[c+1];m==="style"?xb(a,v):m==="dangerouslySetInnerHTML"?gb(a,v):m==="children"?Za(a,v):Lh(a,m,v,f)}switch(u){case"input":yd(a,o);break;case"textarea":mb(a,o);break;case"select":var w=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var N=o.value;N!=null?Pi(a,!!o.multiple,N,!1):w!==!!o.multiple&&(o.defaultValue!=null?Pi(a,!!o.multiple,o.defaultValue,!0):Pi(a,!!o.multiple,o.multiple?[]:"",!1))}a[no]=o}catch(y){ut(t,t.return,y)}}break;case 6:if(Ur(e,t),nn(t),n&4){if(t.stateNode===null)throw Error(he(162));a=t.stateNode,o=t.memoizedProps;try{a.nodeValue=o}catch(y){ut(t,t.return,y)}}break;case 3:if(Ur(e,t),nn(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{Ja(e.containerInfo)}catch(y){ut(t,t.return,y)}break;case 4:Ur(e,t),nn(t);break;case 13:Ur(e,t),nn(t),a=t.child,a.flags&8192&&(o=a.memoizedState!==null,a.stateNode.isHidden=o,!o||a.alternate!==null&&a.alternate.memoizedState!==null||(df=ft())),n&4&&ag(t);break;case 22:if(m=r!==null&&r.memoizedState!==null,t.mode&1?(Ht=(f=Ht)||m,Ur(e,t),Ht=f):Ur(e,t),nn(t),n&8192){if(f=t.memoizedState!==null,(t.stateNode.isHidden=f)&&!m&&t.mode&1)for(we=t,m=t.child;m!==null;){for(v=we=m;we!==null;){switch(w=we,N=w.child,w.tag){case 0:case 11:case 14:case 15:$a(4,w,w.return);break;case 1:ji(w,w.return);var g=w.stateNode;if(typeof g.componentWillUnmount=="function"){n=w,r=w.return;try{e=n,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(y){ut(n,r,y)}}break;case 5:ji(w,w.return);break;case 22:if(w.memoizedState!==null){lg(v);continue}}N!==null?(N.return=w,we=N):lg(v)}m=m.sibling}e:for(m=null,v=t;;){if(v.tag===5){if(m===null){m=v;try{a=v.stateNode,f?(o=a.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(u=v.stateNode,h=v.memoizedProps.style,c=h!=null&&h.hasOwnProperty("display")?h.display:null,u.style.display=yb("display",c))}catch(y){ut(t,t.return,y)}}}else if(v.tag===6){if(m===null)try{v.stateNode.nodeValue=f?"":v.memoizedProps}catch(y){ut(t,t.return,y)}}else if((v.tag!==22&&v.tag!==23||v.memoizedState===null||v===t)&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===t)break e;for(;v.sibling===null;){if(v.return===null||v.return===t)break e;m===v&&(m=null),v=v.return}m===v&&(m=null),v.sibling.return=v.return,v=v.sibling}}break;case 19:Ur(e,t),nn(t),n&4&&ag(t);break;case 21:break;default:Ur(e,t),nn(t)}}function nn(t){var e=t.flags;if(e&2){try{e:{for(var r=t.return;r!==null;){if(q1(r)){var n=r;break e}r=r.return}throw Error(he(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Za(a,""),n.flags&=-33);var o=ig(t);Jd(t,o,a);break;case 3:case 4:var c=n.stateNode.containerInfo,u=ig(t);Yd(t,u,c);break;default:throw Error(he(161))}}catch(h){ut(t,t.return,h)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function h4(t,e,r){we=t,Q1(t)}function Q1(t,e,r){for(var n=(t.mode&1)!==0;we!==null;){var a=we,o=a.child;if(a.tag===22&&n){var c=a.memoizedState!==null||ll;if(!c){var u=a.alternate,h=u!==null&&u.memoizedState!==null||Ht;u=ll;var f=Ht;if(ll=c,(Ht=h)&&!f)for(we=a;we!==null;)c=we,h=c.child,c.tag===22&&c.memoizedState!==null?cg(a):h!==null?(h.return=c,we=h):cg(a);for(;o!==null;)we=o,Q1(o),o=o.sibling;we=a,ll=u,Ht=f}og(t)}else a.subtreeFlags&8772&&o!==null?(o.return=a,we=o):og(t)}}function og(t){for(;we!==null;){var e=we;if(e.flags&8772){var r=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ht||Ec(5,e);break;case 1:var n=e.stateNode;if(e.flags&4&&!Ht)if(r===null)n.componentDidMount();else{var a=e.elementType===e.type?r.memoizedProps:qr(e.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Vp(e,o,n);break;case 3:var c=e.updateQueue;if(c!==null){if(r=null,e.child!==null)switch(e.child.tag){case 5:r=e.child.stateNode;break;case 1:r=e.child.stateNode}Vp(e,c,r)}break;case 5:var u=e.stateNode;if(r===null&&e.flags&4){r=u;var h=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":h.autoFocus&&r.focus();break;case"img":h.src&&(r.src=h.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var f=e.alternate;if(f!==null){var m=f.memoizedState;if(m!==null){var v=m.dehydrated;v!==null&&Ja(v)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(he(163))}Ht||e.flags&512&&Gd(e)}catch(w){ut(e,e.return,w)}}if(e===t){we=null;break}if(r=e.sibling,r!==null){r.return=e.return,we=r;break}we=e.return}}function lg(t){for(;we!==null;){var e=we;if(e===t){we=null;break}var r=e.sibling;if(r!==null){r.return=e.return,we=r;break}we=e.return}}function cg(t){for(;we!==null;){var e=we;try{switch(e.tag){case 0:case 11:case 15:var r=e.return;try{Ec(4,e)}catch(h){ut(e,r,h)}break;case 1:var n=e.stateNode;if(typeof n.componentDidMount=="function"){var a=e.return;try{n.componentDidMount()}catch(h){ut(e,a,h)}}var o=e.return;try{Gd(e)}catch(h){ut(e,o,h)}break;case 5:var c=e.return;try{Gd(e)}catch(h){ut(e,c,h)}}}catch(h){ut(e,e.return,h)}if(e===t){we=null;break}var u=e.sibling;if(u!==null){u.return=e.return,we=u;break}we=e.return}}var f4=Math.ceil,tc=zn.ReactCurrentDispatcher,cf=zn.ReactCurrentOwner,Ir=zn.ReactCurrentBatchConfig,qe=0,Tt=null,xt=null,Dt=0,pr=0,Si=ps(0),Nt=0,co=null,qs=0,Lc=0,uf=0,za=null,sr=null,df=0,Ui=1/0,_n=null,rc=!1,Xd=null,as=null,cl=!1,es=null,nc=0,Fa=0,eh=null,Cl=-1,Pl=0;function Jt(){return qe&6?ft():Cl!==-1?Cl:Cl=ft()}function os(t){return t.mode&1?qe&2&&Dt!==0?Dt&-Dt:GP.transition!==null?(Pl===0&&(Pl=Eb()),Pl):(t=We,t!==0||(t=window.event,t=t===void 0?16:Rb(t.type)),t):1}function Zr(t,e,r,n){if(50<Fa)throw Fa=0,eh=null,Error(he(185));go(t,r,n),(!(qe&2)||t!==Tt)&&(t===Tt&&(!(qe&2)&&(Lc|=r),Nt===4&&Yn(t,Dt)),lr(t,n),r===1&&qe===0&&!(e.mode&1)&&(Ui=ft()+500,Pc&&gs()))}function lr(t,e){var r=t.callbackNode;GC(t,e);var n=zl(t,t===Tt?Dt:0);if(n===0)r!==null&&xp(r),t.callbackNode=null,t.callbackPriority=0;else if(e=n&-n,t.callbackPriority!==e){if(r!=null&&xp(r),e===1)t.tag===0?KP(ug.bind(null,t)):r1(ug.bind(null,t)),VP(function(){!(qe&6)&&gs()}),r=null;else{switch(Lb(n)){case 1:r=Oh;break;case 4:r=kb;break;case 16:r=$l;break;case 536870912:r=Tb;break;default:r=$l}r=e_(r,W1.bind(null,t))}t.callbackPriority=e,t.callbackNode=r}}function W1(t,e){if(Cl=-1,Pl=0,qe&6)throw Error(he(327));var r=t.callbackNode;if(Ai()&&t.callbackNode!==r)return null;var n=zl(t,t===Tt?Dt:0);if(n===0)return null;if(n&30||n&t.expiredLanes||e)e=sc(t,n);else{e=n;var a=qe;qe|=2;var o=K1();(Tt!==t||Dt!==e)&&(_n=null,Ui=ft()+500,Bs(t,e));do try{g4();break}catch(u){Z1(t,u)}while(!0);Kh(),tc.current=o,qe=a,xt!==null?e=0:(Tt=null,Dt=0,e=Nt)}if(e!==0){if(e===2&&(a=Pd(t),a!==0&&(n=a,e=th(t,a))),e===1)throw r=co,Bs(t,0),Yn(t,n),lr(t,ft()),r;if(e===6)Yn(t,n);else{if(a=t.current.alternate,!(n&30)&&!m4(a)&&(e=sc(t,n),e===2&&(o=Pd(t),o!==0&&(n=o,e=th(t,o))),e===1))throw r=co,Bs(t,0),Yn(t,n),lr(t,ft()),r;switch(t.finishedWork=a,t.finishedLanes=n,e){case 0:case 1:throw Error(he(345));case 2:Ts(t,sr,_n);break;case 3:if(Yn(t,n),(n&130023424)===n&&(e=df+500-ft(),10<e)){if(zl(t,0)!==0)break;if(a=t.suspendedLanes,(a&n)!==n){Jt(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=Dd(Ts.bind(null,t,sr,_n),e);break}Ts(t,sr,_n);break;case 4:if(Yn(t,n),(n&4194240)===n)break;for(e=t.eventTimes,a=-1;0<n;){var c=31-Wr(n);o=1<<c,c=e[c],c>a&&(a=c),n&=~o}if(n=a,n=ft()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*f4(n/1960))-n,10<n){t.timeoutHandle=Dd(Ts.bind(null,t,sr,_n),n);break}Ts(t,sr,_n);break;case 5:Ts(t,sr,_n);break;default:throw Error(he(329))}}}return lr(t,ft()),t.callbackNode===r?W1.bind(null,t):null}function th(t,e){var r=za;return t.current.memoizedState.isDehydrated&&(Bs(t,e).flags|=256),t=sc(t,e),t!==2&&(e=sr,sr=r,e!==null&&rh(e)),t}function rh(t){sr===null?sr=t:sr.push.apply(sr,t)}function m4(t){for(var e=t;;){if(e.flags&16384){var r=e.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],o=a.getSnapshot;a=a.value;try{if(!Kr(o(),a))return!1}catch{return!1}}}if(r=e.child,e.subtreeFlags&16384&&r!==null)r.return=e,e=r;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Yn(t,e){for(e&=~uf,e&=~Lc,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var r=31-Wr(e),n=1<<r;t[r]=-1,e&=~n}}function ug(t){if(qe&6)throw Error(he(327));Ai();var e=zl(t,0);if(!(e&1))return lr(t,ft()),null;var r=sc(t,e);if(t.tag!==0&&r===2){var n=Pd(t);n!==0&&(e=n,r=th(t,n))}if(r===1)throw r=co,Bs(t,0),Yn(t,e),lr(t,ft()),r;if(r===6)throw Error(he(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ts(t,sr,_n),lr(t,ft()),null}function hf(t,e){var r=qe;qe|=1;try{return t(e)}finally{qe=r,qe===0&&(Ui=ft()+500,Pc&&gs())}}function Hs(t){es!==null&&es.tag===0&&!(qe&6)&&Ai();var e=qe;qe|=1;var r=Ir.transition,n=We;try{if(Ir.transition=null,We=1,t)return t()}finally{We=n,Ir.transition=r,qe=e,!(qe&6)&&gs()}}function ff(){pr=Si.current,et(Si)}function Bs(t,e){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,HP(r)),xt!==null)for(r=xt.return;r!==null;){var n=r;switch(Qh(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Vl();break;case 3:zi(),et(ar),et(Qt),tf();break;case 5:ef(n);break;case 4:zi();break;case 13:et(it);break;case 19:et(it);break;case 10:Gh(n.type._context);break;case 22:case 23:ff()}r=r.return}if(Tt=t,xt=t=ls(t.current,null),Dt=pr=e,Nt=0,co=null,uf=Lc=qs=0,sr=za=null,Ds!==null){for(e=0;e<Ds.length;e++)if(r=Ds[e],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,o=r.pending;if(o!==null){var c=o.next;o.next=a,n.next=c}r.pending=n}Ds=null}return t}function Z1(t,e){do{var r=xt;try{if(Kh(),Nl.current=ec,Xl){for(var n=at.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}Xl=!1}if(Us=0,Pt=bt=at=null,Ba=!1,ao=0,cf.current=null,r===null||r.return===null){Nt=1,co=e,xt=null;break}e:{var o=t,c=r.return,u=r,h=e;if(e=Dt,u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){var f=h,m=u,v=m.tag;if(!(m.mode&1)&&(v===0||v===11||v===15)){var w=m.alternate;w?(m.updateQueue=w.updateQueue,m.memoizedState=w.memoizedState,m.lanes=w.lanes):(m.updateQueue=null,m.memoizedState=null)}var N=Yp(c);if(N!==null){N.flags&=-257,Jp(N,c,u,o,e),N.mode&1&&Gp(o,f,e),e=N,h=f;var g=e.updateQueue;if(g===null){var y=new Set;y.add(h),e.updateQueue=y}else g.add(h);break e}else{if(!(e&1)){Gp(o,f,e),mf();break e}h=Error(he(426))}}else if(rt&&u.mode&1){var j=Yp(c);if(j!==null){!(j.flags&65536)&&(j.flags|=256),Jp(j,c,u,o,e),Wh(Fi(h,u));break e}}o=h=Fi(h,u),Nt!==4&&(Nt=2),za===null?za=[o]:za.push(o),o=c;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var _=L1(o,h,e);Hp(o,_);break e;case 1:u=h;var b=o.type,P=o.stateNode;if(!(o.flags&128)&&(typeof b.getDerivedStateFromError=="function"||P!==null&&typeof P.componentDidCatch=="function"&&(as===null||!as.has(P)))){o.flags|=65536,e&=-e,o.lanes|=e;var B=A1(o,u,e);Hp(o,B);break e}}o=o.return}while(o!==null)}Y1(r)}catch($){e=$,xt===r&&r!==null&&(xt=r=r.return);continue}break}while(!0)}function K1(){var t=tc.current;return tc.current=ec,t===null?ec:t}function mf(){(Nt===0||Nt===3||Nt===2)&&(Nt=4),Tt===null||!(qs&268435455)&&!(Lc&268435455)||Yn(Tt,Dt)}function sc(t,e){var r=qe;qe|=2;var n=K1();(Tt!==t||Dt!==e)&&(_n=null,Bs(t,e));do try{p4();break}catch(a){Z1(t,a)}while(!0);if(Kh(),qe=r,tc.current=n,xt!==null)throw Error(he(261));return Tt=null,Dt=0,Nt}function p4(){for(;xt!==null;)G1(xt)}function g4(){for(;xt!==null&&!FC();)G1(xt)}function G1(t){var e=X1(t.alternate,t,pr);t.memoizedProps=t.pendingProps,e===null?Y1(t):xt=e,cf.current=null}function Y1(t){var e=t;do{var r=e.alternate;if(t=e.return,e.flags&32768){if(r=c4(r,e),r!==null){r.flags&=32767,xt=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Nt=6,xt=null;return}}else if(r=l4(r,e,pr),r!==null){xt=r;return}if(e=e.sibling,e!==null){xt=e;return}xt=e=t}while(e!==null);Nt===0&&(Nt=5)}function Ts(t,e,r){var n=We,a=Ir.transition;try{Ir.transition=null,We=1,y4(t,e,r,n)}finally{Ir.transition=a,We=n}return null}function y4(t,e,r,n){do Ai();while(es!==null);if(qe&6)throw Error(he(327));r=t.finishedWork;var a=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(he(177));t.callbackNode=null,t.callbackPriority=0;var o=r.lanes|r.childLanes;if(YC(t,o),t===Tt&&(xt=Tt=null,Dt=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||cl||(cl=!0,e_($l,function(){return Ai(),null})),o=(r.flags&15990)!==0,r.subtreeFlags&15990||o){o=Ir.transition,Ir.transition=null;var c=We;We=1;var u=qe;qe|=4,cf.current=null,d4(t,r),V1(r,t),RP(Md),Fl=!!Ad,Md=Ad=null,t.current=r,h4(r),UC(),qe=u,We=c,Ir.transition=o}else t.current=r;if(cl&&(cl=!1,es=t,nc=a),o=t.pendingLanes,o===0&&(as=null),VC(r.stateNode),lr(t,ft()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)a=e[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(rc)throw rc=!1,t=Xd,Xd=null,t;return nc&1&&t.tag!==0&&Ai(),o=t.pendingLanes,o&1?t===eh?Fa++:(Fa=0,eh=t):Fa=0,gs(),null}function Ai(){if(es!==null){var t=Lb(nc),e=Ir.transition,r=We;try{if(Ir.transition=null,We=16>t?16:t,es===null)var n=!1;else{if(t=es,es=null,nc=0,qe&6)throw Error(he(331));var a=qe;for(qe|=4,we=t.current;we!==null;){var o=we,c=o.child;if(we.flags&16){var u=o.deletions;if(u!==null){for(var h=0;h<u.length;h++){var f=u[h];for(we=f;we!==null;){var m=we;switch(m.tag){case 0:case 11:case 15:$a(8,m,o)}var v=m.child;if(v!==null)v.return=m,we=v;else for(;we!==null;){m=we;var w=m.sibling,N=m.return;if(U1(m),m===f){we=null;break}if(w!==null){w.return=N,we=w;break}we=N}}}var g=o.alternate;if(g!==null){var y=g.child;if(y!==null){g.child=null;do{var j=y.sibling;y.sibling=null,y=j}while(y!==null)}}we=o}}if(o.subtreeFlags&2064&&c!==null)c.return=o,we=c;else e:for(;we!==null;){if(o=we,o.flags&2048)switch(o.tag){case 0:case 11:case 15:$a(9,o,o.return)}var _=o.sibling;if(_!==null){_.return=o.return,we=_;break e}we=o.return}}var b=t.current;for(we=b;we!==null;){c=we;var P=c.child;if(c.subtreeFlags&2064&&P!==null)P.return=c,we=P;else e:for(c=b;we!==null;){if(u=we,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Ec(9,u)}}catch($){ut(u,u.return,$)}if(u===c){we=null;break e}var B=u.sibling;if(B!==null){B.return=u.return,we=B;break e}we=u.return}}if(qe=a,gs(),ln&&typeof ln.onPostCommitFiberRoot=="function")try{ln.onPostCommitFiberRoot(_c,t)}catch{}n=!0}return n}finally{We=r,Ir.transition=e}}return!1}function dg(t,e,r){e=Fi(r,e),e=L1(t,e,1),t=is(t,e,1),e=Jt(),t!==null&&(go(t,1,e),lr(t,e))}function ut(t,e,r){if(t.tag===3)dg(t,t,r);else for(;e!==null;){if(e.tag===3){dg(e,t,r);break}else if(e.tag===1){var n=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(as===null||!as.has(n))){t=Fi(r,t),t=A1(e,t,1),e=is(e,t,1),t=Jt(),e!==null&&(go(e,1,t),lr(e,t));break}}e=e.return}}function x4(t,e,r){var n=t.pingCache;n!==null&&n.delete(e),e=Jt(),t.pingedLanes|=t.suspendedLanes&r,Tt===t&&(Dt&r)===r&&(Nt===4||Nt===3&&(Dt&130023424)===Dt&&500>ft()-df?Bs(t,0):uf|=r),lr(t,e)}function J1(t,e){e===0&&(t.mode&1?(e=Xo,Xo<<=1,!(Xo&130023424)&&(Xo=4194304)):e=1);var r=Jt();t=Mn(t,e),t!==null&&(go(t,e,r),lr(t,r))}function v4(t){var e=t.memoizedState,r=0;e!==null&&(r=e.retryLane),J1(t,r)}function w4(t,e){var r=0;switch(t.tag){case 13:var n=t.stateNode,a=t.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(he(314))}n!==null&&n.delete(e),J1(t,r)}var X1;X1=function(t,e,r){if(t!==null)if(t.memoizedProps!==e.pendingProps||ar.current)ir=!0;else{if(!(t.lanes&r)&&!(e.flags&128))return ir=!1,o4(t,e,r);ir=!!(t.flags&131072)}else ir=!1,rt&&e.flags&1048576&&n1(e,Zl,e.index);switch(e.lanes=0,e.tag){case 2:var n=e.type;Sl(t,e),t=e.pendingProps;var a=Ri(e,Qt.current);Li(e,r),a=nf(null,e,n,t,a,r);var o=sf();return e.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,or(n)?(o=!0,Ql(e)):o=!1,e.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Jh(e),a.updater=Tc,e.stateNode=a,a._reactInternals=e,Ud(e,n,t,r),e=Vd(null,e,n,!0,o,r)):(e.tag=0,rt&&o&&Vh(e),Kt(null,e,a,r),e=e.child),e;case 16:n=e.elementType;e:{switch(Sl(t,e),t=e.pendingProps,a=n._init,n=a(n._payload),e.type=n,a=e.tag=_4(n),t=qr(n,t),a){case 0:e=Hd(null,e,n,t,r);break e;case 1:e=tg(null,e,n,t,r);break e;case 11:e=Xp(null,e,n,t,r);break e;case 14:e=eg(null,e,n,qr(n.type,t),r);break e}throw Error(he(306,n,""))}return e;case 0:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:qr(n,a),Hd(t,e,n,a,r);case 1:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:qr(n,a),tg(t,e,n,a,r);case 3:e:{if(O1(e),t===null)throw Error(he(387));n=e.pendingProps,o=e.memoizedState,a=o.element,c1(t,e),Yl(e,n,null,r);var c=e.memoizedState;if(n=c.element,o.isDehydrated)if(o={element:n,isDehydrated:!1,cache:c.cache,pendingSuspenseBoundaries:c.pendingSuspenseBoundaries,transitions:c.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){a=Fi(Error(he(423)),e),e=rg(t,e,n,r,a);break e}else if(n!==a){a=Fi(Error(he(424)),e),e=rg(t,e,n,r,a);break e}else for(yr=ss(e.stateNode.containerInfo.firstChild),xr=e,rt=!0,Vr=null,r=o1(e,null,n,r),e.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Bi(),n===a){e=In(t,e,r);break e}Kt(t,e,n,r)}e=e.child}return e;case 5:return u1(e),t===null&&$d(e),n=e.type,a=e.pendingProps,o=t!==null?t.memoizedProps:null,c=a.children,Id(n,a)?c=null:o!==null&&Id(n,o)&&(e.flags|=32),D1(t,e),Kt(t,e,c,r),e.child;case 6:return t===null&&$d(e),null;case 13:return R1(t,e,r);case 4:return Xh(e,e.stateNode.containerInfo),n=e.pendingProps,t===null?e.child=$i(e,null,n,r):Kt(t,e,n,r),e.child;case 11:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:qr(n,a),Xp(t,e,n,a,r);case 7:return Kt(t,e,e.pendingProps,r),e.child;case 8:return Kt(t,e,e.pendingProps.children,r),e.child;case 12:return Kt(t,e,e.pendingProps.children,r),e.child;case 10:e:{if(n=e.type._context,a=e.pendingProps,o=e.memoizedProps,c=a.value,Je(Kl,n._currentValue),n._currentValue=c,o!==null)if(Kr(o.value,c)){if(o.children===a.children&&!ar.current){e=In(t,e,r);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var u=o.dependencies;if(u!==null){c=o.child;for(var h=u.firstContext;h!==null;){if(h.context===n){if(o.tag===1){h=Tn(-1,r&-r),h.tag=2;var f=o.updateQueue;if(f!==null){f=f.shared;var m=f.pending;m===null?h.next=h:(h.next=m.next,m.next=h),f.pending=h}}o.lanes|=r,h=o.alternate,h!==null&&(h.lanes|=r),zd(o.return,r,e),u.lanes|=r;break}h=h.next}}else if(o.tag===10)c=o.type===e.type?null:o.child;else if(o.tag===18){if(c=o.return,c===null)throw Error(he(341));c.lanes|=r,u=c.alternate,u!==null&&(u.lanes|=r),zd(c,r,e),c=o.sibling}else c=o.child;if(c!==null)c.return=o;else for(c=o;c!==null;){if(c===e){c=null;break}if(o=c.sibling,o!==null){o.return=c.return,c=o;break}c=c.return}o=c}Kt(t,e,a.children,r),e=e.child}return e;case 9:return a=e.type,n=e.pendingProps.children,Li(e,r),a=Dr(a),n=n(a),e.flags|=1,Kt(t,e,n,r),e.child;case 14:return n=e.type,a=qr(n,e.pendingProps),a=qr(n.type,a),eg(t,e,n,a,r);case 15:return M1(t,e,e.type,e.pendingProps,r);case 17:return n=e.type,a=e.pendingProps,a=e.elementType===n?a:qr(n,a),Sl(t,e),e.tag=1,or(n)?(t=!0,Ql(e)):t=!1,Li(e,r),E1(e,n,a),Ud(e,n,a,r),Vd(null,e,n,!0,t,r);case 19:return B1(t,e,r);case 22:return I1(t,e,r)}throw Error(he(156,e.tag))};function e_(t,e){return Pb(t,e)}function b4(t,e,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mr(t,e,r,n){return new b4(t,e,r,n)}function pf(t){return t=t.prototype,!(!t||!t.isReactComponent)}function _4(t){if(typeof t=="function")return pf(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Mh)return 11;if(t===Ih)return 14}return 2}function ls(t,e){var r=t.alternate;return r===null?(r=Mr(t.tag,e,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,e=t.dependencies,r.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function kl(t,e,r,n,a,o){var c=2;if(n=t,typeof t=="function")pf(t)&&(c=1);else if(typeof t=="string")c=5;else e:switch(t){case pi:return $s(r.children,a,o,e);case Ah:c=8,a|=8;break;case hd:return t=Mr(12,r,e,a|2),t.elementType=hd,t.lanes=o,t;case fd:return t=Mr(13,r,e,a),t.elementType=fd,t.lanes=o,t;case md:return t=Mr(19,r,e,a),t.elementType=md,t.lanes=o,t;case ub:return Ac(r,a,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case lb:c=10;break e;case cb:c=9;break e;case Mh:c=11;break e;case Ih:c=14;break e;case Qn:c=16,n=null;break e}throw Error(he(130,t==null?t:typeof t,""))}return e=Mr(c,r,e,a),e.elementType=t,e.type=n,e.lanes=o,e}function $s(t,e,r,n){return t=Mr(7,t,n,e),t.lanes=r,t}function Ac(t,e,r,n){return t=Mr(22,t,n,e),t.elementType=ub,t.lanes=r,t.stateNode={isHidden:!1},t}function Xu(t,e,r){return t=Mr(6,t,null,e),t.lanes=r,t}function ed(t,e,r){return e=Mr(4,t.children!==null?t.children:[],t.key,e),e.lanes=r,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function N4(t,e,r,n,a){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Iu(0),this.expirationTimes=Iu(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Iu(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function gf(t,e,r,n,a,o,c,u,h){return t=new N4(t,e,r,u,h),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Mr(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jh(o),t}function j4(t,e,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mi,key:n==null?null:""+n,children:t,containerInfo:e,implementation:r}}function t_(t){if(!t)return hs;t=t._reactInternals;e:{if(Gs(t)!==t||t.tag!==1)throw Error(he(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(or(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(he(171))}if(t.tag===1){var r=t.type;if(or(r))return t1(t,r,e)}return e}function r_(t,e,r,n,a,o,c,u,h){return t=gf(r,n,!0,t,a,o,c,u,h),t.context=t_(null),r=t.current,n=Jt(),a=os(r),o=Tn(n,a),o.callback=e??null,is(r,o,a),t.current.lanes=a,go(t,a,n),lr(t,n),t}function Mc(t,e,r,n){var a=e.current,o=Jt(),c=os(a);return r=t_(r),e.context===null?e.context=r:e.pendingContext=r,e=Tn(o,c),e.payload={element:t},n=n===void 0?null:n,n!==null&&(e.callback=n),t=is(a,e,c),t!==null&&(Zr(t,a,c,o),_l(t,a,c)),c}function ic(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function hg(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<e?r:e}}function yf(t,e){hg(t,e),(t=t.alternate)&&hg(t,e)}function S4(){return null}var n_=typeof reportError=="function"?reportError:function(t){console.error(t)};function xf(t){this._internalRoot=t}Ic.prototype.render=xf.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(he(409));Mc(t,e,null,null)};Ic.prototype.unmount=xf.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Hs(function(){Mc(null,t,null,null)}),e[An]=null}};function Ic(t){this._internalRoot=t}Ic.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ib();t={blockedOn:null,target:t,priority:e};for(var r=0;r<Gn.length&&e!==0&&e<Gn[r].priority;r++);Gn.splice(r,0,t),r===0&&Ob(t)}};function vf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Dc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function fg(){}function C4(t,e,r,n,a){if(a){if(typeof n=="function"){var o=n;n=function(){var f=ic(c);o.call(f)}}var c=r_(e,n,t,0,null,!1,!1,"",fg);return t._reactRootContainer=c,t[An]=c.current,to(t.nodeType===8?t.parentNode:t),Hs(),c}for(;a=t.lastChild;)t.removeChild(a);if(typeof n=="function"){var u=n;n=function(){var f=ic(h);u.call(f)}}var h=gf(t,0,!1,null,null,!1,!1,"",fg);return t._reactRootContainer=h,t[An]=h.current,to(t.nodeType===8?t.parentNode:t),Hs(function(){Mc(e,h,r,n)}),h}function Oc(t,e,r,n,a){var o=r._reactRootContainer;if(o){var c=o;if(typeof a=="function"){var u=a;a=function(){var h=ic(c);u.call(h)}}Mc(e,c,t,a)}else c=C4(r,e,t,a,n);return ic(c)}Ab=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var r=Ea(e.pendingLanes);r!==0&&(Rh(e,r|1),lr(e,ft()),!(qe&6)&&(Ui=ft()+500,gs()))}break;case 13:Hs(function(){var n=Mn(t,1);if(n!==null){var a=Jt();Zr(n,t,1,a)}}),yf(t,1)}};Bh=function(t){if(t.tag===13){var e=Mn(t,134217728);if(e!==null){var r=Jt();Zr(e,t,134217728,r)}yf(t,134217728)}};Mb=function(t){if(t.tag===13){var e=os(t),r=Mn(t,e);if(r!==null){var n=Jt();Zr(r,t,e,n)}yf(t,e)}};Ib=function(){return We};Db=function(t,e){var r=We;try{return We=t,e()}finally{We=r}};jd=function(t,e,r){switch(e){case"input":if(yd(t,r),e=r.name,r.type==="radio"&&e!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<r.length;e++){var n=r[e];if(n!==t&&n.form===t.form){var a=Cc(n);if(!a)throw Error(he(90));hb(n),yd(n,a)}}}break;case"textarea":mb(t,r);break;case"select":e=r.value,e!=null&&Pi(t,!!r.multiple,e,!1)}};bb=hf;_b=Hs;var P4={usingClientEntryPoint:!1,Events:[xo,vi,Cc,vb,wb,hf]},_a={findFiberByHostInstance:Is,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},k4={bundleType:_a.bundleType,version:_a.version,rendererPackageName:_a.rendererPackageName,rendererConfig:_a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zn.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Sb(t),t===null?null:t.stateNode},findFiberByHostInstance:_a.findFiberByHostInstance||S4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ul=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ul.isDisabled&&ul.supportsFiber)try{_c=ul.inject(k4),ln=ul}catch{}}_r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P4;_r.createPortal=function(t,e){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!vf(e))throw Error(he(200));return j4(t,e,null,r)};_r.createRoot=function(t,e){if(!vf(t))throw Error(he(299));var r=!1,n="",a=n_;return e!=null&&(e.unstable_strictMode===!0&&(r=!0),e.identifierPrefix!==void 0&&(n=e.identifierPrefix),e.onRecoverableError!==void 0&&(a=e.onRecoverableError)),e=gf(t,1,!1,null,null,r,!1,n,a),t[An]=e.current,to(t.nodeType===8?t.parentNode:t),new xf(e)};_r.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(he(188)):(t=Object.keys(t).join(","),Error(he(268,t)));return t=Sb(e),t=t===null?null:t.stateNode,t};_r.flushSync=function(t){return Hs(t)};_r.hydrate=function(t,e,r){if(!Dc(e))throw Error(he(200));return Oc(null,t,e,!0,r)};_r.hydrateRoot=function(t,e,r){if(!vf(t))throw Error(he(405));var n=r!=null&&r.hydratedSources||null,a=!1,o="",c=n_;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(o=r.identifierPrefix),r.onRecoverableError!==void 0&&(c=r.onRecoverableError)),e=r_(e,null,t,1,r??null,a,!1,o,c),t[An]=e.current,to(t),n)for(t=0;t<n.length;t++)r=n[t],a=r._getVersion,a=a(r._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[r,a]:e.mutableSourceEagerHydrationData.push(r,a);return new Ic(e)};_r.render=function(t,e,r){if(!Dc(e))throw Error(he(200));return Oc(null,t,e,!1,r)};_r.unmountComponentAtNode=function(t){if(!Dc(t))throw Error(he(40));return t._reactRootContainer?(Hs(function(){Oc(null,null,t,!1,function(){t._reactRootContainer=null,t[An]=null})}),!0):!1};_r.unstable_batchedUpdates=hf;_r.unstable_renderSubtreeIntoContainer=function(t,e,r,n){if(!Dc(r))throw Error(he(200));if(t==null||t._reactInternals===void 0)throw Error(he(38));return Oc(t,e,r,!1,n)};_r.version="18.3.1-next-f1338f8080-20240426";function s_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s_)}catch(t){console.error(t)}}s_(),sb.exports=_r;var i_=sb.exports,a_,mg=i_;a_=mg.createRoot,mg.hydrateRoot;/**
 * react-router v7.7.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var pg="popstate";function T4(t={}){function e(n,a){let{pathname:o,search:c,hash:u}=n.location;return nh("",{pathname:o,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:uo(a)}return L4(e,r,null,t)}function nt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Gr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function E4(){return Math.random().toString(36).substring(2,10)}function gg(t,e){return{usr:t.state,key:t.key,idx:e}}function nh(t,e,r=null,n){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Wi(e):e,state:r,key:e&&e.key||n||E4()}}function uo({pathname:t="/",search:e="",hash:r=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Wi(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substring(r),t=t.substring(0,r));let n=t.indexOf("?");n>=0&&(e.search=t.substring(n),t=t.substring(0,n)),t&&(e.pathname=t)}return e}function L4(t,e,r,n={}){let{window:a=document.defaultView,v5Compat:o=!1}=n,c=a.history,u="POP",h=null,f=m();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function m(){return(c.state||{idx:null}).idx}function v(){u="POP";let j=m(),_=j==null?null:j-f;f=j,h&&h({action:u,location:y.location,delta:_})}function w(j,_){u="PUSH";let b=nh(y.location,j,_);f=m()+1;let P=gg(b,f),B=y.createHref(b);try{c.pushState(P,"",B)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;a.location.assign(B)}o&&h&&h({action:u,location:y.location,delta:1})}function N(j,_){u="REPLACE";let b=nh(y.location,j,_);f=m();let P=gg(b,f),B=y.createHref(b);c.replaceState(P,"",B),o&&h&&h({action:u,location:y.location,delta:0})}function g(j){return A4(j)}let y={get action(){return u},get location(){return t(a,c)},listen(j){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(pg,v),h=j,()=>{a.removeEventListener(pg,v),h=null}},createHref(j){return e(a,j)},createURL:g,encodeLocation(j){let _=g(j);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:w,replace:N,go(j){return c.go(j)}};return y}function A4(t,e=!1){let r="http://localhost";typeof window<"u"&&(r=window.location.origin!=="null"?window.location.origin:window.location.href),nt(r,"No window.location.(origin|href) available to create URL");let n=typeof t=="string"?t:uo(t);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=r+n),new URL(n,r)}function o_(t,e,r="/"){return M4(t,e,r,!1)}function M4(t,e,r,n){let a=typeof e=="string"?Wi(e):e,o=Dn(a.pathname||"/",r);if(o==null)return null;let c=l_(t);I4(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let f=V4(o);u=q4(c[h],f,n)}return u}function l_(t,e=[],r=[],n=""){let a=(o,c,u)=>{let h={relativePath:u===void 0?o.path||"":u,caseSensitive:o.caseSensitive===!0,childrenIndex:c,route:o};h.relativePath.startsWith("/")&&(nt(h.relativePath.startsWith(n),`Absolute route path "${h.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(n.length));let f=En([n,h.relativePath]),m=r.concat(h);o.children&&o.children.length>0&&(nt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),l_(o.children,e,m,f)),!(o.path==null&&!o.index)&&e.push({path:f,score:F4(f,o.index),routesMeta:m})};return t.forEach((o,c)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))a(o,c);else for(let h of c_(o.path))a(o,c,h)}),e}function c_(t){let e=t.split("/");if(e.length===0)return[];let[r,...n]=e,a=r.endsWith("?"),o=r.replace(/\?$/,"");if(n.length===0)return a?[o,""]:[o];let c=c_(n.join("/")),u=[];return u.push(...c.map(h=>h===""?o:[o,h].join("/"))),a&&u.push(...c),u.map(h=>t.startsWith("/")&&h===""?"/":h)}function I4(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:U4(e.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}var D4=/^:[\w-]+$/,O4=3,R4=2,B4=1,$4=10,z4=-2,yg=t=>t==="*";function F4(t,e){let r=t.split("/"),n=r.length;return r.some(yg)&&(n+=z4),e&&(n+=R4),r.filter(a=>!yg(a)).reduce((a,o)=>a+(D4.test(o)?O4:o===""?B4:$4),n)}function U4(t,e){return t.length===e.length&&t.slice(0,-1).every((n,a)=>n===e[a])?t[t.length-1]-e[e.length-1]:0}function q4(t,e,r=!1){let{routesMeta:n}=t,a={},o="/",c=[];for(let u=0;u<n.length;++u){let h=n[u],f=u===n.length-1,m=o==="/"?e:e.slice(o.length)||"/",v=ac({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},m),w=h.route;if(!v&&f&&r&&!n[n.length-1].route.index&&(v=ac({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},m)),!v)return null;Object.assign(a,v.params),c.push({params:a,pathname:En([o,v.pathname]),pathnameBase:K4(En([o,v.pathnameBase])),route:w}),v.pathnameBase!=="/"&&(o=En([o,v.pathnameBase]))}return c}function ac(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=H4(t.path,t.caseSensitive,t.end),a=e.match(r);if(!a)return null;let o=a[0],c=o.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:n.reduce((f,{paramName:m,isOptional:v},w)=>{if(m==="*"){let g=u[w]||"";c=o.slice(0,o.length-g.length).replace(/(.)\/+$/,"$1")}const N=u[w];return v&&!N?f[m]=void 0:f[m]=(N||"").replace(/%2F/g,"/"),f},{}),pathname:o,pathnameBase:c,pattern:t}}function H4(t,e=!1,r=!0){Gr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(n.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),n]}function V4(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Gr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Dn(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}function Q4(t,e="/"){let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?Wi(t):t;return{pathname:r?r.startsWith("/")?r:W4(r,e):e,search:G4(n),hash:Y4(a)}}function W4(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function td(t,e,r,n){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Z4(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function wf(t){let e=Z4(t);return e.map((r,n)=>n===e.length-1?r.pathname:r.pathnameBase)}function bf(t,e,r,n=!1){let a;typeof t=="string"?a=Wi(t):(a={...t},nt(!a.pathname||!a.pathname.includes("?"),td("?","pathname","search",a)),nt(!a.pathname||!a.pathname.includes("#"),td("#","pathname","hash",a)),nt(!a.search||!a.search.includes("#"),td("#","search","hash",a)));let o=t===""||a.pathname==="",c=o?"/":a.pathname,u;if(c==null)u=r;else{let v=e.length-1;if(!n&&c.startsWith("..")){let w=c.split("/");for(;w[0]==="..";)w.shift(),v-=1;a.pathname=w.join("/")}u=v>=0?e[v]:"/"}let h=Q4(a,u),f=c&&c!=="/"&&c.endsWith("/"),m=(o||c===".")&&r.endsWith("/");return!h.pathname.endsWith("/")&&(f||m)&&(h.pathname+="/"),h}var En=t=>t.join("/").replace(/\/\/+/g,"/"),K4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),G4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Y4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function J4(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var u_=["POST","PUT","PATCH","DELETE"];new Set(u_);var X4=["GET",...u_];new Set(X4);var Zi=R.createContext(null);Zi.displayName="DataRouter";var Rc=R.createContext(null);Rc.displayName="DataRouterState";R.createContext(!1);var d_=R.createContext({isTransitioning:!1});d_.displayName="ViewTransition";var e5=R.createContext(new Map);e5.displayName="Fetchers";var t5=R.createContext(null);t5.displayName="Await";var Yr=R.createContext(null);Yr.displayName="Navigation";var wo=R.createContext(null);wo.displayName="Location";var hn=R.createContext({outlet:null,matches:[],isDataRoute:!1});hn.displayName="Route";var _f=R.createContext(null);_f.displayName="RouteError";function r5(t,{relative:e}={}){nt(Ki(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:n}=R.useContext(Yr),{hash:a,pathname:o,search:c}=bo(t,{relative:e}),u=o;return r!=="/"&&(u=o==="/"?r:En([r,o])),n.createHref({pathname:u,search:c,hash:a})}function Ki(){return R.useContext(wo)!=null}function ys(){return nt(Ki(),"useLocation() may be used only in the context of a <Router> component."),R.useContext(wo).location}var h_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function f_(t){R.useContext(Yr).static||R.useLayoutEffect(t)}function Nf(){let{isDataRoute:t}=R.useContext(hn);return t?p5():n5()}function n5(){nt(Ki(),"useNavigate() may be used only in the context of a <Router> component.");let t=R.useContext(Zi),{basename:e,navigator:r}=R.useContext(Yr),{matches:n}=R.useContext(hn),{pathname:a}=ys(),o=JSON.stringify(wf(n)),c=R.useRef(!1);return f_(()=>{c.current=!0}),R.useCallback((h,f={})=>{if(Gr(c.current,h_),!c.current)return;if(typeof h=="number"){r.go(h);return}let m=bf(h,JSON.parse(o),a,f.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:En([e,m.pathname])),(f.replace?r.replace:r.push)(m,f.state,f)},[e,r,o,a,t])}R.createContext(null);function bo(t,{relative:e}={}){let{matches:r}=R.useContext(hn),{pathname:n}=ys(),a=JSON.stringify(wf(r));return R.useMemo(()=>bf(t,JSON.parse(a),n,e==="path"),[t,a,n,e])}function s5(t,e){return m_(t,e)}function m_(t,e,r,n){var _;nt(Ki(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=R.useContext(Yr),{matches:o}=R.useContext(hn),c=o[o.length-1],u=c?c.params:{},h=c?c.pathname:"/",f=c?c.pathnameBase:"/",m=c&&c.route;{let b=m&&m.path||"";p_(h,!m||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let v=ys(),w;if(e){let b=typeof e=="string"?Wi(e):e;nt(f==="/"||((_=b.pathname)==null?void 0:_.startsWith(f)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${b.pathname}" was given in the \`location\` prop.`),w=b}else w=v;let N=w.pathname||"/",g=N;if(f!=="/"){let b=f.replace(/^\//,"").split("/");g="/"+N.replace(/^\//,"").split("/").slice(b.length).join("/")}let y=o_(t,{pathname:g});Gr(m||y!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),Gr(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let j=c5(y&&y.map(b=>Object.assign({},b,{params:Object.assign({},u,b.params),pathname:En([f,a.encodeLocation?a.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?f:En([f,a.encodeLocation?a.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),o,r,n);return e&&j?R.createElement(wo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},j):j}function i5(){let t=m5(),e=J4(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,n="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=R.createElement(R.Fragment,null,R.createElement("p",null,"💿 Hey developer 👋"),R.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",R.createElement("code",{style:o},"ErrorBoundary")," or"," ",R.createElement("code",{style:o},"errorElement")," prop on your route.")),R.createElement(R.Fragment,null,R.createElement("h2",null,"Unexpected Application Error!"),R.createElement("h3",{style:{fontStyle:"italic"}},e),r?R.createElement("pre",{style:a},r):null,c)}var a5=R.createElement(i5,null),o5=class extends R.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?R.createElement(hn.Provider,{value:this.props.routeContext},R.createElement(_f.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function l5({routeContext:t,match:e,children:r}){let n=R.useContext(Zi);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),R.createElement(hn.Provider,{value:t},r)}function c5(t,e=[],r=null,n=null){if(t==null){if(!r)return null;if(r.errors)t=r.matches;else if(e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let a=t,o=r==null?void 0:r.errors;if(o!=null){let h=a.findIndex(f=>f.route.id&&(o==null?void 0:o[f.route.id])!==void 0);nt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let c=!1,u=-1;if(r)for(let h=0;h<a.length;h++){let f=a[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=h),f.route.id){let{loaderData:m,errors:v}=r,w=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!v||v[f.route.id]===void 0);if(f.route.lazy||w){c=!0,u>=0?a=a.slice(0,u+1):a=[a[0]];break}}}return a.reduceRight((h,f,m)=>{let v,w=!1,N=null,g=null;r&&(v=o&&f.route.id?o[f.route.id]:void 0,N=f.route.errorElement||a5,c&&(u<0&&m===0?(p_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),w=!0,g=null):u===m&&(w=!0,g=f.route.hydrateFallbackElement||null)));let y=e.concat(a.slice(0,m+1)),j=()=>{let _;return v?_=N:w?_=g:f.route.Component?_=R.createElement(f.route.Component,null):f.route.element?_=f.route.element:_=h,R.createElement(l5,{match:f,routeContext:{outlet:h,matches:y,isDataRoute:r!=null},children:_})};return r&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?R.createElement(o5,{location:r.location,revalidation:r.revalidation,component:N,error:v,children:j(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):j()},null)}function jf(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function u5(t){let e=R.useContext(Zi);return nt(e,jf(t)),e}function d5(t){let e=R.useContext(Rc);return nt(e,jf(t)),e}function h5(t){let e=R.useContext(hn);return nt(e,jf(t)),e}function Sf(t){let e=h5(t),r=e.matches[e.matches.length-1];return nt(r.route.id,`${t} can only be used on routes that contain a unique "id"`),r.route.id}function f5(){return Sf("useRouteId")}function m5(){var n;let t=R.useContext(_f),e=d5("useRouteError"),r=Sf("useRouteError");return t!==void 0?t:(n=e.errors)==null?void 0:n[r]}function p5(){let{router:t}=u5("useNavigate"),e=Sf("useNavigate"),r=R.useRef(!1);return f_(()=>{r.current=!0}),R.useCallback(async(a,o={})=>{Gr(r.current,h_),r.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...o}))},[t,e])}var xg={};function p_(t,e,r){!e&&!xg[t]&&(xg[t]=!0,Gr(!1,r))}R.memo(g5);function g5({routes:t,future:e,state:r}){return m_(t,void 0,r,e)}function y5({to:t,replace:e,state:r,relative:n}){nt(Ki(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=R.useContext(Yr);Gr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=R.useContext(hn),{pathname:c}=ys(),u=Nf(),h=bf(t,wf(o),c,n==="path"),f=JSON.stringify(h);return R.useEffect(()=>{u(JSON.parse(f),{replace:e,state:r,relative:n})},[u,f,n,e,r]),null}function Ct(t){nt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function x5({basename:t="/",children:e=null,location:r,navigationType:n="POP",navigator:a,static:o=!1}){nt(!Ki(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=R.useMemo(()=>({basename:c,navigator:a,static:o,future:{}}),[c,a,o]);typeof r=="string"&&(r=Wi(r));let{pathname:h="/",search:f="",hash:m="",state:v=null,key:w="default"}=r,N=R.useMemo(()=>{let g=Dn(h,c);return g==null?null:{location:{pathname:g,search:f,hash:m,state:v,key:w},navigationType:n}},[c,h,f,m,v,w,n]);return Gr(N!=null,`<Router basename="${c}"> is not able to match the URL "${h}${f}${m}" because it does not start with the basename, so the <Router> won't render anything.`),N==null?null:R.createElement(Yr.Provider,{value:u},R.createElement(wo.Provider,{children:e,value:N}))}function v5({children:t,location:e}){return s5(sh(t),e)}function sh(t,e=[]){let r=[];return R.Children.forEach(t,(n,a)=>{if(!R.isValidElement(n))return;let o=[...e,a];if(n.type===R.Fragment){r.push.apply(r,sh(n.props.children,o));return}nt(n.type===Ct,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),nt(!n.props.index||!n.props.children,"An index route cannot have child routes.");let c={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(c.children=sh(n.props.children,o)),r.push(c)}),r}var Tl="get",El="application/x-www-form-urlencoded";function Bc(t){return t!=null&&typeof t.tagName=="string"}function w5(t){return Bc(t)&&t.tagName.toLowerCase()==="button"}function b5(t){return Bc(t)&&t.tagName.toLowerCase()==="form"}function _5(t){return Bc(t)&&t.tagName.toLowerCase()==="input"}function N5(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function j5(t,e){return t.button===0&&(!e||e==="_self")&&!N5(t)}var dl=null;function S5(){if(dl===null)try{new FormData(document.createElement("form"),0),dl=!1}catch{dl=!0}return dl}var C5=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function rd(t){return t!=null&&!C5.has(t)?(Gr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${El}"`),null):t}function P5(t,e){let r,n,a,o,c;if(b5(t)){let u=t.getAttribute("action");n=u?Dn(u,e):null,r=t.getAttribute("method")||Tl,a=rd(t.getAttribute("enctype"))||El,o=new FormData(t)}else if(w5(t)||_5(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=t.getAttribute("formaction")||u.getAttribute("action");if(n=h?Dn(h,e):null,r=t.getAttribute("formmethod")||u.getAttribute("method")||Tl,a=rd(t.getAttribute("formenctype"))||rd(u.getAttribute("enctype"))||El,o=new FormData(u,t),!S5()){let{name:f,type:m,value:v}=t;if(m==="image"){let w=f?`${f}.`:"";o.append(`${w}x`,"0"),o.append(`${w}y`,"0")}else f&&o.append(f,v)}}else{if(Bc(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=Tl,n=null,a=El,c=t}return o&&a==="text/plain"&&(c=o,o=void 0),{action:n,method:r.toLowerCase(),encType:a,formData:o,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Cf(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function k5(t,e,r){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname=`_root.${r}`:e&&Dn(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${r}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${r}`,n}async function T5(t,e){if(t.id in e)return e[t.id];try{let r=await import(t.module);return e[t.id]=r,r}catch(r){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function E5(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function L5(t,e,r){let n=await Promise.all(t.map(async a=>{let o=e.routes[a.route.id];if(o){let c=await T5(o,r);return c.links?c.links():[]}return[]}));return D5(n.flat(1).filter(E5).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function vg(t,e,r,n,a,o){let c=(h,f)=>r[f]?h.route.id!==r[f].route.id:!0,u=(h,f)=>{var m;return r[f].pathname!==h.pathname||((m=r[f].route.path)==null?void 0:m.endsWith("*"))&&r[f].params["*"]!==h.params["*"]};return o==="assets"?e.filter((h,f)=>c(h,f)||u(h,f)):o==="data"?e.filter((h,f)=>{var v;let m=n.routes[h.route.id];if(!m||!m.hasLoader)return!1;if(c(h,f)||u(h,f))return!0;if(h.route.shouldRevalidate){let w=h.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:((v=r[0])==null?void 0:v.params)||{},nextUrl:new URL(t,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof w=="boolean")return w}return!0}):[]}function A5(t,e,{includeHydrateFallback:r}={}){return M5(t.map(n=>{let a=e.routes[n.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),r&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function M5(t){return[...new Set(t)]}function I5(t){let e={},r=Object.keys(t).sort();for(let n of r)e[n]=t[n];return e}function D5(t,e){let r=new Set;return new Set(e),t.reduce((n,a)=>{let o=JSON.stringify(I5(a));return r.has(o)||(r.add(o),n.push({key:o,link:a})),n},[])}function g_(){let t=R.useContext(Zi);return Cf(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function O5(){let t=R.useContext(Rc);return Cf(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Pf=R.createContext(void 0);Pf.displayName="FrameworkContext";function y_(){let t=R.useContext(Pf);return Cf(t,"You must render this element inside a <HydratedRouter> element"),t}function R5(t,e){let r=R.useContext(Pf),[n,a]=R.useState(!1),[o,c]=R.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:f,onMouseLeave:m,onTouchStart:v}=e,w=R.useRef(null);R.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let y=_=>{_.forEach(b=>{c(b.isIntersecting)})},j=new IntersectionObserver(y,{threshold:.5});return w.current&&j.observe(w.current),()=>{j.disconnect()}}},[t]),R.useEffect(()=>{if(n){let y=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(y)}}},[n]);let N=()=>{a(!0)},g=()=>{a(!1),c(!1)};return r?t!=="intent"?[o,w,{}]:[o,w,{onFocus:Na(u,N),onBlur:Na(h,g),onMouseEnter:Na(f,N),onMouseLeave:Na(m,g),onTouchStart:Na(v,N)}]:[!1,w,{}]}function Na(t,e){return r=>{t&&t(r),r.defaultPrevented||e(r)}}function B5({page:t,...e}){let{router:r}=g_(),n=R.useMemo(()=>o_(r.routes,t,r.basename),[r.routes,t,r.basename]);return n?R.createElement(z5,{page:t,matches:n,...e}):null}function $5(t){let{manifest:e,routeModules:r}=y_(),[n,a]=R.useState([]);return R.useEffect(()=>{let o=!1;return L5(t,e,r).then(c=>{o||a(c)}),()=>{o=!0}},[t,e,r]),n}function z5({page:t,matches:e,...r}){let n=ys(),{manifest:a,routeModules:o}=y_(),{basename:c}=g_(),{loaderData:u,matches:h}=O5(),f=R.useMemo(()=>vg(t,e,h,a,n,"data"),[t,e,h,a,n]),m=R.useMemo(()=>vg(t,e,h,a,n,"assets"),[t,e,h,a,n]),v=R.useMemo(()=>{if(t===n.pathname+n.search+n.hash)return[];let g=new Set,y=!1;if(e.forEach(_=>{var P;let b=a.routes[_.route.id];!b||!b.hasLoader||(!f.some(B=>B.route.id===_.route.id)&&_.route.id in u&&((P=o[_.route.id])!=null&&P.shouldRevalidate)||b.hasClientLoader?y=!0:g.add(_.route.id))}),g.size===0)return[];let j=k5(t,c,"data");return y&&g.size>0&&j.searchParams.set("_routes",e.filter(_=>g.has(_.route.id)).map(_=>_.route.id).join(",")),[j.pathname+j.search]},[c,u,n,a,f,e,t,o]),w=R.useMemo(()=>A5(m,a),[m,a]),N=$5(m);return R.createElement(R.Fragment,null,v.map(g=>R.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...r})),w.map(g=>R.createElement("link",{key:g,rel:"modulepreload",href:g,...r})),N.map(({key:g,link:y})=>R.createElement("link",{key:g,...y})))}function F5(...t){return e=>{t.forEach(r=>{typeof r=="function"?r(e):r!=null&&(r.current=e)})}}var x_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{x_&&(window.__reactRouterVersion="7.7.1")}catch{}function U5({basename:t,children:e,window:r}){let n=R.useRef();n.current==null&&(n.current=T4({window:r,v5Compat:!0}));let a=n.current,[o,c]=R.useState({action:a.action,location:a.location}),u=R.useCallback(h=>{R.startTransition(()=>c(h))},[c]);return R.useLayoutEffect(()=>a.listen(u),[a,u]),R.createElement(x5,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a})}var v_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,oc=R.forwardRef(function({onClick:e,discover:r="render",prefetch:n="none",relative:a,reloadDocument:o,replace:c,state:u,target:h,to:f,preventScrollReset:m,viewTransition:v,...w},N){let{basename:g}=R.useContext(Yr),y=typeof f=="string"&&v_.test(f),j,_=!1;if(typeof f=="string"&&y&&(j=f,x_))try{let D=new URL(window.location.href),U=f.startsWith("//")?new URL(D.protocol+f):new URL(f),V=Dn(U.pathname,g);U.origin===D.origin&&V!=null?f=V+U.search+U.hash:_=!0}catch{Gr(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=r5(f,{relative:a}),[P,B,$]=R5(n,w),k=V5(f,{replace:c,state:u,target:h,preventScrollReset:m,relative:a,viewTransition:v});function I(D){e&&e(D),D.defaultPrevented||k(D)}let T=R.createElement("a",{...w,...$,href:j||b,onClick:_||o?e:I,ref:F5(N,B),target:h,"data-discover":!y&&r==="render"?"true":void 0});return P&&!y?R.createElement(R.Fragment,null,T,R.createElement(B5,{page:b})):T});oc.displayName="Link";var w_=R.forwardRef(function({"aria-current":e="page",caseSensitive:r=!1,className:n="",end:a=!1,style:o,to:c,viewTransition:u,children:h,...f},m){let v=bo(c,{relative:f.relative}),w=ys(),N=R.useContext(Rc),{navigator:g,basename:y}=R.useContext(Yr),j=N!=null&&G5(v)&&u===!0,_=g.encodeLocation?g.encodeLocation(v).pathname:v.pathname,b=w.pathname,P=N&&N.navigation&&N.navigation.location?N.navigation.location.pathname:null;r||(b=b.toLowerCase(),P=P?P.toLowerCase():null,_=_.toLowerCase()),P&&y&&(P=Dn(P,y)||P);const B=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let $=b===_||!a&&b.startsWith(_)&&b.charAt(B)==="/",k=P!=null&&(P===_||!a&&P.startsWith(_)&&P.charAt(_.length)==="/"),I={isActive:$,isPending:k,isTransitioning:j},T=$?e:void 0,D;typeof n=="function"?D=n(I):D=[n,$?"active":null,k?"pending":null,j?"transitioning":null].filter(Boolean).join(" ");let U=typeof o=="function"?o(I):o;return R.createElement(oc,{...f,"aria-current":T,className:D,ref:m,style:U,to:c,viewTransition:u},typeof h=="function"?h(I):h)});w_.displayName="NavLink";var q5=R.forwardRef(({discover:t="render",fetcherKey:e,navigate:r,reloadDocument:n,replace:a,state:o,method:c=Tl,action:u,onSubmit:h,relative:f,preventScrollReset:m,viewTransition:v,...w},N)=>{let g=Z5(),y=K5(u,{relative:f}),j=c.toLowerCase()==="get"?"get":"post",_=typeof u=="string"&&v_.test(u),b=P=>{if(h&&h(P),P.defaultPrevented)return;P.preventDefault();let B=P.nativeEvent.submitter,$=(B==null?void 0:B.getAttribute("formmethod"))||c;g(B||P.currentTarget,{fetcherKey:e,method:$,navigate:r,replace:a,state:o,relative:f,preventScrollReset:m,viewTransition:v})};return R.createElement("form",{ref:N,method:j,action:y,onSubmit:n?h:b,...w,"data-discover":!_&&t==="render"?"true":void 0})});q5.displayName="Form";function H5(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function b_(t){let e=R.useContext(Zi);return nt(e,H5(t)),e}function V5(t,{target:e,replace:r,state:n,preventScrollReset:a,relative:o,viewTransition:c}={}){let u=Nf(),h=ys(),f=bo(t,{relative:o});return R.useCallback(m=>{if(j5(m,e)){m.preventDefault();let v=r!==void 0?r:uo(h)===uo(f);u(t,{replace:v,state:n,preventScrollReset:a,relative:o,viewTransition:c})}},[h,u,f,r,n,e,t,a,o,c])}var Q5=0,W5=()=>`__${String(++Q5)}__`;function Z5(){let{router:t}=b_("useSubmit"),{basename:e}=R.useContext(Yr),r=f5();return R.useCallback(async(n,a={})=>{let{action:o,method:c,encType:u,formData:h,body:f}=P5(n,e);if(a.navigate===!1){let m=a.fetcherKey||W5();await t.fetch(m,r,a.action||o,{preventScrollReset:a.preventScrollReset,formData:h,body:f,formMethod:a.method||c,formEncType:a.encType||u,flushSync:a.flushSync})}else await t.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:h,body:f,formMethod:a.method||c,formEncType:a.encType||u,replace:a.replace,state:a.state,fromRouteId:r,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,r])}function K5(t,{relative:e}={}){let{basename:r}=R.useContext(Yr),n=R.useContext(hn);nt(n,"useFormAction must be used inside a RouteContext");let[a]=n.matches.slice(-1),o={...bo(t||".",{relative:e})},c=ys();if(t==null){o.search=c.search;let u=new URLSearchParams(o.search),h=u.getAll("index");if(h.some(m=>m==="")){u.delete("index"),h.filter(v=>v).forEach(v=>u.append("index",v));let m=u.toString();o.search=m?`?${m}`:""}}return(!t||t===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(o.pathname=o.pathname==="/"?r:En([r,o.pathname])),uo(o)}function G5(t,{relative:e}={}){let r=R.useContext(d_);nt(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=b_("useViewTransitionState"),a=bo(t,{relative:e});if(!r.isTransitioning)return!1;let o=Dn(r.currentLocation.pathname,n)||r.currentLocation.pathname,c=Dn(r.nextLocation.pathname,n)||r.nextLocation.pathname;return ac(a.pathname,c)!=null||ac(a.pathname,o)!=null}var Y5=Object.create,Gi=Object.defineProperty,J5=Object.getOwnPropertyDescriptor,X5=Object.getOwnPropertyNames,ek=Object.getPrototypeOf,tk=Object.prototype.hasOwnProperty,rk=(t,e,r)=>e in t?Gi(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,A=(t,e)=>Gi(t,"name",{value:e,configurable:!0}),hr=(t,e)=>()=>(t&&(e=t(t=0)),e),Oe=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Jr=(t,e)=>{for(var r in e)Gi(t,r,{get:e[r],enumerable:!0})},__=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of X5(e))!tk.call(t,a)&&a!==r&&Gi(t,a,{get:()=>e[a],enumerable:!(n=J5(e,a))||n.enumerable});return t},Ys=(t,e,r)=>(r=t!=null?Y5(ek(t)):{},__(e||!t||!t.__esModule?Gi(r,"default",{value:t,enumerable:!0}):r,t)),Et=t=>__(Gi({},"__esModule",{value:!0}),t),Te=(t,e,r)=>rk(t,typeof e!="symbol"?e+"":e,r),nk=Oe(t=>{_e(),t.byteLength=h,t.toByteArray=m,t.fromByteArray=N;var e=[],r=[],n=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(o=0,c=a.length;o<c;++o)e[o]=a[o],r[a.charCodeAt(o)]=o;var o,c;r[45]=62,r[95]=63;function u(g){var y=g.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var j=g.indexOf("=");j===-1&&(j=y);var _=j===y?0:4-j%4;return[j,_]}A(u,"getLens");function h(g){var y=u(g),j=y[0],_=y[1];return(j+_)*3/4-_}A(h,"byteLength");function f(g,y,j){return(y+j)*3/4-j}A(f,"_byteLength");function m(g){var y,j=u(g),_=j[0],b=j[1],P=new n(f(g,_,b)),B=0,$=b>0?_-4:_,k;for(k=0;k<$;k+=4)y=r[g.charCodeAt(k)]<<18|r[g.charCodeAt(k+1)]<<12|r[g.charCodeAt(k+2)]<<6|r[g.charCodeAt(k+3)],P[B++]=y>>16&255,P[B++]=y>>8&255,P[B++]=y&255;return b===2&&(y=r[g.charCodeAt(k)]<<2|r[g.charCodeAt(k+1)]>>4,P[B++]=y&255),b===1&&(y=r[g.charCodeAt(k)]<<10|r[g.charCodeAt(k+1)]<<4|r[g.charCodeAt(k+2)]>>2,P[B++]=y>>8&255,P[B++]=y&255),P}A(m,"toByteArray");function v(g){return e[g>>18&63]+e[g>>12&63]+e[g>>6&63]+e[g&63]}A(v,"tripletToBase64");function w(g,y,j){for(var _,b=[],P=y;P<j;P+=3)_=(g[P]<<16&16711680)+(g[P+1]<<8&65280)+(g[P+2]&255),b.push(v(_));return b.join("")}A(w,"encodeChunk");function N(g){for(var y,j=g.length,_=j%3,b=[],P=16383,B=0,$=j-_;B<$;B+=P)b.push(w(g,B,B+P>$?$:B+P));return _===1?(y=g[j-1],b.push(e[y>>2]+e[y<<4&63]+"==")):_===2&&(y=(g[j-2]<<8)+g[j-1],b.push(e[y>>10]+e[y>>4&63]+e[y<<2&63]+"=")),b.join("")}A(N,"fromByteArray")}),sk=Oe(t=>{_e(),t.read=function(e,r,n,a,o){var c,u,h=o*8-a-1,f=(1<<h)-1,m=f>>1,v=-7,w=n?o-1:0,N=n?-1:1,g=e[r+w];for(w+=N,c=g&(1<<-v)-1,g>>=-v,v+=h;v>0;c=c*256+e[r+w],w+=N,v-=8);for(u=c&(1<<-v)-1,c>>=-v,v+=a;v>0;u=u*256+e[r+w],w+=N,v-=8);if(c===0)c=1-m;else{if(c===f)return u?NaN:(g?-1:1)*(1/0);u=u+Math.pow(2,a),c=c-m}return(g?-1:1)*u*Math.pow(2,c-a)},t.write=function(e,r,n,a,o,c){var u,h,f,m=c*8-o-1,v=(1<<m)-1,w=v>>1,N=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=a?0:c-1,y=a?1:-1,j=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(h=isNaN(r)?1:0,u=v):(u=Math.floor(Math.log(r)/Math.LN2),r*(f=Math.pow(2,-u))<1&&(u--,f*=2),u+w>=1?r+=N/f:r+=N*Math.pow(2,1-w),r*f>=2&&(u++,f/=2),u+w>=v?(h=0,u=v):u+w>=1?(h=(r*f-1)*Math.pow(2,o),u=u+w):(h=r*Math.pow(2,w-1)*Math.pow(2,o),u=0));o>=8;e[n+g]=h&255,g+=y,h/=256,o-=8);for(u=u<<o|h,m+=o;m>0;e[n+g]=u&255,g+=y,u/=256,m-=8);e[n+g-y]|=j*128}}),ik=Oe(t=>{_e();var e=nk(),r=sk(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=b,t.INSPECT_MAX_BYTES=50;var a=2147483647;t.kMaxLength=a,u.TYPED_ARRAY_SUPPORT=o(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{let x=new Uint8Array(1),C={foo:A(function(){return 42},"foo")};return Object.setPrototypeOf(C,Uint8Array.prototype),Object.setPrototypeOf(x,C),x.foo()===42}catch{return!1}}A(o,"typedArraySupport"),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:A(function(){if(u.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:A(function(){if(u.isBuffer(this))return this.byteOffset},"get")});function c(x){if(x>a)throw new RangeError('The value "'+x+'" is invalid for option "size"');let C=new Uint8Array(x);return Object.setPrototypeOf(C,u.prototype),C}A(c,"createBuffer");function u(x,C,E){if(typeof x=="number"){if(typeof C=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return v(x)}return h(x,C,E)}A(u,"Buffer"),u.poolSize=8192;function h(x,C,E){if(typeof x=="string")return w(x,C);if(ArrayBuffer.isView(x))return g(x);if(x==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof x);if(rr(x,ArrayBuffer)||x&&rr(x.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(rr(x,SharedArrayBuffer)||x&&rr(x.buffer,SharedArrayBuffer)))return y(x,C,E);if(typeof x=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let H=x.valueOf&&x.valueOf();if(H!=null&&H!==x)return u.from(H,C,E);let G=j(x);if(G)return G;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof x[Symbol.toPrimitive]=="function")return u.from(x[Symbol.toPrimitive]("string"),C,E);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof x)}A(h,"from"),u.from=function(x,C,E){return h(x,C,E)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function f(x){if(typeof x!="number")throw new TypeError('"size" argument must be of type number');if(x<0)throw new RangeError('The value "'+x+'" is invalid for option "size"')}A(f,"assertSize");function m(x,C,E){return f(x),x<=0?c(x):C!==void 0?typeof E=="string"?c(x).fill(C,E):c(x).fill(C):c(x)}A(m,"alloc"),u.alloc=function(x,C,E){return m(x,C,E)};function v(x){return f(x),c(x<0?0:_(x)|0)}A(v,"allocUnsafe"),u.allocUnsafe=function(x){return v(x)},u.allocUnsafeSlow=function(x){return v(x)};function w(x,C){if((typeof C!="string"||C==="")&&(C="utf8"),!u.isEncoding(C))throw new TypeError("Unknown encoding: "+C);let E=P(x,C)|0,H=c(E),G=H.write(x,C);return G!==E&&(H=H.slice(0,G)),H}A(w,"fromString");function N(x){let C=x.length<0?0:_(x.length)|0,E=c(C);for(let H=0;H<C;H+=1)E[H]=x[H]&255;return E}A(N,"fromArrayLike");function g(x){if(rr(x,Uint8Array)){let C=new Uint8Array(x);return y(C.buffer,C.byteOffset,C.byteLength)}return N(x)}A(g,"fromArrayView");function y(x,C,E){if(C<0||x.byteLength<C)throw new RangeError('"offset" is outside of buffer bounds');if(x.byteLength<C+(E||0))throw new RangeError('"length" is outside of buffer bounds');let H;return C===void 0&&E===void 0?H=new Uint8Array(x):E===void 0?H=new Uint8Array(x,C):H=new Uint8Array(x,C,E),Object.setPrototypeOf(H,u.prototype),H}A(y,"fromArrayBuffer");function j(x){if(u.isBuffer(x)){let C=_(x.length)|0,E=c(C);return E.length===0||x.copy(E,0,0,C),E}if(x.length!==void 0)return typeof x.length!="number"||_s(x.length)?c(0):N(x);if(x.type==="Buffer"&&Array.isArray(x.data))return N(x.data)}A(j,"fromObject");function _(x){if(x>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return x|0}A(_,"checked");function b(x){return+x!=x&&(x=0),u.alloc(+x)}A(b,"SlowBuffer"),u.isBuffer=A(function(x){return x!=null&&x._isBuffer===!0&&x!==u.prototype},"isBuffer"),u.compare=A(function(x,C){if(rr(x,Uint8Array)&&(x=u.from(x,x.offset,x.byteLength)),rr(C,Uint8Array)&&(C=u.from(C,C.offset,C.byteLength)),!u.isBuffer(x)||!u.isBuffer(C))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(x===C)return 0;let E=x.length,H=C.length;for(let G=0,se=Math.min(E,H);G<se;++G)if(x[G]!==C[G]){E=x[G],H=C[G];break}return E<H?-1:H<E?1:0},"compare"),u.isEncoding=A(function(x){switch(String(x).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),u.concat=A(function(x,C){if(!Array.isArray(x))throw new TypeError('"list" argument must be an Array of Buffers');if(x.length===0)return u.alloc(0);let E;if(C===void 0)for(C=0,E=0;E<x.length;++E)C+=x[E].length;let H=u.allocUnsafe(C),G=0;for(E=0;E<x.length;++E){let se=x[E];if(rr(se,Uint8Array))G+se.length>H.length?(u.isBuffer(se)||(se=u.from(se)),se.copy(H,G)):Uint8Array.prototype.set.call(H,se,G);else if(u.isBuffer(se))se.copy(H,G);else throw new TypeError('"list" argument must be an Array of Buffers');G+=se.length}return H},"concat");function P(x,C){if(u.isBuffer(x))return x.length;if(ArrayBuffer.isView(x)||rr(x,ArrayBuffer))return x.byteLength;if(typeof x!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof x);let E=x.length,H=arguments.length>2&&arguments[2]===!0;if(!H&&E===0)return 0;let G=!1;for(;;)switch(C){case"ascii":case"latin1":case"binary":return E;case"utf8":case"utf-8":return Un(x).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E*2;case"hex":return E>>>1;case"base64":return Xs(x).length;default:if(G)return H?-1:Un(x).length;C=(""+C).toLowerCase(),G=!0}}A(P,"byteLength"),u.byteLength=P;function B(x,C,E){let H=!1;if((C===void 0||C<0)&&(C=0),C>this.length||((E===void 0||E>this.length)&&(E=this.length),E<=0)||(E>>>=0,C>>>=0,E<=C))return"";for(x||(x="utf8");;)switch(x){case"hex":return ne(this,C,E);case"utf8":case"utf-8":return Q(this,C,E);case"ascii":return re(this,C,E);case"latin1":case"binary":return Z(this,C,E);case"base64":return q(this,C,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ie(this,C,E);default:if(H)throw new TypeError("Unknown encoding: "+x);x=(x+"").toLowerCase(),H=!0}}A(B,"slowToString"),u.prototype._isBuffer=!0;function $(x,C,E){let H=x[C];x[C]=x[E],x[E]=H}A($,"swap"),u.prototype.swap16=A(function(){let x=this.length;if(x%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let C=0;C<x;C+=2)$(this,C,C+1);return this},"swap16"),u.prototype.swap32=A(function(){let x=this.length;if(x%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let C=0;C<x;C+=4)$(this,C,C+3),$(this,C+1,C+2);return this},"swap32"),u.prototype.swap64=A(function(){let x=this.length;if(x%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let C=0;C<x;C+=8)$(this,C,C+7),$(this,C+1,C+6),$(this,C+2,C+5),$(this,C+3,C+4);return this},"swap64"),u.prototype.toString=A(function(){let x=this.length;return x===0?"":arguments.length===0?Q(this,0,x):B.apply(this,arguments)},"toString"),u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=A(function(x){if(!u.isBuffer(x))throw new TypeError("Argument must be a Buffer");return this===x?!0:u.compare(this,x)===0},"equals"),u.prototype.inspect=A(function(){let x="",C=t.INSPECT_MAX_BYTES;return x=this.toString("hex",0,C).replace(/(.{2})/g,"$1 ").trim(),this.length>C&&(x+=" ... "),"<Buffer "+x+">"},"inspect"),n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=A(function(x,C,E,H,G){if(rr(x,Uint8Array)&&(x=u.from(x,x.offset,x.byteLength)),!u.isBuffer(x))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof x);if(C===void 0&&(C=0),E===void 0&&(E=x?x.length:0),H===void 0&&(H=0),G===void 0&&(G=this.length),C<0||E>x.length||H<0||G>this.length)throw new RangeError("out of range index");if(H>=G&&C>=E)return 0;if(H>=G)return-1;if(C>=E)return 1;if(C>>>=0,E>>>=0,H>>>=0,G>>>=0,this===x)return 0;let se=G-H,me=E-C,Qe=Math.min(se,me),dt=this.slice(H,G),Ke=x.slice(C,E);for(let He=0;He<Qe;++He)if(dt[He]!==Ke[He]){se=dt[He],me=Ke[He];break}return se<me?-1:me<se?1:0},"compare");function k(x,C,E,H,G){if(x.length===0)return-1;if(typeof E=="string"?(H=E,E=0):E>2147483647?E=2147483647:E<-2147483648&&(E=-2147483648),E=+E,_s(E)&&(E=G?0:x.length-1),E<0&&(E=x.length+E),E>=x.length){if(G)return-1;E=x.length-1}else if(E<0)if(G)E=0;else return-1;if(typeof C=="string"&&(C=u.from(C,H)),u.isBuffer(C))return C.length===0?-1:I(x,C,E,H,G);if(typeof C=="number")return C=C&255,typeof Uint8Array.prototype.indexOf=="function"?G?Uint8Array.prototype.indexOf.call(x,C,E):Uint8Array.prototype.lastIndexOf.call(x,C,E):I(x,[C],E,H,G);throw new TypeError("val must be string, number or Buffer")}A(k,"bidirectionalIndexOf");function I(x,C,E,H,G){let se=1,me=x.length,Qe=C.length;if(H!==void 0&&(H=String(H).toLowerCase(),H==="ucs2"||H==="ucs-2"||H==="utf16le"||H==="utf-16le")){if(x.length<2||C.length<2)return-1;se=2,me/=2,Qe/=2,E/=2}function dt(He,ct){return se===1?He[ct]:He.readUInt16BE(ct*se)}A(dt,"read");let Ke;if(G){let He=-1;for(Ke=E;Ke<me;Ke++)if(dt(x,Ke)===dt(C,He===-1?0:Ke-He)){if(He===-1&&(He=Ke),Ke-He+1===Qe)return He*se}else He!==-1&&(Ke-=Ke-He),He=-1}else for(E+Qe>me&&(E=me-Qe),Ke=E;Ke>=0;Ke--){let He=!0;for(let ct=0;ct<Qe;ct++)if(dt(x,Ke+ct)!==dt(C,ct)){He=!1;break}if(He)return Ke}return-1}A(I,"arrayIndexOf"),u.prototype.includes=A(function(x,C,E){return this.indexOf(x,C,E)!==-1},"includes"),u.prototype.indexOf=A(function(x,C,E){return k(this,x,C,E,!0)},"indexOf"),u.prototype.lastIndexOf=A(function(x,C,E){return k(this,x,C,E,!1)},"lastIndexOf");function T(x,C,E,H){E=Number(E)||0;let G=x.length-E;H?(H=Number(H),H>G&&(H=G)):H=G;let se=C.length;H>se/2&&(H=se/2);let me;for(me=0;me<H;++me){let Qe=parseInt(C.substr(me*2,2),16);if(_s(Qe))return me;x[E+me]=Qe}return me}A(T,"hexWrite");function D(x,C,E,H){return pn(Un(C,x.length-E),x,E,H)}A(D,"utf8Write");function U(x,C,E,H){return pn(bs(C),x,E,H)}A(U,"asciiWrite");function V(x,C,E,H){return pn(Xs(C),x,E,H)}A(V,"base64Write");function z(x,C,E,H){return pn(To(C,x.length-E),x,E,H)}A(z,"ucs2Write"),u.prototype.write=A(function(x,C,E,H){if(C===void 0)H="utf8",E=this.length,C=0;else if(E===void 0&&typeof C=="string")H=C,E=this.length,C=0;else if(isFinite(C))C=C>>>0,isFinite(E)?(E=E>>>0,H===void 0&&(H="utf8")):(H=E,E=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let G=this.length-C;if((E===void 0||E>G)&&(E=G),x.length>0&&(E<0||C<0)||C>this.length)throw new RangeError("Attempt to write outside buffer bounds");H||(H="utf8");let se=!1;for(;;)switch(H){case"hex":return T(this,x,C,E);case"utf8":case"utf-8":return D(this,x,C,E);case"ascii":case"latin1":case"binary":return U(this,x,C,E);case"base64":return V(this,x,C,E);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,x,C,E);default:if(se)throw new TypeError("Unknown encoding: "+H);H=(""+H).toLowerCase(),se=!0}},"write"),u.prototype.toJSON=A(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function q(x,C,E){return C===0&&E===x.length?e.fromByteArray(x):e.fromByteArray(x.slice(C,E))}A(q,"base64Slice");function Q(x,C,E){E=Math.min(x.length,E);let H=[],G=C;for(;G<E;){let se=x[G],me=null,Qe=se>239?4:se>223?3:se>191?2:1;if(G+Qe<=E){let dt,Ke,He,ct;switch(Qe){case 1:se<128&&(me=se);break;case 2:dt=x[G+1],(dt&192)===128&&(ct=(se&31)<<6|dt&63,ct>127&&(me=ct));break;case 3:dt=x[G+1],Ke=x[G+2],(dt&192)===128&&(Ke&192)===128&&(ct=(se&15)<<12|(dt&63)<<6|Ke&63,ct>2047&&(ct<55296||ct>57343)&&(me=ct));break;case 4:dt=x[G+1],Ke=x[G+2],He=x[G+3],(dt&192)===128&&(Ke&192)===128&&(He&192)===128&&(ct=(se&15)<<18|(dt&63)<<12|(Ke&63)<<6|He&63,ct>65535&&ct<1114112&&(me=ct))}}me===null?(me=65533,Qe=1):me>65535&&(me-=65536,H.push(me>>>10&1023|55296),me=56320|me&1023),H.push(me),G+=Qe}return de(H)}A(Q,"utf8Slice");var te=4096;function de(x){let C=x.length;if(C<=te)return String.fromCharCode.apply(String,x);let E="",H=0;for(;H<C;)E+=String.fromCharCode.apply(String,x.slice(H,H+=te));return E}A(de,"decodeCodePointsArray");function re(x,C,E){let H="";E=Math.min(x.length,E);for(let G=C;G<E;++G)H+=String.fromCharCode(x[G]&127);return H}A(re,"asciiSlice");function Z(x,C,E){let H="";E=Math.min(x.length,E);for(let G=C;G<E;++G)H+=String.fromCharCode(x[G]);return H}A(Z,"latin1Slice");function ne(x,C,E){let H=x.length;(!C||C<0)&&(C=0),(!E||E<0||E>H)&&(E=H);let G="";for(let se=C;se<E;++se)G+=tu[x[se]];return G}A(ne,"hexSlice");function ie(x,C,E){let H=x.slice(C,E),G="";for(let se=0;se<H.length-1;se+=2)G+=String.fromCharCode(H[se]+H[se+1]*256);return G}A(ie,"utf16leSlice"),u.prototype.slice=A(function(x,C){let E=this.length;x=~~x,C=C===void 0?E:~~C,x<0?(x+=E,x<0&&(x=0)):x>E&&(x=E),C<0?(C+=E,C<0&&(C=0)):C>E&&(C=E),C<x&&(C=x);let H=this.subarray(x,C);return Object.setPrototypeOf(H,u.prototype),H},"slice");function K(x,C,E){if(x%1!==0||x<0)throw new RangeError("offset is not uint");if(x+C>E)throw new RangeError("Trying to access beyond buffer length")}A(K,"checkOffset"),u.prototype.readUintLE=u.prototype.readUIntLE=A(function(x,C,E){x=x>>>0,C=C>>>0,E||K(x,C,this.length);let H=this[x],G=1,se=0;for(;++se<C&&(G*=256);)H+=this[x+se]*G;return H},"readUIntLE"),u.prototype.readUintBE=u.prototype.readUIntBE=A(function(x,C,E){x=x>>>0,C=C>>>0,E||K(x,C,this.length);let H=this[x+--C],G=1;for(;C>0&&(G*=256);)H+=this[x+--C]*G;return H},"readUIntBE"),u.prototype.readUint8=u.prototype.readUInt8=A(function(x,C){return x=x>>>0,C||K(x,1,this.length),this[x]},"readUInt8"),u.prototype.readUint16LE=u.prototype.readUInt16LE=A(function(x,C){return x=x>>>0,C||K(x,2,this.length),this[x]|this[x+1]<<8},"readUInt16LE"),u.prototype.readUint16BE=u.prototype.readUInt16BE=A(function(x,C){return x=x>>>0,C||K(x,2,this.length),this[x]<<8|this[x+1]},"readUInt16BE"),u.prototype.readUint32LE=u.prototype.readUInt32LE=A(function(x,C){return x=x>>>0,C||K(x,4,this.length),(this[x]|this[x+1]<<8|this[x+2]<<16)+this[x+3]*16777216},"readUInt32LE"),u.prototype.readUint32BE=u.prototype.readUInt32BE=A(function(x,C){return x=x>>>0,C||K(x,4,this.length),this[x]*16777216+(this[x+1]<<16|this[x+2]<<8|this[x+3])},"readUInt32BE"),u.prototype.readBigUInt64LE=$r(A(function(x){x=x>>>0,Br(x,"offset");let C=this[x],E=this[x+7];(C===void 0||E===void 0)&&Fn(x,this.length-8);let H=C+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24,G=this[++x]+this[++x]*2**8+this[++x]*2**16+E*2**24;return BigInt(H)+(BigInt(G)<<BigInt(32))},"readBigUInt64LE")),u.prototype.readBigUInt64BE=$r(A(function(x){x=x>>>0,Br(x,"offset");let C=this[x],E=this[x+7];(C===void 0||E===void 0)&&Fn(x,this.length-8);let H=C*2**24+this[++x]*2**16+this[++x]*2**8+this[++x],G=this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+E;return(BigInt(H)<<BigInt(32))+BigInt(G)},"readBigUInt64BE")),u.prototype.readIntLE=A(function(x,C,E){x=x>>>0,C=C>>>0,E||K(x,C,this.length);let H=this[x],G=1,se=0;for(;++se<C&&(G*=256);)H+=this[x+se]*G;return G*=128,H>=G&&(H-=Math.pow(2,8*C)),H},"readIntLE"),u.prototype.readIntBE=A(function(x,C,E){x=x>>>0,C=C>>>0,E||K(x,C,this.length);let H=C,G=1,se=this[x+--H];for(;H>0&&(G*=256);)se+=this[x+--H]*G;return G*=128,se>=G&&(se-=Math.pow(2,8*C)),se},"readIntBE"),u.prototype.readInt8=A(function(x,C){return x=x>>>0,C||K(x,1,this.length),this[x]&128?(255-this[x]+1)*-1:this[x]},"readInt8"),u.prototype.readInt16LE=A(function(x,C){x=x>>>0,C||K(x,2,this.length);let E=this[x]|this[x+1]<<8;return E&32768?E|4294901760:E},"readInt16LE"),u.prototype.readInt16BE=A(function(x,C){x=x>>>0,C||K(x,2,this.length);let E=this[x+1]|this[x]<<8;return E&32768?E|4294901760:E},"readInt16BE"),u.prototype.readInt32LE=A(function(x,C){return x=x>>>0,C||K(x,4,this.length),this[x]|this[x+1]<<8|this[x+2]<<16|this[x+3]<<24},"readInt32LE"),u.prototype.readInt32BE=A(function(x,C){return x=x>>>0,C||K(x,4,this.length),this[x]<<24|this[x+1]<<16|this[x+2]<<8|this[x+3]},"readInt32BE"),u.prototype.readBigInt64LE=$r(A(function(x){x=x>>>0,Br(x,"offset");let C=this[x],E=this[x+7];(C===void 0||E===void 0)&&Fn(x,this.length-8);let H=this[x+4]+this[x+5]*2**8+this[x+6]*2**16+(E<<24);return(BigInt(H)<<BigInt(32))+BigInt(C+this[++x]*2**8+this[++x]*2**16+this[++x]*2**24)},"readBigInt64LE")),u.prototype.readBigInt64BE=$r(A(function(x){x=x>>>0,Br(x,"offset");let C=this[x],E=this[x+7];(C===void 0||E===void 0)&&Fn(x,this.length-8);let H=(C<<24)+this[++x]*2**16+this[++x]*2**8+this[++x];return(BigInt(H)<<BigInt(32))+BigInt(this[++x]*2**24+this[++x]*2**16+this[++x]*2**8+E)},"readBigInt64BE")),u.prototype.readFloatLE=A(function(x,C){return x=x>>>0,C||K(x,4,this.length),r.read(this,x,!0,23,4)},"readFloatLE"),u.prototype.readFloatBE=A(function(x,C){return x=x>>>0,C||K(x,4,this.length),r.read(this,x,!1,23,4)},"readFloatBE"),u.prototype.readDoubleLE=A(function(x,C){return x=x>>>0,C||K(x,8,this.length),r.read(this,x,!0,52,8)},"readDoubleLE"),u.prototype.readDoubleBE=A(function(x,C){return x=x>>>0,C||K(x,8,this.length),r.read(this,x,!1,52,8)},"readDoubleBE");function fe(x,C,E,H,G,se){if(!u.isBuffer(x))throw new TypeError('"buffer" argument must be a Buffer instance');if(C>G||C<se)throw new RangeError('"value" argument is out of bounds');if(E+H>x.length)throw new RangeError("Index out of range")}A(fe,"checkInt"),u.prototype.writeUintLE=u.prototype.writeUIntLE=A(function(x,C,E,H){if(x=+x,C=C>>>0,E=E>>>0,!H){let me=Math.pow(2,8*E)-1;fe(this,x,C,E,me,0)}let G=1,se=0;for(this[C]=x&255;++se<E&&(G*=256);)this[C+se]=x/G&255;return C+E},"writeUIntLE"),u.prototype.writeUintBE=u.prototype.writeUIntBE=A(function(x,C,E,H){if(x=+x,C=C>>>0,E=E>>>0,!H){let me=Math.pow(2,8*E)-1;fe(this,x,C,E,me,0)}let G=E-1,se=1;for(this[C+G]=x&255;--G>=0&&(se*=256);)this[C+G]=x/se&255;return C+E},"writeUIntBE"),u.prototype.writeUint8=u.prototype.writeUInt8=A(function(x,C,E){return x=+x,C=C>>>0,E||fe(this,x,C,1,255,0),this[C]=x&255,C+1},"writeUInt8"),u.prototype.writeUint16LE=u.prototype.writeUInt16LE=A(function(x,C,E){return x=+x,C=C>>>0,E||fe(this,x,C,2,65535,0),this[C]=x&255,this[C+1]=x>>>8,C+2},"writeUInt16LE"),u.prototype.writeUint16BE=u.prototype.writeUInt16BE=A(function(x,C,E){return x=+x,C=C>>>0,E||fe(this,x,C,2,65535,0),this[C]=x>>>8,this[C+1]=x&255,C+2},"writeUInt16BE"),u.prototype.writeUint32LE=u.prototype.writeUInt32LE=A(function(x,C,E){return x=+x,C=C>>>0,E||fe(this,x,C,4,4294967295,0),this[C+3]=x>>>24,this[C+2]=x>>>16,this[C+1]=x>>>8,this[C]=x&255,C+4},"writeUInt32LE"),u.prototype.writeUint32BE=u.prototype.writeUInt32BE=A(function(x,C,E){return x=+x,C=C>>>0,E||fe(this,x,C,4,4294967295,0),this[C]=x>>>24,this[C+1]=x>>>16,this[C+2]=x>>>8,this[C+3]=x&255,C+4},"writeUInt32BE");function Ae(x,C,E,H,G){mn(C,H,G,x,E,7);let se=Number(C&BigInt(4294967295));x[E++]=se,se=se>>8,x[E++]=se,se=se>>8,x[E++]=se,se=se>>8,x[E++]=se;let me=Number(C>>BigInt(32)&BigInt(4294967295));return x[E++]=me,me=me>>8,x[E++]=me,me=me>>8,x[E++]=me,me=me>>8,x[E++]=me,E}A(Ae,"wrtBigUInt64LE");function ee(x,C,E,H,G){mn(C,H,G,x,E,7);let se=Number(C&BigInt(4294967295));x[E+7]=se,se=se>>8,x[E+6]=se,se=se>>8,x[E+5]=se,se=se>>8,x[E+4]=se;let me=Number(C>>BigInt(32)&BigInt(4294967295));return x[E+3]=me,me=me>>8,x[E+2]=me,me=me>>8,x[E+1]=me,me=me>>8,x[E]=me,E+8}A(ee,"wrtBigUInt64BE"),u.prototype.writeBigUInt64LE=$r(A(function(x,C=0){return Ae(this,x,C,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),u.prototype.writeBigUInt64BE=$r(A(function(x,C=0){return ee(this,x,C,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),u.prototype.writeIntLE=A(function(x,C,E,H){if(x=+x,C=C>>>0,!H){let Qe=Math.pow(2,8*E-1);fe(this,x,C,E,Qe-1,-Qe)}let G=0,se=1,me=0;for(this[C]=x&255;++G<E&&(se*=256);)x<0&&me===0&&this[C+G-1]!==0&&(me=1),this[C+G]=(x/se>>0)-me&255;return C+E},"writeIntLE"),u.prototype.writeIntBE=A(function(x,C,E,H){if(x=+x,C=C>>>0,!H){let Qe=Math.pow(2,8*E-1);fe(this,x,C,E,Qe-1,-Qe)}let G=E-1,se=1,me=0;for(this[C+G]=x&255;--G>=0&&(se*=256);)x<0&&me===0&&this[C+G+1]!==0&&(me=1),this[C+G]=(x/se>>0)-me&255;return C+E},"writeIntBE"),u.prototype.writeInt8=A(function(x,C,E){return x=+x,C=C>>>0,E||fe(this,x,C,1,127,-128),x<0&&(x=255+x+1),this[C]=x&255,C+1},"writeInt8"),u.prototype.writeInt16LE=A(function(x,C,E){return x=+x,C=C>>>0,E||fe(this,x,C,2,32767,-32768),this[C]=x&255,this[C+1]=x>>>8,C+2},"writeInt16LE"),u.prototype.writeInt16BE=A(function(x,C,E){return x=+x,C=C>>>0,E||fe(this,x,C,2,32767,-32768),this[C]=x>>>8,this[C+1]=x&255,C+2},"writeInt16BE"),u.prototype.writeInt32LE=A(function(x,C,E){return x=+x,C=C>>>0,E||fe(this,x,C,4,2147483647,-2147483648),this[C]=x&255,this[C+1]=x>>>8,this[C+2]=x>>>16,this[C+3]=x>>>24,C+4},"writeInt32LE"),u.prototype.writeInt32BE=A(function(x,C,E){return x=+x,C=C>>>0,E||fe(this,x,C,4,2147483647,-2147483648),x<0&&(x=4294967295+x+1),this[C]=x>>>24,this[C+1]=x>>>16,this[C+2]=x>>>8,this[C+3]=x&255,C+4},"writeInt32BE"),u.prototype.writeBigInt64LE=$r(A(function(x,C=0){return Ae(this,x,C,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),u.prototype.writeBigInt64BE=$r(A(function(x,C=0){return ee(this,x,C,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function ue(x,C,E,H,G,se){if(E+H>x.length)throw new RangeError("Index out of range");if(E<0)throw new RangeError("Index out of range")}A(ue,"checkIEEE754");function ae(x,C,E,H,G){return C=+C,E=E>>>0,G||ue(x,C,E,4),r.write(x,C,E,H,23,4),E+4}A(ae,"writeFloat"),u.prototype.writeFloatLE=A(function(x,C,E){return ae(this,x,C,!0,E)},"writeFloatLE"),u.prototype.writeFloatBE=A(function(x,C,E){return ae(this,x,C,!1,E)},"writeFloatBE");function pe(x,C,E,H,G){return C=+C,E=E>>>0,G||ue(x,C,E,8),r.write(x,C,E,H,52,8),E+8}A(pe,"writeDouble"),u.prototype.writeDoubleLE=A(function(x,C,E){return pe(this,x,C,!0,E)},"writeDoubleLE"),u.prototype.writeDoubleBE=A(function(x,C,E){return pe(this,x,C,!1,E)},"writeDoubleBE"),u.prototype.copy=A(function(x,C,E,H){if(!u.isBuffer(x))throw new TypeError("argument should be a Buffer");if(E||(E=0),!H&&H!==0&&(H=this.length),C>=x.length&&(C=x.length),C||(C=0),H>0&&H<E&&(H=E),H===E||x.length===0||this.length===0)return 0;if(C<0)throw new RangeError("targetStart out of bounds");if(E<0||E>=this.length)throw new RangeError("Index out of range");if(H<0)throw new RangeError("sourceEnd out of bounds");H>this.length&&(H=this.length),x.length-C<H-E&&(H=x.length-C+E);let G=H-E;return this===x&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(C,E,H):Uint8Array.prototype.set.call(x,this.subarray(E,H),C),G},"copy"),u.prototype.fill=A(function(x,C,E,H){if(typeof x=="string"){if(typeof C=="string"?(H=C,C=0,E=this.length):typeof E=="string"&&(H=E,E=this.length),H!==void 0&&typeof H!="string")throw new TypeError("encoding must be a string");if(typeof H=="string"&&!u.isEncoding(H))throw new TypeError("Unknown encoding: "+H);if(x.length===1){let se=x.charCodeAt(0);(H==="utf8"&&se<128||H==="latin1")&&(x=se)}}else typeof x=="number"?x=x&255:typeof x=="boolean"&&(x=Number(x));if(C<0||this.length<C||this.length<E)throw new RangeError("Out of range index");if(E<=C)return this;C=C>>>0,E=E===void 0?this.length:E>>>0,x||(x=0);let G;if(typeof x=="number")for(G=C;G<E;++G)this[G]=x;else{let se=u.isBuffer(x)?x:u.from(x,H),me=se.length;if(me===0)throw new TypeError('The value "'+x+'" is invalid for argument "value"');for(G=0;G<E-C;++G)this[G+C]=se[G%me]}return this},"fill");var Re={};function $t(x,C,E){var H;Re[x]=(H=class extends E{constructor(){super(),Object.defineProperty(this,"message",{value:C.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${x}]`,this.stack,delete this.name}get code(){return x}set code(G){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:G,writable:!0})}toString(){return`${this.name} [${x}]: ${this.message}`}},A(H,"NodeError"),H)}A($t,"E"),$t("ERR_BUFFER_OUT_OF_BOUNDS",function(x){return x?`${x} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),$t("ERR_INVALID_ARG_TYPE",function(x,C){return`The "${x}" argument must be of type number. Received type ${typeof C}`},TypeError),$t("ERR_OUT_OF_RANGE",function(x,C,E){let H=`The value of "${x}" is out of range.`,G=E;return Number.isInteger(E)&&Math.abs(E)>2**32?G=fr(String(E)):typeof E=="bigint"&&(G=String(E),(E>BigInt(2)**BigInt(32)||E<-(BigInt(2)**BigInt(32)))&&(G=fr(G)),G+="n"),H+=` It must be ${C}. Received ${G}`,H},RangeError);function fr(x){let C="",E=x.length,H=x[0]==="-"?1:0;for(;E>=H+4;E-=3)C=`_${x.slice(E-3,E)}${C}`;return`${x.slice(0,E)}${C}`}A(fr,"addNumericalSeparator");function fn(x,C,E){Br(C,"offset"),(x[C]===void 0||x[C+E]===void 0)&&Fn(C,x.length-(E+1))}A(fn,"checkBounds");function mn(x,C,E,H,G,se){if(x>E||x<C){let me=typeof C=="bigint"?"n":"",Qe;throw se>3?C===0||C===BigInt(0)?Qe=`>= 0${me} and < 2${me} ** ${(se+1)*8}${me}`:Qe=`>= -(2${me} ** ${(se+1)*8-1}${me}) and < 2 ** ${(se+1)*8-1}${me}`:Qe=`>= ${C}${me} and <= ${E}${me}`,new Re.ERR_OUT_OF_RANGE("value",Qe,x)}fn(H,G,se)}A(mn,"checkIntBI");function Br(x,C){if(typeof x!="number")throw new Re.ERR_INVALID_ARG_TYPE(C,"number",x)}A(Br,"validateNumber");function Fn(x,C,E){throw Math.floor(x)!==x?(Br(x,E),new Re.ERR_OUT_OF_RANGE(E||"offset","an integer",x)):C<0?new Re.ERR_BUFFER_OUT_OF_BOUNDS:new Re.ERR_OUT_OF_RANGE(E||"offset",`>= ${E?1:0} and <= ${C}`,x)}A(Fn,"boundsError");var ko=/[^+/0-9A-Za-z-_]/g;function ra(x){if(x=x.split("=")[0],x=x.trim().replace(ko,""),x.length<2)return"";for(;x.length%4!==0;)x=x+"=";return x}A(ra,"base64clean");function Un(x,C){C=C||1/0;let E,H=x.length,G=null,se=[];for(let me=0;me<H;++me){if(E=x.charCodeAt(me),E>55295&&E<57344){if(!G){if(E>56319){(C-=3)>-1&&se.push(239,191,189);continue}else if(me+1===H){(C-=3)>-1&&se.push(239,191,189);continue}G=E;continue}if(E<56320){(C-=3)>-1&&se.push(239,191,189),G=E;continue}E=(G-55296<<10|E-56320)+65536}else G&&(C-=3)>-1&&se.push(239,191,189);if(G=null,E<128){if((C-=1)<0)break;se.push(E)}else if(E<2048){if((C-=2)<0)break;se.push(E>>6|192,E&63|128)}else if(E<65536){if((C-=3)<0)break;se.push(E>>12|224,E>>6&63|128,E&63|128)}else if(E<1114112){if((C-=4)<0)break;se.push(E>>18|240,E>>12&63|128,E>>6&63|128,E&63|128)}else throw new Error("Invalid code point")}return se}A(Un,"utf8ToBytes");function bs(x){let C=[];for(let E=0;E<x.length;++E)C.push(x.charCodeAt(E)&255);return C}A(bs,"asciiToBytes");function To(x,C){let E,H,G,se=[];for(let me=0;me<x.length&&!((C-=2)<0);++me)E=x.charCodeAt(me),H=E>>8,G=E%256,se.push(G),se.push(H);return se}A(To,"utf16leToBytes");function Xs(x){return e.toByteArray(ra(x))}A(Xs,"base64ToBytes");function pn(x,C,E,H){let G;for(G=0;G<H&&!(G+E>=C.length||G>=x.length);++G)C[G+E]=x[G];return G}A(pn,"blitBuffer");function rr(x,C){return x instanceof C||x!=null&&x.constructor!=null&&x.constructor.name!=null&&x.constructor.name===C.name}A(rr,"isInstance");function _s(x){return x!==x}A(_s,"numberIsNaN");var tu=function(){let x="0123456789abcdef",C=new Array(256);for(let E=0;E<16;++E){let H=E*16;for(let G=0;G<16;++G)C[H+G]=x[E]+x[G]}return C}();function $r(x){return typeof BigInt>"u"?ei:x}A($r,"defineBigIntMethod");function ei(){throw new Error("BigInt not supported")}A(ei,"BufferBigIntNotDefined")}),$c,kf,Pe,De,_e=hr(()=>{$c=globalThis,kf=globalThis.setImmediate??(t=>setTimeout(t,0)),Pe=typeof globalThis.Buffer=="function"&&typeof globalThis.Buffer.allocUnsafe=="function"?globalThis.Buffer:ik().Buffer,De=globalThis.process??{},De.env??(De.env={});try{De.nextTick(()=>{})}catch{let t=Promise.resolve();De.nextTick=t.then.bind(t)}}),Js=Oe((t,e)=>{_e();var r=typeof Reflect=="object"?Reflect:null,n=r&&typeof r.apply=="function"?r.apply:A(function(k,I,T){return Function.prototype.apply.call(k,I,T)},"ReflectApply"),a;r&&typeof r.ownKeys=="function"?a=r.ownKeys:Object.getOwnPropertySymbols?a=A(function(k){return Object.getOwnPropertyNames(k).concat(Object.getOwnPropertySymbols(k))},"ReflectOwnKeys"):a=A(function(k){return Object.getOwnPropertyNames(k)},"ReflectOwnKeys");function o(k){console&&console.warn&&console.warn(k)}A(o,"ProcessEmitWarning");var c=Number.isNaN||A(function(k){return k!==k},"NumberIsNaN");function u(){u.init.call(this)}A(u,"EventEmitter"),e.exports=u,e.exports.once=P,u.EventEmitter=u,u.prototype._events=void 0,u.prototype._eventsCount=0,u.prototype._maxListeners=void 0;var h=10;function f(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}A(f,"checkListener"),Object.defineProperty(u,"defaultMaxListeners",{enumerable:!0,get:A(function(){return h},"get"),set:A(function(k){if(typeof k!="number"||k<0||c(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");h=k},"set")}),u.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},u.prototype.setMaxListeners=A(function(k){if(typeof k!="number"||k<0||c(k))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+k+".");return this._maxListeners=k,this},"setMaxListeners");function m(k){return k._maxListeners===void 0?u.defaultMaxListeners:k._maxListeners}A(m,"_getMaxListeners"),u.prototype.getMaxListeners=A(function(){return m(this)},"getMaxListeners"),u.prototype.emit=A(function(k){for(var I=[],T=1;T<arguments.length;T++)I.push(arguments[T]);var D=k==="error",U=this._events;if(U!==void 0)D=D&&U.error===void 0;else if(!D)return!1;if(D){var V;if(I.length>0&&(V=I[0]),V instanceof Error)throw V;var z=new Error("Unhandled error."+(V?" ("+V.message+")":""));throw z.context=V,z}var q=U[k];if(q===void 0)return!1;if(typeof q=="function")n(q,this,I);else for(var Q=q.length,te=j(q,Q),T=0;T<Q;++T)n(te[T],this,I);return!0},"emit");function v(k,I,T,D){var U,V,z;if(f(T),V=k._events,V===void 0?(V=k._events=Object.create(null),k._eventsCount=0):(V.newListener!==void 0&&(k.emit("newListener",I,T.listener?T.listener:T),V=k._events),z=V[I]),z===void 0)z=V[I]=T,++k._eventsCount;else if(typeof z=="function"?z=V[I]=D?[T,z]:[z,T]:D?z.unshift(T):z.push(T),U=m(k),U>0&&z.length>U&&!z.warned){z.warned=!0;var q=new Error("Possible EventEmitter memory leak detected. "+z.length+" "+String(I)+" listeners added. Use emitter.setMaxListeners() to increase limit");q.name="MaxListenersExceededWarning",q.emitter=k,q.type=I,q.count=z.length,o(q)}return k}A(v,"_addListener"),u.prototype.addListener=A(function(k,I){return v(this,k,I,!1)},"addListener"),u.prototype.on=u.prototype.addListener,u.prototype.prependListener=A(function(k,I){return v(this,k,I,!0)},"prependListener");function w(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}A(w,"onceWrapper");function N(k,I,T){var D={fired:!1,wrapFn:void 0,target:k,type:I,listener:T},U=w.bind(D);return U.listener=T,D.wrapFn=U,U}A(N,"_onceWrap"),u.prototype.once=A(function(k,I){return f(I),this.on(k,N(this,k,I)),this},"once"),u.prototype.prependOnceListener=A(function(k,I){return f(I),this.prependListener(k,N(this,k,I)),this},"prependOnceListener"),u.prototype.removeListener=A(function(k,I){var T,D,U,V,z;if(f(I),D=this._events,D===void 0)return this;if(T=D[k],T===void 0)return this;if(T===I||T.listener===I)--this._eventsCount===0?this._events=Object.create(null):(delete D[k],D.removeListener&&this.emit("removeListener",k,T.listener||I));else if(typeof T!="function"){for(U=-1,V=T.length-1;V>=0;V--)if(T[V]===I||T[V].listener===I){z=T[V].listener,U=V;break}if(U<0)return this;U===0?T.shift():_(T,U),T.length===1&&(D[k]=T[0]),D.removeListener!==void 0&&this.emit("removeListener",k,z||I)}return this},"removeListener"),u.prototype.off=u.prototype.removeListener,u.prototype.removeAllListeners=A(function(k){var I,T,D;if(T=this._events,T===void 0)return this;if(T.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):T[k]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete T[k]),this;if(arguments.length===0){var U=Object.keys(T),V;for(D=0;D<U.length;++D)V=U[D],V!=="removeListener"&&this.removeAllListeners(V);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(I=T[k],typeof I=="function")this.removeListener(k,I);else if(I!==void 0)for(D=I.length-1;D>=0;D--)this.removeListener(k,I[D]);return this},"removeAllListeners");function g(k,I,T){var D=k._events;if(D===void 0)return[];var U=D[I];return U===void 0?[]:typeof U=="function"?T?[U.listener||U]:[U]:T?b(U):j(U,U.length)}A(g,"_listeners"),u.prototype.listeners=A(function(k){return g(this,k,!0)},"listeners"),u.prototype.rawListeners=A(function(k){return g(this,k,!1)},"rawListeners"),u.listenerCount=function(k,I){return typeof k.listenerCount=="function"?k.listenerCount(I):y.call(k,I)},u.prototype.listenerCount=y;function y(k){var I=this._events;if(I!==void 0){var T=I[k];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}A(y,"listenerCount"),u.prototype.eventNames=A(function(){return this._eventsCount>0?a(this._events):[]},"eventNames");function j(k,I){for(var T=new Array(I),D=0;D<I;++D)T[D]=k[D];return T}A(j,"arrayClone");function _(k,I){for(;I+1<k.length;I++)k[I]=k[I+1];k.pop()}A(_,"spliceOne");function b(k){for(var I=new Array(k.length),T=0;T<I.length;++T)I[T]=k[T].listener||k[T];return I}A(b,"unwrapListeners");function P(k,I){return new Promise(function(T,D){function U(z){k.removeListener(I,V),D(z)}A(U,"errorListener");function V(){typeof k.removeListener=="function"&&k.removeListener("error",U),T([].slice.call(arguments))}A(V,"resolver"),$(k,I,V,{once:!0}),I!=="error"&&B(k,U,{once:!0})})}A(P,"once");function B(k,I,T){typeof k.on=="function"&&$(k,"error",I,T)}A(B,"addErrorHandlerIfEventEmitter");function $(k,I,T,D){if(typeof k.on=="function")D.once?k.once(I,T):k.on(I,T);else if(typeof k.addEventListener=="function")k.addEventListener(I,A(function U(V){D.once&&k.removeEventListener(I,U),T(V)},"wrapListener"));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}A($,"eventTargetAgnosticAddListener")}),N_={};Jr(N_,{Socket:()=>ho,isIP:()=>j_});function j_(t){return 0}var wg,nd,ja,ho,_o=hr(()=>{_e(),wg=Ys(Js(),1),A(j_,"isIP"),nd=/^[^.]+\./,ja=class je extends wg.EventEmitter{constructor(){super(...arguments),Te(this,"opts",{}),Te(this,"connecting",!1),Te(this,"pending",!0),Te(this,"writable",!0),Te(this,"encrypted",!1),Te(this,"authorized",!1),Te(this,"destroyed",!1),Te(this,"ws",null),Te(this,"writeBuffer"),Te(this,"tlsState",0),Te(this,"tlsRead"),Te(this,"tlsWrite")}static get poolQueryViaFetch(){return je.opts.poolQueryViaFetch??je.defaults.poolQueryViaFetch}static set poolQueryViaFetch(e){je.opts.poolQueryViaFetch=e}static get fetchEndpoint(){return je.opts.fetchEndpoint??je.defaults.fetchEndpoint}static set fetchEndpoint(e){je.opts.fetchEndpoint=e}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(e){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return je.opts.fetchFunction??je.defaults.fetchFunction}static set fetchFunction(e){je.opts.fetchFunction=e}static get webSocketConstructor(){return je.opts.webSocketConstructor??je.defaults.webSocketConstructor}static set webSocketConstructor(e){je.opts.webSocketConstructor=e}get webSocketConstructor(){return this.opts.webSocketConstructor??je.webSocketConstructor}set webSocketConstructor(e){this.opts.webSocketConstructor=e}static get wsProxy(){return je.opts.wsProxy??je.defaults.wsProxy}static set wsProxy(e){je.opts.wsProxy=e}get wsProxy(){return this.opts.wsProxy??je.wsProxy}set wsProxy(e){this.opts.wsProxy=e}static get coalesceWrites(){return je.opts.coalesceWrites??je.defaults.coalesceWrites}static set coalesceWrites(e){je.opts.coalesceWrites=e}get coalesceWrites(){return this.opts.coalesceWrites??je.coalesceWrites}set coalesceWrites(e){this.opts.coalesceWrites=e}static get useSecureWebSocket(){return je.opts.useSecureWebSocket??je.defaults.useSecureWebSocket}static set useSecureWebSocket(e){je.opts.useSecureWebSocket=e}get useSecureWebSocket(){return this.opts.useSecureWebSocket??je.useSecureWebSocket}set useSecureWebSocket(e){this.opts.useSecureWebSocket=e}static get forceDisablePgSSL(){return je.opts.forceDisablePgSSL??je.defaults.forceDisablePgSSL}static set forceDisablePgSSL(e){je.opts.forceDisablePgSSL=e}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??je.forceDisablePgSSL}set forceDisablePgSSL(e){this.opts.forceDisablePgSSL=e}static get disableSNI(){return je.opts.disableSNI??je.defaults.disableSNI}static set disableSNI(e){je.opts.disableSNI=e}get disableSNI(){return this.opts.disableSNI??je.disableSNI}set disableSNI(e){this.opts.disableSNI=e}static get disableWarningInBrowsers(){return je.opts.disableWarningInBrowsers??je.defaults.disableWarningInBrowsers}static set disableWarningInBrowsers(e){je.opts.disableWarningInBrowsers=e}get disableWarningInBrowsers(){return this.opts.disableWarningInBrowsers??je.disableWarningInBrowsers}set disableWarningInBrowsers(e){this.opts.disableWarningInBrowsers=e}static get pipelineConnect(){return je.opts.pipelineConnect??je.defaults.pipelineConnect}static set pipelineConnect(e){je.opts.pipelineConnect=e}get pipelineConnect(){return this.opts.pipelineConnect??je.pipelineConnect}set pipelineConnect(e){this.opts.pipelineConnect=e}static get subtls(){return je.opts.subtls??je.defaults.subtls}static set subtls(e){je.opts.subtls=e}get subtls(){return this.opts.subtls??je.subtls}set subtls(e){this.opts.subtls=e}static get pipelineTLS(){return je.opts.pipelineTLS??je.defaults.pipelineTLS}static set pipelineTLS(e){je.opts.pipelineTLS=e}get pipelineTLS(){return this.opts.pipelineTLS??je.pipelineTLS}set pipelineTLS(e){this.opts.pipelineTLS=e}static get rootCerts(){return je.opts.rootCerts??je.defaults.rootCerts}static set rootCerts(e){je.opts.rootCerts=e}get rootCerts(){return this.opts.rootCerts??je.rootCerts}set rootCerts(e){this.opts.rootCerts=e}wsProxyAddrForHost(e,r){let n=this.wsProxy;if(n===void 0)throw new Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return typeof n=="function"?n(e,r):`${n}?address=${e}:${r}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(e,r,n){this.connecting=!0,n&&this.once("connect",n);let a=A(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),o=A((u,h=!1)=>{u.binaryType="arraybuffer",u.addEventListener("error",f=>{this.emit("error",f),this.emit("close")}),u.addEventListener("message",f=>{if(this.tlsState===0){let m=Pe.from(f.data);this.emit("data",m)}}),u.addEventListener("close",()=>{this.emit("close")}),h?a():u.addEventListener("open",a)},"configureWebSocket"),c;try{c=this.wsProxyAddrForHost(r,typeof e=="string"?parseInt(e,10):e)}catch(u){this.emit("error",u),this.emit("close");return}try{let u=(this.useSecureWebSocket?"wss:":"ws:")+"//"+c;if(this.webSocketConstructor!==void 0)this.ws=new this.webSocketConstructor(u),o(this.ws);else try{this.ws=new WebSocket(u),o(this.ws)}catch{this.ws=new __unstable_WebSocket(u),o(this.ws)}}catch(u){let h=(this.useSecureWebSocket?"https:":"http:")+"//"+c;fetch(h,{headers:{Upgrade:"websocket"}}).then(f=>{if(this.ws=f.webSocket,this.ws==null)throw u;this.ws.accept(),o(this.ws,!0)}).catch(f=>{this.emit("error",new Error(`All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined. Details: ${f}`)),this.emit("close")})}}async startTls(e){if(this.subtls===void 0)throw new Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let r=await this.subtls.TrustedCert.databaseFromPEM(this.rootCerts),n=new this.subtls.WebSocketReadQueue(this.ws),a=n.read.bind(n),o=this.rawWrite.bind(this),{read:c,write:u}=await this.subtls.startTls(e,r,a,o,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=c,this.tlsWrite=u,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let e=await this.tlsRead();if(e===void 0)break;{let r=Pe.from(e);this.emit("data",r)}}}rawWrite(e){if(!this.coalesceWrites){this.ws&&this.ws.send(e);return}if(this.writeBuffer===void 0)this.writeBuffer=e,setTimeout(()=>{this.ws&&this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let r=new Uint8Array(this.writeBuffer.length+e.length);r.set(this.writeBuffer),r.set(e,this.writeBuffer.length),this.writeBuffer=r}}write(e,r="utf8",n=a=>{}){return e.length===0?(n(),!0):(typeof e=="string"&&(e=Pe.from(e,r)),this.tlsState===0?(this.rawWrite(e),n()):this.tlsState===1?this.once("secureConnection",()=>{this.write(e,r,n)}):(this.tlsWrite(e),n()),!0)}end(e=Pe.alloc(0),r="utf8",n=()=>{}){return this.write(e,r,()=>{this.ws.close(),n()}),this}destroy(){return this.destroyed=!0,this.end()}},A(ja,"Socket"),Te(ja,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:A((t,e,r)=>{let n;return r!=null&&r.jwtAuth?n=t.replace(nd,"apiauth."):n=t.replace(nd,"api."),"https://"+n+"/sql"},"fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:A(t=>t+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1,disableWarningInBrowsers:!1}),Te(ja,"opts",{}),ho=ja}),S_={};Jr(S_,{parse:()=>Tf});function Tf(t,e=!1){let{protocol:r}=new URL(t),n="http:"+t.substring(r.length),{username:a,password:o,host:c,hostname:u,port:h,pathname:f,search:m,searchParams:v,hash:w}=new URL(n);o=decodeURIComponent(o),a=decodeURIComponent(a),f=decodeURIComponent(f);let N=a+":"+o,g=e?Object.fromEntries(v.entries()):m;return{href:t,protocol:r,auth:N,username:a,password:o,host:c,hostname:u,port:h,pathname:f,search:m,query:g,hash:w}}var C_=hr(()=>{_e(),A(Tf,"parse")}),P_=Oe(t=>{_e(),t.parse=function(a,o){return new r(a,o).parse()};var e=class k_{constructor(o,c){this.source=o,this.transform=c||n,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var o=this.source[this.position++];return o==="\\"?{value:this.source[this.position++],escaped:!0}:{value:o,escaped:!1}}record(o){this.recorded.push(o)}newEntry(o){var c;(this.recorded.length>0||o)&&(c=this.recorded.join(""),c==="NULL"&&!o&&(c=null),c!==null&&(c=this.transform(c)),this.entries.push(c),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var o=this.nextCharacter();if(o.value==="=")break}}parse(o){var c,u,h;for(this.consumeDimensions();!this.isEof();)if(c=this.nextCharacter(),c.value==="{"&&!h)this.dimension++,this.dimension>1&&(u=new k_(this.source.substr(this.position-1),this.transform),this.entries.push(u.parse(!0)),this.position+=u.position-2);else if(c.value==="}"&&!h){if(this.dimension--,!this.dimension&&(this.newEntry(),o))return this.entries}else c.value==='"'&&!c.escaped?(h&&this.newEntry(!0),h=!h):c.value===","&&!h?this.newEntry():this.record(c.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};A(e,"ArrayParser");var r=e;function n(a){return a}A(n,"identity")}),T_=Oe((t,e)=>{_e();var r=P_();e.exports={create:A(function(n,a){return{parse:A(function(){return r.parse(n,a)},"parse")}},"create")}}),ak=Oe((t,e)=>{_e();var r=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,n=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,a=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,o=/^-?infinity$/;e.exports=A(function(m){if(o.test(m))return Number(m.replace("i","I"));var v=r.exec(m);if(!v)return c(m)||null;var w=!!v[8],N=parseInt(v[1],10);w&&(N=h(N));var g=parseInt(v[2],10)-1,y=v[3],j=parseInt(v[4],10),_=parseInt(v[5],10),b=parseInt(v[6],10),P=v[7];P=P?1e3*parseFloat(P):0;var B,$=u(m);return $!=null?(B=new Date(Date.UTC(N,g,y,j,_,b,P)),f(N)&&B.setUTCFullYear(N),$!==0&&B.setTime(B.getTime()-$)):(B=new Date(N,g,y,j,_,b,P),f(N)&&B.setFullYear(N)),B},"parseDate");function c(m){var v=n.exec(m);if(v){var w=parseInt(v[1],10),N=!!v[4];N&&(w=h(w));var g=parseInt(v[2],10)-1,y=v[3],j=new Date(w,g,y);return f(w)&&j.setFullYear(w),j}}A(c,"getDate");function u(m){if(m.endsWith("+00"))return 0;var v=a.exec(m.split(" ")[1]);if(v){var w=v[1];if(w==="Z")return 0;var N=w==="-"?-1:1,g=parseInt(v[2],10)*3600+parseInt(v[3]||0,10)*60+parseInt(v[4]||0,10);return g*N*1e3}}A(u,"timeZoneOffset");function h(m){return-(m-1)}A(h,"bcYearToNegativeYear");function f(m){return m>=0&&m<100}A(f,"is0To99")}),ok=Oe((t,e)=>{_e(),e.exports=n;var r=Object.prototype.hasOwnProperty;function n(a){for(var o=1;o<arguments.length;o++){var c=arguments[o];for(var u in c)r.call(c,u)&&(a[u]=c[u])}return a}A(n,"extend")}),lk=Oe((t,e)=>{_e();var r=ok();e.exports=n;function n(b){if(!(this instanceof n))return new n(b);r(this,_(b))}A(n,"PostgresInterval");var a=["seconds","minutes","hours","days","months","years"];n.prototype.toPostgres=function(){var b=a.filter(this.hasOwnProperty,this);return this.milliseconds&&b.indexOf("seconds")<0&&b.push("seconds"),b.length===0?"0":b.map(function(P){var B=this[P]||0;return P==="seconds"&&this.milliseconds&&(B=(B+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),B+" "+P},this).join(" ")};var o={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},c=["years","months","days"],u=["hours","minutes","seconds"];n.prototype.toISOString=n.prototype.toISO=function(){var b=c.map(B,this).join(""),P=u.map(B,this).join("");return"P"+b+"T"+P;function B($){var k=this[$]||0;return $==="seconds"&&this.milliseconds&&(k=(k+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),k+o[$]}};var h="([+-]?\\d+)",f=h+"\\s+years?",m=h+"\\s+mons?",v=h+"\\s+days?",w="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",N=new RegExp([f,m,v,w].map(function(b){return"("+b+")?"}).join("\\s*")),g={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},y=["hours","minutes","seconds","milliseconds"];function j(b){var P=b+"000000".slice(b.length);return parseInt(P,10)/1e3}A(j,"parseMilliseconds");function _(b){if(!b)return{};var P=N.exec(b),B=P[8]==="-";return Object.keys(g).reduce(function($,k){var I=g[k],T=P[I];return!T||(T=k==="milliseconds"?j(T):parseInt(T,10),!T)||(B&&~y.indexOf(k)&&(T*=-1),$[k]=T),$},{})}A(_,"parse")}),ck=Oe((t,e)=>{_e(),e.exports=A(function(r){if(/^\\x/.test(r))return new Pe(r.substr(2),"hex");for(var n="",a=0;a<r.length;)if(r[a]!=="\\")n+=r[a],++a;else if(/[0-7]{3}/.test(r.substr(a+1,3)))n+=String.fromCharCode(parseInt(r.substr(a+1,3),8)),a+=4;else{for(var o=1;a+o<r.length&&r[a+o]==="\\";)o++;for(var c=0;c<Math.floor(o/2);++c)n+="\\";a+=Math.floor(o/2)*2}return new Pe(n,"binary")},"parseBytea")}),uk=Oe((t,e)=>{_e();var r=P_(),n=T_(),a=ak(),o=lk(),c=ck();function u(D){return A(function(U){return U===null?U:D(U)},"nullAllowed")}A(u,"allowNull");function h(D){return D===null?D:D==="TRUE"||D==="t"||D==="true"||D==="y"||D==="yes"||D==="on"||D==="1"}A(h,"parseBool");function f(D){return D?r.parse(D,h):null}A(f,"parseBoolArray");function m(D){return parseInt(D,10)}A(m,"parseBaseTenInt");function v(D){return D?r.parse(D,u(m)):null}A(v,"parseIntegerArray");function w(D){return D?r.parse(D,u(function(U){return B(U).trim()})):null}A(w,"parseBigIntegerArray");var N=A(function(D){if(!D)return null;var U=n.create(D,function(V){return V!==null&&(V=k(V)),V});return U.parse()},"parsePointArray"),g=A(function(D){if(!D)return null;var U=n.create(D,function(V){return V!==null&&(V=parseFloat(V)),V});return U.parse()},"parseFloatArray"),y=A(function(D){if(!D)return null;var U=n.create(D);return U.parse()},"parseStringArray"),j=A(function(D){if(!D)return null;var U=n.create(D,function(V){return V!==null&&(V=a(V)),V});return U.parse()},"parseDateArray"),_=A(function(D){if(!D)return null;var U=n.create(D,function(V){return V!==null&&(V=o(V)),V});return U.parse()},"parseIntervalArray"),b=A(function(D){return D?r.parse(D,u(c)):null},"parseByteAArray"),P=A(function(D){return parseInt(D,10)},"parseInteger"),B=A(function(D){var U=String(D);return/^\d+$/.test(U)?U:D},"parseBigInteger"),$=A(function(D){return D?r.parse(D,u(JSON.parse)):null},"parseJsonArray"),k=A(function(D){return D[0]!=="("?null:(D=D.substring(1,D.length-1).split(","),{x:parseFloat(D[0]),y:parseFloat(D[1])})},"parsePoint"),I=A(function(D){if(D[0]!=="<"&&D[1]!=="(")return null;for(var U="(",V="",z=!1,q=2;q<D.length-1;q++){if(z||(U+=D[q]),D[q]===")"){z=!0;continue}else if(!z)continue;D[q]!==","&&(V+=D[q])}var Q=k(U);return Q.radius=parseFloat(V),Q},"parseCircle"),T=A(function(D){D(20,B),D(21,P),D(23,P),D(26,P),D(700,parseFloat),D(701,parseFloat),D(16,h),D(1082,a),D(1114,a),D(1184,a),D(600,k),D(651,y),D(718,I),D(1e3,f),D(1001,b),D(1005,v),D(1007,v),D(1028,v),D(1016,w),D(1017,N),D(1021,g),D(1022,g),D(1231,g),D(1014,y),D(1015,y),D(1008,y),D(1009,y),D(1040,y),D(1041,y),D(1115,j),D(1182,j),D(1185,j),D(1186,o),D(1187,_),D(17,c),D(114,JSON.parse.bind(JSON)),D(3802,JSON.parse.bind(JSON)),D(199,$),D(3807,$),D(3907,y),D(2951,y),D(791,y),D(1183,y),D(1270,y)},"init");e.exports={init:T}}),dk=Oe((t,e)=>{_e();var r=1e6;function n(a){var o=a.readInt32BE(0),c=a.readUInt32BE(4),u="";o<0&&(o=~o+(c===0),c=~c+1>>>0,u="-");var h="",f,m,v,w,N,g;{if(f=o%r,o=o/r>>>0,m=4294967296*f+c,c=m/r>>>0,v=""+(m-r*c),c===0&&o===0)return u+v+h;for(w="",N=6-v.length,g=0;g<N;g++)w+="0";h=w+v+h}{if(f=o%r,o=o/r>>>0,m=4294967296*f+c,c=m/r>>>0,v=""+(m-r*c),c===0&&o===0)return u+v+h;for(w="",N=6-v.length,g=0;g<N;g++)w+="0";h=w+v+h}{if(f=o%r,o=o/r>>>0,m=4294967296*f+c,c=m/r>>>0,v=""+(m-r*c),c===0&&o===0)return u+v+h;for(w="",N=6-v.length,g=0;g<N;g++)w+="0";h=w+v+h}return f=o%r,m=4294967296*f+c,v=""+m%r,u+v+h}A(n,"readInt8"),e.exports=n}),hk=Oe((t,e)=>{_e();var r=dk(),n=A(function(y,j,_,b,P){_=_||0,b=b||!1,P=P||function(z,q,Q){return z*Math.pow(2,Q)+q};var B=_>>3,$=A(function(z){return b?~z&255:z},"inv"),k=255,I=8-_%8;j<I&&(k=255<<8-j&255,I=j),_&&(k=k>>_%8);var T=0;_%8+j>=8&&(T=P(0,$(y[B])&k,I));for(var D=j+_>>3,U=B+1;U<D;U++)T=P(T,$(y[U]),8);var V=(j+_)%8;return V>0&&(T=P(T,$(y[D])>>8-V,V)),T},"parseBits"),a=A(function(y,j,_){var b=Math.pow(2,_-1)-1,P=n(y,1),B=n(y,_,1);if(B===0)return 0;var $=1,k=A(function(T,D,U){T===0&&(T=1);for(var V=1;V<=U;V++)$/=2,(D&1<<U-V)>0&&(T+=$);return T},"parsePrecisionBits"),I=n(y,j,_+1,!1,k);return B==Math.pow(2,_+1)-1?I===0?P===0?1/0:-1/0:NaN:(P===0?1:-1)*Math.pow(2,B-b)*I},"parseFloatFromBits"),o=A(function(y){return n(y,1)==1?-1*(n(y,15,1,!0)+1):n(y,15,1)},"parseInt16"),c=A(function(y){return n(y,1)==1?-1*(n(y,31,1,!0)+1):n(y,31,1)},"parseInt32"),u=A(function(y){return a(y,23,8)},"parseFloat32"),h=A(function(y){return a(y,52,11)},"parseFloat64"),f=A(function(y){var j=n(y,16,32);if(j==49152)return NaN;for(var _=Math.pow(1e4,n(y,16,16)),b=0,P=[],B=n(y,16),$=0;$<B;$++)b+=n(y,16,64+16*$)*_,_/=1e4;var k=Math.pow(10,n(y,16,48));return(j===0?1:-1)*Math.round(b*k)/k},"parseNumeric"),m=A(function(y,j){var _=n(j,1),b=n(j,63,1),P=new Date((_===0?1:-1)*b/1e3+9466848e5);return y||P.setTime(P.getTime()+P.getTimezoneOffset()*6e4),P.usec=b%1e3,P.getMicroSeconds=function(){return this.usec},P.setMicroSeconds=function(B){this.usec=B},P.getUTCMicroSeconds=function(){return this.usec},P},"parseDate"),v=A(function(y){for(var j=n(y,32),_=n(y,32,32),b=n(y,32,64),P=96,B=[],$=0;$<j;$++)B[$]=n(y,32,P),P+=32,P+=32;var k=A(function(T){var D=n(y,32,P);if(P+=32,D==4294967295)return null;var U;if(T==23||T==20)return U=n(y,D*8,P),P+=D*8,U;if(T==25)return U=y.toString(this.encoding,P>>3,(P+=D<<3)>>3),U;console.log("ERROR: ElementType not implemented: "+T)},"parseElement"),I=A(function(T,D){var U=[],V;if(T.length>1){var z=T.shift();for(V=0;V<z;V++)U[V]=I(T,D);T.unshift(z)}else for(V=0;V<T[0];V++)U[V]=k(D);return U},"parse");return I(B,b)},"parseArray"),w=A(function(y){return y.toString("utf8")},"parseText"),N=A(function(y){return y===null?null:n(y,8)>0},"parseBool"),g=A(function(y){y(20,r),y(21,o),y(23,c),y(26,c),y(1700,f),y(700,u),y(701,h),y(16,N),y(1114,m.bind(null,!1)),y(1184,m.bind(null,!0)),y(1e3,v),y(1007,v),y(1016,v),y(1008,v),y(1009,v),y(25,w)},"init");e.exports={init:g}}),fk=Oe((t,e)=>{_e(),e.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),zc=Oe(t=>{_e();var e=uk(),r=hk(),n=T_(),a=fk();t.getTypeParser=u,t.setTypeParser=h,t.arrayParser=n,t.builtins=a;var o={text:{},binary:{}};function c(f){return String(f)}A(c,"noParse");function u(f,m){return m=m||"text",o[m]&&o[m][f]||c}A(u,"getTypeParser");function h(f,m,v){typeof m=="function"&&(v=m,m="text"),o[m][f]=v}A(h,"setTypeParser"),e.init(function(f,m){o.text[f]=m}),r.init(function(f,m){o.binary[f]=m})}),Ef=Oe((t,e)=>{_e();var r=zc();function n(a){this._types=a||r,this.text={},this.binary={}}A(n,"TypeOverrides"),n.prototype.getOverrides=function(a){switch(a){case"text":return this.text;case"binary":return this.binary;default:return{}}},n.prototype.setTypeParser=function(a,o,c){typeof o=="function"&&(c=o,o="text"),this.getOverrides(o)[a]=c},n.prototype.getTypeParser=function(a,o){return o=o||"text",this.getOverrides(o)[a]||this._types.getTypeParser(a,o)},e.exports=n});function Ua(t){let e=1779033703,r=3144134277,n=1013904242,a=2773480762,o=1359893119,c=2600822924,u=528734635,h=1541459225,f=0,m=0,v=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],w=A((b,P)=>b>>>P|b<<32-P,"rrot"),N=new Uint32Array(64),g=new Uint8Array(64),y=A(()=>{for(let U=0,V=0;U<16;U++,V+=4)N[U]=g[V]<<24|g[V+1]<<16|g[V+2]<<8|g[V+3];for(let U=16;U<64;U++){let V=w(N[U-15],7)^w(N[U-15],18)^N[U-15]>>>3,z=w(N[U-2],17)^w(N[U-2],19)^N[U-2]>>>10;N[U]=N[U-16]+V+N[U-7]+z|0}let b=e,P=r,B=n,$=a,k=o,I=c,T=u,D=h;for(let U=0;U<64;U++){let V=w(k,6)^w(k,11)^w(k,25),z=k&I^~k&T,q=D+V+z+v[U]+N[U]|0,Q=w(b,2)^w(b,13)^w(b,22),te=b&P^b&B^P&B,de=Q+te|0;D=T,T=I,I=k,k=$+q|0,$=B,B=P,P=b,b=q+de|0}e=e+b|0,r=r+P|0,n=n+B|0,a=a+$|0,o=o+k|0,c=c+I|0,u=u+T|0,h=h+D|0,m=0},"process"),j=A(b=>{typeof b=="string"&&(b=new TextEncoder().encode(b));for(let P=0;P<b.length;P++)g[m++]=b[P],m===64&&y();f+=b.length},"add"),_=A(()=>{if(g[m++]=128,m==64&&y(),m+8>64){for(;m<64;)g[m++]=0;y()}for(;m<58;)g[m++]=0;let b=f*8;g[m++]=b/1099511627776&255,g[m++]=b/4294967296&255,g[m++]=b>>>24,g[m++]=b>>>16&255,g[m++]=b>>>8&255,g[m++]=b&255,y();let P=new Uint8Array(32);return P[0]=e>>>24,P[1]=e>>>16&255,P[2]=e>>>8&255,P[3]=e&255,P[4]=r>>>24,P[5]=r>>>16&255,P[6]=r>>>8&255,P[7]=r&255,P[8]=n>>>24,P[9]=n>>>16&255,P[10]=n>>>8&255,P[11]=n&255,P[12]=a>>>24,P[13]=a>>>16&255,P[14]=a>>>8&255,P[15]=a&255,P[16]=o>>>24,P[17]=o>>>16&255,P[18]=o>>>8&255,P[19]=o&255,P[20]=c>>>24,P[21]=c>>>16&255,P[22]=c>>>8&255,P[23]=c&255,P[24]=u>>>24,P[25]=u>>>16&255,P[26]=u>>>8&255,P[27]=u&255,P[28]=h>>>24,P[29]=h>>>16&255,P[30]=h>>>8&255,P[31]=h&255,P},"digest");return t===void 0?{add:j,digest:_}:(j(t),_())}var mk=hr(()=>{_e(),A(Ua,"sha256")}),wn,ih,pk=hr(()=>{_e(),wn=class kr{constructor(){Te(this,"_dataLength",0),Te(this,"_bufferLength",0),Te(this,"_state",new Int32Array(4)),Te(this,"_buffer",new ArrayBuffer(68)),Te(this,"_buffer8"),Te(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(e,r=!1){return this.onePassHasher.start().appendByteArray(e).end(r)}static hashStr(e,r=!1){return this.onePassHasher.start().appendStr(e).end(r)}static hashAsciiStr(e,r=!1){return this.onePassHasher.start().appendAsciiStr(e).end(r)}static _hex(e){let r=kr.hexChars,n=kr.hexOut,a,o,c,u;for(u=0;u<4;u+=1)for(o=u*8,a=e[u],c=0;c<8;c+=2)n[o+1+c]=r.charAt(a&15),a>>>=4,n[o+0+c]=r.charAt(a&15),a>>>=4;return n.join("")}static _md5cycle(e,r){let n=e[0],a=e[1],o=e[2],c=e[3];n+=(a&o|~a&c)+r[0]-680876936|0,n=(n<<7|n>>>25)+a|0,c+=(n&a|~n&o)+r[1]-389564586|0,c=(c<<12|c>>>20)+n|0,o+=(c&n|~c&a)+r[2]+606105819|0,o=(o<<17|o>>>15)+c|0,a+=(o&c|~o&n)+r[3]-1044525330|0,a=(a<<22|a>>>10)+o|0,n+=(a&o|~a&c)+r[4]-176418897|0,n=(n<<7|n>>>25)+a|0,c+=(n&a|~n&o)+r[5]+1200080426|0,c=(c<<12|c>>>20)+n|0,o+=(c&n|~c&a)+r[6]-1473231341|0,o=(o<<17|o>>>15)+c|0,a+=(o&c|~o&n)+r[7]-45705983|0,a=(a<<22|a>>>10)+o|0,n+=(a&o|~a&c)+r[8]+1770035416|0,n=(n<<7|n>>>25)+a|0,c+=(n&a|~n&o)+r[9]-1958414417|0,c=(c<<12|c>>>20)+n|0,o+=(c&n|~c&a)+r[10]-42063|0,o=(o<<17|o>>>15)+c|0,a+=(o&c|~o&n)+r[11]-1990404162|0,a=(a<<22|a>>>10)+o|0,n+=(a&o|~a&c)+r[12]+1804603682|0,n=(n<<7|n>>>25)+a|0,c+=(n&a|~n&o)+r[13]-40341101|0,c=(c<<12|c>>>20)+n|0,o+=(c&n|~c&a)+r[14]-1502002290|0,o=(o<<17|o>>>15)+c|0,a+=(o&c|~o&n)+r[15]+1236535329|0,a=(a<<22|a>>>10)+o|0,n+=(a&c|o&~c)+r[1]-165796510|0,n=(n<<5|n>>>27)+a|0,c+=(n&o|a&~o)+r[6]-1069501632|0,c=(c<<9|c>>>23)+n|0,o+=(c&a|n&~a)+r[11]+643717713|0,o=(o<<14|o>>>18)+c|0,a+=(o&n|c&~n)+r[0]-373897302|0,a=(a<<20|a>>>12)+o|0,n+=(a&c|o&~c)+r[5]-701558691|0,n=(n<<5|n>>>27)+a|0,c+=(n&o|a&~o)+r[10]+38016083|0,c=(c<<9|c>>>23)+n|0,o+=(c&a|n&~a)+r[15]-660478335|0,o=(o<<14|o>>>18)+c|0,a+=(o&n|c&~n)+r[4]-405537848|0,a=(a<<20|a>>>12)+o|0,n+=(a&c|o&~c)+r[9]+568446438|0,n=(n<<5|n>>>27)+a|0,c+=(n&o|a&~o)+r[14]-1019803690|0,c=(c<<9|c>>>23)+n|0,o+=(c&a|n&~a)+r[3]-187363961|0,o=(o<<14|o>>>18)+c|0,a+=(o&n|c&~n)+r[8]+1163531501|0,a=(a<<20|a>>>12)+o|0,n+=(a&c|o&~c)+r[13]-1444681467|0,n=(n<<5|n>>>27)+a|0,c+=(n&o|a&~o)+r[2]-51403784|0,c=(c<<9|c>>>23)+n|0,o+=(c&a|n&~a)+r[7]+1735328473|0,o=(o<<14|o>>>18)+c|0,a+=(o&n|c&~n)+r[12]-1926607734|0,a=(a<<20|a>>>12)+o|0,n+=(a^o^c)+r[5]-378558|0,n=(n<<4|n>>>28)+a|0,c+=(n^a^o)+r[8]-2022574463|0,c=(c<<11|c>>>21)+n|0,o+=(c^n^a)+r[11]+1839030562|0,o=(o<<16|o>>>16)+c|0,a+=(o^c^n)+r[14]-35309556|0,a=(a<<23|a>>>9)+o|0,n+=(a^o^c)+r[1]-1530992060|0,n=(n<<4|n>>>28)+a|0,c+=(n^a^o)+r[4]+1272893353|0,c=(c<<11|c>>>21)+n|0,o+=(c^n^a)+r[7]-155497632|0,o=(o<<16|o>>>16)+c|0,a+=(o^c^n)+r[10]-1094730640|0,a=(a<<23|a>>>9)+o|0,n+=(a^o^c)+r[13]+681279174|0,n=(n<<4|n>>>28)+a|0,c+=(n^a^o)+r[0]-358537222|0,c=(c<<11|c>>>21)+n|0,o+=(c^n^a)+r[3]-722521979|0,o=(o<<16|o>>>16)+c|0,a+=(o^c^n)+r[6]+76029189|0,a=(a<<23|a>>>9)+o|0,n+=(a^o^c)+r[9]-640364487|0,n=(n<<4|n>>>28)+a|0,c+=(n^a^o)+r[12]-421815835|0,c=(c<<11|c>>>21)+n|0,o+=(c^n^a)+r[15]+530742520|0,o=(o<<16|o>>>16)+c|0,a+=(o^c^n)+r[2]-995338651|0,a=(a<<23|a>>>9)+o|0,n+=(o^(a|~c))+r[0]-198630844|0,n=(n<<6|n>>>26)+a|0,c+=(a^(n|~o))+r[7]+1126891415|0,c=(c<<10|c>>>22)+n|0,o+=(n^(c|~a))+r[14]-1416354905|0,o=(o<<15|o>>>17)+c|0,a+=(c^(o|~n))+r[5]-57434055|0,a=(a<<21|a>>>11)+o|0,n+=(o^(a|~c))+r[12]+1700485571|0,n=(n<<6|n>>>26)+a|0,c+=(a^(n|~o))+r[3]-1894986606|0,c=(c<<10|c>>>22)+n|0,o+=(n^(c|~a))+r[10]-1051523|0,o=(o<<15|o>>>17)+c|0,a+=(c^(o|~n))+r[1]-2054922799|0,a=(a<<21|a>>>11)+o|0,n+=(o^(a|~c))+r[8]+1873313359|0,n=(n<<6|n>>>26)+a|0,c+=(a^(n|~o))+r[15]-30611744|0,c=(c<<10|c>>>22)+n|0,o+=(n^(c|~a))+r[6]-1560198380|0,o=(o<<15|o>>>17)+c|0,a+=(c^(o|~n))+r[13]+1309151649|0,a=(a<<21|a>>>11)+o|0,n+=(o^(a|~c))+r[4]-145523070|0,n=(n<<6|n>>>26)+a|0,c+=(a^(n|~o))+r[11]-1120210379|0,c=(c<<10|c>>>22)+n|0,o+=(n^(c|~a))+r[2]+718787259|0,o=(o<<15|o>>>17)+c|0,a+=(c^(o|~n))+r[9]-343485551|0,a=(a<<21|a>>>11)+o|0,e[0]=n+e[0]|0,e[1]=a+e[1]|0,e[2]=o+e[2]|0,e[3]=c+e[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(kr.stateIdentity),this}appendStr(e){let r=this._buffer8,n=this._buffer32,a=this._bufferLength,o,c;for(c=0;c<e.length;c+=1){if(o=e.charCodeAt(c),o<128)r[a++]=o;else if(o<2048)r[a++]=(o>>>6)+192,r[a++]=o&63|128;else if(o<55296||o>56319)r[a++]=(o>>>12)+224,r[a++]=o>>>6&63|128,r[a++]=o&63|128;else{if(o=(o-55296)*1024+(e.charCodeAt(++c)-56320)+65536,o>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");r[a++]=(o>>>18)+240,r[a++]=o>>>12&63|128,r[a++]=o>>>6&63|128,r[a++]=o&63|128}a>=64&&(this._dataLength+=64,kr._md5cycle(this._state,n),a-=64,n[0]=n[16])}return this._bufferLength=a,this}appendAsciiStr(e){let r=this._buffer8,n=this._buffer32,a=this._bufferLength,o,c=0;for(;;){for(o=Math.min(e.length-c,64-a);o--;)r[a++]=e.charCodeAt(c++);if(a<64)break;this._dataLength+=64,kr._md5cycle(this._state,n),a=0}return this._bufferLength=a,this}appendByteArray(e){let r=this._buffer8,n=this._buffer32,a=this._bufferLength,o,c=0;for(;;){for(o=Math.min(e.length-c,64-a);o--;)r[a++]=e[c++];if(a<64)break;this._dataLength+=64,kr._md5cycle(this._state,n),a=0}return this._bufferLength=a,this}getState(){let e=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[e[0],e[1],e[2],e[3]]}}setState(e){let r=e.buffer,n=e.state,a=this._state,o;for(this._dataLength=e.length,this._bufferLength=e.buflen,a[0]=n[0],a[1]=n[1],a[2]=n[2],a[3]=n[3],o=0;o<r.length;o+=1)this._buffer8[o]=r.charCodeAt(o)}end(e=!1){let r=this._bufferLength,n=this._buffer8,a=this._buffer32,o=(r>>2)+1;this._dataLength+=r;let c=this._dataLength*8;if(n[r]=128,n[r+1]=n[r+2]=n[r+3]=0,a.set(kr.buffer32Identity.subarray(o),o),r>55&&(kr._md5cycle(this._state,a),a.set(kr.buffer32Identity)),c<=4294967295)a[14]=c;else{let u=c.toString(16).match(/(.*?)(.{0,8})$/);if(u===null)return;let h=parseInt(u[2],16),f=parseInt(u[1],16)||0;a[14]=h,a[15]=f}return kr._md5cycle(this._state,a),e?this._state:kr._hex(this._state)}},A(wn,"Md5"),Te(wn,"stateIdentity",new Int32Array([1732584193,-271733879,-1732584194,271733878])),Te(wn,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Te(wn,"hexChars","0123456789abcdef"),Te(wn,"hexOut",[]),Te(wn,"onePassHasher",new wn),ih=wn}),Lf={};Jr(Lf,{createHash:()=>L_,createHmac:()=>A_,randomBytes:()=>E_});function E_(t){return crypto.getRandomValues(Pe.alloc(t))}function L_(t){if(t==="sha256")return{update:A(function(e){return{digest:A(function(){return Pe.from(Ua(e))},"digest")}},"update")};if(t==="md5")return{update:A(function(e){return{digest:A(function(){return typeof e=="string"?ih.hashStr(e):ih.hashByteArray(e)},"digest")}},"update")};throw new Error(`Hash type '${t}' not supported`)}function A_(t,e){if(t!=="sha256")throw new Error(`Only sha256 is supported (requested: '${t}')`);return{update:A(function(r){return{digest:A(function(){typeof e=="string"&&(e=new TextEncoder().encode(e)),typeof r=="string"&&(r=new TextEncoder().encode(r));let n=e.length;if(n>64)e=Ua(e);else if(n<64){let h=new Uint8Array(64);h.set(e),e=h}let a=new Uint8Array(64),o=new Uint8Array(64);for(let h=0;h<64;h++)a[h]=54^e[h],o[h]=92^e[h];let c=new Uint8Array(r.length+64);c.set(a,0),c.set(r,64);let u=new Uint8Array(96);return u.set(o,0),u.set(Ua(c),64),Pe.from(Ua(u))},"digest")}},"update")}}var M_=hr(()=>{_e(),mk(),pk(),A(E_,"randomBytes"),A(L_,"createHash"),A(A_,"createHmac")}),Fc=Oe((t,e)=>{_e(),e.exports={host:"localhost",user:De.platform==="win32"?De.env.USERNAME:De.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var r=zc(),n=r.getTypeParser(20,"text"),a=r.getTypeParser(1016,"text");e.exports.__defineSetter__("parseInt8",function(o){r.setTypeParser(20,"text",o?r.getTypeParser(23,"text"):n),r.setTypeParser(1016,"text",o?r.getTypeParser(1007,"text"):a)})}),Uc=Oe((t,e)=>{_e();var r=(M_(),Et(Lf)),n=Fc();function a(g){var y=g.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+y+'"'}A(a,"escapeElement");function o(g){for(var y="{",j=0;j<g.length;j++)j>0&&(y=y+","),g[j]===null||typeof g[j]>"u"?y=y+"NULL":Array.isArray(g[j])?y=y+o(g[j]):g[j]instanceof Pe?y+="\\\\x"+g[j].toString("hex"):y+=a(c(g[j]));return y=y+"}",y}A(o,"arrayString");var c=A(function(g,y){if(g==null)return null;if(g instanceof Pe)return g;if(ArrayBuffer.isView(g)){var j=Pe.from(g.buffer,g.byteOffset,g.byteLength);return j.length===g.byteLength?j:j.slice(g.byteOffset,g.byteOffset+g.byteLength)}return g instanceof Date?n.parseInputDatesAsUTC?m(g):f(g):Array.isArray(g)?o(g):typeof g=="object"?u(g,y):g.toString()},"prepareValue");function u(g,y){if(g&&typeof g.toPostgres=="function"){if(y=y||[],y.indexOf(g)!==-1)throw new Error('circular reference detected while preparing "'+g+'" for query');return y.push(g),c(g.toPostgres(c),y)}return JSON.stringify(g)}A(u,"prepareObject");function h(g,y){for(g=""+g;g.length<y;)g="0"+g;return g}A(h,"pad");function f(g){var y=-g.getTimezoneOffset(),j=g.getFullYear(),_=j<1;_&&(j=Math.abs(j)+1);var b=h(j,4)+"-"+h(g.getMonth()+1,2)+"-"+h(g.getDate(),2)+"T"+h(g.getHours(),2)+":"+h(g.getMinutes(),2)+":"+h(g.getSeconds(),2)+"."+h(g.getMilliseconds(),3);return y<0?(b+="-",y*=-1):b+="+",b+=h(Math.floor(y/60),2)+":"+h(y%60,2),_&&(b+=" BC"),b}A(f,"dateToString");function m(g){var y=g.getUTCFullYear(),j=y<1;j&&(y=Math.abs(y)+1);var _=h(y,4)+"-"+h(g.getUTCMonth()+1,2)+"-"+h(g.getUTCDate(),2)+"T"+h(g.getUTCHours(),2)+":"+h(g.getUTCMinutes(),2)+":"+h(g.getUTCSeconds(),2)+"."+h(g.getUTCMilliseconds(),3);return _+="+00:00",j&&(_+=" BC"),_}A(m,"dateToStringUTC");function v(g,y,j){return g=typeof g=="string"?{text:g}:g,y&&(typeof y=="function"?g.callback=y:g.values=y),j&&(g.callback=j),g}A(v,"normalizeQueryConfig");var w=A(function(g){return r.createHash("md5").update(g,"utf-8").digest("hex")},"md5"),N=A(function(g,y,j){var _=w(y+g),b=w(Pe.concat([Pe.from(_),j]));return"md5"+b},"postgresMd5PasswordHash");e.exports={prepareValue:A(function(g){return c(g)},"prepareValueWrapper"),normalizeQueryConfig:v,postgresMd5PasswordHash:N,md5:w}}),No={};Jr(No,{default:()=>I_});var I_,qc=hr(()=>{_e(),I_={}}),gk=Oe((t,e)=>{_e();var r=(M_(),Et(Lf));function n(y){if(y.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let j=r.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:j,response:"n,,n=*,r="+j,message:"SASLInitialResponse"}}A(n,"startSession");function a(y,j,_){if(y.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof j!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(typeof _!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let b=f(_);if(b.nonce.startsWith(y.clientNonce)){if(b.nonce.length===y.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var P=Pe.from(b.salt,"base64"),B=g(j,P,b.iteration),$=N(B,"Client Key"),k=w($),I="n=*,r="+y.clientNonce,T="r="+b.nonce+",s="+b.salt+",i="+b.iteration,D="c=biws,r="+b.nonce,U=I+","+T+","+D,V=N(k,U),z=v($,V),q=z.toString("base64"),Q=N(B,"Server Key"),te=N(Q,U);y.message="SASLResponse",y.serverSignature=te.toString("base64"),y.response=D+",p="+q}A(a,"continueSession");function o(y,j){if(y.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof j!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:_}=m(j);if(_!==y.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}A(o,"finalizeSession");function c(y){if(typeof y!="string")throw new TypeError("SASL: text must be a string");return y.split("").map((j,_)=>y.charCodeAt(_)).every(j=>j>=33&&j<=43||j>=45&&j<=126)}A(c,"isPrintableChars");function u(y){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(y)}A(u,"isBase64");function h(y){if(typeof y!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(y.split(",").map(j=>{if(!/^.=/.test(j))throw new Error("SASL: Invalid attribute pair entry");let _=j[0],b=j.substring(2);return[_,b]}))}A(h,"parseAttributePairs");function f(y){let j=h(y),_=j.get("r");if(_){if(!c(_))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let b=j.get("s");if(b){if(!u(b))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let P=j.get("i");if(P){if(!/^[1-9][0-9]*$/.test(P))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let B=parseInt(P,10);return{nonce:_,salt:b,iteration:B}}A(f,"parseServerFirstMessage");function m(y){let j=h(y).get("v");if(j){if(!u(j))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:j}}A(m,"parseServerFinalMessage");function v(y,j){if(!Pe.isBuffer(y))throw new TypeError("first argument must be a Buffer");if(!Pe.isBuffer(j))throw new TypeError("second argument must be a Buffer");if(y.length!==j.length)throw new Error("Buffer lengths must match");if(y.length===0)throw new Error("Buffers cannot be empty");return Pe.from(y.map((_,b)=>y[b]^j[b]))}A(v,"xorBuffers");function w(y){return r.createHash("sha256").update(y).digest()}A(w,"sha256");function N(y,j){return r.createHmac("sha256",y).update(j).digest()}A(N,"hmacSha256");function g(y,j,_){for(var b=N(y,Pe.concat([j,Pe.from([0,0,0,1])])),P=b,B=0;B<_-1;B++)b=N(y,b),P=v(P,b);return P}A(g,"Hi"),e.exports={startSession:n,continueSession:a,finalizeSession:o}}),Af={};Jr(Af,{join:()=>D_});function D_(...t){return t.join("/")}var O_=hr(()=>{_e(),A(D_,"join")}),Mf={};Jr(Mf,{stat:()=>R_});function R_(t,e){e(new Error("No filesystem"))}var B_=hr(()=>{_e(),A(R_,"stat")}),If={};Jr(If,{default:()=>$_});var $_,z_=hr(()=>{_e(),$_={}}),F_={};Jr(F_,{StringDecoder:()=>U_});var sd,U_,yk=hr(()=>{_e(),sd=class{constructor(e){Te(this,"td"),this.td=new TextDecoder(e)}write(e){return this.td.decode(e,{stream:!0})}end(e){return this.td.decode(e)}},A(sd,"StringDecoder"),U_=sd}),xk=Oe((t,e)=>{_e();var{Transform:r}=(z_(),Et(If)),{StringDecoder:n}=(yk(),Et(F_)),a=Symbol("last"),o=Symbol("decoder");function c(v,w,N){let g;if(this.overflow){if(g=this[o].write(v).split(this.matcher),g.length===1)return N();g.shift(),this.overflow=!1}else this[a]+=this[o].write(v),g=this[a].split(this.matcher);this[a]=g.pop();for(let y=0;y<g.length;y++)try{h(this,this.mapper(g[y]))}catch(j){return N(j)}if(this.overflow=this[a].length>this.maxLength,this.overflow&&!this.skipOverflow){N(new Error("maximum buffer reached"));return}N()}A(c,"transform");function u(v){if(this[a]+=this[o].end(),this[a])try{h(this,this.mapper(this[a]))}catch(w){return v(w)}v()}A(u,"flush");function h(v,w){w!==void 0&&v.push(w)}A(h,"push");function f(v){return v}A(f,"noop");function m(v,w,N){switch(v=v||/\r?\n/,w=w||f,N=N||{},arguments.length){case 1:typeof v=="function"?(w=v,v=/\r?\n/):typeof v=="object"&&!(v instanceof RegExp)&&!v[Symbol.split]&&(N=v,v=/\r?\n/);break;case 2:typeof v=="function"?(N=w,w=v,v=/\r?\n/):typeof w=="object"&&(N=w,w=f)}N=Object.assign({},N),N.autoDestroy=!0,N.transform=c,N.flush=u,N.readableObjectMode=!0;let g=new r(N);return g[a]="",g[o]=new n("utf8"),g.matcher=v,g.mapper=w,g.maxLength=N.maxLength,g.skipOverflow=N.skipOverflow||!1,g.overflow=!1,g._destroy=function(y,j){this._writableState.errorEmitted=!1,j(y)},g}A(m,"split"),e.exports=m}),vk=Oe((t,e)=>{_e();var r=(O_(),Et(Af)),n=(z_(),Et(If)).Stream,a=xk(),o=(qc(),Et(No)),c=5432,u=De.platform==="win32",h=De.stderr,f=56,m=7,v=61440,w=32768;function N($){return($&v)==w}A(N,"isRegFile");var g=["host","port","database","user","password"],y=g.length,j=g[y-1];function _(){var $=h instanceof n&&h.writable===!0;if($){var k=Array.prototype.slice.call(arguments).concat(`
`);h.write(o.format.apply(o,k))}}A(_,"warn"),Object.defineProperty(e.exports,"isWin",{get:A(function(){return u},"get"),set:A(function($){u=$},"set")}),e.exports.warnTo=function($){var k=h;return h=$,k},e.exports.getFileName=function($){var k=$||De.env,I=k.PGPASSFILE||(u?r.join(k.APPDATA||"./","postgresql","pgpass.conf"):r.join(k.HOME||"./",".pgpass"));return I},e.exports.usePgPass=function($,k){return Object.prototype.hasOwnProperty.call(De.env,"PGPASSWORD")?!1:u?!0:(k=k||"<unkn>",N($.mode)?$.mode&(f|m)?(_('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',k),!1):!0:(_('WARNING: password file "%s" is not a plain file',k),!1))};var b=e.exports.match=function($,k){return g.slice(0,-1).reduce(function(I,T,D){return D==1&&Number($[T]||c)===Number(k[T])?I&&!0:I&&(k[T]==="*"||k[T]===$[T])},!0)};e.exports.getPassword=function($,k,I){var T,D=k.pipe(a());function U(q){var Q=P(q);Q&&B(Q)&&b($,Q)&&(T=Q[j],D.end())}A(U,"onLine");var V=A(function(){k.destroy(),I(T)},"onEnd"),z=A(function(q){k.destroy(),_("WARNING: error on reading file: %s",q),I(void 0)},"onErr");k.on("error",z),D.on("data",U).on("end",V).on("error",z)};var P=e.exports.parseLine=function($){if($.length<11||$.match(/^\s+#/))return null;for(var k="",I="",T=0,D=0,U=0,V={},z=!1,q=A(function(te,de,re){var Z=$.substring(de,re);Object.hasOwnProperty.call(De.env,"PGPASS_NO_DEESCAPE")||(Z=Z.replace(/\\([:\\])/g,"$1")),V[g[te]]=Z},"addToObj"),Q=0;Q<$.length-1;Q+=1){if(k=$.charAt(Q+1),I=$.charAt(Q),z=T==y-1,z){q(T,D);break}Q>=0&&k==":"&&I!=="\\"&&(q(T,D,Q+1),D=Q+2,T+=1)}return V=Object.keys(V).length===y?V:null,V},B=e.exports.isValidEntry=function($){for(var k={0:function(V){return V.length>0},1:function(V){return V==="*"?!0:(V=Number(V),isFinite(V)&&V>0&&V<9007199254740992&&Math.floor(V)===V)},2:function(V){return V.length>0},3:function(V){return V.length>0},4:function(V){return V.length>0}},I=0;I<g.length;I+=1){var T=k[I],D=$[g[I]]||"",U=T(D);if(!U)return!1}return!0}}),wk=Oe((t,e)=>{_e(),O_(),Et(Af);var r=(B_(),Et(Mf)),n=vk();e.exports=function(a,o){var c=n.getFileName();r.stat(c,function(u,h){if(u||!n.usePgPass(h,c))return o(void 0);var f=r.createReadStream(c);n.getPassword(a,f,o)})},e.exports.warnTo=n.warnTo}),q_={};Jr(q_,{default:()=>H_});var H_,bk=hr(()=>{_e(),H_={}}),_k=Oe((t,e)=>{_e();var r=(C_(),Et(S_)),n=(B_(),Et(Mf));function a(o){if(o.charAt(0)==="/"){var u=o.split(" ");return{host:u[0],database:u[1]}}var c=r.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(o)?encodeURI(o).replace(/\%25(\d\d)/g,"%$1"):o,!0),u=c.query;for(var h in u)Array.isArray(u[h])&&(u[h]=u[h][u[h].length-1]);var f=(c.auth||":").split(":");if(u.user=f[0],u.password=f.splice(1).join(":"),u.port=c.port,c.protocol=="socket:")return u.host=decodeURI(c.pathname),u.database=c.query.db,u.client_encoding=c.query.encoding,u;u.host||(u.host=c.hostname);var m=c.pathname;if(!u.host&&m&&/^%2f/i.test(m)){var v=m.split("/");u.host=decodeURIComponent(v[0]),m=v.splice(1).join("/")}switch(m&&m.charAt(0)==="/"&&(m=m.slice(1)||null),u.database=m&&decodeURI(m),(u.ssl==="true"||u.ssl==="1")&&(u.ssl=!0),u.ssl==="0"&&(u.ssl=!1),(u.sslcert||u.sslkey||u.sslrootcert||u.sslmode)&&(u.ssl={}),u.sslcert&&(u.ssl.cert=n.readFileSync(u.sslcert).toString()),u.sslkey&&(u.ssl.key=n.readFileSync(u.sslkey).toString()),u.sslrootcert&&(u.ssl.ca=n.readFileSync(u.sslrootcert).toString()),u.sslmode){case"disable":{u.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{u.ssl.rejectUnauthorized=!1;break}}return u}A(a,"parse"),e.exports=a,a.parse=a}),Df=Oe((t,e)=>{_e();var r=(bk(),Et(q_)),n=Fc(),a=_k().parse,o=A(function(v,w,N){return N===void 0?N=De.env["PG"+v.toUpperCase()]:N===!1||(N=De.env[N]),w[v]||N||n[v]},"val"),c=A(function(){switch(De.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return n.ssl},"readSSLConfigFromEnvironment"),u=A(function(v){return"'"+(""+v).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),h=A(function(v,w,N){var g=w[N];g!=null&&v.push(N+"="+u(g))},"add"),f=class{constructor(w){w=typeof w=="string"?a(w):w||{},w.connectionString&&(w=Object.assign({},w,a(w.connectionString))),this.user=o("user",w),this.database=o("database",w),this.database===void 0&&(this.database=this.user),this.port=parseInt(o("port",w),10),this.host=o("host",w),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:o("password",w)}),this.binary=o("binary",w),this.options=o("options",w),this.ssl=typeof w.ssl>"u"?c():w.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=o("client_encoding",w),this.replication=o("replication",w),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=o("application_name",w,"PGAPPNAME"),this.fallback_application_name=o("fallback_application_name",w,!1),this.statement_timeout=o("statement_timeout",w,!1),this.lock_timeout=o("lock_timeout",w,!1),this.idle_in_transaction_session_timeout=o("idle_in_transaction_session_timeout",w,!1),this.query_timeout=o("query_timeout",w,!1),w.connectionTimeoutMillis===void 0?this.connect_timeout=De.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(w.connectionTimeoutMillis/1e3),w.keepAlive===!1?this.keepalives=0:w.keepAlive===!0&&(this.keepalives=1),typeof w.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(w.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(w){var N=[];h(N,this,"user"),h(N,this,"password"),h(N,this,"port"),h(N,this,"application_name"),h(N,this,"fallback_application_name"),h(N,this,"connect_timeout"),h(N,this,"options");var g=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(h(N,g,"sslmode"),h(N,g,"sslca"),h(N,g,"sslkey"),h(N,g,"sslcert"),h(N,g,"sslrootcert"),this.database&&N.push("dbname="+u(this.database)),this.replication&&N.push("replication="+u(this.replication)),this.host&&N.push("host="+u(this.host)),this.isDomainSocket)return w(null,N.join(" "));this.client_encoding&&N.push("client_encoding="+u(this.client_encoding)),r.lookup(this.host,function(y,j){return y?w(y,null):(N.push("hostaddr="+u(j)),w(null,N.join(" ")))})}};A(f,"ConnectionParameters");var m=f;e.exports=m}),Nk=Oe((t,e)=>{_e();var r=zc(),n=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,a=class{constructor(u,h){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=h,this.RowCtor=null,this.rowAsArray=u==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(u){var h;u.text?h=n.exec(u.text):h=n.exec(u.command),h&&(this.command=h[1],h[3]?(this.oid=parseInt(h[2],10),this.rowCount=parseInt(h[3],10)):h[2]&&(this.rowCount=parseInt(h[2],10)))}_parseRowAsArray(u){for(var h=new Array(u.length),f=0,m=u.length;f<m;f++){var v=u[f];v!==null?h[f]=this._parsers[f](v):h[f]=null}return h}parseRow(u){for(var h={},f=0,m=u.length;f<m;f++){var v=u[f],w=this.fields[f].name;v!==null?h[w]=this._parsers[f](v):h[w]=null}return h}addRow(u){this.rows.push(u)}addFields(u){this.fields=u,this.fields.length&&(this._parsers=new Array(u.length));for(var h=0;h<u.length;h++){var f=u[h];this._types?this._parsers[h]=this._types.getTypeParser(f.dataTypeID,f.format||"text"):this._parsers[h]=r.getTypeParser(f.dataTypeID,f.format||"text")}}};A(a,"Result");var o=a;e.exports=o}),jk=Oe((t,e)=>{_e();var{EventEmitter:r}=Js(),n=Nk(),a=Uc(),o=class extends r{constructor(h,f,m){super(),h=a.normalizeQueryConfig(h,f,m),this.text=h.text,this.values=h.values,this.rows=h.rows,this.types=h.types,this.name=h.name,this.binary=h.binary,this.portal=h.portal||"",this.callback=h.callback,this._rowMode=h.rowMode,De.domain&&h.callback&&(this.callback=De.domain.bind(h.callback)),this._result=new n(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new n(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(h){this._checkForMultirow(),this._result.addFields(h.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(h){let f;if(!this._canceledDueToError){try{f=this._result.parseRow(h.fields)}catch(m){this._canceledDueToError=m;return}this.emit("row",f,this._result),this._accumulateRows&&this._result.addRow(f)}}handleCommandComplete(h,f){this._checkForMultirow(),this._result.addCommandComplete(h),this.rows&&f.sync()}handleEmptyQuery(h){this.rows&&h.sync()}handleError(h,f){if(this._canceledDueToError&&(h=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(h);this.emit("error",h)}handleReadyForQuery(h){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,h);if(this.callback)try{this.callback(null,this._results)}catch(f){De.nextTick(()=>{throw f})}this.emit("end",this._results)}submit(h){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let f=h.parsedStatements[this.name];return this.text&&f&&this.text!==f?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(h):h.query(this.text),null)}hasBeenParsed(h){return this.name&&h.parsedStatements[this.name]}handlePortalSuspended(h){this._getRows(h,this.rows)}_getRows(h,f){h.execute({portal:this.portal,rows:f}),f?h.flush():h.sync()}prepare(h){this.isPreparedStatement=!0,this.hasBeenParsed(h)||h.parse({text:this.text,name:this.name,types:this.types});try{h.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:a.prepareValue})}catch(f){this.handleError(f,h);return}h.describe({type:"P",name:this.portal||""}),this._getRows(h,this.rows)}handleCopyInResponse(h){h.sendCopyFail("No source stream defined")}handleCopyData(h,f){}};A(o,"Query");var c=o;e.exports=c}),V_=Oe(t=>{_e(),Object.defineProperty(t,"__esModule",{value:!0}),t.NoticeMessage=t.DataRowMessage=t.CommandCompleteMessage=t.ReadyForQueryMessage=t.NotificationResponseMessage=t.BackendKeyDataMessage=t.AuthenticationMD5Password=t.ParameterStatusMessage=t.ParameterDescriptionMessage=t.RowDescriptionMessage=t.Field=t.CopyResponse=t.CopyDataMessage=t.DatabaseError=t.copyDone=t.emptyQuery=t.replicationStart=t.portalSuspended=t.noData=t.closeComplete=t.bindComplete=t.parseComplete=void 0,t.parseComplete={name:"parseComplete",length:5},t.bindComplete={name:"bindComplete",length:5},t.closeComplete={name:"closeComplete",length:5},t.noData={name:"noData",length:5},t.portalSuspended={name:"portalSuspended",length:5},t.replicationStart={name:"replicationStart",length:4},t.emptyQuery={name:"emptyQuery",length:4},t.copyDone={name:"copyDone",length:4};var e=class extends Error{constructor(Q,te,de){super(Q),this.length=te,this.name=de}};A(e,"DatabaseError");var r=e;t.DatabaseError=r;var n=class{constructor(Q,te){this.length=Q,this.chunk=te,this.name="copyData"}};A(n,"CopyDataMessage");var a=n;t.CopyDataMessage=a;var o=class{constructor(Q,te,de,re){this.length=Q,this.name=te,this.binary=de,this.columnTypes=new Array(re)}};A(o,"CopyResponse");var c=o;t.CopyResponse=c;var u=class{constructor(Q,te,de,re,Z,ne,ie){this.name=Q,this.tableID=te,this.columnID=de,this.dataTypeID=re,this.dataTypeSize=Z,this.dataTypeModifier=ne,this.format=ie}};A(u,"Field");var h=u;t.Field=h;var f=class{constructor(Q,te){this.length=Q,this.fieldCount=te,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};A(f,"RowDescriptionMessage");var m=f;t.RowDescriptionMessage=m;var v=class{constructor(Q,te){this.length=Q,this.parameterCount=te,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};A(v,"ParameterDescriptionMessage");var w=v;t.ParameterDescriptionMessage=w;var N=class{constructor(Q,te,de){this.length=Q,this.parameterName=te,this.parameterValue=de,this.name="parameterStatus"}};A(N,"ParameterStatusMessage");var g=N;t.ParameterStatusMessage=g;var y=class{constructor(Q,te){this.length=Q,this.salt=te,this.name="authenticationMD5Password"}};A(y,"AuthenticationMD5Password");var j=y;t.AuthenticationMD5Password=j;var _=class{constructor(Q,te,de){this.length=Q,this.processID=te,this.secretKey=de,this.name="backendKeyData"}};A(_,"BackendKeyDataMessage");var b=_;t.BackendKeyDataMessage=b;var P=class{constructor(Q,te,de,re){this.length=Q,this.processId=te,this.channel=de,this.payload=re,this.name="notification"}};A(P,"NotificationResponseMessage");var B=P;t.NotificationResponseMessage=B;var $=class{constructor(Q,te){this.length=Q,this.status=te,this.name="readyForQuery"}};A($,"ReadyForQueryMessage");var k=$;t.ReadyForQueryMessage=k;var I=class{constructor(Q,te){this.length=Q,this.text=te,this.name="commandComplete"}};A(I,"CommandCompleteMessage");var T=I;t.CommandCompleteMessage=T;var D=class{constructor(Q,te){this.length=Q,this.fields=te,this.name="dataRow",this.fieldCount=te.length}};A(D,"DataRowMessage");var U=D;t.DataRowMessage=U;var V=class{constructor(Q,te){this.length=Q,this.message=te,this.name="notice"}};A(V,"NoticeMessage");var z=V;t.NoticeMessage=z}),Sk=Oe(t=>{_e(),Object.defineProperty(t,"__esModule",{value:!0}),t.Writer=void 0;var e=class{constructor(a=256){this.size=a,this.offset=5,this.headerPosition=0,this.buffer=Pe.allocUnsafe(a)}ensure(a){if(this.buffer.length-this.offset<a){let o=this.buffer,c=o.length+(o.length>>1)+a;this.buffer=Pe.allocUnsafe(c),o.copy(this.buffer)}}addInt32(a){return this.ensure(4),this.buffer[this.offset++]=a>>>24&255,this.buffer[this.offset++]=a>>>16&255,this.buffer[this.offset++]=a>>>8&255,this.buffer[this.offset++]=a>>>0&255,this}addInt16(a){return this.ensure(2),this.buffer[this.offset++]=a>>>8&255,this.buffer[this.offset++]=a>>>0&255,this}addCString(a){if(!a)this.ensure(1);else{let o=Pe.byteLength(a);this.ensure(o+1),this.buffer.write(a,this.offset,"utf-8"),this.offset+=o}return this.buffer[this.offset++]=0,this}addString(a=""){let o=Pe.byteLength(a);return this.ensure(o),this.buffer.write(a,this.offset),this.offset+=o,this}add(a){return this.ensure(a.length),a.copy(this.buffer,this.offset),this.offset+=a.length,this}join(a){if(a){this.buffer[this.headerPosition]=a;let o=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(o,this.headerPosition+1)}return this.buffer.slice(a?0:5,this.offset)}flush(a){let o=this.join(a);return this.offset=5,this.headerPosition=0,this.buffer=Pe.allocUnsafe(this.size),o}};A(e,"Writer");var r=e;t.Writer=r}),Ck=Oe(t=>{_e(),Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=void 0;var e=Sk(),r=new e.Writer,n=A(Q=>{r.addInt16(3).addInt16(0);for(let re of Object.keys(Q))r.addCString(re).addCString(Q[re]);r.addCString("client_encoding").addCString("UTF8");let te=r.addCString("").flush(),de=te.length+4;return new e.Writer().addInt32(de).add(te).flush()},"startup"),a=A(()=>{let Q=Pe.allocUnsafe(8);return Q.writeInt32BE(8,0),Q.writeInt32BE(80877103,4),Q},"requestSsl"),o=A(Q=>r.addCString(Q).flush(112),"password"),c=A(function(Q,te){return r.addCString(Q).addInt32(Pe.byteLength(te)).addString(te),r.flush(112)},"sendSASLInitialResponseMessage"),u=A(function(Q){return r.addString(Q).flush(112)},"sendSCRAMClientFinalMessage"),h=A(Q=>r.addCString(Q).flush(81),"query"),f=[],m=A(Q=>{let te=Q.name||"";te.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",te,te.length),console.error("This can cause conflicts and silent errors executing queries"));let de=Q.types||f,re=de.length,Z=r.addCString(te).addCString(Q.text).addInt16(re);for(let ne=0;ne<re;ne++)Z.addInt32(de[ne]);return r.flush(80)},"parse"),v=new e.Writer,w=A(function(Q,te){for(let de=0;de<Q.length;de++){let re=te?te(Q[de],de):Q[de];re==null?(r.addInt16(0),v.addInt32(-1)):re instanceof Pe?(r.addInt16(1),v.addInt32(re.length),v.add(re)):(r.addInt16(0),v.addInt32(Pe.byteLength(re)),v.addString(re))}},"writeValues"),N=A((Q={})=>{let te=Q.portal||"",de=Q.statement||"",re=Q.binary||!1,Z=Q.values||f,ne=Z.length;return r.addCString(te).addCString(de),r.addInt16(ne),w(Z,Q.valueMapper),r.addInt16(ne),r.add(v.flush()),r.addInt16(re?1:0),r.flush(66)},"bind"),g=Pe.from([69,0,0,0,9,0,0,0,0,0]),y=A(Q=>{if(!Q||!Q.portal&&!Q.rows)return g;let te=Q.portal||"",de=Q.rows||0,re=Pe.byteLength(te),Z=4+re+1+4,ne=Pe.allocUnsafe(1+Z);return ne[0]=69,ne.writeInt32BE(Z,1),ne.write(te,5,"utf-8"),ne[re+5]=0,ne.writeUInt32BE(de,ne.length-4),ne},"execute"),j=A((Q,te)=>{let de=Pe.allocUnsafe(16);return de.writeInt32BE(16,0),de.writeInt16BE(1234,4),de.writeInt16BE(5678,6),de.writeInt32BE(Q,8),de.writeInt32BE(te,12),de},"cancel"),_=A((Q,te)=>{let de=4+Pe.byteLength(te)+1,re=Pe.allocUnsafe(1+de);return re[0]=Q,re.writeInt32BE(de,1),re.write(te,5,"utf-8"),re[de]=0,re},"cstringMessage"),b=r.addCString("P").flush(68),P=r.addCString("S").flush(68),B=A(Q=>Q.name?_(68,`${Q.type}${Q.name||""}`):Q.type==="P"?b:P,"describe"),$=A(Q=>{let te=`${Q.type}${Q.name||""}`;return _(67,te)},"close"),k=A(Q=>r.add(Q).flush(100),"copyData"),I=A(Q=>_(102,Q),"copyFail"),T=A(Q=>Pe.from([Q,0,0,0,4]),"codeOnlyBuffer"),D=T(72),U=T(83),V=T(88),z=T(99),q={startup:n,password:o,requestSsl:a,sendSASLInitialResponseMessage:c,sendSCRAMClientFinalMessage:u,query:h,parse:m,bind:N,execute:y,describe:B,close:$,flush:A(()=>D,"flush"),sync:A(()=>U,"sync"),end:A(()=>V,"end"),copyData:k,copyDone:A(()=>z,"copyDone"),copyFail:I,cancel:j};t.serialize=q}),Pk=Oe(t=>{_e(),Object.defineProperty(t,"__esModule",{value:!0}),t.BufferReader=void 0;var e=Pe.allocUnsafe(0),r=class{constructor(o=0){this.offset=o,this.buffer=e,this.encoding="utf-8"}setBuffer(o,c){this.offset=o,this.buffer=c}int16(){let o=this.buffer.readInt16BE(this.offset);return this.offset+=2,o}byte(){let o=this.buffer[this.offset];return this.offset++,o}int32(){let o=this.buffer.readInt32BE(this.offset);return this.offset+=4,o}uint32(){let o=this.buffer.readUInt32BE(this.offset);return this.offset+=4,o}string(o){let c=this.buffer.toString(this.encoding,this.offset,this.offset+o);return this.offset+=o,c}cstring(){let o=this.offset,c=o;for(;this.buffer[c++]!==0;);return this.offset=c,this.buffer.toString(this.encoding,o,c-1)}bytes(o){let c=this.buffer.slice(this.offset,this.offset+o);return this.offset+=o,c}};A(r,"BufferReader");var n=r;t.BufferReader=n}),kk=Oe(t=>{_e(),Object.defineProperty(t,"__esModule",{value:!0}),t.Parser=void 0;var e=V_(),r=Pk(),n=1,a=4,o=n+a,c=Pe.allocUnsafe(0),u=class{constructor(m){if(this.buffer=c,this.bufferLength=0,this.bufferOffset=0,this.reader=new r.BufferReader,(m==null?void 0:m.mode)==="binary")throw new Error("Binary mode not supported yet");this.mode=(m==null?void 0:m.mode)||"text"}parse(m,v){this.mergeBuffer(m);let w=this.bufferOffset+this.bufferLength,N=this.bufferOffset;for(;N+o<=w;){let g=this.buffer[N],y=this.buffer.readUInt32BE(N+n),j=n+y;if(j+N<=w){let _=this.handlePacket(N+o,g,y,this.buffer);v(_),N+=j}else break}N===w?(this.buffer=c,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=w-N,this.bufferOffset=N)}mergeBuffer(m){if(this.bufferLength>0){let v=this.bufferLength+m.byteLength;if(v+this.bufferOffset>this.buffer.byteLength){let w;if(v<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)w=this.buffer;else{let N=this.buffer.byteLength*2;for(;v>=N;)N*=2;w=Pe.allocUnsafe(N)}this.buffer.copy(w,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=w,this.bufferOffset=0}m.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=v}else this.buffer=m,this.bufferOffset=0,this.bufferLength=m.byteLength}handlePacket(m,v,w,N){switch(v){case 50:return e.bindComplete;case 49:return e.parseComplete;case 51:return e.closeComplete;case 110:return e.noData;case 115:return e.portalSuspended;case 99:return e.copyDone;case 87:return e.replicationStart;case 73:return e.emptyQuery;case 68:return this.parseDataRowMessage(m,w,N);case 67:return this.parseCommandCompleteMessage(m,w,N);case 90:return this.parseReadyForQueryMessage(m,w,N);case 65:return this.parseNotificationMessage(m,w,N);case 82:return this.parseAuthenticationResponse(m,w,N);case 83:return this.parseParameterStatusMessage(m,w,N);case 75:return this.parseBackendKeyData(m,w,N);case 69:return this.parseErrorMessage(m,w,N,"error");case 78:return this.parseErrorMessage(m,w,N,"notice");case 84:return this.parseRowDescriptionMessage(m,w,N);case 116:return this.parseParameterDescriptionMessage(m,w,N);case 71:return this.parseCopyInMessage(m,w,N);case 72:return this.parseCopyOutMessage(m,w,N);case 100:return this.parseCopyData(m,w,N);default:return new e.DatabaseError("received invalid response: "+v.toString(16),w,"error")}}parseReadyForQueryMessage(m,v,w){this.reader.setBuffer(m,w);let N=this.reader.string(1);return new e.ReadyForQueryMessage(v,N)}parseCommandCompleteMessage(m,v,w){this.reader.setBuffer(m,w);let N=this.reader.cstring();return new e.CommandCompleteMessage(v,N)}parseCopyData(m,v,w){let N=w.slice(m,m+(v-4));return new e.CopyDataMessage(v,N)}parseCopyInMessage(m,v,w){return this.parseCopyMessage(m,v,w,"copyInResponse")}parseCopyOutMessage(m,v,w){return this.parseCopyMessage(m,v,w,"copyOutResponse")}parseCopyMessage(m,v,w,N){this.reader.setBuffer(m,w);let g=this.reader.byte()!==0,y=this.reader.int16(),j=new e.CopyResponse(v,N,g,y);for(let _=0;_<y;_++)j.columnTypes[_]=this.reader.int16();return j}parseNotificationMessage(m,v,w){this.reader.setBuffer(m,w);let N=this.reader.int32(),g=this.reader.cstring(),y=this.reader.cstring();return new e.NotificationResponseMessage(v,N,g,y)}parseRowDescriptionMessage(m,v,w){this.reader.setBuffer(m,w);let N=this.reader.int16(),g=new e.RowDescriptionMessage(v,N);for(let y=0;y<N;y++)g.fields[y]=this.parseField();return g}parseField(){let m=this.reader.cstring(),v=this.reader.uint32(),w=this.reader.int16(),N=this.reader.uint32(),g=this.reader.int16(),y=this.reader.int32(),j=this.reader.int16()===0?"text":"binary";return new e.Field(m,v,w,N,g,y,j)}parseParameterDescriptionMessage(m,v,w){this.reader.setBuffer(m,w);let N=this.reader.int16(),g=new e.ParameterDescriptionMessage(v,N);for(let y=0;y<N;y++)g.dataTypeIDs[y]=this.reader.int32();return g}parseDataRowMessage(m,v,w){this.reader.setBuffer(m,w);let N=this.reader.int16(),g=new Array(N);for(let y=0;y<N;y++){let j=this.reader.int32();g[y]=j===-1?null:this.reader.string(j)}return new e.DataRowMessage(v,g)}parseParameterStatusMessage(m,v,w){this.reader.setBuffer(m,w);let N=this.reader.cstring(),g=this.reader.cstring();return new e.ParameterStatusMessage(v,N,g)}parseBackendKeyData(m,v,w){this.reader.setBuffer(m,w);let N=this.reader.int32(),g=this.reader.int32();return new e.BackendKeyDataMessage(v,N,g)}parseAuthenticationResponse(m,v,w){this.reader.setBuffer(m,w);let N=this.reader.int32(),g={name:"authenticationOk",length:v};switch(N){case 0:break;case 3:g.length===8&&(g.name="authenticationCleartextPassword");break;case 5:if(g.length===12){g.name="authenticationMD5Password";let y=this.reader.bytes(4);return new e.AuthenticationMD5Password(v,y)}break;case 10:{g.name="authenticationSASL",g.mechanisms=[];let y;do y=this.reader.cstring(),y&&g.mechanisms.push(y);while(y)}break;case 11:g.name="authenticationSASLContinue",g.data=this.reader.string(v-8);break;case 12:g.name="authenticationSASLFinal",g.data=this.reader.string(v-8);break;default:throw new Error("Unknown authenticationOk message type "+N)}return g}parseErrorMessage(m,v,w,N){this.reader.setBuffer(m,w);let g={},y=this.reader.string(1);for(;y!=="\0";)g[y]=this.reader.cstring(),y=this.reader.string(1);let j=g.M,_=N==="notice"?new e.NoticeMessage(v,j):new e.DatabaseError(j,v,N);return _.severity=g.S,_.code=g.C,_.detail=g.D,_.hint=g.H,_.position=g.P,_.internalPosition=g.p,_.internalQuery=g.q,_.where=g.W,_.schema=g.s,_.table=g.t,_.column=g.c,_.dataType=g.d,_.constraint=g.n,_.file=g.F,_.line=g.L,_.routine=g.R,_}};A(u,"Parser");var h=u;t.Parser=h}),Q_=Oe(t=>{_e(),Object.defineProperty(t,"__esModule",{value:!0}),t.DatabaseError=t.serialize=t.parse=void 0;var e=V_();Object.defineProperty(t,"DatabaseError",{enumerable:!0,get:A(function(){return e.DatabaseError},"get")});var r=Ck();Object.defineProperty(t,"serialize",{enumerable:!0,get:A(function(){return r.serialize},"get")});var n=kk();function a(o,c){let u=new n.Parser;return o.on("data",h=>u.parse(h,c)),new Promise(h=>o.on("end",()=>h()))}A(a,"parse"),t.parse=a}),W_={};Jr(W_,{connect:()=>Z_});function Z_({socket:t,servername:e}){return t.startTls(e),t}var Tk=hr(()=>{_e(),A(Z_,"connect")}),K_=Oe((t,e)=>{_e();var r=(_o(),Et(N_)),n=Js().EventEmitter,{parse:a,serialize:o}=Q_(),c=o.flush(),u=o.sync(),h=o.end(),f=class extends n{constructor(w){super(),w=w||{},this.stream=w.stream||new r.Socket,this._keepAlive=w.keepAlive,this._keepAliveInitialDelayMillis=w.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=w.ssl||!1,this._ending=!1,this._emitMessage=!1;var N=this;this.on("newListener",function(g){g==="message"&&(N._emitMessage=!0)})}connect(w,N){var g=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(w,N),this.stream.once("connect",function(){g._keepAlive&&g.stream.setKeepAlive(!0,g._keepAliveInitialDelayMillis),g.emit("connect")});let y=A(function(j){g._ending&&(j.code==="ECONNRESET"||j.code==="EPIPE")||g.emit("error",j)},"reportStreamError");if(this.stream.on("error",y),this.stream.on("close",function(){g.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(j){var _=j.toString("utf8");switch(_){case"S":break;case"N":return g.stream.end(),g.emit("error",new Error("The server does not support SSL connections"));default:return g.stream.end(),g.emit("error",new Error("There was an error establishing an SSL connection"))}var b=(Tk(),Et(W_));let P={socket:g.stream};g.ssl!==!0&&(Object.assign(P,g.ssl),"key"in g.ssl&&(P.key=g.ssl.key)),r.isIP(N)===0&&(P.servername=N);try{g.stream=b.connect(P)}catch(B){return g.emit("error",B)}g.attachListeners(g.stream),g.stream.on("error",y),g.emit("sslconnect")})}attachListeners(w){w.on("end",()=>{this.emit("end")}),a(w,N=>{var g=N.name==="error"?"errorMessage":N.name;this._emitMessage&&this.emit("message",N),this.emit(g,N)})}requestSsl(){this.stream.write(o.requestSsl())}startup(w){this.stream.write(o.startup(w))}cancel(w,N){this._send(o.cancel(w,N))}password(w){this._send(o.password(w))}sendSASLInitialResponseMessage(w,N){this._send(o.sendSASLInitialResponseMessage(w,N))}sendSCRAMClientFinalMessage(w){this._send(o.sendSCRAMClientFinalMessage(w))}_send(w){return this.stream.writable?this.stream.write(w):!1}query(w){this._send(o.query(w))}parse(w){this._send(o.parse(w))}bind(w){this._send(o.bind(w))}execute(w){this._send(o.execute(w))}flush(){this.stream.writable&&this.stream.write(c)}sync(){this._ending=!0,this._send(c),this._send(u)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(h,()=>{this.stream.end()})}close(w){this._send(o.close(w))}describe(w){this._send(o.describe(w))}sendCopyFromChunk(w){this._send(o.copyData(w))}endCopyFrom(){this._send(o.copyDone())}sendCopyFail(w){this._send(o.copyFail(w))}};A(f,"Connection");var m=f;e.exports=m}),Ek=Oe((t,e)=>{_e();var r=Js().EventEmitter;qc(),Et(No);var n=Uc(),a=gk(),o=wk(),c=Ef(),u=Df(),h=jk(),f=Fc(),m=K_(),v=class extends r{constructor(g){super(),this.connectionParameters=new u(g),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var y=g||{};this._Promise=y.Promise||$c.Promise,this._types=new c(y.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=y.connection||new m({stream:y.stream,ssl:this.connectionParameters.ssl,keepAlive:y.keepAlive||!1,keepAliveInitialDelayMillis:y.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=y.binary||f.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=y.connectionTimeoutMillis||0}_errorAllQueries(g){let y=A(j=>{De.nextTick(()=>{j.handleError(g,this.connection)})},"enqueueError");this.activeQuery&&(y(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(y),this.queryQueue.length=0}_connect(g){var y=this,j=this.connection;if(this._connectionCallback=g,this._connecting||this._connected){let _=new Error("Client has already been connected. You cannot reuse a client.");De.nextTick(()=>{g(_)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{j._ending=!0,j.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?j.connect(this.host+"/.s.PGSQL."+this.port):j.connect(this.port,this.host),j.on("connect",function(){y.ssl?j.requestSsl():j.startup(y.getStartupConf())}),j.on("sslconnect",function(){j.startup(y.getStartupConf())}),this._attachListeners(j),j.once("end",()=>{let _=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(_),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(_):this._handleErrorEvent(_):this._connectionError||this._handleErrorEvent(_)),De.nextTick(()=>{this.emit("end")})})}connect(g){if(g){this._connect(g);return}return new this._Promise((y,j)=>{this._connect(_=>{_?j(_):y()})})}_attachListeners(g){g.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),g.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),g.on("authenticationSASL",this._handleAuthSASL.bind(this)),g.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),g.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),g.on("backendKeyData",this._handleBackendKeyData.bind(this)),g.on("error",this._handleErrorEvent.bind(this)),g.on("errorMessage",this._handleErrorMessage.bind(this)),g.on("readyForQuery",this._handleReadyForQuery.bind(this)),g.on("notice",this._handleNotice.bind(this)),g.on("rowDescription",this._handleRowDescription.bind(this)),g.on("dataRow",this._handleDataRow.bind(this)),g.on("portalSuspended",this._handlePortalSuspended.bind(this)),g.on("emptyQuery",this._handleEmptyQuery.bind(this)),g.on("commandComplete",this._handleCommandComplete.bind(this)),g.on("parseComplete",this._handleParseComplete.bind(this)),g.on("copyInResponse",this._handleCopyInResponse.bind(this)),g.on("copyData",this._handleCopyData.bind(this)),g.on("notification",this._handleNotification.bind(this))}_checkPgPass(g){let y=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(j=>{if(j!==void 0){if(typeof j!="string"){y.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=j}else this.connectionParameters.password=this.password=null;g()}).catch(j=>{y.emit("error",j)}):this.password!==null?g():o(this.connectionParameters,j=>{j!==void 0&&(this.connectionParameters.password=this.password=j),g()})}_handleAuthCleartextPassword(g){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(g){this._checkPgPass(()=>{let y=n.postgresMd5PasswordHash(this.user,this.password,g.salt);this.connection.password(y)})}_handleAuthSASL(g){this._checkPgPass(()=>{this.saslSession=a.startSession(g.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(g){a.continueSession(this.saslSession,this.password,g.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(g){a.finalizeSession(this.saslSession,g.data),this.saslSession=null}_handleBackendKeyData(g){this.processID=g.processID,this.secretKey=g.secretKey}_handleReadyForQuery(g){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:y}=this;this.activeQuery=null,this.readyForQuery=!0,y&&y.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(g){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(g);this.emit("error",g)}}_handleErrorEvent(g){if(this._connecting)return this._handleErrorWhileConnecting(g);this._queryable=!1,this._errorAllQueries(g),this.emit("error",g)}_handleErrorMessage(g){if(this._connecting)return this._handleErrorWhileConnecting(g);let y=this.activeQuery;if(!y){this._handleErrorEvent(g);return}this.activeQuery=null,y.handleError(g,this.connection)}_handleRowDescription(g){this.activeQuery.handleRowDescription(g)}_handleDataRow(g){this.activeQuery.handleDataRow(g)}_handlePortalSuspended(g){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(g){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(g){this.activeQuery.handleCommandComplete(g,this.connection)}_handleParseComplete(g){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(g){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(g){this.activeQuery.handleCopyData(g,this.connection)}_handleNotification(g){this.emit("notification",g)}_handleNotice(g){this.emit("notice",g)}getStartupConf(){var g=this.connectionParameters,y={user:g.user,database:g.database},j=g.application_name||g.fallback_application_name;return j&&(y.application_name=j),g.replication&&(y.replication=""+g.replication),g.statement_timeout&&(y.statement_timeout=String(parseInt(g.statement_timeout,10))),g.lock_timeout&&(y.lock_timeout=String(parseInt(g.lock_timeout,10))),g.idle_in_transaction_session_timeout&&(y.idle_in_transaction_session_timeout=String(parseInt(g.idle_in_transaction_session_timeout,10))),g.options&&(y.options=g.options),y}cancel(g,y){if(g.activeQuery===y){var j=this.connection;this.host&&this.host.indexOf("/")===0?j.connect(this.host+"/.s.PGSQL."+this.port):j.connect(this.port,this.host),j.on("connect",function(){j.cancel(g.processID,g.secretKey)})}else g.queryQueue.indexOf(y)!==-1&&g.queryQueue.splice(g.queryQueue.indexOf(y),1)}setTypeParser(g,y,j){return this._types.setTypeParser(g,y,j)}getTypeParser(g,y){return this._types.getTypeParser(g,y)}escapeIdentifier(g){return'"'+g.replace(/"/g,'""')+'"'}escapeLiteral(g){for(var y=!1,j="'",_=0;_<g.length;_++){var b=g[_];b==="'"?j+=b+b:b==="\\"?(j+=b+b,y=!0):j+=b}return j+="'",y===!0&&(j=" E"+j),j}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let g=this.activeQuery.submit(this.connection);g&&De.nextTick(()=>{this.activeQuery.handleError(g,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(g,y,j){var _,b,P,B,$;if(g==null)throw new TypeError("Client was passed a null or undefined query");return typeof g.submit=="function"?(P=g.query_timeout||this.connectionParameters.query_timeout,b=_=g,typeof y=="function"&&(_.callback=_.callback||y)):(P=this.connectionParameters.query_timeout,_=new h(g,y,j),_.callback||(b=new this._Promise((k,I)=>{_.callback=(T,D)=>T?I(T):k(D)}))),P&&($=_.callback,B=setTimeout(()=>{var k=new Error("Query read timeout");De.nextTick(()=>{_.handleError(k,this.connection)}),$(k),_.callback=()=>{};var I=this.queryQueue.indexOf(_);I>-1&&this.queryQueue.splice(I,1),this._pulseQueryQueue()},P),_.callback=(k,I)=>{clearTimeout(B),$(k,I)}),this.binary&&!_.binary&&(_.binary=!0),_._result&&!_._result._types&&(_._result._types=this._types),this._queryable?this._ending?(De.nextTick(()=>{_.handleError(new Error("Client was closed and is not queryable"),this.connection)}),b):(this.queryQueue.push(_),this._pulseQueryQueue(),b):(De.nextTick(()=>{_.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),b)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(g){if(this._ending=!0,!this.connection._connecting)if(g)g();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),g)this.connection.once("end",g);else return new this._Promise(y=>{this.connection.once("end",y)})}};A(v,"Client");var w=v;w.Query=h,e.exports=w}),Lk=Oe((t,e)=>{_e();var r=Js().EventEmitter,n=A(function(){},"NOOP"),a=A((g,y)=>{let j=g.findIndex(y);return j===-1?void 0:g.splice(j,1)[0]},"removeWhere"),o=class{constructor(y,j,_){this.client=y,this.idleListener=j,this.timeoutId=_}};A(o,"IdleItem");var c=o,u=class{constructor(y){this.callback=y}};A(u,"PendingItem");var h=u;function f(){throw new Error("Release called on client which has already been released to the pool.")}A(f,"throwOnDoubleRelease");function m(g,y){if(y)return{callback:y,result:void 0};let j,_,b=A(function(B,$){B?j(B):_($)},"cb"),P=new g(function(B,$){_=B,j=$}).catch(B=>{throw Error.captureStackTrace(B),B});return{callback:b,result:P}}A(m,"promisify");function v(g,y){return A(function j(_){_.client=y,y.removeListener("error",j),y.on("error",()=>{g.log("additional client error after disconnection due to error",_)}),g._remove(y),g.emit("error",_,y)},"idleListener")}A(v,"makeIdleListener");var w=class extends r{constructor(y,j){super(),this.options=Object.assign({},y),y!=null&&"password"in y&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:y.password}),y!=null&&y.ssl&&y.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||j||Hc().Client,this.Promise=this.options.Promise||$c.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(j=>{this._remove(j.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let y=this._pendingQueue.shift();if(this._idle.length){let j=this._idle.pop();clearTimeout(j.timeoutId);let _=j.client;_.ref&&_.ref();let b=j.idleListener;return this._acquireClient(_,y,b,!1)}if(!this._isFull())return this.newClient(y);throw new Error("unexpected condition")}_remove(y){let j=a(this._idle,_=>_.client===y);j!==void 0&&clearTimeout(j.timeoutId),this._clients=this._clients.filter(_=>_!==y),y.end(),this.emit("remove",y)}connect(y){if(this.ending){let b=new Error("Cannot use a pool after calling end on the pool");return y?y(b):this.Promise.reject(b)}let j=m(this.Promise,y),_=j.result;if(this._isFull()||this._idle.length){if(this._idle.length&&De.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new h(j.callback)),_;let b=A(($,k,I)=>{clearTimeout(B),j.callback($,k,I)},"queueCallback"),P=new h(b),B=setTimeout(()=>{a(this._pendingQueue,$=>$.callback===b),P.timedOut=!0,j.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return B.unref&&B.unref(),this._pendingQueue.push(P),_}return this.newClient(new h(j.callback)),_}newClient(y){let j=new this.Client(this.options);this._clients.push(j);let _=v(this,j);this.log("checking client timeout");let b,P=!1;this.options.connectionTimeoutMillis&&(b=setTimeout(()=>{this.log("ending client due to timeout"),P=!0,j.connection?j.connection.stream.destroy():j.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),j.connect(B=>{if(b&&clearTimeout(b),j.on("error",_),B)this.log("client failed to connect",B),this._clients=this._clients.filter($=>$!==j),P&&(B=new Error("Connection terminated due to connection timeout",{cause:B})),this._pulseQueue(),y.timedOut||y.callback(B,void 0,n);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let $=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(j),this._idle.findIndex(k=>k.client===j)!==-1&&this._acquireClient(j,new h((k,I,T)=>T()),_,!1)},this.options.maxLifetimeSeconds*1e3);$.unref(),j.once("end",()=>clearTimeout($))}return this._acquireClient(j,y,_,!0)}})}_acquireClient(y,j,_,b){b&&this.emit("connect",y),this.emit("acquire",y),y.release=this._releaseOnce(y,_),y.removeListener("error",_),j.timedOut?b&&this.options.verify?this.options.verify(y,y.release):y.release():b&&this.options.verify?this.options.verify(y,P=>{if(P)return y.release(P),j.callback(P,void 0,n);j.callback(void 0,y,y.release)}):j.callback(void 0,y,y.release)}_releaseOnce(y,j){let _=!1;return b=>{_&&f(),_=!0,this._release(y,j,b)}}_release(y,j,_){if(y.on("error",j),y._poolUseCount=(y._poolUseCount||0)+1,this.emit("release",_,y),_||this.ending||!y._queryable||y._ending||y._poolUseCount>=this.options.maxUses){y._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(y),this._pulseQueue();return}if(this._expired.has(y)){this.log("remove expired client"),this._expired.delete(y),this._remove(y),this._pulseQueue();return}let b;this.options.idleTimeoutMillis&&this._isAboveMin()&&(b=setTimeout(()=>{this.log("remove idle client"),this._remove(y)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&b.unref()),this.options.allowExitOnIdle&&y.unref(),this._idle.push(new c(y,j,b)),this._pulseQueue()}query(y,j,_){if(typeof y=="function"){let P=m(this.Promise,y);return kf(function(){return P.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),P.result}typeof j=="function"&&(_=j,j=void 0);let b=m(this.Promise,_);return _=b.callback,this.connect((P,B)=>{if(P)return _(P);let $=!1,k=A(I=>{$||($=!0,B.release(I),_(I))},"onError");B.once("error",k),this.log("dispatching query");try{B.query(y,j,(I,T)=>{if(this.log("query dispatched"),B.removeListener("error",k),!$)return $=!0,B.release(I),I?_(I):_(void 0,T)})}catch(I){return B.release(I),_(I)}}),b.result}end(y){if(this.log("ending"),this.ending){let _=new Error("Called end on pool more than once");return y?y(_):this.Promise.reject(_)}this.ending=!0;let j=m(this.Promise,y);return this._endCallback=j.callback,this._pulseQueue(),j.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((y,j)=>y+(this._expired.has(j)?1:0),0)}get totalCount(){return this._clients.length}};A(w,"Pool");var N=w;e.exports=N}),G_={};Jr(G_,{default:()=>Y_});var Y_,Ak=hr(()=>{_e(),Y_={}}),Mk=Oe((t,e)=>{e.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),Ik=Oe((t,e)=>{_e();var r=Js().EventEmitter,n=(qc(),Et(No)),a=Uc(),o=e.exports=function(u,h,f){r.call(this),u=a.normalizeQueryConfig(u,h,f),this.text=u.text,this.values=u.values,this.name=u.name,this.callback=u.callback,this.state="new",this._arrayMode=u.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",(function(m){m==="row"&&(this._emitRowEvents=!0)}).bind(this))};n.inherits(o,r);var c={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};o.prototype.handleError=function(u){var h=this.native.pq.resultErrorFields();if(h)for(var f in h){var m=c[f]||f;u[m]=h[f]}this.callback?this.callback(u):this.emit("error",u),this.state="error"},o.prototype.then=function(u,h){return this._getPromise().then(u,h)},o.prototype.catch=function(u){return this._getPromise().catch(u)},o.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise((function(u,h){this._once("end",u),this._once("error",h)}).bind(this)),this._promise)},o.prototype.submit=function(u){this.state="running";var h=this;this.native=u.native,u.native.arrayMode=this._arrayMode;var f=A(function(w,N,g){if(u.native.arrayMode=!1,kf(function(){h.emit("_done")}),w)return h.handleError(w);h._emitRowEvents&&(g.length>1?N.forEach((y,j)=>{y.forEach(_=>{h.emit("row",_,g[j])})}):N.forEach(function(y){h.emit("row",y,g)})),h.state="end",h.emit("end",g),h.callback&&h.callback(null,g)},"after");if(De.domain&&(f=De.domain.bind(f)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var m=(this.values||[]).map(a.prepareValue);if(u.namedQueries[this.name]){if(this.text&&u.namedQueries[this.name]!==this.text){let w=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return f(w)}return u.native.execute(this.name,m,f)}return u.native.prepare(this.name,this.text,m.length,function(w){return w?f(w):(u.namedQueries[h.name]=h.text,h.native.execute(h.name,m,f))})}else if(this.values){if(!Array.isArray(this.values)){let w=new Error("Query values must be an array");return f(w)}var v=this.values.map(a.prepareValue);u.native.query(this.text,v,f)}else u.native.query(this.text,f)}}),Dk=Oe((t,e)=>{_e();var r=(Ak(),Et(G_)),n=Ef();Mk();var a=Js().EventEmitter,o=(qc(),Et(No)),c=Df(),u=Ik(),h=e.exports=function(f){a.call(this),f=f||{},this._Promise=f.Promise||$c.Promise,this._types=new n(f.types),this.native=new r({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var m=this.connectionParameters=new c(f);this.user=m.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:m.password}),this.database=m.database,this.host=m.host,this.port=m.port,this.namedQueries={}};h.Query=u,o.inherits(h,a),h.prototype._errorAllQueries=function(f){let m=A(v=>{De.nextTick(()=>{v.native=this.native,v.handleError(f)})},"enqueueError");this._hasActiveQuery()&&(m(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(m),this._queryQueue.length=0},h.prototype._connect=function(f){var m=this;if(this._connecting){De.nextTick(()=>f(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(v,w){if(v)return f(v);m.native.connect(w,function(N){if(N)return m.native.end(),f(N);m._connected=!0,m.native.on("error",function(g){m._queryable=!1,m._errorAllQueries(g),m.emit("error",g)}),m.native.on("notification",function(g){m.emit("notification",{channel:g.relname,payload:g.extra})}),m.emit("connect"),m._pulseQueryQueue(!0),f()})})},h.prototype.connect=function(f){if(f){this._connect(f);return}return new this._Promise((m,v)=>{this._connect(w=>{w?v(w):m()})})},h.prototype.query=function(f,m,v){var w,N,g,y,j;if(f==null)throw new TypeError("Client was passed a null or undefined query");if(typeof f.submit=="function")g=f.query_timeout||this.connectionParameters.query_timeout,N=w=f,typeof m=="function"&&(f.callback=m);else if(g=this.connectionParameters.query_timeout,w=new u(f,m,v),!w.callback){let _,b;N=new this._Promise((P,B)=>{_=P,b=B}),w.callback=(P,B)=>P?b(P):_(B)}return g&&(j=w.callback,y=setTimeout(()=>{var _=new Error("Query read timeout");De.nextTick(()=>{w.handleError(_,this.connection)}),j(_),w.callback=()=>{};var b=this._queryQueue.indexOf(w);b>-1&&this._queryQueue.splice(b,1),this._pulseQueryQueue()},g),w.callback=(_,b)=>{clearTimeout(y),j(_,b)}),this._queryable?this._ending?(w.native=this.native,De.nextTick(()=>{w.handleError(new Error("Client was closed and is not queryable"))}),N):(this._queryQueue.push(w),this._pulseQueryQueue(),N):(w.native=this.native,De.nextTick(()=>{w.handleError(new Error("Client has encountered a connection error and is not queryable"))}),N)},h.prototype.end=function(f){var m=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,f));var v;return f||(v=new this._Promise(function(w,N){f=A(g=>g?N(g):w(),"cb")})),this.native.end(function(){m._errorAllQueries(new Error("Connection terminated")),De.nextTick(()=>{m.emit("end"),f&&f()})}),v},h.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"},h.prototype._pulseQueryQueue=function(f){if(this._connected&&!this._hasActiveQuery()){var m=this._queryQueue.shift();if(!m){f||this.emit("drain");return}this._activeQuery=m,m.submit(this);var v=this;m.once("_done",function(){v._pulseQueryQueue()})}},h.prototype.cancel=function(f){this._activeQuery===f?this.native.cancel(function(){}):this._queryQueue.indexOf(f)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(f),1)},h.prototype.ref=function(){},h.prototype.unref=function(){},h.prototype.setTypeParser=function(f,m,v){return this._types.setTypeParser(f,m,v)},h.prototype.getTypeParser=function(f,m){return this._types.getTypeParser(f,m)}}),bg=Oe((t,e)=>{_e(),e.exports=Dk()}),Hc=Oe((t,e)=>{_e();var r=Ek(),n=Fc(),a=K_(),o=Lk(),{DatabaseError:c}=Q_(),u=A(f=>{var m;return m=class extends o{constructor(v){super(v,f)}},A(m,"BoundPool"),m},"poolFactory"),h=A(function(f){this.defaults=n,this.Client=f,this.Query=this.Client.Query,this.Pool=u(this.Client),this._pools=[],this.Connection=a,this.types=zc(),this.DatabaseError=c},"PG");typeof De.env.NODE_PG_FORCE_NATIVE<"u"?e.exports=new h(bg()):(e.exports=new h(r),Object.defineProperty(e.exports,"native",{configurable:!0,enumerable:!1,get(){var f=null;try{f=new h(bg())}catch(m){if(m.code!=="MODULE_NOT_FOUND")throw m}return Object.defineProperty(e.exports,"native",{value:f}),f}}))});_e();_e();_o();C_();_e();var Ok=Object.defineProperty,Rk=Object.defineProperties,Bk=Object.getOwnPropertyDescriptors,_g=Object.getOwnPropertySymbols,$k=Object.prototype.hasOwnProperty,zk=Object.prototype.propertyIsEnumerable,Ng=A((t,e,r)=>e in t?Ok(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,"__defNormalProp"),Fk=A((t,e)=>{for(var r in e||(e={}))$k.call(e,r)&&Ng(t,r,e[r]);if(_g)for(var r of _g(e))zk.call(e,r)&&Ng(t,r,e[r]);return t},"__spreadValues"),Uk=A((t,e)=>Rk(t,Bk(e)),"__spreadProps"),qk=1008e3,jg=new Uint8Array(new Uint16Array([258]).buffer)[0]===2,Hk=new TextDecoder,Of=new TextEncoder,hl=Of.encode("0123456789abcdef"),fl=Of.encode("0123456789ABCDEF"),Vk=Of.encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),J_=Vk.slice();J_[62]=45;J_[63]=95;var Sa,ml;function X_(t,{alphabet:e,scratchArr:r}={}){if(!Sa)if(Sa=new Uint16Array(256),ml=new Uint16Array(256),jg)for(let N=0;N<256;N++)Sa[N]=hl[N&15]<<8|hl[N>>>4],ml[N]=fl[N&15]<<8|fl[N>>>4];else for(let N=0;N<256;N++)Sa[N]=hl[N&15]|hl[N>>>4]<<8,ml[N]=fl[N&15]|fl[N>>>4]<<8;t.byteOffset%4!==0&&(t=new Uint8Array(t));let n=t.length,a=n>>>1,o=n>>>2,c=r||new Uint16Array(n),u=new Uint32Array(t.buffer,t.byteOffset,o),h=new Uint32Array(c.buffer,c.byteOffset,a),f=e==="upper"?ml:Sa,m=0,v=0,w;if(jg)for(;m<o;)w=u[m++],h[v++]=f[w>>>8&255]<<16|f[w&255],h[v++]=f[w>>>24]<<16|f[w>>>16&255];else for(;m<o;)w=u[m++],h[v++]=f[w>>>24]<<16|f[w>>>16&255],h[v++]=f[w>>>8&255]<<16|f[w&255];for(m<<=2;m<n;)c[m]=f[t[m++]];return Hk.decode(c.subarray(0,n))}A(X_,"_toHex");function eN(t,e={}){let r="",n=t.length,a=qk>>>1,o=Math.ceil(n/a),c=new Uint16Array(o>1?a:n);for(let u=0;u<o;u++){let h=u*a,f=h+a;r+=X_(t.subarray(h,f),Uk(Fk({},e),{scratchArr:c}))}return r}A(eN,"_toHexChunked");function tN(t,e={}){return e.alphabet!=="upper"&&typeof t.toHex=="function"?t.toHex():eN(t,e)}A(tN,"toHex");_e();var rN=class nN{constructor(e,r){this.strings=e,this.values=r}toParameterizedQuery(e={query:"",params:[]}){var a;let{strings:r,values:n}=this;for(let o=0,c=r.length;o<c;o++)if(e.query+=r[o],o<n.length){let u=n[o];if(u instanceof aN)e.query+=u.sql;else if(u instanceof Ll)if(u.queryData instanceof nN)u.queryData.toParameterizedQuery(e);else{if((a=u.queryData.params)!=null&&a.length)throw new Error("This query is not composable");e.query+=u.queryData.query}else{let{params:h}=e;h.push(u),e.query+="$"+h.length,(u instanceof Pe||ArrayBuffer.isView(u))&&(e.query+="::bytea")}}return e}};A(rN,"SqlTemplate");var sN=rN,iN=class{constructor(e){this.sql=e}};A(iN,"UnsafeRawSql");var aN=iN;_e();function Rf(){typeof window<"u"&&typeof document<"u"&&typeof console<"u"&&typeof console.warn=="function"&&console.warn(`          
        ************************************************************
        *                                                          *
        *  WARNING: Running SQL directly from the browser can have *
        *  security implications. Even if your database is         *
        *  protected by Row-Level Security (RLS), use it at your   *
        *  own risk. This approach is great for fast prototyping,  *
        *  but ensure proper safeguards are in place to prevent    *
        *  misuse or execution of expensive SQL queries by your    *
        *  end users.                                              *
        *                                                          *
        *  If you've assessed the risks, suppress this message     *
        *  using the disableWarningInBrowsers configuration        *
        *  parameter.                                              *
        *                                                          *
        ************************************************************`)}A(Rf,"warnIfBrowser");_o();var Qk=Ys(Ef()),Wk=Ys(Uc()),oN=class lN extends Error{constructor(e){super(e),Te(this,"name","NeonDbError"),Te(this,"severity"),Te(this,"code"),Te(this,"detail"),Te(this,"hint"),Te(this,"position"),Te(this,"internalPosition"),Te(this,"internalQuery"),Te(this,"where"),Te(this,"schema"),Te(this,"table"),Te(this,"column"),Te(this,"dataType"),Te(this,"constraint"),Te(this,"file"),Te(this,"line"),Te(this,"routine"),Te(this,"sourceError"),"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,lN)}};A(oN,"NeonDbError");var Ci=oN,Sg="transaction() expects an array of queries, or a function returning an array of queries",Zk=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function cN(t){return t instanceof Pe?"\\x"+tN(t):t}A(cN,"encodeBuffersAsBytea");function ah(t){let{query:e,params:r}=t instanceof sN?t.toParameterizedQuery():t;return{query:e,params:r.map(n=>cN((0,Wk.prepareValue)(n)))}}A(ah,"prepareQuery");function Mi(t,{arrayMode:e,fullResults:r,fetchOptions:n,isolationLevel:a,readOnly:o,deferrable:c,authToken:u,disableWarningInBrowsers:h}={}){if(!t)throw new Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");let f;try{f=Tf(t)}catch{throw new Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(t))}let{protocol:m,username:v,hostname:w,port:N,pathname:g}=f;if(m!=="postgres:"&&m!=="postgresql:"||!v||!w||!g)throw new Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function y(_,...b){if(!(Array.isArray(_)&&Array.isArray(_.raw)&&Array.isArray(b)))throw new Error('This function can now be called only as a tagged-template function: sql`SELECT ${value}`, not sql("SELECT $1", [value], options). For a conventional function call with value placeholders ($1, $2, etc.), use sql.query("SELECT $1", [value], options).');return new Ll(j,new sN(_,b))}A(y,"templateFn"),y.query=(_,b,P)=>new Ll(j,{query:_,params:b??[]},P),y.unsafe=_=>new aN(_),y.transaction=async(_,b)=>{if(typeof _=="function"&&(_=_(y)),!Array.isArray(_))throw new Error(Sg);_.forEach($=>{if(!($ instanceof Ll))throw new Error(Sg)});let P=_.map($=>$.queryData),B=_.map($=>$.opts??{});return j(P,B,b)};async function j(_,b,P){let{fetchEndpoint:B,fetchFunction:$}=ho,k=Array.isArray(_)?{queries:_.map(Z=>ah(Z))}:ah(_),I=n??{},T=e??!1,D=r??!1,U=a,V=o,z=c;P!==void 0&&(P.fetchOptions!==void 0&&(I={...I,...P.fetchOptions}),P.arrayMode!==void 0&&(T=P.arrayMode),P.fullResults!==void 0&&(D=P.fullResults),P.isolationLevel!==void 0&&(U=P.isolationLevel),P.readOnly!==void 0&&(V=P.readOnly),P.deferrable!==void 0&&(z=P.deferrable)),b!==void 0&&!Array.isArray(b)&&b.fetchOptions!==void 0&&(I={...I,...b.fetchOptions});let q=u;!Array.isArray(b)&&(b==null?void 0:b.authToken)!==void 0&&(q=b.authToken);let Q=typeof B=="function"?B(w,N,{jwtAuth:q!==void 0}):B,te={"Neon-Connection-String":t,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"},de=await dN(q);de&&(te.Authorization=`Bearer ${de}`),Array.isArray(_)&&(U!==void 0&&(te["Neon-Batch-Isolation-Level"]=U),V!==void 0&&(te["Neon-Batch-Read-Only"]=String(V)),z!==void 0&&(te["Neon-Batch-Deferrable"]=String(z))),h||ho.disableWarningInBrowsers||Rf();let re;try{re=await($??fetch)(Q,{method:"POST",body:JSON.stringify(k),headers:te,...I})}catch(Z){let ne=new Ci(`Error connecting to database: ${Z}`);throw ne.sourceError=Z,ne}if(re.ok){let Z=await re.json();if(Array.isArray(_)){let ne=Z.results;if(!Array.isArray(ne))throw new Ci("Neon internal error: unexpected result format");return ne.map((ie,K)=>{let fe=b[K]??{},Ae=fe.arrayMode??T,ee=fe.fullResults??D;return oh(ie,{arrayMode:Ae,fullResults:ee,types:fe.types})})}else{let ne=b??{},ie=ne.arrayMode??T,K=ne.fullResults??D;return oh(Z,{arrayMode:ie,fullResults:K,types:ne.types})}}else{let{status:Z}=re;if(Z===400){let ne=await re.json(),ie=new Ci(ne.message);for(let K of Zk)ie[K]=ne[K]??void 0;throw ie}else{let ne=await re.text();throw new Ci(`Server error (HTTP status ${Z}): ${ne}`)}}}return A(j,"execute"),y}A(Mi,"neon");var uN=class{constructor(e,r,n){this.execute=e,this.queryData=r,this.opts=n}then(e,r){return this.execute(this.queryData,this.opts).then(e,r)}catch(e){return this.execute(this.queryData,this.opts).catch(e)}finally(e){return this.execute(this.queryData,this.opts).finally(e)}};A(uN,"NeonQueryPromise");var Ll=uN;function oh(t,{arrayMode:e,fullResults:r,types:n}){let a=new Qk.default(n),o=t.fields.map(h=>h.name),c=t.fields.map(h=>a.getTypeParser(h.dataTypeID)),u=e===!0?t.rows.map(h=>h.map((f,m)=>f===null?null:c[m](f))):t.rows.map(h=>Object.fromEntries(h.map((f,m)=>[o[m],f===null?null:c[m](f)])));return r?(t.viaNeonFetch=!0,t.rowAsArray=e,t.rows=u,t._parsers=c,t._types=a,t):u}A(oh,"processQueryResult");async function dN(t){if(typeof t=="string")return t;if(typeof t=="function")try{return await Promise.resolve(t())}catch(e){let r=new Ci("Error getting auth token.");throw e instanceof Error&&(r=new Ci(`Error getting auth token: ${e.message}`)),r}}A(dN,"getAuthToken");_e();var Kk=Ys(Hc());_e();var Gk=Ys(Hc()),hN=class extends Gk.Client{constructor(e){super(e),this.config=e}get neonConfig(){return this.connection.stream}connect(e){var f,m;let{neonConfig:r}=this;r.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&r.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let n=typeof this.config!="string"&&((f=this.config)==null?void 0:f.host)!==void 0||typeof this.config!="string"&&((m=this.config)==null?void 0:m.connectionString)!==void 0||De.env.PGHOST!==void 0,a=De.env.USER??De.env.USERNAME;if(!n&&this.host==="localhost"&&this.user===a&&this.database===a&&this.password===null)throw new Error(`No database host or connection string was set, and key parameters have default values (host: localhost, user: ${a}, db: ${a}, password: null). Is an environment variable missing? Alternatively, if you intended to connect with these parameters, please set the host to 'localhost' explicitly.`);let o=super.connect(e),c=r.pipelineTLS&&this.ssl,u=r.pipelineConnect==="password";if(!c&&!r.pipelineConnect)return o;let h=this.connection;if(c&&h.on("connect",()=>h.stream.emit("data","S")),u){h.removeAllListeners("authenticationCleartextPassword"),h.removeAllListeners("readyForQuery"),h.once("readyForQuery",()=>h.on("readyForQuery",this._handleReadyForQuery.bind(this)));let v=this.ssl?"sslconnect":"connect";h.on(v,()=>{this.neonConfig.disableWarningInBrowsers||Rf(),this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return o}async _handleAuthSASLContinue(e){if(typeof crypto>"u"||crypto.subtle===void 0||crypto.subtle.importKey===void 0)throw new Error("Cannot use SASL auth when `crypto.subtle` is not defined");let r=crypto.subtle,n=this.saslSession,a=this.password,o=e.data;if(n.message!=="SASLInitialResponse"||typeof a!="string"||typeof o!="string")throw new Error("SASL: protocol error");let c=Object.fromEntries(o.split(",").map(Z=>{if(!/^.=/.test(Z))throw new Error("SASL: Invalid attribute pair entry");let ne=Z[0],ie=Z.substring(2);return[ne,ie]})),u=c.r,h=c.s,f=c.i;if(!u||!/^[!-+--~]+$/.test(u))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!h||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(h))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!f||!/^[1-9][0-9]*$/.test(f))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!u.startsWith(n.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(u.length===n.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let m=parseInt(f,10),v=Pe.from(h,"base64"),w=new TextEncoder,N=w.encode(a),g=await r.importKey("raw",N,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),y=new Uint8Array(await r.sign("HMAC",g,Pe.concat([v,Pe.from([0,0,0,1])]))),j=y;for(var _=0;_<m-1;_++)y=new Uint8Array(await r.sign("HMAC",g,y)),j=Pe.from(j.map((Z,ne)=>j[ne]^y[ne]));let b=j,P=await r.importKey("raw",b,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),B=new Uint8Array(await r.sign("HMAC",P,w.encode("Client Key"))),$=await r.digest("SHA-256",B),k="n=*,r="+n.clientNonce,I="r="+u+",s="+h+",i="+m,T="c=biws,r="+u,D=k+","+I+","+T,U=await r.importKey("raw",$,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var V=new Uint8Array(await r.sign("HMAC",U,w.encode(D))),z=Pe.from(B.map((Z,ne)=>B[ne]^V[ne])),q=z.toString("base64");let Q=await r.importKey("raw",b,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),te=await r.sign("HMAC",Q,w.encode("Server Key")),de=await r.importKey("raw",te,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var re=Pe.from(await r.sign("HMAC",de,w.encode(D)));n.message="SASLResponse",n.serverSignature=re.toString("base64"),n.response=T+",p="+q,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};A(hN,"NeonClient");var Yk=hN;_o();var Jk=Ys(Df());function fN(t,e){if(e)return{callback:e,result:void 0};let r,n,a=A(function(c,u){c?r(c):n(u)},"cb"),o=new t(function(c,u){n=c,r=u});return{callback:a,result:o}}A(fN,"promisify");var Xk=class extends Kk.Pool{constructor(){super(...arguments),Te(this,"Client",Yk),Te(this,"hasFetchUnsupportedListeners",!1),Te(this,"addListener",this.on)}on(e,r){return e!=="error"&&(this.hasFetchUnsupportedListeners=!0),super.on(e,r)}query(e,r,n){var o;if(!ho.poolQueryViaFetch||this.hasFetchUnsupportedListeners||typeof e=="function")return super.query(e,r,n);typeof r=="function"&&(n=r,r=void 0);let a=fN(this.Promise,n);n=a.callback;try{let c=new Jk.default(this.options),u=encodeURIComponent,h=encodeURI,f=`postgresql://${u(c.user)}:${u(c.password)}@${u(c.host)}/${h(c.database)}`,m=typeof e=="string"?e:e.text,v=r??e.values??[];Mi(f,{fullResults:!0,arrayMode:e.rowMode==="array"}).query(m,v,{types:e.types??((o=this.options)==null?void 0:o.types)}).then(w=>n(void 0,w)).catch(w=>n(w))}catch(c){n(c)}return a.result}};A(Xk,"NeonPool");_o();var jo=Ys(Hc());jo.DatabaseError;jo.defaults;jo.escapeIdentifier;jo.escapeLiteral;var mr=jo.types;/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/const J=Symbol.for("drizzle:entityKind");function oe(t,e){if(!t||typeof t!="object")return!1;if(t instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,J))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(t).constructor;if(r)for(;r;){if(J in r&&r[J]===e[J])return!0;r=Object.getPrototypeOf(r)}return!1}var Wg;Wg=J;class mN{write(e){console.log(e)}}O(mN,Wg,"ConsoleLogWriter");var Zg;Zg=J;class pN{constructor(e){O(this,"writer");this.writer=(e==null?void 0:e.writer)??new mN}logQuery(e,r){const n=r.map(o=>{try{return JSON.stringify(o)}catch{return String(o)}}),a=n.length?` -- params: [${n.join(", ")}]`:"";this.writer.write(`Query: ${e}${a}`)}}O(pN,Zg,"DefaultLogger");var Kg;Kg=J;class gN{logQuery(){}}O(gN,Kg,"NoopLogger");var Gg,Yg;Yg=J,Gg=Symbol.toStringTag;class xs{constructor(){O(this,Gg,"QueryPromise")}catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e==null||e(),r),r=>{throw e==null||e(),r})}then(e,r){return this.execute().then(e,r)}}O(xs,Yg,"QueryPromise");var Jg;Jg=J;class _t{constructor(e,r){O(this,"name");O(this,"keyAsName");O(this,"primary");O(this,"notNull");O(this,"default");O(this,"defaultFn");O(this,"onUpdateFn");O(this,"hasDefault");O(this,"isUnique");O(this,"uniqueName");O(this,"uniqueType");O(this,"dataType");O(this,"columnType");O(this,"enumValues");O(this,"generated");O(this,"generatedIdentity");O(this,"config");this.table=e,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}O(_t,Jg,"Column");var Xg;Xg=J;class yN{constructor(e,r,n){O(this,"config");O(this,"$default",this.$defaultFn);O(this,"$onUpdate",this.$onUpdateFn);this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}O(yN,Xg,"ColumnBuilder");const cs=Symbol.for("drizzle:Name");var ey;ey=J;class xN{constructor(e,r){O(this,"reference");O(this,"_onUpdate","no action");O(this,"_onDelete","no action");this.reference=()=>{const{name:n,columns:a,foreignColumns:o}=e();return{name:n,columns:a,foreignTable:o[0].table,foreignColumns:o}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new vN(e,this)}}O(xN,ey,"PgForeignKeyBuilder");var ty;ty=J;class vN{constructor(e,r){O(this,"reference");O(this,"onUpdate");O(this,"onDelete");this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}getName(){const{name:e,columns:r,foreignColumns:n}=this.reference(),a=r.map(u=>u.name),o=n.map(u=>u.name),c=[this.table[cs],...a,n[0].table[cs],...o];return e??`${c.join("_")}_fk`}}O(vN,ty,"PgForeignKey");function e3(t,...e){return t(...e)}function t3(t,e){return`${t[cs]}_${e.join("_")}_unique`}function Cg(t,e,r){for(let n=e;n<t.length;n++){const a=t[n];if(a==="\\"){n++;continue}if(a==='"')return[t.slice(e,n).replace(/\\/g,""),n+1];if(!r&&(a===","||a==="}"))return[t.slice(e,n).replace(/\\/g,""),n]}return[t.slice(e).replace(/\\/g,""),t.length]}function wN(t,e=0){const r=[];let n=e,a=!1;for(;n<t.length;){const o=t[n];if(o===","){(a||n===e)&&r.push(""),a=!0,n++;continue}if(a=!1,o==="\\"){n+=2;continue}if(o==='"'){const[h,f]=Cg(t,n+1,!0);r.push(h),n=f;continue}if(o==="}")return[r,n+1];if(o==="{"){const[h,f]=wN(t,n+1);r.push(h),n=f;continue}const[c,u]=Cg(t,n,!1);r.push(c),n=u}return[r,n]}function r3(t){const[e]=wN(t,1);return e}function bN(t){return`{${t.map(e=>Array.isArray(e)?bN(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var ry,ny;class ze extends(ny=yN,ry=J,ny){constructor(){super(...arguments);O(this,"foreignKeyConfigs",[])}array(r){return new NN(this.config.name,this,r)}references(r,n={}){return this.foreignKeyConfigs.push({ref:r,actions:n}),this}unique(r,n){return this.config.isUnique=!0,this.config.uniqueName=r,this.config.uniqueType=n==null?void 0:n.nulls,this}generatedAlwaysAs(r){return this.config.generated={as:r,type:"always",mode:"stored"},this}buildForeignKeys(r,n){return this.foreignKeyConfigs.map(({ref:a,actions:o})=>e3((c,u)=>{const h=new xN(()=>{const f=c();return{columns:[r],foreignColumns:[f]}});return u.onUpdate&&h.onUpdate(u.onUpdate),u.onDelete&&h.onDelete(u.onDelete),h.build(n)},a,o))}buildExtraConfigColumn(r){return new _N(r,this.config)}}O(ze,ry,"PgColumnBuilder");var sy,iy;class Ee extends(iy=_t,sy=J,iy){constructor(e,r){r.uniqueName||(r.uniqueName=t3(e,[r.name])),super(e,r),this.table=e}}O(Ee,sy,"PgColumn");var ay,oy;class _N extends(oy=Ee,ay=J,oy){constructor(){super(...arguments);O(this,"indexConfig",{order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass});O(this,"defaultConfig",{order:"asc",nulls:"last",opClass:void 0})}getSQLType(){return this.getSQLType()}asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(r){return this.indexConfig.opClass=r,this}}O(_N,ay,"ExtraConfigColumn");var ly,cy;class NN extends(cy=ze,ly=J,cy){constructor(e,r,n){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(e){const r=this.config.baseBuilder.build(e);return new lh(e,this.config,r)}}O(NN,ly,"PgArrayBuilder");var uy,dy;const gc=class gc extends(dy=Ee,uy=J,dy){constructor(r,n,a,o){super(r,n);O(this,"size");this.baseColumn=a,this.range=o,this.size=n.size}getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(r){return typeof r=="string"&&(r=r3(r)),r.map(n=>this.baseColumn.mapFromDriverValue(n))}mapToDriverValue(r,n=!1){const a=r.map(o=>o===null?null:oe(this.baseColumn,gc)?this.baseColumn.mapToDriverValue(o,!0):this.baseColumn.mapToDriverValue(o));return n?a:bN(a)}};O(gc,uy,"PgArray");let lh=gc;const Pg=Symbol.for("drizzle:isPgEnum");function n3(t){return!!t&&typeof t=="function"&&Pg in t&&t[Pg]===!0}var hy;hy=J;class cr{constructor(e,r,n,a=!1,o=[]){this._={brand:"Subquery",sql:e,selectedFields:r,alias:n,isWith:a,usedTables:o}}}O(cr,hy,"Subquery");var fy,my;class Bf extends(my=cr,fy=J,my){}O(Bf,fy,"WithSubquery");const wr={startActiveSpan(t,e){return e()}},jt=Symbol.for("drizzle:ViewBaseConfig"),Ii=Symbol.for("drizzle:Schema"),ch=Symbol.for("drizzle:Columns"),kg=Symbol.for("drizzle:ExtraConfigColumns"),id=Symbol.for("drizzle:OriginalName"),ad=Symbol.for("drizzle:BaseName"),lc=Symbol.for("drizzle:IsAlias"),Tg=Symbol.for("drizzle:ExtraConfigBuilder"),s3=Symbol.for("drizzle:IsDrizzleTable");var py,gy,yy,xy,vy,wy,by,_y,Ny,jy;jy=J,Ny=cs,_y=id,by=Ii,wy=ch,vy=kg,xy=ad,yy=lc,gy=s3,py=Tg;class xe{constructor(e,r,n){O(this,Ny);O(this,_y);O(this,by);O(this,wy);O(this,vy);O(this,xy);O(this,yy,!1);O(this,gy,!0);O(this,py);this[cs]=this[id]=e,this[Ii]=r,this[ad]=n}}O(xe,jy,"Table"),O(xe,"Symbol",{Name:cs,Schema:Ii,OriginalName:id,Columns:ch,ExtraConfigColumns:kg,BaseName:ad,IsAlias:lc,ExtraConfigBuilder:Tg});function Pn(t){return t[cs]}function fo(t){return`${t[Ii]??"public"}.${t[cs]}`}function jN(t){return t!=null&&typeof t.getSQL=="function"}function i3(t){var r;const e={sql:"",params:[]};for(const n of t)e.sql+=n.sql,e.params.push(...n.params),(r=n.typings)!=null&&r.length&&(e.typings||(e.typings=[]),e.typings.push(...n.typings));return e}var Sy;Sy=J;class kt{constructor(e){O(this,"value");this.value=Array.isArray(e)?e:[e]}getSQL(){return new Se([this])}}O(kt,Sy,"StringChunk");var Cy;Cy=J;const Ms=class Ms{constructor(e){O(this,"decoder",SN);O(this,"shouldInlineParams",!1);O(this,"usedTables",[]);this.queryChunks=e;for(const r of e)if(oe(r,xe)){const n=r[xe.Symbol.Schema];this.usedTables.push(n===void 0?r[xe.Symbol.Name]:n+"."+r[xe.Symbol.Name])}}append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return wr.startActiveSpan("drizzle.buildSQL",r=>{const n=this.buildQueryFromSourceParams(this.queryChunks,e);return r==null||r.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,r){const n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:a,escapeName:o,escapeParam:c,prepareTyping:u,inlineParams:h,paramStartIndex:f}=n;return i3(e.map(m=>{var v;if(oe(m,kt))return{sql:m.value.join(""),params:[]};if(oe(m,cc))return{sql:o(m.value),params:[]};if(m===void 0)return{sql:"",params:[]};if(Array.isArray(m)){const w=[new kt("(")];for(const[N,g]of m.entries())w.push(g),N<m.length-1&&w.push(new kt(", "));return w.push(new kt(")")),this.buildQueryFromSourceParams(w,n)}if(oe(m,Ms))return this.buildQueryFromSourceParams(m.queryChunks,{...n,inlineParams:h||m.shouldInlineParams});if(oe(m,xe)){const w=m[xe.Symbol.Schema],N=m[xe.Symbol.Name];return{sql:w===void 0||m[lc]?o(N):o(w)+"."+o(N),params:[]}}if(oe(m,_t)){const w=a.getColumnCasing(m);if(r.invokeSource==="indexes")return{sql:o(w),params:[]};const N=m.table[xe.Symbol.Schema];return{sql:m.table[lc]||N===void 0?o(m.table[xe.Symbol.Name])+"."+o(w):o(N)+"."+o(m.table[xe.Symbol.Name])+"."+o(w),params:[]}}if(oe(m,vs)){const w=m[jt].schema,N=m[jt].name;return{sql:w===void 0||m[jt].isAlias?o(N):o(w)+"."+o(N),params:[]}}if(oe(m,On)){if(oe(m.value,Vs))return{sql:c(f.value++,m),params:[m],typings:["none"]};const w=m.value===null?null:m.encoder.mapToDriverValue(m.value);if(oe(w,Ms))return this.buildQueryFromSourceParams([w],n);if(h)return{sql:this.mapInlineParam(w,n),params:[]};let N=["none"];return u&&(N=[u(m.encoder)]),{sql:c(f.value++,w),params:[w],typings:N}}return oe(m,Vs)?{sql:c(f.value++,m),params:[m],typings:["none"]}:oe(m,Ms.Aliased)&&m.fieldAlias!==void 0?{sql:o(m.fieldAlias),params:[]}:oe(m,cr)?m._.isWith?{sql:o(m._.alias),params:[]}:this.buildQueryFromSourceParams([new kt("("),m._.sql,new kt(") "),new cc(m._.alias)],n):n3(m)?m.schema?{sql:o(m.schema)+"."+o(m.enumName),params:[]}:{sql:o(m.enumName),params:[]}:jN(m)?(v=m.shouldOmitSQLParens)!=null&&v.call(m)?this.buildQueryFromSourceParams([m.getSQL()],n):this.buildQueryFromSourceParams([new kt("("),m.getSQL(),new kt(")")],n):h?{sql:this.mapInlineParam(m,n),params:[]}:{sql:c(f.value++,m),params:[m],typings:["none"]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){const n=e.toString();return r(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new Ms.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}};O(Ms,Cy,"SQL");let Se=Ms;var Py;Py=J;class cc{constructor(e){O(this,"brand");this.value=e}getSQL(){return new Se([this])}}O(cc,Py,"Name");function a3(t){return typeof t=="object"&&t!==null&&"mapToDriverValue"in t&&typeof t.mapToDriverValue=="function"}const SN={mapFromDriverValue:t=>t},CN={mapToDriverValue:t=>t};({...SN,...CN});var ky;ky=J;class On{constructor(e,r=CN){O(this,"brand");this.value=e,this.encoder=r}getSQL(){return new Se([this])}}O(On,ky,"Param");function W(t,...e){const r=[];(e.length>0||t.length>0&&t[0]!=="")&&r.push(new kt(t[0]));for(const[n,a]of e.entries())r.push(a,new kt(t[n+1]));return new Se(r)}(t=>{function e(){return new Se([])}t.empty=e;function r(h){return new Se(h)}t.fromList=r;function n(h){return new Se([new kt(h)])}t.raw=n;function a(h,f){const m=[];for(const[v,w]of h.entries())v>0&&f!==void 0&&m.push(f),m.push(w);return new Se(m)}t.join=a;function o(h){return new cc(h)}t.identifier=o;function c(h){return new Vs(h)}t.placeholder=c;function u(h,f){return new On(h,f)}t.param=u})(W||(W={}));(t=>{var r;r=J;const n=class n{constructor(o,c){O(this,"isSelectionField",!1);this.sql=o,this.fieldAlias=c}getSQL(){return this.sql}clone(){return new n(this.sql,this.fieldAlias)}};O(n,r,"SQL.Aliased");let e=n;t.Aliased=e})(Se||(Se={}));var Ty;Ty=J;class Vs{constructor(e){this.name=e}getSQL(){return new Se([this])}}O(Vs,Ty,"Placeholder");function od(t,e){return t.map(r=>{if(oe(r,Vs)){if(!(r.name in e))throw new Error(`No value for placeholder "${r.name}" was provided`);return e[r.name]}if(oe(r,On)&&oe(r.value,Vs)){if(!(r.value.name in e))throw new Error(`No value for placeholder "${r.value.name}" was provided`);return r.encoder.mapToDriverValue(e[r.value.name])}return r})}const o3=Symbol.for("drizzle:IsDrizzleView");var Ey,Ly,Ay;Ay=J,Ly=jt,Ey=o3;class vs{constructor({name:e,schema:r,selectedFields:n,query:a}){O(this,Ly);O(this,Ey,!0);this[jt]={name:e,originalName:e,schema:r,selectedFields:n,query:a,isExisting:!a,isAlias:!1}}getSQL(){return new Se([this])}}O(vs,Ay,"View");_t.prototype.getSQL=function(){return new Se([this])};xe.prototype.getSQL=function(){return new Se([this])};cr.prototype.getSQL=function(){return new Se([this])};var My;My=J;class mo{constructor(e){this.table=e}get(e,r){return r==="table"?this.table:e[r]}}O(mo,My,"ColumnAliasProxyHandler");var Iy;Iy=J;class Vc{constructor(e,r){this.alias=e,this.replaceOriginalName=r}get(e,r){if(r===xe.Symbol.IsAlias)return!0;if(r===xe.Symbol.Name)return this.alias;if(this.replaceOriginalName&&r===xe.Symbol.OriginalName)return this.alias;if(r===jt)return{...e[jt],name:this.alias,isAlias:!0};if(r===xe.Symbol.Columns){const a=e[xe.Symbol.Columns];if(!a)return a;const o={};return Object.keys(a).map(c=>{o[c]=new Proxy(a[c],new mo(new Proxy(e,this)))}),o}const n=e[r];return oe(n,_t)?new Proxy(n,new mo(new Proxy(e,this))):n}}O(Vc,Iy,"TableAliasProxyHandler");function ld(t,e){return new Proxy(t,new Vc(e,!1))}function bn(t,e){return new Proxy(t,new mo(new Proxy(t.table,new Vc(e,!1))))}function PN(t,e){return new Se.Aliased(uc(t.sql,e),t.fieldAlias)}function uc(t,e){return W.join(t.queryChunks.map(r=>oe(r,_t)?bn(r,e):oe(r,Se)?uc(r,e):oe(r,Se.Aliased)?PN(r,e):r))}var Dy;Dy=J;const yc=class yc{constructor(e){O(this,"config");this.config={...e}}get(e,r){if(r==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(r===jt)return{...e[jt],selectedFields:new Proxy(e[jt].selectedFields,this)};if(typeof r=="symbol")return e[r];const a=(oe(e,cr)?e._.selectedFields:oe(e,vs)?e[jt].selectedFields:e)[r];if(oe(a,Se.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!a.isSelectionField)return a.sql;const o=a.clone();return o.isSelectionField=!0,o}if(oe(a,Se)){if(this.config.sqlBehavior==="sql")return a;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return oe(a,_t)?this.config.alias?new Proxy(a,new mo(new Proxy(a.table,new Vc(this.config.alias,this.config.replaceOriginalName??!1)))):a:typeof a!="object"||a===null?a:new Proxy(a,new yc(this.config))}};O(yc,Dy,"SelectionProxyHandler");let qt=yc;function l3(t,e,r){const n={},a=t.reduce((o,{path:c,field:u},h)=>{let f;oe(u,_t)?f=u:oe(u,Se)?f=u.decoder:f=u.sql.decoder;let m=o;for(const[v,w]of c.entries())if(v<c.length-1)w in m||(m[w]={}),m=m[w];else{const N=e[h],g=m[w]=N===null?null:f.mapFromDriverValue(N);if(r&&oe(u,_t)&&c.length===2){const y=c[0];y in n?typeof n[y]=="string"&&n[y]!==Pn(u.table)&&(n[y]=!1):n[y]=g===null?Pn(u.table):!1}}return o},{});if(r&&Object.keys(n).length>0)for(const[o,c]of Object.entries(n))typeof c=="string"&&!r[c]&&(a[o]=null);return a}function Qs(t,e){return Object.entries(t).reduce((r,[n,a])=>{if(typeof n!="string")return r;const o=e?[...e,n]:[n];return oe(a,_t)||oe(a,Se)||oe(a,Se.Aliased)?r.push({path:o,field:a}):oe(a,xe)?r.push(...Qs(a[xe.Symbol.Columns],o)):r.push(...Qs(a,o)),r},[])}function $f(t,e){const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(const[a,o]of r.entries())if(o!==n[a])return!1;return!0}function kN(t,e){const r=Object.entries(e).filter(([,n])=>n!==void 0).map(([n,a])=>oe(a,Se)||oe(a,_t)?[n,a]:[n,new On(a,t[xe.Symbol.Columns][n])]);if(r.length===0)throw new Error("No values to set");return Object.fromEntries(r)}function c3(t,e){for(const r of e)for(const n of Object.getOwnPropertyNames(r.prototype))n!=="constructor"&&Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(r.prototype,n)||Object.create(null))}function u3(t){return t[xe.Symbol.Columns]}function As(t){return oe(t,cr)?t._.alias:oe(t,vs)?t[jt].name:oe(t,Se)?void 0:t[xe.Symbol.IsAlias]?t[xe.Symbol.Name]:t[xe.Symbol.BaseName]}function At(t,e){return{name:typeof t=="string"&&t.length>0?t:"",config:typeof t=="object"?t:e}}function d3(t){if(typeof t!="object"||t===null||t.constructor.name!=="Object")return!1;if("logger"in t){const e=typeof t.logger;return!(e!=="boolean"&&(e!=="object"||typeof t.logger.logQuery!="function")&&e!=="undefined")}if("schema"in t){const e=typeof t.schema;return!(e!=="object"&&e!=="undefined")}if("casing"in t){const e=typeof t.casing;return!(e!=="string"&&e!=="undefined")}if("mode"in t)return!(t.mode!=="default"||t.mode!=="planetscale"||t.mode!==void 0);if("connection"in t){const e=typeof t.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in t){const e=typeof t.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(t).length===0}var Oy,Ry;class So extends(Ry=ze,Oy=J,Ry){generatedAlwaysAsIdentity(e){if(e){const{name:r,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){const{name:r,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}O(So,Oy,"PgIntColumnBaseBuilder");var By,$y;class TN extends($y=So,By=J,$y){constructor(e){super(e,"number","PgBigInt53")}build(e){return new EN(e,this.config)}}O(TN,By,"PgBigInt53Builder");var zy,Fy;class EN extends(Fy=Ee,zy=J,Fy){getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}O(EN,zy,"PgBigInt53");var Uy,qy;class LN extends(qy=So,Uy=J,qy){constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new AN(e,this.config)}}O(LN,Uy,"PgBigInt64Builder");var Hy,Vy;class AN extends(Vy=Ee,Hy=J,Vy){getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}O(AN,Hy,"PgBigInt64");function h3(t,e){const{name:r,config:n}=At(t,e);return n.mode==="number"?new TN(r):new LN(r)}var Qy,Wy;class MN extends(Wy=ze,Qy=J,Wy){constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new IN(e,this.config)}}O(MN,Qy,"PgBigSerial53Builder");var Zy,Ky;class IN extends(Ky=Ee,Zy=J,Ky){getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}}O(IN,Zy,"PgBigSerial53");var Gy,Yy;class DN extends(Yy=ze,Gy=J,Yy){constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new ON(e,this.config)}}O(DN,Gy,"PgBigSerial64Builder");var Jy,Xy;class ON extends(Xy=Ee,Jy=J,Xy){getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}O(ON,Jy,"PgBigSerial64");function f3(t,e){const{name:r,config:n}=At(t,e);return n.mode==="number"?new MN(r):new DN(r)}var e0,t0;class RN extends(t0=ze,e0=J,t0){constructor(e){super(e,"boolean","PgBoolean")}build(e){return new BN(e,this.config)}}O(RN,e0,"PgBooleanBuilder");var r0,n0;class BN extends(n0=Ee,r0=J,n0){getSQLType(){return"boolean"}}O(BN,r0,"PgBoolean");function un(t){return new RN(t??"")}var s0,i0;class $N extends(i0=ze,s0=J,i0){constructor(e,r){super(e,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new zN(e,this.config)}}O($N,s0,"PgCharBuilder");var a0,o0;class zN extends(o0=Ee,a0=J,o0){constructor(){super(...arguments);O(this,"length",this.config.length);O(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}O(zN,a0,"PgChar");function m3(t,e={}){const{name:r,config:n}=At(t,e);return new $N(r,n)}var l0,c0;class FN extends(c0=ze,l0=J,c0){constructor(e){super(e,"string","PgCidr")}build(e){return new UN(e,this.config)}}O(FN,l0,"PgCidrBuilder");var u0,d0;class UN extends(d0=Ee,u0=J,d0){getSQLType(){return"cidr"}}O(UN,u0,"PgCidr");function p3(t){return new FN(t??"")}var h0,f0;class qN extends(f0=ze,h0=J,f0){constructor(e,r,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(e){return new HN(e,this.config)}}O(qN,h0,"PgCustomColumnBuilder");var m0,p0;class HN extends(p0=Ee,m0=J,p0){constructor(r,n){super(r,n);O(this,"sqlName");O(this,"mapTo");O(this,"mapFrom");this.sqlName=n.customTypeParams.dataType(n.fieldConfig),this.mapTo=n.customTypeParams.toDriver,this.mapFrom=n.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(r){return typeof this.mapFrom=="function"?this.mapFrom(r):r}mapToDriverValue(r){return typeof this.mapTo=="function"?this.mapTo(r):r}}O(HN,m0,"PgCustomColumn");function g3(t){return(e,r)=>{const{name:n,config:a}=At(e,r);return new qN(n,a,t)}}var g0,y0;class Yi extends(y0=ze,g0=J,y0){defaultNow(){return this.default(W`now()`)}}O(Yi,g0,"PgDateColumnBaseBuilder");var x0,v0;class VN extends(v0=Yi,x0=J,v0){constructor(e){super(e,"date","PgDate")}build(e){return new zf(e,this.config)}}O(VN,x0,"PgDateBuilder");var w0,b0;class zf extends(b0=Ee,w0=J,b0){getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}}O(zf,w0,"PgDate");var _0,N0;class QN extends(N0=Yi,_0=J,N0){constructor(e){super(e,"string","PgDateString")}build(e){return new Ff(e,this.config)}}O(QN,_0,"PgDateStringBuilder");var j0,S0;class Ff extends(S0=Ee,j0=J,S0){getSQLType(){return"date"}}O(Ff,j0,"PgDateString");function Uf(t,e){const{name:r,config:n}=At(t,e);return(n==null?void 0:n.mode)==="date"?new VN(r):new QN(r)}var C0,P0;class WN extends(P0=ze,C0=J,P0){constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new ZN(e,this.config)}}O(WN,C0,"PgDoublePrecisionBuilder");var k0,T0;class ZN extends(T0=Ee,k0=J,T0){getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}O(ZN,k0,"PgDoublePrecision");function y3(t){return new WN(t??"")}var E0,L0;class KN extends(L0=ze,E0=J,L0){constructor(e){super(e,"string","PgInet")}build(e){return new GN(e,this.config)}}O(KN,E0,"PgInetBuilder");var A0,M0;class GN extends(M0=Ee,A0=J,M0){getSQLType(){return"inet"}}O(GN,A0,"PgInet");function x3(t){return new KN(t??"")}var I0,D0;class YN extends(D0=So,I0=J,D0){constructor(e){super(e,"number","PgInteger")}build(e){return new JN(e,this.config)}}O(YN,I0,"PgIntegerBuilder");var O0,R0;class JN extends(R0=Ee,O0=J,R0){getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}O(JN,O0,"PgInteger");function Xt(t){return new YN(t??"")}var B0,$0;class XN extends($0=ze,B0=J,$0){constructor(e,r){super(e,"string","PgInterval"),this.config.intervalConfig=r}build(e){return new e2(e,this.config)}}O(XN,B0,"PgIntervalBuilder");var z0,F0;class e2 extends(F0=Ee,z0=J,F0){constructor(){super(...arguments);O(this,"fields",this.config.intervalConfig.fields);O(this,"precision",this.config.intervalConfig.precision)}getSQLType(){const r=this.fields?` ${this.fields}`:"",n=this.precision?`(${this.precision})`:"";return`interval${r}${n}`}}O(e2,z0,"PgInterval");function v3(t,e={}){const{name:r,config:n}=At(t,e);return new XN(r,n)}var U0,q0;class t2 extends(q0=ze,U0=J,q0){constructor(e){super(e,"json","PgJson")}build(e){return new qf(e,this.config)}}O(t2,U0,"PgJsonBuilder");var H0,V0;class qf extends(V0=Ee,H0=J,V0){constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}O(qf,H0,"PgJson");function w3(t){return new t2(t??"")}var Q0,W0;class r2 extends(W0=ze,Q0=J,W0){constructor(e){super(e,"json","PgJsonb")}build(e){return new Hf(e,this.config)}}O(r2,Q0,"PgJsonbBuilder");var Z0,K0;class Hf extends(K0=Ee,Z0=J,K0){constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}O(Hf,Z0,"PgJsonb");function Ze(t){return new r2(t??"")}var G0,Y0;class n2 extends(Y0=ze,G0=J,Y0){constructor(e){super(e,"array","PgLine")}build(e){return new s2(e,this.config)}}O(n2,G0,"PgLineBuilder");var J0,X0;class s2 extends(X0=Ee,J0=J,X0){getSQLType(){return"line"}mapFromDriverValue(e){const[r,n,a]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(a)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}}O(s2,J0,"PgLine");var ex,tx;class i2 extends(tx=ze,ex=J,tx){constructor(e){super(e,"json","PgLineABC")}build(e){return new a2(e,this.config)}}O(i2,ex,"PgLineABCBuilder");var rx,nx;class a2 extends(nx=Ee,rx=J,nx){getSQLType(){return"line"}mapFromDriverValue(e){const[r,n,a]=e.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(a)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}O(a2,rx,"PgLineABC");function b3(t,e){const{name:r,config:n}=At(t,e);return!(n!=null&&n.mode)||n.mode==="tuple"?new n2(r):new i2(r)}var sx,ix;class o2 extends(ix=ze,sx=J,ix){constructor(e){super(e,"string","PgMacaddr")}build(e){return new l2(e,this.config)}}O(o2,sx,"PgMacaddrBuilder");var ax,ox;class l2 extends(ox=Ee,ax=J,ox){getSQLType(){return"macaddr"}}O(l2,ax,"PgMacaddr");function _3(t){return new o2(t??"")}var lx,cx;class c2 extends(cx=ze,lx=J,cx){constructor(e){super(e,"string","PgMacaddr8")}build(e){return new u2(e,this.config)}}O(c2,lx,"PgMacaddr8Builder");var ux,dx;class u2 extends(dx=Ee,ux=J,dx){getSQLType(){return"macaddr8"}}O(u2,ux,"PgMacaddr8");function N3(t){return new c2(t??"")}var hx,fx;class d2 extends(fx=ze,hx=J,fx){constructor(e,r,n){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(e){return new Vf(e,this.config)}}O(d2,hx,"PgNumericBuilder");var mx,px;class Vf extends(px=Ee,mx=J,px){constructor(r,n){super(r,n);O(this,"precision");O(this,"scale");this.precision=n.precision,this.scale=n.scale}mapFromDriverValue(r){return typeof r=="string"?r:String(r)}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}O(Vf,mx,"PgNumeric");var gx,yx;class h2 extends(yx=ze,gx=J,yx){constructor(e,r,n){super(e,"number","PgNumericNumber"),this.config.precision=r,this.config.scale=n}build(e){return new f2(e,this.config)}}O(h2,gx,"PgNumericNumberBuilder");var xx,vx;class f2 extends(vx=Ee,xx=J,vx){constructor(r,n){super(r,n);O(this,"precision");O(this,"scale");O(this,"mapToDriverValue",String);this.precision=n.precision,this.scale=n.scale}mapFromDriverValue(r){return typeof r=="number"?r:Number(r)}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}O(f2,xx,"PgNumericNumber");var wx,bx;class m2 extends(bx=ze,wx=J,bx){constructor(e,r,n){super(e,"bigint","PgNumericBigInt"),this.config.precision=r,this.config.scale=n}build(e){return new p2(e,this.config)}}O(m2,wx,"PgNumericBigIntBuilder");var _x,Nx;class p2 extends(Nx=Ee,_x=J,Nx){constructor(r,n){super(r,n);O(this,"precision");O(this,"scale");O(this,"mapFromDriverValue",BigInt);O(this,"mapToDriverValue",String);this.precision=n.precision,this.scale=n.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}O(p2,_x,"PgNumericBigInt");function g2(t,e){const{name:r,config:n}=At(t,e),a=n==null?void 0:n.mode;return a==="number"?new h2(r,n==null?void 0:n.precision,n==null?void 0:n.scale):a==="bigint"?new m2(r,n==null?void 0:n.precision,n==null?void 0:n.scale):new d2(r,n==null?void 0:n.precision,n==null?void 0:n.scale)}const mt=g2;var jx,Sx;class y2 extends(Sx=ze,jx=J,Sx){constructor(e){super(e,"array","PgPointTuple")}build(e){return new x2(e,this.config)}}O(y2,jx,"PgPointTupleBuilder");var Cx,Px;class x2 extends(Px=Ee,Cx=J,Px){getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}}O(x2,Cx,"PgPointTuple");var kx,Tx;class v2 extends(Tx=ze,kx=J,Tx){constructor(e){super(e,"json","PgPointObject")}build(e){return new w2(e,this.config)}}O(v2,kx,"PgPointObjectBuilder");var Ex,Lx;class w2 extends(Lx=Ee,Ex=J,Lx){getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){const[r,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}O(w2,Ex,"PgPointObject");function j3(t,e){const{name:r,config:n}=At(t,e);return!(n!=null&&n.mode)||n.mode==="tuple"?new y2(r):new v2(r)}function S3(t){const e=[];for(let r=0;r<t.length;r+=2)e.push(Number.parseInt(t.slice(r,r+2),16));return new Uint8Array(e)}function Eg(t,e){const r=new ArrayBuffer(8),n=new DataView(r);for(let a=0;a<8;a++)n.setUint8(a,t[e+a]);return n.getFloat64(0,!0)}function b2(t){const e=S3(t);let r=0;const n=e[r];r+=1;const a=new DataView(e.buffer),o=a.getUint32(r,n===1);if(r+=4,o&536870912&&(a.getUint32(r,n===1),r+=4),(o&65535)===1){const c=Eg(e,r);r+=8;const u=Eg(e,r);return r+=8,[c,u]}throw new Error("Unsupported geometry type")}var Ax,Mx;class _2 extends(Mx=ze,Ax=J,Mx){constructor(e){super(e,"array","PgGeometry")}build(e){return new N2(e,this.config)}}O(_2,Ax,"PgGeometryBuilder");var Ix,Dx;class N2 extends(Dx=Ee,Ix=J,Dx){getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return b2(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}}O(N2,Ix,"PgGeometry");var Ox,Rx;class j2 extends(Rx=ze,Ox=J,Rx){constructor(e){super(e,"json","PgGeometryObject")}build(e){return new S2(e,this.config)}}O(j2,Ox,"PgGeometryObjectBuilder");var Bx,$x;class S2 extends($x=Ee,Bx=J,$x){getSQLType(){return"geometry(point)"}mapFromDriverValue(e){const r=b2(e);return{x:r[0],y:r[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}O(S2,Bx,"PgGeometryObject");function C3(t,e){const{name:r,config:n}=At(t,e);return!(n!=null&&n.mode)||n.mode==="tuple"?new _2(r):new j2(r)}var zx,Fx;class C2 extends(Fx=ze,zx=J,Fx){constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new P2(e,this.config)}}O(C2,zx,"PgRealBuilder");var Ux,qx;class P2 extends(qx=Ee,Ux=J,qx){constructor(r,n){super(r,n);O(this,"mapFromDriverValue",r=>typeof r=="string"?Number.parseFloat(r):r)}getSQLType(){return"real"}}O(P2,Ux,"PgReal");function P3(t){return new C2(t??"")}var Hx,Vx;class k2 extends(Vx=ze,Hx=J,Vx){constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new T2(e,this.config)}}O(k2,Hx,"PgSerialBuilder");var Qx,Wx;class T2 extends(Wx=Ee,Qx=J,Wx){getSQLType(){return"serial"}}O(T2,Qx,"PgSerial");function k3(t){return new k2(t??"")}var Zx,Kx;class E2 extends(Kx=So,Zx=J,Kx){constructor(e){super(e,"number","PgSmallInt")}build(e){return new L2(e,this.config)}}O(E2,Zx,"PgSmallIntBuilder");var Gx,Yx;class L2 extends(Yx=Ee,Gx=J,Yx){constructor(){super(...arguments);O(this,"mapFromDriverValue",r=>typeof r=="string"?Number(r):r)}getSQLType(){return"smallint"}}O(L2,Gx,"PgSmallInt");function T3(t){return new E2(t??"")}var Jx,Xx;class A2 extends(Xx=ze,Jx=J,Xx){constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new M2(e,this.config)}}O(A2,Jx,"PgSmallSerialBuilder");var ev,tv;class M2 extends(tv=Ee,ev=J,tv){getSQLType(){return"smallserial"}}O(M2,ev,"PgSmallSerial");function E3(t){return new A2(t??"")}var rv,nv;class I2 extends(nv=ze,rv=J,nv){constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new D2(e,this.config)}}O(I2,rv,"PgTextBuilder");var sv,iv;class D2 extends(iv=Ee,sv=J,iv){constructor(){super(...arguments);O(this,"enumValues",this.config.enumValues)}getSQLType(){return"text"}}O(D2,sv,"PgText");function be(t,e={}){const{name:r,config:n}=At(t,e);return new I2(r,n)}var av,ov;class O2 extends(ov=Yi,av=J,ov){constructor(e,r,n){super(e,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}build(e){return new Qf(e,this.config)}}O(O2,av,"PgTimeBuilder");var lv,cv;class Qf extends(cv=Ee,lv=J,cv){constructor(r,n){super(r,n);O(this,"withTimezone");O(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}O(Qf,lv,"PgTime");function L3(t,e={}){const{name:r,config:n}=At(t,e);return new O2(r,n.withTimezone??!1,n.precision)}var uv,dv;class R2 extends(dv=Yi,uv=J,dv){constructor(e,r,n){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(e){return new Wf(e,this.config)}}O(R2,uv,"PgTimestampBuilder");var hv,fv;class Wf extends(fv=Ee,hv=J,fv){constructor(r,n){super(r,n);O(this,"withTimezone");O(this,"precision");O(this,"mapFromDriverValue",r=>new Date(this.withTimezone?r:r+"+0000"));O(this,"mapToDriverValue",r=>r.toISOString());this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}}O(Wf,hv,"PgTimestamp");var mv,pv;class B2 extends(pv=Yi,mv=J,pv){constructor(e,r,n){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(e){return new Zf(e,this.config)}}O(B2,mv,"PgTimestampStringBuilder");var gv,yv;class Zf extends(yv=Ee,gv=J,yv){constructor(r,n){super(r,n);O(this,"withTimezone");O(this,"precision");this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}O(Zf,gv,"PgTimestampString");function ke(t,e={}){const{name:r,config:n}=At(t,e);return(n==null?void 0:n.mode)==="string"?new B2(r,n.withTimezone??!1,n.precision):new R2(r,(n==null?void 0:n.withTimezone)??!1,n==null?void 0:n.precision)}var xv,vv;class $2 extends(vv=ze,xv=J,vv){constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(W`gen_random_uuid()`)}build(e){return new Kf(e,this.config)}}O($2,xv,"PgUUIDBuilder");var wv,bv;class Kf extends(bv=Ee,wv=J,bv){getSQLType(){return"uuid"}}O(Kf,wv,"PgUUID");function A3(t){return new $2(t??"")}var _v,Nv;class z2 extends(Nv=ze,_v=J,Nv){constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new F2(e,this.config)}}O(z2,_v,"PgVarcharBuilder");var jv,Sv;class F2 extends(Sv=Ee,jv=J,Sv){constructor(){super(...arguments);O(this,"length",this.config.length);O(this,"enumValues",this.config.enumValues)}getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}O(F2,jv,"PgVarchar");function ve(t,e={}){const{name:r,config:n}=At(t,e);return new z2(r,n)}var Cv,Pv;class U2 extends(Pv=ze,Cv=J,Pv){constructor(e,r){super(e,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(e){return new q2(e,this.config)}}O(U2,Cv,"PgBinaryVectorBuilder");var kv,Tv;class q2 extends(Tv=Ee,kv=J,Tv){constructor(){super(...arguments);O(this,"dimensions",this.config.dimensions)}getSQLType(){return`bit(${this.dimensions})`}}O(q2,kv,"PgBinaryVector");function M3(t,e){const{name:r,config:n}=At(t,e);return new U2(r,n)}var Ev,Lv;class H2 extends(Lv=ze,Ev=J,Lv){constructor(e,r){super(e,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(e){return new V2(e,this.config)}}O(H2,Ev,"PgHalfVectorBuilder");var Av,Mv;class V2 extends(Mv=Ee,Av=J,Mv){constructor(){super(...arguments);O(this,"dimensions",this.config.dimensions)}getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}O(V2,Av,"PgHalfVector");function I3(t,e){const{name:r,config:n}=At(t,e);return new H2(r,n)}var Iv,Dv;class Q2 extends(Dv=ze,Iv=J,Dv){constructor(e,r){super(e,"string","PgSparseVector"),this.config.dimensions=r.dimensions}build(e){return new W2(e,this.config)}}O(Q2,Iv,"PgSparseVectorBuilder");var Ov,Rv;class W2 extends(Rv=Ee,Ov=J,Rv){constructor(){super(...arguments);O(this,"dimensions",this.config.dimensions)}getSQLType(){return`sparsevec(${this.dimensions})`}}O(W2,Ov,"PgSparseVector");function D3(t,e){const{name:r,config:n}=At(t,e);return new Q2(r,n)}var Bv,$v;class Z2 extends($v=ze,Bv=J,$v){constructor(e,r){super(e,"array","PgVector"),this.config.dimensions=r.dimensions}build(e){return new K2(e,this.config)}}O(Z2,Bv,"PgVectorBuilder");var zv,Fv;class K2 extends(Fv=Ee,zv=J,Fv){constructor(){super(...arguments);O(this,"dimensions",this.config.dimensions)}getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(r){return JSON.stringify(r)}mapFromDriverValue(r){return r.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}O(K2,zv,"PgVector");function O3(t,e){const{name:r,config:n}=At(t,e);return new Z2(r,n)}function R3(){return{bigint:h3,bigserial:f3,boolean:un,char:m3,cidr:p3,customType:g3,date:Uf,doublePrecision:y3,inet:x3,integer:Xt,interval:v3,json:w3,jsonb:Ze,line:b3,macaddr:_3,macaddr8:N3,numeric:g2,point:j3,geometry:C3,real:P3,serial:k3,smallint:T3,smallserial:E3,text:be,time:L3,timestamp:ke,uuid:A3,varchar:ve,bit:M3,halfvec:I3,sparsevec:D3,vector:O3}}const uh=Symbol.for("drizzle:PgInlineForeignKeys"),Lg=Symbol.for("drizzle:EnableRLS");var Uv,qv,Hv,Vv,Qv,Wv;class Gt extends(Wv=xe,Qv=J,Vv=uh,Hv=Lg,qv=xe.Symbol.ExtraConfigBuilder,Uv=xe.Symbol.ExtraConfigColumns,Wv){constructor(){super(...arguments);O(this,Vv,[]);O(this,Hv,!1);O(this,qv);O(this,Uv,{})}}O(Gt,Qv,"PgTable"),O(Gt,"Symbol",Object.assign({},xe.Symbol,{InlineForeignKeys:uh,EnableRLS:Lg}));function B3(t,e,r,n,a=t){const o=new Gt(t,n,a),c=typeof e=="function"?e(R3()):e,u=Object.fromEntries(Object.entries(c).map(([m,v])=>{const w=v;w.setName(m);const N=w.build(o);return o[uh].push(...w.buildForeignKeys(N,o)),[m,N]})),h=Object.fromEntries(Object.entries(c).map(([m,v])=>{const w=v;w.setName(m);const N=w.buildExtraConfigColumn(o);return[m,N]})),f=Object.assign(o,u);return f[xe.Symbol.Columns]=u,f[xe.Symbol.ExtraConfigColumns]=h,Object.assign(f,{enableRLS:()=>(f[Gt.Symbol.EnableRLS]=!0,f)})}const Bt=(t,e,r)=>B3(t,e,r,void 0);var Zv;Zv=J;class G2{constructor(e,r){O(this,"columns");O(this,"name");this.columns=e,this.name=r}build(e){return new Y2(e,this.columns,this.name)}}O(G2,Zv,"PgPrimaryKeyBuilder");var Kv;Kv=J;class Y2{constructor(e,r,n){O(this,"columns");O(this,"name");this.table=e,this.columns=r,this.name=n}getName(){return this.name??`${this.table[Gt.Symbol.Name]}_${this.columns.map(e=>e.name).join("_")}_pk`}}O(Y2,Kv,"PgPrimaryKey");function $3(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(r=>r.toLowerCase()).join("_")}function z3(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((r,n,a)=>{const o=a===0?n.toLowerCase():`${n[0].toUpperCase()}${n.slice(1)}`;return r+o},"")}function F3(t){return t}var Gv;Gv=J;class J2{constructor(e){O(this,"cache",{});O(this,"cachedTables",{});O(this,"convert");this.convert=e==="snake_case"?$3:e==="camelCase"?z3:F3}getColumnCasing(e){if(!e.keyAsName)return e.name;const r=e.table[xe.Symbol.Schema]??"public",n=e.table[xe.Symbol.OriginalName],a=`${r}.${n}.${e.name}`;return this.cache[a]||this.cacheTable(e.table),this.cache[a]}cacheTable(e){const r=e[xe.Symbol.Schema]??"public",n=e[xe.Symbol.OriginalName],a=`${r}.${n}`;if(!this.cachedTables[a]){for(const o of Object.values(e[xe.Symbol.Columns])){const c=`${a}.${o.name}`;this.cache[c]=this.convert(o.name)}this.cachedTables[a]=!0}}clearCache(){this.cache={},this.cachedTables={}}}O(J2,Gv,"CasingCache");var Yv,Jv;class X2 extends(Jv=Error,Yv=J,Jv){constructor({message:e,cause:r}){super(e),this.name="DrizzleError",this.cause=r}}O(X2,Yv,"DrizzleError");class Zn extends Error{constructor(e,r,n){super(`Failed query: ${e}
params: ${r}`),this.query=e,this.params=r,this.cause=n,Error.captureStackTrace(this,Zn),n&&(this.cause=n)}}function dr(t,e){return a3(e)&&!jN(t)&&!oe(t,On)&&!oe(t,Vs)&&!oe(t,_t)&&!oe(t,xe)&&!oe(t,vs)?new On(t,e):t}const Le=(t,e)=>W`${t} = ${dr(e,t)}`,U3=(t,e)=>W`${t} <> ${dr(e,t)}`;function dc(...t){const e=t.filter(r=>r!==void 0);if(e.length!==0)return e.length===1?new Se(e):new Se([new kt("("),W.join(e,new kt(" and ")),new kt(")")])}function q3(...t){const e=t.filter(r=>r!==void 0);if(e.length!==0)return e.length===1?new Se(e):new Se([new kt("("),W.join(e,new kt(" or ")),new kt(")")])}function H3(t){return W`not ${t}`}const V3=(t,e)=>W`${t} > ${dr(e,t)}`,Q3=(t,e)=>W`${t} >= ${dr(e,t)}`,W3=(t,e)=>W`${t} < ${dr(e,t)}`,ej=(t,e)=>W`${t} <= ${dr(e,t)}`;function Z3(t,e){return Array.isArray(e)?e.length===0?W`false`:W`${t} in ${e.map(r=>dr(r,t))}`:W`${t} in ${dr(e,t)}`}function K3(t,e){return Array.isArray(e)?e.length===0?W`true`:W`${t} not in ${e.map(r=>dr(r,t))}`:W`${t} not in ${dr(e,t)}`}function G3(t){return W`${t} is null`}function Y3(t){return W`${t} is not null`}function J3(t){return W`exists ${t}`}function X3(t){return W`not exists ${t}`}function eT(t,e,r){return W`${t} between ${dr(e,t)} and ${dr(r,t)}`}function tT(t,e,r){return W`${t} not between ${dr(e,t)} and ${dr(r,t)}`}function rT(t,e){return W`${t} like ${e}`}function nT(t,e){return W`${t} not like ${e}`}function sT(t,e){return W`${t} ilike ${e}`}function iT(t,e){return W`${t} not ilike ${e}`}function aT(t){return W`${t} asc`}function Er(t){return W`${t} desc`}var Xv;Xv=J;class Gf{constructor(e,r,n){O(this,"referencedTableName");O(this,"fieldName");this.sourceTable=e,this.referencedTable=r,this.relationName=n,this.referencedTableName=r[xe.Symbol.Name]}}O(Gf,Xv,"Relation");var ew;ew=J;class tj{constructor(e,r){this.table=e,this.config=r}}O(tj,ew,"Relations");var tw,rw;const xc=class xc extends(rw=Gf,tw=J,rw){constructor(e,r,n,a){super(e,r,n==null?void 0:n.relationName),this.config=n,this.isNullable=a}withFieldName(e){const r=new xc(this.sourceTable,this.referencedTable,this.config,this.isNullable);return r.fieldName=e,r}};O(xc,tw,"One");let Ws=xc;var nw,sw;const vc=class vc extends(sw=Gf,nw=J,sw){constructor(e,r,n){super(e,r,n==null?void 0:n.relationName),this.config=n}withFieldName(e){const r=new vc(this.sourceTable,this.referencedTable,this.config);return r.fieldName=e,r}};O(vc,nw,"Many");let hc=vc;function oT(){return{and:dc,between:eT,eq:Le,exists:J3,gt:V3,gte:Q3,ilike:sT,inArray:Z3,isNull:G3,isNotNull:Y3,like:rT,lt:W3,lte:ej,ne:U3,not:H3,notBetween:tT,notExists:X3,notLike:nT,notIlike:iT,notInArray:K3,or:q3,sql:W}}function lT(){return{sql:W,asc:aT,desc:Er}}function cT(t,e){var o;Object.keys(t).length===1&&"default"in t&&!oe(t.default,xe)&&(t=t.default);const r={},n={},a={};for(const[c,u]of Object.entries(t))if(oe(u,xe)){const h=fo(u),f=n[h];r[h]=c,a[c]={tsName:c,dbName:u[xe.Symbol.Name],schema:u[xe.Symbol.Schema],columns:u[xe.Symbol.Columns],relations:(f==null?void 0:f.relations)??{},primaryKey:(f==null?void 0:f.primaryKey)??[]};for(const v of Object.values(u[xe.Symbol.Columns]))v.primary&&a[c].primaryKey.push(v);const m=(o=u[xe.Symbol.ExtraConfigBuilder])==null?void 0:o.call(u,u[xe.Symbol.ExtraConfigColumns]);if(m)for(const v of Object.values(m))oe(v,G2)&&a[c].primaryKey.push(...v.columns)}else if(oe(u,tj)){const h=fo(u.table),f=r[h],m=u.config(e(u.table));let v;for(const[w,N]of Object.entries(m))if(f){const g=a[f];g.relations[w]=N}else h in n||(n[h]={relations:{},primaryKey:v}),n[h].relations[w]=N}return{tables:a,tableNamesMap:r}}function uT(t){return function(r,n){return new Ws(t,r,n,(n==null?void 0:n.fields.reduce((a,o)=>a&&o.notNull,!0))??!1)}}function dT(t){return function(r,n){return new hc(t,r,n)}}function hT(t,e,r){if(oe(r,Ws)&&r.config)return{fields:r.config.fields,references:r.config.references};const n=e[fo(r.referencedTable)];if(!n)throw new Error(`Table "${r.referencedTable[xe.Symbol.Name]}" not found in schema`);const a=t[n];if(!a)throw new Error(`Table "${n}" not found in schema`);const o=r.sourceTable,c=e[fo(o)];if(!c)throw new Error(`Table "${o[xe.Symbol.Name]}" not found in schema`);const u=[];for(const h of Object.values(a.relations))(r.relationName&&r!==h&&h.relationName===r.relationName||!r.relationName&&h.referencedTable===r.sourceTable)&&u.push(h);if(u.length>1)throw r.relationName?new Error(`There are multiple relations with name "${r.relationName}" in table "${n}"`):new Error(`There are multiple relations between "${n}" and "${r.sourceTable[xe.Symbol.Name]}". Please specify relation name`);if(u[0]&&oe(u[0],Ws)&&u[0].config)return{fields:u[0].config.references,references:u[0].config.fields};throw new Error(`There is not enough information to infer relation "${c}.${r.fieldName}"`)}function fT(t){return{one:uT(t),many:dT(t)}}function dh(t,e,r,n,a=o=>o){const o={};for(const[c,u]of n.entries())if(u.isJson){const h=e.relations[u.tsKey],f=r[c],m=typeof f=="string"?JSON.parse(f):f;o[u.tsKey]=oe(h,Ws)?m&&dh(t,t[u.relationTableTsKey],m,u.selection,a):m.map(v=>dh(t,t[u.relationTableTsKey],v,u.selection,a))}else{const h=a(r[c]),f=u.field;let m;oe(f,_t)?m=f:oe(f,Se)?m=f.decoder:m=f.sql.decoder,o[u.tsKey]=h===null?null:m.mapFromDriverValue(h)}return o}var iw,aw;class Yf extends(aw=vs,iw=J,aw){}O(Yf,iw,"PgViewBase");var ow;ow=J;class qa{constructor(e){O(this,"casing");this.casing=new J2(e==null?void 0:e.casing)}async migrate(e,r,n){const a=typeof n=="string"?"__drizzle_migrations":n.migrationsTable??"__drizzle_migrations",o=typeof n=="string"?"drizzle":n.migrationsSchema??"drizzle",c=W`
			CREATE TABLE IF NOT EXISTS ${W.identifier(o)}.${W.identifier(a)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await r.execute(W`CREATE SCHEMA IF NOT EXISTS ${W.identifier(o)}`),await r.execute(c);const h=(await r.all(W`select id, hash, created_at from ${W.identifier(o)}.${W.identifier(a)} order by created_at desc limit 1`))[0];await r.transaction(async f=>{for await(const m of e)if(!h||Number(h.created_at)<m.folderMillis){for(const v of m.sql)await f.execute(W.raw(v));await f.execute(W`insert into ${W.identifier(o)}.${W.identifier(a)} ("hash", "created_at") values(${m.hash}, ${m.folderMillis})`)}})}escapeName(e){return`"${e}"`}escapeParam(e){return`$${e+1}`}escapeString(e){return`'${e.replace(/'/g,"''")}'`}buildWithCTE(e){if(!(e!=null&&e.length))return;const r=[W`with `];for(const[n,a]of e.entries())r.push(W`${W.identifier(a._.alias)} as (${a._.sql})`),n<e.length-1&&r.push(W`, `);return r.push(W` `),W.join(r)}buildDeleteQuery({table:e,where:r,returning:n,withList:a}){const o=this.buildWithCTE(a),c=n?W` returning ${this.buildSelection(n,{isSingleTable:!0})}`:void 0,u=r?W` where ${r}`:void 0;return W`${o}delete from ${e}${u}${c}`}buildUpdateSet(e,r){const n=e[xe.Symbol.Columns],a=Object.keys(n).filter(c=>{var u;return r[c]!==void 0||((u=n[c])==null?void 0:u.onUpdateFn)!==void 0}),o=a.length;return W.join(a.flatMap((c,u)=>{const h=n[c],f=r[c]??W.param(h.onUpdateFn(),h),m=W`${W.identifier(this.casing.getColumnCasing(h))} = ${f}`;return u<o-1?[m,W.raw(", ")]:[m]}))}buildUpdateQuery({table:e,set:r,where:n,returning:a,withList:o,from:c,joins:u}){const h=this.buildWithCTE(o),f=e[Gt.Symbol.Name],m=e[Gt.Symbol.Schema],v=e[Gt.Symbol.OriginalName],w=f===v?void 0:f,N=W`${m?W`${W.identifier(m)}.`:void 0}${W.identifier(v)}${w&&W` ${W.identifier(w)}`}`,g=this.buildUpdateSet(e,r),y=c&&W.join([W.raw(" from "),this.buildFromTable(c)]),j=this.buildJoins(u),_=a?W` returning ${this.buildSelection(a,{isSingleTable:!c})}`:void 0,b=n?W` where ${n}`:void 0;return W`${h}update ${N} set ${g}${y}${j}${b}${_}`}buildSelection(e,{isSingleTable:r=!1}={}){const n=e.length,a=e.flatMap(({field:o},c)=>{const u=[];if(oe(o,Se.Aliased)&&o.isSelectionField)u.push(W.identifier(o.fieldAlias));else if(oe(o,Se.Aliased)||oe(o,Se)){const h=oe(o,Se.Aliased)?o.sql:o;r?u.push(new Se(h.queryChunks.map(f=>oe(f,Ee)?W.identifier(this.casing.getColumnCasing(f)):f))):u.push(h),oe(o,Se.Aliased)&&u.push(W` as ${W.identifier(o.fieldAlias)}`)}else oe(o,_t)&&(r?u.push(W.identifier(this.casing.getColumnCasing(o))):u.push(o));return c<n-1&&u.push(W`, `),u});return W.join(a)}buildJoins(e){if(!e||e.length===0)return;const r=[];for(const[n,a]of e.entries()){n===0&&r.push(W` `);const o=a.table,c=a.lateral?W` lateral`:void 0,u=a.on?W` on ${a.on}`:void 0;if(oe(o,Gt)){const h=o[Gt.Symbol.Name],f=o[Gt.Symbol.Schema],m=o[Gt.Symbol.OriginalName],v=h===m?void 0:a.alias;r.push(W`${W.raw(a.joinType)} join${c} ${f?W`${W.identifier(f)}.`:void 0}${W.identifier(m)}${v&&W` ${W.identifier(v)}`}${u}`)}else if(oe(o,vs)){const h=o[jt].name,f=o[jt].schema,m=o[jt].originalName,v=h===m?void 0:a.alias;r.push(W`${W.raw(a.joinType)} join${c} ${f?W`${W.identifier(f)}.`:void 0}${W.identifier(m)}${v&&W` ${W.identifier(v)}`}${u}`)}else r.push(W`${W.raw(a.joinType)} join${c} ${o}${u}`);n<e.length-1&&r.push(W` `)}return W.join(r)}buildFromTable(e){if(oe(e,xe)&&e[xe.Symbol.IsAlias]){let r=W`${W.identifier(e[xe.Symbol.OriginalName])}`;return e[xe.Symbol.Schema]&&(r=W`${W.identifier(e[xe.Symbol.Schema])}.${r}`),W`${r} ${W.identifier(e[xe.Symbol.Name])}`}return e}buildSelectQuery({withList:e,fields:r,fieldsFlat:n,where:a,having:o,table:c,joins:u,orderBy:h,groupBy:f,limit:m,offset:v,lockingClause:w,distinct:N,setOperators:g}){const y=n??Qs(r);for(const Q of y)if(oe(Q.field,_t)&&Pn(Q.field.table)!==(oe(c,cr)?c._.alias:oe(c,Yf)?c[jt].name:oe(c,Se)?void 0:Pn(c))&&!(te=>u==null?void 0:u.some(({alias:de})=>de===(te[xe.Symbol.IsAlias]?Pn(te):te[xe.Symbol.BaseName])))(Q.field.table)){const te=Pn(Q.field.table);throw new Error(`Your "${Q.path.join("->")}" field references a column "${te}"."${Q.field.name}", but the table "${te}" is not part of the query! Did you forget to join it?`)}const j=!u||u.length===0,_=this.buildWithCTE(e);let b;N&&(b=N===!0?W` distinct`:W` distinct on (${W.join(N.on,W`, `)})`);const P=this.buildSelection(y,{isSingleTable:j}),B=this.buildFromTable(c),$=this.buildJoins(u),k=a?W` where ${a}`:void 0,I=o?W` having ${o}`:void 0;let T;h&&h.length>0&&(T=W` order by ${W.join(h,W`, `)}`);let D;f&&f.length>0&&(D=W` group by ${W.join(f,W`, `)}`);const U=typeof m=="object"||typeof m=="number"&&m>=0?W` limit ${m}`:void 0,V=v?W` offset ${v}`:void 0,z=W.empty();if(w){const Q=W` for ${W.raw(w.strength)}`;w.config.of&&Q.append(W` of ${W.join(Array.isArray(w.config.of)?w.config.of:[w.config.of],W`, `)}`),w.config.noWait?Q.append(W` nowait`):w.config.skipLocked&&Q.append(W` skip locked`),z.append(Q)}const q=W`${_}select${b} ${P} from ${B}${$}${k}${D}${I}${T}${U}${V}${z}`;return g.length>0?this.buildSetOperations(q,g):q}buildSetOperations(e,r){const[n,...a]=r;if(!n)throw new Error("Cannot pass undefined values to any set operator");return a.length===0?this.buildSetOperationQuery({leftSelect:e,setOperator:n}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:e,setOperator:n}),a)}buildSetOperationQuery({leftSelect:e,setOperator:{type:r,isAll:n,rightSelect:a,limit:o,orderBy:c,offset:u}}){const h=W`(${e.getSQL()}) `,f=W`(${a.getSQL()})`;let m;if(c&&c.length>0){const g=[];for(const y of c)if(oe(y,Ee))g.push(W.identifier(y.name));else if(oe(y,Se)){for(let j=0;j<y.queryChunks.length;j++){const _=y.queryChunks[j];oe(_,Ee)&&(y.queryChunks[j]=W.identifier(_.name))}g.push(W`${y}`)}else g.push(W`${y}`);m=W` order by ${W.join(g,W`, `)} `}const v=typeof o=="object"||typeof o=="number"&&o>=0?W` limit ${o}`:void 0,w=W.raw(`${r} ${n?"all ":""}`),N=u?W` offset ${u}`:void 0;return W`${h}${w}${f}${m}${v}${N}`}buildInsertQuery({table:e,values:r,onConflict:n,returning:a,withList:o,select:c,overridingSystemValue_:u}){const h=[],f=e[xe.Symbol.Columns],m=Object.entries(f).filter(([_,b])=>!b.shouldDisableInsert()),v=m.map(([,_])=>W.identifier(this.casing.getColumnCasing(_)));if(c){const _=r;oe(_,Se)?h.push(_):h.push(_.getSQL())}else{const _=r;h.push(W.raw("values "));for(const[b,P]of _.entries()){const B=[];for(const[$,k]of m){const I=P[$];if(I===void 0||oe(I,On)&&I.value===void 0)if(k.defaultFn!==void 0){const T=k.defaultFn(),D=oe(T,Se)?T:W.param(T,k);B.push(D)}else if(!k.default&&k.onUpdateFn!==void 0){const T=k.onUpdateFn(),D=oe(T,Se)?T:W.param(T,k);B.push(D)}else B.push(W`default`);else B.push(I)}h.push(B),b<_.length-1&&h.push(W`, `)}}const w=this.buildWithCTE(o),N=W.join(h),g=a?W` returning ${this.buildSelection(a,{isSingleTable:!0})}`:void 0,y=n?W` on conflict ${n}`:void 0,j=u===!0?W`overriding system value `:void 0;return W`${w}insert into ${e} ${v} ${j}${N}${y}${g}`}buildRefreshMaterializedViewQuery({view:e,concurrently:r,withNoData:n}){const a=r?W` concurrently`:void 0,o=n?W` with no data`:void 0;return W`refresh materialized view${a} ${e}${o}`}prepareTyping(e){return oe(e,Hf)||oe(e,qf)?"json":oe(e,Vf)?"decimal":oe(e,Qf)?"time":oe(e,Wf)||oe(e,Zf)?"timestamp":oe(e,zf)||oe(e,Ff)?"date":oe(e,Kf)?"uuid":"none"}sqlToQuery(e,r){return e.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:r})}buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:a,tableConfig:o,queryConfig:c,tableAlias:u,nestedQueryRelation:h,joinOn:f}){let m=[],v,w,N=[],g;const y=[];if(c===!0)m=Object.entries(o.columns).map(([b,P])=>({dbKey:P.name,tsKey:b,field:bn(P,u),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{const _=Object.fromEntries(Object.entries(o.columns).map(([I,T])=>[I,bn(T,u)]));if(c.where){const I=typeof c.where=="function"?c.where(_,oT()):c.where;g=I&&uc(I,u)}const b=[];let P=[];if(c.columns){let I=!1;for(const[T,D]of Object.entries(c.columns))D!==void 0&&T in o.columns&&(!I&&D===!0&&(I=!0),P.push(T));P.length>0&&(P=I?P.filter(T=>{var D;return((D=c.columns)==null?void 0:D[T])===!0}):Object.keys(o.columns).filter(T=>!P.includes(T)))}else P=Object.keys(o.columns);for(const I of P){const T=o.columns[I];b.push({tsKey:I,value:T})}let B=[];c.with&&(B=Object.entries(c.with).filter(I=>!!I[1]).map(([I,T])=>({tsKey:I,queryConfig:T,relation:o.relations[I]})));let $;if(c.extras){$=typeof c.extras=="function"?c.extras(_,{sql:W}):c.extras;for(const[I,T]of Object.entries($))b.push({tsKey:I,value:PN(T,u)})}for(const{tsKey:I,value:T}of b)m.push({dbKey:oe(T,Se.Aliased)?T.fieldAlias:o.columns[I].name,tsKey:I,field:oe(T,_t)?bn(T,u):T,relationTableTsKey:void 0,isJson:!1,selection:[]});let k=typeof c.orderBy=="function"?c.orderBy(_,lT()):c.orderBy??[];Array.isArray(k)||(k=[k]),N=k.map(I=>oe(I,_t)?bn(I,u):uc(I,u)),v=c.limit,w=c.offset;for(const{tsKey:I,queryConfig:T,relation:D}of B){const U=hT(r,n,D),V=fo(D.referencedTable),z=n[V],q=`${u}_${I}`,Q=dc(...U.fields.map((re,Z)=>Le(bn(U.references[Z],q),bn(re,u)))),te=this.buildRelationalQueryWithoutPK({fullSchema:e,schema:r,tableNamesMap:n,table:e[z],tableConfig:r[z],queryConfig:oe(D,Ws)?T===!0?{limit:1}:{...T,limit:1}:T,tableAlias:q,joinOn:Q,nestedQueryRelation:D}),de=W`${W.identifier(q)}.${W.identifier("data")}`.as(I);y.push({on:W`true`,table:new cr(te.sql,{},q),alias:q,joinType:"left",lateral:!0}),m.push({dbKey:I,tsKey:I,field:de,relationTableTsKey:z,isJson:!0,selection:te.selection})}}if(m.length===0)throw new X2({message:`No fields selected for table "${o.tsName}" ("${u}")`});let j;if(g=dc(f,g),h){let _=W`json_build_array(${W.join(m.map(({field:B,tsKey:$,isJson:k})=>k?W`${W.identifier(`${u}_${$}`)}.${W.identifier("data")}`:oe(B,Se.Aliased)?B.sql:B),W`, `)})`;oe(h,hc)&&(_=W`coalesce(json_agg(${_}${N.length>0?W` order by ${W.join(N,W`, `)}`:void 0}), '[]'::json)`);const b=[{dbKey:"data",tsKey:"data",field:_.as("data"),isJson:!0,relationTableTsKey:o.tsName,selection:m}];v!==void 0||w!==void 0||N.length>0?(j=this.buildSelectQuery({table:ld(a,u),fields:{},fieldsFlat:[{path:[],field:W.raw("*")}],where:g,limit:v,offset:w,orderBy:N,setOperators:[]}),g=void 0,v=void 0,w=void 0,N=[]):j=ld(a,u),j=this.buildSelectQuery({table:oe(j,Gt)?j:new cr(j,{},u),fields:{},fieldsFlat:b.map(({field:B})=>({path:[],field:oe(B,_t)?bn(B,u):B})),joins:y,where:g,limit:v,offset:w,orderBy:N,setOperators:[]})}else j=this.buildSelectQuery({table:ld(a,u),fields:{},fieldsFlat:m.map(({field:_})=>({path:[],field:oe(_,_t)?bn(_,u):_})),joins:y,where:g,limit:v,offset:w,orderBy:N,setOperators:[]});return{tableTsKey:o.tsName,sql:j,selection:m}}}O(qa,ow,"PgDialect");var lw;lw=J;class rj{getSelectedFields(){return this._.selectedFields}}O(rj,lw,"TypedQueryBuilder");var cw;cw=J;class gr{constructor(e){O(this,"fields");O(this,"session");O(this,"dialect");O(this,"withList",[]);O(this,"distinct");O(this,"authToken");this.fields=e.fields,this.session=e.session,this.dialect=e.dialect,e.withList&&(this.withList=e.withList),this.distinct=e.distinct}setToken(e){return this.authToken=e,this}from(e){const r=!!this.fields,n=e;let a;return this.fields?a=this.fields:oe(n,cr)?a=Object.fromEntries(Object.keys(n._.selectedFields).map(o=>[o,n[o]])):oe(n,Yf)?a=n[jt].selectedFields:oe(n,Se)?a={}:a=u3(n),new Jf({table:n,fields:a,isPartialSelect:r,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}O(gr,cw,"PgSelectBuilder");var uw,dw;class nj extends(dw=rj,uw=J,dw){constructor({table:r,fields:n,isPartialSelect:a,session:o,dialect:c,withList:u,distinct:h}){super();O(this,"_");O(this,"config");O(this,"joinsNotNullableMap");O(this,"tableName");O(this,"isPartialSelect");O(this,"session");O(this,"dialect");O(this,"cacheConfig");O(this,"usedTables",new Set);O(this,"leftJoin",this.createJoin("left",!1));O(this,"leftJoinLateral",this.createJoin("left",!0));O(this,"rightJoin",this.createJoin("right",!1));O(this,"innerJoin",this.createJoin("inner",!1));O(this,"innerJoinLateral",this.createJoin("inner",!0));O(this,"fullJoin",this.createJoin("full",!1));O(this,"crossJoin",this.createJoin("cross",!1));O(this,"crossJoinLateral",this.createJoin("cross",!0));O(this,"union",this.createSetOperator("union",!1));O(this,"unionAll",this.createSetOperator("union",!0));O(this,"intersect",this.createSetOperator("intersect",!1));O(this,"intersectAll",this.createSetOperator("intersect",!0));O(this,"except",this.createSetOperator("except",!1));O(this,"exceptAll",this.createSetOperator("except",!0));this.config={withList:u,table:r,fields:{...n},distinct:h,setOperators:[]},this.isPartialSelect=a,this.session=o,this.dialect=c,this._={selectedFields:n,config:this.config},this.tableName=As(r),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{};for(const f of Rs(r))this.usedTables.add(f)}getUsedTables(){return[...this.usedTables]}createJoin(r,n){return(a,o)=>{var h;const c=this.tableName,u=As(a);for(const f of Rs(a))this.usedTables.add(f);if(typeof u=="string"&&((h=this.config.joins)!=null&&h.some(f=>f.alias===u)))throw new Error(`Alias "${u}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof c=="string"&&(this.config.fields={[c]:this.config.fields}),typeof u=="string"&&!oe(a,Se))){const f=oe(a,cr)?a._.selectedFields:oe(a,vs)?a[jt].selectedFields:a[xe.Symbol.Columns];this.config.fields[u]=f}if(typeof o=="function"&&(o=o(new Proxy(this.config.fields,new qt({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:o,table:a,joinType:r,alias:u,lateral:n}),typeof u=="string")switch(r){case"left":{this.joinsNotNullableMap[u]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([f])=>[f,!1])),this.joinsNotNullableMap[u]=!0;break}case"cross":case"inner":{this.joinsNotNullableMap[u]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([f])=>[f,!1])),this.joinsNotNullableMap[u]=!1;break}}return this}}createSetOperator(r,n){return a=>{const o=typeof a=="function"?a(mT()):a;if(!$f(this.getSelectedFields(),o.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:r,isAll:n,rightSelect:o}),this}}addSetOperators(r){return this.config.setOperators.push(...r),this}where(r){return typeof r=="function"&&(r=r(new Proxy(this.config.fields,new qt({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=r,this}having(r){return typeof r=="function"&&(r=r(new Proxy(this.config.fields,new qt({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=r,this}groupBy(...r){if(typeof r[0]=="function"){const n=r[0](new Proxy(this.config.fields,new qt({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(n)?n:[n]}else this.config.groupBy=r;return this}orderBy(...r){if(typeof r[0]=="function"){const n=r[0](new Proxy(this.config.fields,new qt({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),a=Array.isArray(n)?n:[n];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=a:this.config.orderBy=a}else{const n=r;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}return this}limit(r){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=r:this.config.limit=r,this}offset(r){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=r:this.config.offset=r,this}for(r,n={}){return this.config.lockingClause={strength:r,config:n},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){const{typings:r,...n}=this.dialect.sqlToQuery(this.getSQL());return n}as(r){const n=[];if(n.push(...Rs(this.config.table)),this.config.joins)for(const a of this.config.joins)n.push(...Rs(a.table));return new Proxy(new cr(this.getSQL(),this.config.fields,r,!1,[...new Set(n)]),new qt({alias:r,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new qt({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}$withCache(r){return this.cacheConfig=r===void 0?{config:{},enable:!0,autoInvalidate:!0}:r===!1?{enable:!1}:{enable:!0,autoInvalidate:!0,...r},this}}O(nj,uw,"PgSelectQueryBuilder");var hw,fw;class Jf extends(fw=nj,hw=J,fw){constructor(){super(...arguments);O(this,"authToken");O(this,"execute",r=>wr.startActiveSpan("drizzle.operation",()=>this._prepare().execute(r,this.authToken)))}_prepare(r){const{session:n,config:a,dialect:o,joinsNotNullableMap:c,authToken:u,cacheConfig:h,usedTables:f}=this;if(!n)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");const{fields:m}=a;return wr.startActiveSpan("drizzle.prepareQuery",()=>{const v=Qs(m),w=n.prepareQuery(o.sqlToQuery(this.getSQL()),v,r,!0,void 0,{type:"select",tables:[...f]},h);return w.joinsNotNullableMap=c,w.setToken(u)})}prepare(r){return this._prepare(r)}setToken(r){return this.authToken=r,this}}O(Jf,hw,"PgSelect");c3(Jf,[xs]);function Ji(t,e){return(r,n,...a)=>{const o=[n,...a].map(c=>({type:t,isAll:e,rightSelect:c}));for(const c of o)if(!$f(r.getSelectedFields(),c.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return r.addSetOperators(o)}}const mT=()=>({union:pT,unionAll:gT,intersect:yT,intersectAll:xT,except:vT,exceptAll:wT}),pT=Ji("union",!1),gT=Ji("union",!0),yT=Ji("intersect",!1),xT=Ji("intersect",!0),vT=Ji("except",!1),wT=Ji("except",!0);var mw;mw=J;class Xf{constructor(e){O(this,"dialect");O(this,"dialectConfig");O(this,"$with",(e,r)=>{const n=this;return{as:o=>(typeof o=="function"&&(o=o(n)),new Proxy(new Bf(o.getSQL(),r??("getSelectedFields"in o?o.getSelectedFields()??{}:{}),e,!0),new qt({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}});this.dialect=oe(e,qa)?e:void 0,this.dialectConfig=oe(e,qa)?void 0:e}with(...e){const r=this;function n(c){return new gr({fields:c??void 0,session:void 0,dialect:r.getDialect(),withList:e})}function a(c){return new gr({fields:c??void 0,session:void 0,dialect:r.getDialect(),distinct:!0})}function o(c,u){return new gr({fields:u??void 0,session:void 0,dialect:r.getDialect(),distinct:{on:c}})}return{select:n,selectDistinct:a,selectDistinctOn:o}}select(e){return new gr({fields:e??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(e){return new gr({fields:e??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(e,r){return new gr({fields:r??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:e}})}getDialect(){return this.dialect||(this.dialect=new qa(this.dialectConfig)),this.dialect}}O(Xf,mw,"PgQueryBuilder");function Rs(t){return oe(t,Gt)?[t[Ii]?`${t[Ii]}.${t[xe.Symbol.BaseName]}`:t[xe.Symbol.BaseName]]:oe(t,cr)?t._.usedTables??[]:oe(t,Se)?t.usedTables??[]:[]}var pw,gw;class hh extends(gw=xs,pw=J,gw){constructor(r,n,a,o){super();O(this,"config");O(this,"cacheConfig");O(this,"authToken");O(this,"execute",r=>wr.startActiveSpan("drizzle.operation",()=>this._prepare().execute(r,this.authToken)));this.session=n,this.dialect=a,this.config={table:r,withList:o}}where(r){return this.config.where=r,this}returning(r=this.config.table[xe.Symbol.Columns]){return this.config.returningFields=r,this.config.returning=Qs(r),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){const{typings:r,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(r){return wr.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,r,!0,void 0,{type:"delete",tables:Rs(this.config.table)},this.cacheConfig))}prepare(r){return this._prepare(r)}setToken(r){return this.authToken=r,this}getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new qt({alias:Pn(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}O(hh,pw,"PgDelete");var yw;yw=J;class fh{constructor(e,r,n,a,o){O(this,"authToken");this.table=e,this.session=r,this.dialect=n,this.withList=a,this.overridingSystemValue_=o}setToken(e){return this.authToken=e,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(e){if(e=Array.isArray(e)?e:[e],e.length===0)throw new Error("values() must be called with at least one value");const r=e.map(n=>{const a={},o=this.table[xe.Symbol.Columns];for(const c of Object.keys(n)){const u=n[c];a[c]=oe(u,Se)?u:new On(u,o[c])}return a});return new mh(this.table,r,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(e){const r=typeof e=="function"?e(new Xf):e;if(!oe(r,Se)&&!$f(this.table[ch],r._.selectedFields))throw new Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new mh(this.table,r,this.session,this.dialect,this.withList,!0)}}O(fh,yw,"PgInsertBuilder");var xw,vw;class mh extends(vw=xs,xw=J,vw){constructor(r,n,a,o,c,u,h){super();O(this,"config");O(this,"cacheConfig");O(this,"authToken");O(this,"execute",r=>wr.startActiveSpan("drizzle.operation",()=>this._prepare().execute(r,this.authToken)));this.session=a,this.dialect=o,this.config={table:r,values:n,withList:c,select:u,overridingSystemValue_:h}}returning(r=this.config.table[xe.Symbol.Columns]){return this.config.returningFields=r,this.config.returning=Qs(r),this}onConflictDoNothing(r={}){if(r.target===void 0)this.config.onConflict=W`do nothing`;else{let n="";n=Array.isArray(r.target)?r.target.map(o=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(o))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(r.target));const a=r.where?W` where ${r.where}`:void 0;this.config.onConflict=W`(${W.raw(n)})${a} do nothing`}return this}onConflictDoUpdate(r){if(r.where&&(r.targetWhere||r.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');const n=r.where?W` where ${r.where}`:void 0,a=r.targetWhere?W` where ${r.targetWhere}`:void 0,o=r.setWhere?W` where ${r.setWhere}`:void 0,c=this.dialect.buildUpdateSet(this.config.table,kN(this.config.table,r.set));let u="";return u=Array.isArray(r.target)?r.target.map(h=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(h))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(r.target)),this.config.onConflict=W`(${W.raw(u)})${a} do update set ${c}${n}${o}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){const{typings:r,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(r){return wr.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,r,!0,void 0,{type:"insert",tables:Rs(this.config.table)},this.cacheConfig))}prepare(r){return this._prepare(r)}setToken(r){return this.authToken=r,this}getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new qt({alias:Pn(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}O(mh,xw,"PgInsert");var ww,bw;class sj extends(bw=xs,ww=J,bw){constructor(r,n,a){super();O(this,"config");O(this,"authToken");O(this,"execute",r=>wr.startActiveSpan("drizzle.operation",()=>this._prepare().execute(r,this.authToken)));this.session=n,this.dialect=a,this.config={view:r}}concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){const{typings:r,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(r){return wr.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,r,!0))}prepare(r){return this._prepare(r)}setToken(r){return this.authToken=r,this}}O(sj,ww,"PgRefreshMaterializedView");var _w;_w=J;class ph{constructor(e,r,n,a){O(this,"authToken");this.table=e,this.session=r,this.dialect=n,this.withList=a}setToken(e){return this.authToken=e,this}set(e){return new ij(this.table,kN(this.table,e),this.session,this.dialect,this.withList).setToken(this.authToken)}}O(ph,_w,"PgUpdateBuilder");var Nw,jw;class ij extends(jw=xs,Nw=J,jw){constructor(r,n,a,o,c){super();O(this,"config");O(this,"tableName");O(this,"joinsNotNullableMap");O(this,"cacheConfig");O(this,"leftJoin",this.createJoin("left"));O(this,"rightJoin",this.createJoin("right"));O(this,"innerJoin",this.createJoin("inner"));O(this,"fullJoin",this.createJoin("full"));O(this,"authToken");O(this,"execute",r=>this._prepare().execute(r,this.authToken));this.session=a,this.dialect=o,this.config={set:n,table:r,withList:c,joins:[]},this.tableName=As(r),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}from(r){const n=r,a=As(n);return typeof a=="string"&&(this.joinsNotNullableMap[a]=!0),this.config.from=n,this}getTableLikeFields(r){return oe(r,Gt)?r[xe.Symbol.Columns]:oe(r,cr)?r._.selectedFields:r[jt].selectedFields}createJoin(r){return(n,a)=>{const o=As(n);if(typeof o=="string"&&this.config.joins.some(c=>c.alias===o))throw new Error(`Alias "${o}" is already used in this query`);if(typeof a=="function"){const c=this.config.from&&!oe(this.config.from,Se)?this.getTableLikeFields(this.config.from):void 0;a=a(new Proxy(this.config.table[xe.Symbol.Columns],new qt({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),c&&new Proxy(c,new qt({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:a,table:n,joinType:r,alias:o}),typeof o=="string")switch(r){case"left":{this.joinsNotNullableMap[o]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([c])=>[c,!1])),this.joinsNotNullableMap[o]=!0;break}case"inner":{this.joinsNotNullableMap[o]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([c])=>[c,!1])),this.joinsNotNullableMap[o]=!1;break}}return this}}where(r){return this.config.where=r,this}returning(r){if(!r&&(r=Object.assign({},this.config.table[xe.Symbol.Columns]),this.config.from)){const n=As(this.config.from);if(typeof n=="string"&&this.config.from&&!oe(this.config.from,Se)){const a=this.getTableLikeFields(this.config.from);r[n]=a}for(const a of this.config.joins){const o=As(a.table);if(typeof o=="string"&&!oe(a.table,Se)){const c=this.getTableLikeFields(a.table);r[o]=c}}}return this.config.returningFields=r,this.config.returning=Qs(r),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){const{typings:r,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(r){const n=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,r,!0,void 0,{type:"insert",tables:Rs(this.config.table)},this.cacheConfig);return n.joinsNotNullableMap=this.joinsNotNullableMap,n}prepare(r){return this._prepare(r)}setToken(r){return this.authToken=r,this}getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new qt({alias:Pn(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}O(ij,Nw,"PgUpdate");var Sw,Cw,Pw;const Va=class Va extends(Pw=Se,Cw=J,Sw=Symbol.toStringTag,Pw){constructor(r){super(Va.buildEmbeddedCount(r.source,r.filters).queryChunks);O(this,"sql");O(this,"token");O(this,Sw,"PgCountBuilder");O(this,"session");this.params=r,this.mapWith(Number),this.session=r.session,this.sql=Va.buildCount(r.source,r.filters)}static buildEmbeddedCount(r,n){return W`(select count(*) from ${r}${W.raw(" where ").if(n)}${n})`}static buildCount(r,n){return W`select count(*) as count from ${r}${W.raw(" where ").if(n)}${n};`}setToken(r){return this.token=r,this}then(r,n){return Promise.resolve(this.session.count(this.sql,this.token)).then(r,n)}catch(r){return this.then(void 0,r)}finally(r){return this.then(n=>(r==null||r(),n),n=>{throw r==null||r(),n})}};O(Va,Cw,"PgCountBuilder");let gh=Va;var kw;kw=J;class aj{constructor(e,r,n,a,o,c,u){this.fullSchema=e,this.schema=r,this.tableNamesMap=n,this.table=a,this.tableConfig=o,this.dialect=c,this.session=u}findMany(e){return new yh(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e||{},"many")}findFirst(e){return new yh(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,e?{...e,limit:1}:{limit:1},"first")}}O(aj,kw,"PgRelationalQueryBuilder");var Tw,Ew;class yh extends(Ew=xs,Tw=J,Ew){constructor(r,n,a,o,c,u,h,f,m){super();O(this,"authToken");this.fullSchema=r,this.schema=n,this.tableNamesMap=a,this.table=o,this.tableConfig=c,this.dialect=u,this.session=h,this.config=f,this.mode=m}_prepare(r){return wr.startActiveSpan("drizzle.prepareQuery",()=>{const{query:n,builtQuery:a}=this._toSQL();return this.session.prepareQuery(a,void 0,r,!0,(o,c)=>{const u=o.map(h=>dh(this.schema,this.tableConfig,h,n.selection,c));return this.mode==="first"?u[0]:u})})}prepare(r){return this._prepare(r)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){const r=this._getQuery(),n=this.dialect.sqlToQuery(r.sql);return{query:r,builtQuery:n}}toSQL(){return this._toSQL().builtQuery}setToken(r){return this.authToken=r,this}execute(){return wr.startActiveSpan("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}}O(yh,Tw,"PgRelationalQuery");var Lw,Aw;class oj extends(Aw=xs,Lw=J,Aw){constructor(e,r,n,a){super(),this.execute=e,this.sql=r,this.query=n,this.mapBatchResult=a}getSQL(){return this.sql}getQuery(){return this.query}mapResult(e,r){return r?this.mapBatchResult(e):e}_prepare(){return this}isResponseInArrayMode(){return!1}}O(oj,Lw,"PgRaw");var Mw;Mw=J;class lj{constructor(e,r,n){O(this,"query");O(this,"$with",(e,r)=>{const n=this;return{as:o=>(typeof o=="function"&&(o=o(new Xf(n.dialect))),new Proxy(new Bf(o.getSQL(),r??("getSelectedFields"in o?o.getSelectedFields()??{}:{}),e,!0),new qt({alias:e,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}});O(this,"$cache");O(this,"authToken");if(this.dialect=e,this.session=r,this._=n?{schema:n.schema,fullSchema:n.fullSchema,tableNamesMap:n.tableNamesMap,session:r}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:r},this.query={},this._.schema)for(const[a,o]of Object.entries(this._.schema))this.query[a]=new aj(n.fullSchema,this._.schema,this._.tableNamesMap,n.fullSchema[a],o,e,r);this.$cache={invalidate:async a=>{}}}$count(e,r){return new gh({source:e,filters:r,session:this.session})}with(...e){const r=this;function n(f){return new gr({fields:f??void 0,session:r.session,dialect:r.dialect,withList:e})}function a(f){return new gr({fields:f??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:!0})}function o(f,m){return new gr({fields:m??void 0,session:r.session,dialect:r.dialect,withList:e,distinct:{on:f}})}function c(f){return new ph(f,r.session,r.dialect,e)}function u(f){return new fh(f,r.session,r.dialect,e)}function h(f){return new hh(f,r.session,r.dialect,e)}return{select:n,selectDistinct:a,selectDistinctOn:o,update:c,insert:u,delete:h}}select(e){return new gr({fields:e??void 0,session:this.session,dialect:this.dialect})}selectDistinct(e){return new gr({fields:e??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(e,r){return new gr({fields:r??void 0,session:this.session,dialect:this.dialect,distinct:{on:e}})}update(e){return new ph(e,this.session,this.dialect)}insert(e){return new fh(e,this.session,this.dialect)}delete(e){return new hh(e,this.session,this.dialect)}refreshMaterializedView(e){return new sj(e,this.session,this.dialect)}execute(e){const r=typeof e=="string"?W.raw(e):e.getSQL(),n=this.dialect.sqlToQuery(r),a=this.session.prepareQuery(n,void 0,void 0,!1);return new oj(()=>a.execute(void 0,this.authToken),r,n,o=>a.mapResult(o,!0))}transaction(e,r){return this.session.transaction(e,r)}}O(lj,Mw,"PgDatabase");var Iw;Iw=J;class cj{}O(cj,Iw,"Cache");var Dw,Ow;class em extends(Ow=cj,Dw=J,Ow){strategy(){return"all"}async get(e){}async put(e,r,n,a){}async onMutate(e){}}O(em,Dw,"NoopCache");async function Ag(t,e){const r=`${t}-${JSON.stringify(e)}`,a=new TextEncoder().encode(r),o=await crypto.subtle.digest("SHA-256",a);return[...new Uint8Array(o)].map(h=>h.toString(16).padStart(2,"0")).join("")}var Rw;Rw=J;class uj{constructor(e,r,n,a){O(this,"authToken");O(this,"joinsNotNullableMap");var o;this.query=e,this.cache=r,this.queryMetadata=n,this.cacheConfig=a,r&&r.strategy()==="all"&&a===void 0&&(this.cacheConfig={enable:!0,autoInvalidate:!0}),(o=this.cacheConfig)!=null&&o.enable||(this.cacheConfig=void 0)}getQuery(){return this.query}mapResult(e,r){return e}setToken(e){return this.authToken=e,this}async queryWithCache(e,r,n){if(this.cache===void 0||oe(this.cache,em)||this.queryMetadata===void 0)try{return await n()}catch(a){throw new Zn(e,r,a)}if(this.cacheConfig&&!this.cacheConfig.enable)try{return await n()}catch(a){throw new Zn(e,r,a)}if((this.queryMetadata.type==="insert"||this.queryMetadata.type==="update"||this.queryMetadata.type==="delete")&&this.queryMetadata.tables.length>0)try{const[a]=await Promise.all([n(),this.cache.onMutate({tables:this.queryMetadata.tables})]);return a}catch(a){throw new Zn(e,r,a)}if(!this.cacheConfig)try{return await n()}catch(a){throw new Zn(e,r,a)}if(this.queryMetadata.type==="select"){const a=await this.cache.get(this.cacheConfig.tag??await Ag(e,r),this.queryMetadata.tables,this.cacheConfig.tag!==void 0,this.cacheConfig.autoInvalidate);if(a===void 0){let o;try{o=await n()}catch(c){throw new Zn(e,r,c)}return await this.cache.put(this.cacheConfig.tag??await Ag(e,r),o,this.cacheConfig.autoInvalidate?this.queryMetadata.tables:[],this.cacheConfig.tag!==void 0,this.cacheConfig.config),o}return a}try{return await n()}catch(a){throw new Zn(e,r,a)}}}O(uj,Rw,"PgPreparedQuery");var Bw;Bw=J;class dj{constructor(e){this.dialect=e}execute(e,r){return wr.startActiveSpan("drizzle.operation",()=>wr.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1)).setToken(r).execute(void 0,r))}all(e){return this.prepareQuery(this.dialect.sqlToQuery(e),void 0,void 0,!1).all()}async count(e,r){const n=await this.execute(e,r);return Number(n[0].count)}}O(dj,Bw,"PgSession");const pl={arrayMode:!1,fullResults:!0},xh={arrayMode:!0,fullResults:!0};var $w,zw;class hj extends(zw=uj,$w=J,zw){constructor(r,n,a,o,c,u,h,f,m){super(n,o,c,u);O(this,"clientQuery");this.client=r,this.logger=a,this.fields=h,this._isResponseInArrayMode=f,this.customResultMapper=m,this.clientQuery=r.query??r}async execute(r={},n=this.authToken){const a=od(this.query.params,r);this.logger.logQuery(this.query.sql,a);const{fields:o,clientQuery:c,query:u,customResultMapper:h}=this;if(!o&&!h)return this.queryWithCache(u.sql,a,async()=>c(u.sql,a,n===void 0?pl:{...pl,authToken:n}));const f=await this.queryWithCache(u.sql,a,async()=>await c(u.sql,a,n===void 0?xh:{...xh,authToken:n}));return this.mapResult(f)}mapResult(r){if(!this.fields&&!this.customResultMapper)return r;const n=r.rows;return this.customResultMapper?this.customResultMapper(n):n.map(a=>l3(this.fields,a,this.joinsNotNullableMap))}all(r={}){const n=od(this.query.params,r);return this.logger.logQuery(this.query.sql,n),this.clientQuery(this.query.sql,n,this.authToken===void 0?pl:{...pl,authToken:this.authToken}).then(a=>a.rows)}values(r={},n){const a=od(this.query.params,r);return this.logger.logQuery(this.query.sql,a),this.clientQuery(this.query.sql,a,{arrayMode:!0,fullResults:!0,authToken:n}).then(o=>o.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}}O(hj,$w,"NeonHttpPreparedQuery");var Fw,Uw;class fj extends(Uw=dj,Fw=J,Uw){constructor(r,n,a,o={}){super(n);O(this,"clientQuery");O(this,"logger");O(this,"cache");this.client=r,this.schema=a,this.options=o,this.clientQuery=r.query??r,this.logger=o.logger??new gN,this.cache=o.cache??new em}prepareQuery(r,n,a,o,c,u,h){return new hj(this.client,r,this.logger,this.cache,u,h,n,o,c)}async batch(r){const n=[],a=[];for(const c of r){const u=c._prepare(),h=u.getQuery();n.push(u),a.push(this.clientQuery(h.sql,h.params,{fullResults:!0,arrayMode:u.isResponseInArrayMode()}))}return(await this.client.transaction(a,xh)).map((c,u)=>n[u].mapResult(c,!0))}async query(r,n){return this.logger.logQuery(r,n),await this.clientQuery(r,n,{arrayMode:!0,fullResults:!0})}async queryObjects(r,n){return this.clientQuery(r,n,{arrayMode:!1,fullResults:!0})}async count(r,n){const a=await this.execute(r,n);return Number(a.rows[0].count)}async transaction(r,n={}){throw new Error("No transactions support in neon-http driver")}}O(fj,Fw,"NeonHttpSession");var qw;qw=J;class mj{constructor(e,r,n={}){this.client=e,this.dialect=r,this.options=n,this.initMappers()}createSession(e){return new fj(this.client,this.dialect,e,{logger:this.options.logger,cache:this.options.cache})}initMappers(){mr.setTypeParser(mr.builtins.TIMESTAMPTZ,e=>e),mr.setTypeParser(mr.builtins.TIMESTAMP,e=>e),mr.setTypeParser(mr.builtins.DATE,e=>e),mr.setTypeParser(mr.builtins.INTERVAL,e=>e),mr.setTypeParser(1231,e=>e),mr.setTypeParser(1115,e=>e),mr.setTypeParser(1185,e=>e),mr.setTypeParser(1187,e=>e),mr.setTypeParser(1182,e=>e)}}O(mj,qw,"NeonHttpDriver");function fc(t,e,r,n){return new Proxy(t,{get(a,o){const c=a[o];return typeof c!="function"&&(typeof c!="object"||c===null)?c:n?fc(c,e,r):o==="query"?fc(c,e,r,!0):new Proxy(c,{apply(u,h,f){const m=u.call(h,...f);return typeof m=="object"&&m!==null&&"setToken"in m&&typeof m.setToken=="function"&&m.setToken(e),r(u,o,m)}})}})}var Hw,Vw;class pj extends(Vw=lj,Hw=J,Vw){$withAuth(e){return this.authToken=e,fc(this,e,(r,n,a)=>n==="with"?fc(a,e,(o,c,u)=>u):a)}async batch(e){return this.session.batch(e)}}O(pj,Hw,"NeonHttpDatabase");function di(t,e={}){var h;const r=new qa({casing:e.casing});let n;e.logger===!0?n=new pN:e.logger!==!1&&(n=e.logger);let a;if(e.schema){const f=cT(e.schema,fT);a={fullSchema:e.schema,schema:f.tables,tableNamesMap:f.tableNamesMap}}const c=new mj(t,r,{logger:n,cache:e.cache}).createSession(a),u=new pj(r,c,a);return u.$client=t,u.$cache=e.cache,u.$cache&&(u.$cache.invalidate=(h=e.cache)==null?void 0:h.onMutate),u}function vh(...t){if(typeof t[0]=="string"){const e=Mi(t[0]);return di(e,t[1])}if(d3(t[0])){const{connection:e,client:r,...n}=t[0];if(r)return di(r,n);if(typeof e=="object"){const{connectionString:o,...c}=e,u=Mi(o,c);return di(u,n)}const a=Mi(e);return di(a,n)}return di(t[0],t[1])}(t=>{function e(r){return di({},r)}t.mock=e})(vh||(vh={}));const Fe=Bt("users",{id:be("id").primaryKey(),email:ve("email",{length:255}).notNull().unique(),password:ve("password",{length:255}).notNull(),name:ve("name",{length:255}).notNull(),role:ve("role",{length:50}).notNull(),branchId:be("branch_id"),professionalInfo:Ze("professional_info"),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),gj=Bt("shippers",{id:be("id").primaryKey(),userId:be("user_id").notNull().references(()=>Fe.id),name:ve("name",{length:255}).notNull(),email:ve("email",{length:255}).notNull(),phone:ve("phone",{length:20}).notNull(),vehicleType:ve("vehicle_type",{length:50}).notNull(),vehicleNumber:ve("vehicle_number",{length:20}).notNull(),licenseNumber:ve("license_number",{length:50}).notNull(),currentLocation:Ze("current_location"),isAvailable:un("is_available").default(!0),rating:mt("rating",{precision:3,scale:2}).default("5.00"),totalDeliveries:Xt("total_deliveries").default(0),branchId:be("branch_id"),emergencyContact:Ze("emergency_contact"),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),yj=Bt("branches",{id:be("id").primaryKey(),name:ve("name",{length:255}).notNull(),address:be("address").notNull(),city:ve("city",{length:100}).notNull(),province:ve("province",{length:100}).notNull(),postalCode:ve("postal_code",{length:10}),phone:ve("phone",{length:20}).notNull(),email:ve("email",{length:255}),location:Ze("location"),operatingHours:Ze("operating_hours"),managerId:be("manager_id").references(()=>Fe.id),isActive:un("is_active").default(!0),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),tt=Bt("customers",{id:be("id").primaryKey(),name:ve("name",{length:255}).notNull(),email:ve("email",{length:255}).notNull().unique(),phone:ve("phone",{length:20}).notNull(),address:be("address").notNull(),dateOfBirth:Uf("date_of_birth").notNull(),allergies:Ze("allergies").$type().default([]),prescriptionHistory:Ze("prescription_history").$type().default([]),orderHistory:Ze("order_history").$type().default([]),healthStatus:Ze("health_status"),membershipTier:ve("membership_tier",{length:20}).default("bronze"),joinDate:ke("join_date").defaultNow(),totalSpent:mt("total_spent",{precision:12,scale:2}).default("0"),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),Zt=Bt("products",{id:be("id").primaryKey(),name:ve("name",{length:255}).notNull(),description:be("description"),category:ve("category",{length:100}).notNull(),price:mt("price",{precision:10,scale:2}).notNull(),stock:Xt("stock").notNull(),minStock:Xt("min_stock").notNull(),manufacturer:ve("manufacturer",{length:255}).notNull(),expiryDate:Uf("expiry_date").notNull(),requiresPrescription:un("requires_prescription").default(!1),batchNumber:ve("batch_number",{length:100}).notNull(),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),Tr=Bt("prescriptions",{id:be("id").primaryKey(),customerId:be("customer_id").notNull().references(()=>tt.id),customerName:ve("customer_name",{length:255}).notNull(),pharmacistId:be("pharmacist_id").references(()=>Fe.id),pharmacistName:ve("pharmacist_name",{length:255}),medications:Ze("medications"),status:ve("status",{length:20}).notNull().default("pending"),uploadDate:ke("upload_date").defaultNow(),validationDate:ke("validation_date"),notes:be("notes"),imageUrl:be("image_url"),totalAmount:mt("total_amount",{precision:10,scale:2}),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),Ut=Bt("orders",{id:be("id").primaryKey(),customerId:be("customer_id").notNull().references(()=>tt.id),customerName:ve("customer_name",{length:255}).notNull(),items:Ze("items"),total:mt("total",{precision:10,scale:2}).notNull(),status:ve("status",{length:20}).notNull().default("pending"),orderDate:ke("order_date").defaultNow(),shippingAddress:be("shipping_address").notNull(),paymentMethod:ve("payment_method",{length:20}).notNull(),paymentStatus:ve("payment_status",{length:20}).notNull().default("pending"),trackingNumber:ve("tracking_number",{length:100}),deliveryDate:ke("delivery_date"),assignedShipperId:be("assigned_shipper_id").references(()=>gj.id),assignedAt:ke("assigned_at"),assignedBy:be("assigned_by").references(()=>Fe.id),originBranchId:be("origin_branch_id").references(()=>yj.id),destinationLocation:Ze("destination_location"),routeData:Ze("route_data"),estimatedDistance:mt("estimated_distance",{precision:8,scale:2}),estimatedDuration:Xt("estimated_duration"),shippingInfo:Ze("shipping_info"),estimatedDelivery:ke("estimated_delivery"),actualDelivery:ke("actual_delivery"),shipperLocation:Ze("shipper_location"),trackingHistory:Ze("tracking_history"),deliveryProof:Ze("delivery_proof"),customerRating:Xt("customer_rating"),deliveryNotes:be("delivery_notes"),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),Es=Bt("notifications",{id:be("id").primaryKey(),userId:be("user_id").notNull().references(()=>Fe.id),type:ve("type",{length:20}).notNull(),title:ve("title",{length:255}).notNull(),message:be("message").notNull(),read:un("read").default(!1),actionUrl:be("action_url"),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),Al=Bt("activity_logs",{id:be("id").primaryKey(),userId:be("user_id").references(()=>Fe.id),action:ve("action",{length:255}).notNull(),entityType:ve("entity_type",{length:50}).notNull(),entityId:be("entity_id"),details:Ze("details"),ipAddress:ve("ip_address",{length:45}),userAgent:be("user_agent"),createdAt:ke("created_at").defaultNow()}),xj=Bt("inventory_transactions",{id:be("id").primaryKey(),productId:be("product_id").notNull().references(()=>Zt.id),type:ve("type",{length:20}).notNull(),quantity:Xt("quantity").notNull(),previousStock:Xt("previous_stock").notNull(),newStock:Xt("new_stock").notNull(),reason:ve("reason",{length:255}),userId:be("user_id").references(()=>Fe.id),createdAt:ke("created_at").defaultNow()}),bT=Object.freeze(Object.defineProperty({__proto__:null,activityLogs:Al,branches:yj,customers:tt,inventoryTransactions:xj,notifications:Es,orders:Ut,prescriptions:Tr,products:Zt,shippers:gj,users:Fe},Symbol.toStringTag,{value:"Module"})),hi=Bt("customer_health_info",{id:be("id").primaryKey(),customerId:be("customer_id").notNull().references(()=>tt.id,{onDelete:"cascade"}),bloodType:ve("blood_type",{length:10}),height:Xt("height"),weight:mt("weight",{precision:5,scale:2}),allergies:Ze("allergies").$type().default([]),chronicConditions:Ze("chronic_conditions").$type().default([]),currentMedications:Ze("current_medications").$type().default([]),emergencyContactName:ve("emergency_contact_name",{length:255}),emergencyContactPhone:ve("emergency_contact_phone",{length:20}),emergencyContactRelationship:ve("emergency_contact_relationship",{length:100}),insuranceProvider:ve("insurance_provider",{length:255}),insurancePolicyNumber:ve("insurance_policy_number",{length:100}),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),Aa=Bt("customer_order_items",{id:be("id").primaryKey(),customerId:be("customer_id").notNull().references(()=>tt.id,{onDelete:"cascade"}),orderId:be("order_id").notNull().references(()=>Ut.id,{onDelete:"cascade"}),productId:be("product_id").notNull(),productName:ve("product_name",{length:255}).notNull(),productCategory:ve("product_category",{length:100}).notNull(),quantity:Xt("quantity").notNull(),unitPrice:mt("unit_price",{precision:10,scale:2}).notNull(),totalPrice:mt("total_price",{precision:10,scale:2}).notNull(),therapeuticClass:ve("therapeutic_class",{length:100}),activeIngredients:Ze("active_ingredients").$type().default([]),orderDate:ke("order_date").notNull(),orderStatus:ve("order_status",{length:20}).notNull(),createdAt:ke("created_at").defaultNow()}),Ls=Bt("customer_purchase_patterns",{id:be("id").primaryKey(),customerId:be("customer_id").notNull().references(()=>tt.id,{onDelete:"cascade"}),productCategory:ve("product_category",{length:100}).notNull(),purchaseFrequency:Xt("purchase_frequency").default(0),totalQuantity:Xt("total_quantity").default(0),totalAmount:mt("total_amount",{precision:12,scale:2}).default("0"),averageQuantityPerOrder:mt("average_quantity_per_order",{precision:8,scale:2}).default("0"),lastPurchaseDate:ke("last_purchase_date"),firstPurchaseDate:ke("first_purchase_date"),preferenceScore:mt("preference_score",{precision:5,scale:2}).default("0"),seasonalPattern:Ze("seasonal_pattern").$type().default({spring:0,summer:0,autumn:0,winter:0}),updatedAt:ke("updated_at").defaultNow()}),_T=Object.freeze(Object.defineProperty({__proto__:null,customerHealthInfo:hi,customerOrderItems:Aa,customerPurchasePatterns:Ls},Symbol.toStringTag,{value:"Module"})),Ye=Bt("payment_transactions",{id:be("id").primaryKey(),orderId:be("order_id").notNull().references(()=>Ut.id,{onDelete:"cascade"}),customerId:be("customer_id").notNull().references(()=>tt.id),amount:mt("amount",{precision:10,scale:2}).notNull(),currency:ve("currency",{length:3}).default("VND"),paymentMethod:ve("payment_method",{length:20}).notNull(),paymentStatus:ve("payment_status",{length:20}).notNull().default("pending"),gatewayProvider:ve("gateway_provider",{length:50}),gatewayTransactionId:ve("gateway_transaction_id",{length:255}),gatewayResponse:Ze("gateway_response"),transactionDate:ke("transaction_date").defaultNow(),processedAt:ke("processed_at"),failureReason:be("failure_reason"),refundAmount:mt("refund_amount",{precision:10,scale:2}),refundDate:ke("refund_date"),refundReason:be("refund_reason"),securityCode:ve("security_code",{length:10}),ipAddress:ve("ip_address",{length:45}),userAgent:be("user_agent"),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),NT=Bt("customer_payment_methods",{id:be("id").primaryKey(),customerId:be("customer_id").notNull().references(()=>tt.id,{onDelete:"cascade"}),type:ve("type",{length:20}).notNull(),provider:ve("provider",{length:50}),name:ve("name",{length:100}).notNull(),maskedNumber:ve("masked_number",{length:50}),token:be("token"),expiryMonth:Xt("expiry_month"),expiryYear:Xt("expiry_year"),isDefault:un("is_default").default(!1),isActive:un("is_active").default(!0),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),fi=Bt("receipts",{id:be("id").primaryKey(),orderId:be("order_id").notNull().references(()=>Ut.id,{onDelete:"cascade"}),paymentTransactionId:be("payment_transaction_id").references(()=>Ye.id),customerId:be("customer_id").notNull().references(()=>tt.id),receiptNumber:ve("receipt_number",{length:50}).notNull(),type:ve("type",{length:20}).notNull(),subtotal:mt("subtotal",{precision:10,scale:2}).notNull(),taxAmount:mt("tax_amount",{precision:10,scale:2}).default("0"),discountAmount:mt("discount_amount",{precision:10,scale:2}).default("0"),totalAmount:mt("total_amount",{precision:10,scale:2}).notNull(),items:Ze("items").notNull(),taxRate:mt("tax_rate",{precision:5,scale:2}).default("0"),taxId:ve("tax_id",{length:50}),generatedAt:ke("generated_at").defaultNow(),sentToCustomer:un("sent_to_customer").default(!1),emailSentAt:ke("email_sent_at"),printedAt:ke("printed_at"),pdfUrl:be("pdf_url"),qrCode:be("qr_code"),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),Ml=Bt("payment_gateway_configs",{id:be("id").primaryKey(),provider:ve("provider",{length:50}).notNull(),name:ve("name",{length:100}).notNull(),isActive:un("is_active").default(!1),isTestMode:un("is_test_mode").default(!0),config:Ze("config").notNull(),merchantId:ve("merchant_id",{length:255}),secretKey:be("secret_key"),publicKey:be("public_key"),supportedCurrencies:Ze("supported_currencies").default(["VND"]),minAmount:mt("min_amount",{precision:10,scale:2}).default("1000"),maxAmount:mt("max_amount",{precision:10,scale:2}).default("100000000"),createdAt:ke("created_at").defaultNow(),updatedAt:ke("updated_at").defaultNow()}),jT=Object.freeze(Object.defineProperty({__proto__:null,customerPaymentMethods:NT,paymentGatewayConfigs:Ml,paymentTransactions:Ye,receipts:fi},Symbol.toStringTag,{value:"Module"})),ST="postgresql://neondb_owner:npg_Ft5wrU2equCd@ep-dry-breeze-a15awvf5-pooler.ap-southeast-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require",CT=Mi(ST),ce=vh(CT,{schema:{...bT,..._T,...jT}});class on{static hashPassword(e){return btoa(e+"longchau-salt")}static verifyPassword(e,r){return this.hashPassword(e)===r}static async createUser(e){try{if(e.role!=="customer"&&e.role!=="shipper"&&e.role!=="manager")return{success:!1,error:"Only customer, shipper, and manager accounts can be created through registration."};if((await ce.select().from(Fe).where(Le(Fe.email,e.email))).length>0)return{success:!1,error:"User with this email already exists"};const n="user_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),a=this.hashPassword(e.password),o=await ce.insert(Fe).values({id:n,email:e.email,password:a,name:e.name,role:e.role,branchId:e.branchId||null,professionalInfo:e.professionalInfo||null}).returning();if(o.length===0)return{success:!1,error:"Failed to create user"};const c={id:o[0].id,email:o[0].email,name:o[0].name,role:o[0].role,branchId:o[0].branchId||void 0,professionalInfo:o[0].professionalInfo||void 0};return console.log("✅ User created successfully:",c.email),{success:!0,user:c}}catch(r){return console.error("❌ Error creating user:",r),{success:!1,error:"Database error occurred"}}}static async loginUser(e,r){try{const n=await ce.select().from(Fe).where(Le(Fe.email,e));if(n.length===0)return{success:!1,error:"User not found"};const a=n[0];if(!this.verifyPassword(r,a.password))return{success:!1,error:"Invalid password"};const o={id:a.id,email:a.email,name:a.name,role:a.role,branchId:a.branchId||void 0,professionalInfo:a.professionalInfo||void 0};return console.log("✅ User logged in successfully:",o.email),{success:!0,user:o}}catch(n){return console.error("❌ Error during login:",n),{success:!1,error:"Database error occurred"}}}static async getAllUsers(){try{return(await ce.select({id:Fe.id,email:Fe.email,name:Fe.name,role:Fe.role,branchId:Fe.branchId,professionalInfo:Fe.professionalInfo,createdAt:Fe.createdAt}).from(Fe)).map(r=>({id:r.id,email:r.email,name:r.name,role:r.role,branchId:r.branchId||void 0,professionalInfo:r.professionalInfo||void 0}))}catch(e){return console.error("❌ Error fetching users:",e),[]}}static async changePassword(e,r,n){try{const a=await ce.select().from(Fe).where(Le(Fe.id,e));if(a.length===0)return{success:!1,error:"User not found"};const o=a[0];if(o.role!=="customer")return{success:!1,error:"Only customer accounts can change passwords through the app. Staff password changes must be done by administrators."};if(!this.verifyPassword(r,o.password))return{success:!1,error:"Current password is incorrect"};const c=this.hashPassword(n);return await ce.update(Fe).set({password:c,updatedAt:new Date}).where(Le(Fe.id,e)),console.log("✅ Password changed successfully for user:",o.email),{success:!0}}catch(a){return console.error("❌ Error changing password:",a),{success:!1,error:"Database error occurred"}}}static async createStaffAccount(e){try{if(!["pharmacist","manager"].includes(e.role))return{success:!1,error:"This function is only for creating staff accounts (pharmacist/manager)"};if((await ce.select().from(Fe).where(Le(Fe.email,e.email))).length>0)return{success:!1,error:"User with this email already exists"};const n="staff_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),a=this.hashPassword(e.password),o=await ce.insert(Fe).values({id:n,email:e.email,password:a,name:e.name,role:e.role,branchId:e.branchId||null,professionalInfo:e.professionalInfo||null}).returning();if(o.length===0)return{success:!1,error:"Failed to create staff account"};const c={id:o[0].id,email:o[0].email,name:o[0].name,role:o[0].role,branchId:o[0].branchId||void 0,professionalInfo:o[0].professionalInfo||void 0};return console.log("✅ Staff account created successfully:",c.email,"-",c.role),{success:!0,user:c}}catch(r){return console.error("❌ Error creating staff account:",r),{success:!1,error:"Database error occurred"}}}static async deleteUser(e){try{return await ce.delete(Fe).where(Le(Fe.id,e)),console.log("✅ User deleted successfully:",e),{success:!0}}catch(r){return console.error("❌ Error deleting user:",r),{success:!1,error:"Database error occurred"}}}}const vj=R.createContext(void 0);function pt(){const t=R.useContext(vj);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function PT({children:t}){const[e,r]=R.useState(null),[n,a]=R.useState(!0);R.useEffect(()=>{const m=localStorage.getItem("lcpms-user");if(m)try{r(JSON.parse(m))}catch(v){console.error("Error parsing stored user:",v),localStorage.removeItem("lcpms-user")}a(!1)},[]);const o=async(m,v)=>{a(!0);try{const w=await on.loginUser(m,v);return w.success&&w.user?(r(w.user),localStorage.setItem("lcpms-user",JSON.stringify(w.user)),a(!1),!0):(console.error("Login failed:",w.error),a(!1),!1)}catch(w){return console.error("Login error:",w),a(!1),!1}},c=async(m,v,w,N)=>{try{const g=await on.createUser({email:m,password:v,name:w,role:N});return g.success&&g.user?(r(g.user),localStorage.setItem("lcpms-user",JSON.stringify(g.user)),{success:!0}):{success:!1,error:g.error}}catch(g){return console.error("Registration error:",g),{success:!1,error:"Registration failed"}}},u=async(m,v)=>{if(!e)return{success:!1,error:"No user logged in"};try{const w=await on.changePassword(e.id,m,v);return w.success?(console.log("✅ Password changed successfully"),{success:!0}):{success:!1,error:w.error}}catch(w){return console.error("Password change error:",w),{success:!1,error:"Password change failed"}}},h=async()=>{if(e)try{const m=await on.loginUser(e.email,"skip-password-check");m.success&&m.user&&(r(m.user),localStorage.setItem("lcpms-user",JSON.stringify(m.user)))}catch(m){console.error("Error refreshing user data:",m)}},f=()=>{r(null),localStorage.removeItem("lcpms-user")};return s.jsx(vj.Provider,{value:{user:e,login:o,logout:f,register:c,changePassword:u,refreshUser:h,isLoading:n},children:t})}class wt{static async createUser(e){if(!ce)return null;try{const[r]=await ce.insert(Fe).values(e).returning();return r}catch(r){return console.error("Error creating user:",r),null}}static async getUserByEmail(e){if(!ce)return null;try{const[r]=await ce.select().from(Fe).where(Le(Fe.email,e));return r||null}catch(r){return console.error("Error getting user by email:",r),null}}static async getUserById(e){if(!ce)return null;try{const[r]=await ce.select().from(Fe).where(Le(Fe.id,e));return r||null}catch(r){return console.error("Error getting user by ID:",r),null}}static async getAllCustomers(){if(!ce)return[];try{return await ce.select().from(tt).orderBy(Er(tt.createdAt))}catch(e){return console.error("Error getting customers:",e),[]}}static async createCustomer(e){if(!ce)return null;try{const[r]=await ce.insert(tt).values(e).returning();return r}catch(r){return console.error("Error creating customer:",r),null}}static async updateCustomer(e,r){if(!ce)return null;try{const[n]=await ce.update(tt).set({...r,updatedAt:new Date}).where(Le(tt.id,e)).returning();return n}catch(n){return console.error("Error updating customer:",n),null}}static async getCustomerById(e){if(!ce)return null;try{const[r]=await ce.select().from(tt).where(Le(tt.id,e));return r||null}catch(r){return console.error("Error getting customer by ID:",r),null}}static async getAllProducts(){if(!ce)return[];try{return await ce.select().from(Zt).orderBy(Er(Zt.createdAt))}catch(e){return console.error("Error getting products:",e),[]}}static async createProduct(e){if(!ce)return null;try{const[r]=await ce.insert(Zt).values(e).returning();return r}catch(r){return console.error("Error creating product:",r),null}}static async updateProduct(e,r){if(!ce)return null;try{const[n]=await ce.update(Zt).set({...r,updatedAt:new Date}).where(Le(Zt.id,e)).returning();return n}catch(n){return console.error("Error updating product:",n),null}}static async getProductById(e){if(!ce)return null;try{const[r]=await ce.select().from(Zt).where(Le(Zt.id,e));return r||null}catch(r){return console.error("Error getting product by ID:",r),null}}static async getLowStockProducts(){if(!ce)return[];try{return await ce.select().from(Zt).where(ej(Zt.stock,Zt.minStock))}catch(e){return console.error("Error getting low stock products:",e),[]}}static async getAllPrescriptions(){if(!ce)return[];try{return await ce.select().from(Tr).orderBy(Er(Tr.createdAt))}catch(e){return console.error("Error getting prescriptions:",e),[]}}static async createPrescription(e){if(!ce)return null;try{const[r]=await ce.insert(Tr).values(e).returning();return r}catch(r){return console.error("Error creating prescription:",r),null}}static async updatePrescription(e,r){if(!ce)return null;try{const[n]=await ce.update(Tr).set({...r,updatedAt:new Date}).where(Le(Tr.id,e)).returning();return n}catch(n){return console.error("Error updating prescription:",n),null}}static async getPrescriptionsByCustomerId(e){if(!ce)return[];try{return await ce.select().from(Tr).where(Le(Tr.customerId,e)).orderBy(Er(Tr.createdAt))}catch(r){return console.error("Error getting prescriptions by customer ID:",r),[]}}static async getPendingPrescriptions(){if(!ce)return[];try{return await ce.select().from(Tr).where(Le(Tr.status,"pending")).orderBy(Er(Tr.createdAt))}catch(e){return console.error("Error getting pending prescriptions:",e),[]}}static async getAllOrders(){if(!ce)return[];try{return await ce.select().from(Ut).orderBy(Er(Ut.createdAt))}catch(e){return console.error("Error getting orders:",e),[]}}static async createOrder(e){if(!ce)return null;try{const[r]=await ce.insert(Ut).values(e).returning();return r}catch(r){return console.error("Error creating order:",r),null}}static async updateOrder(e,r){if(!ce)return null;try{const[n]=await ce.update(Ut).set({...r,updatedAt:new Date}).where(Le(Ut.id,e)).returning();return n}catch(n){return console.error("Error updating order:",n),null}}static async getOrdersByCustomerId(e){if(!ce)return[];try{return await ce.select().from(Ut).where(Le(Ut.customerId,e)).orderBy(Er(Ut.createdAt))}catch(r){return console.error("Error getting orders by customer ID:",r),[]}}static async createNotification(e){if(!ce)return!1;try{return await ce.insert(Es).values(e),!0}catch(r){return console.error("Error creating notification:",r),!1}}static async getUserNotifications(e){if(!ce)return[];try{return await ce.select().from(Es).where(Le(Es.userId,e)).orderBy(Er(Es.createdAt))}catch(r){return console.error("Error getting user notifications:",r),[]}}static async markNotificationAsRead(e){if(!ce)return!1;try{return await ce.update(Es).set({read:!0,updatedAt:new Date}).where(Le(Es.id,e)),!0}catch(r){return console.error("Error marking notification as read:",r),!1}}static async createActivityLog(e){if(!ce)return!1;try{return await ce.insert(Al).values(e),!0}catch(r){return console.error("Error creating activity log:",r),!1}}static async getRecentActivities(e=20){if(!ce)return[];try{return await ce.select().from(Al).orderBy(Er(Al.createdAt)).limit(e)}catch(r){return console.error("Error getting recent activities:",r),[]}}static async createInventoryTransaction(e){if(!ce)return!1;try{return await ce.insert(xj).values(e),!0}catch(r){return console.error("Error creating inventory transaction:",r),!1}}static async seedDatabase(){if(!ce)return!1;try{return console.log("Database seeding would happen here"),!0}catch(e){return console.error("Error seeding database:",e),!1}}static async healthCheck(){if(!ce)return!1;try{console.log("🏥 Performing database health check...");const e=await Promise.race([ce.select().from(Zt).limit(1),new Promise((r,n)=>setTimeout(()=>n(new Error("Health check timeout")),5e3))]);return console.log("✅ Database health check passed"),!0}catch(e){return console.warn("❌ Database health check failed:",e),!1}}}const om=class om{static async storeOrder(e){const r="id"in e?e.id:`ORD-${Date.now()}-${Math.random().toString(36).substr(2,4).toUpperCase()}`,n={...e,id:r};try{return await wt.createOrder({id:r,customerId:e.customerId,customerName:e.customerName,items:e.items,total:e.total.toString(),status:e.status,shippingAddress:e.shippingAddress,paymentMethod:e.paymentMethod,paymentStatus:e.paymentStatus}),console.log(`✅ Order ${r} successfully stored in database`),{success:!0,stored:"database"}}catch(a){return console.warn(`⚠️ Database storage failed for order ${r}, storing locally:`,a),this.pendingOperations.push({type:"order",operation:"create",data:n}),{success:!0,stored:"local",error:a.message}}}static async storePrescription(e){var a;const r="id"in e?e.id:`pres-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,n={...e,id:r};try{return await wt.createPrescription({id:r,customerId:e.customerId,customerName:e.customerName,pharmacistId:e.pharmacistId,pharmacistName:e.pharmacistName,medications:e.medications,status:e.status,notes:e.notes,imageUrl:e.imageUrl,totalAmount:(a=e.totalAmount)==null?void 0:a.toString()}),console.log(`✅ Prescription ${r} successfully stored in database`),{success:!0,stored:"database"}}catch(o){return console.warn(`⚠️ Database storage failed for prescription ${r}, storing locally:`,o),this.pendingOperations.push({type:"prescription",operation:"create",data:n}),{success:!0,stored:"local",error:o.message}}}static async updateOrder(e){try{return await wt.updateOrder(e.id,{status:e.status,paymentStatus:e.paymentStatus}),console.log(`✅ Order ${e.id} successfully updated in database`),{success:!0,stored:"database"}}catch(r){return console.warn(`⚠️ Database update failed for order ${e.id}, updating locally:`,r),this.pendingOperations.push({type:"order",operation:"update",data:e,id:e.id}),{success:!0,stored:"local",error:r.message}}}static async updatePrescription(e){var r;try{return await wt.updatePrescription(e.id,{pharmacistId:e.pharmacistId,pharmacistName:e.pharmacistName,status:e.status,notes:e.notes,totalAmount:(r=e.totalAmount)==null?void 0:r.toString(),validationDate:e.validationDate?new Date(e.validationDate):void 0}),console.log(`✅ Prescription ${e.id} successfully updated in database`),{success:!0,stored:"database"}}catch(n){return console.warn(`⚠️ Database update failed for prescription ${e.id}, updating locally:`,n),this.pendingOperations.push({type:"prescription",operation:"update",data:e,id:e.id}),{success:!0,stored:"local",error:n.message}}}static async retryPendingOperations(){let e=0,r=0;const n=[...this.pendingOperations];this.pendingOperations=[];for(const a of n)try{switch(a.type){case"order":a.operation==="create"?await wt.createOrder(a.data):await wt.updateOrder(a.id,a.data);break;case"prescription":a.operation==="create"?await wt.createPrescription(a.data):await wt.updatePrescription(a.id,a.data);break}e++,console.log(`✅ Retried ${a.type} ${a.operation} successfully`)}catch(o){r++,console.warn(`❌ Failed to retry ${a.type} ${a.operation}:`,o),this.pendingOperations.push(a)}return{completed:e,failed:r}}static getPendingOperationsCount(){return this.pendingOperations.length}static getPendingOperationsSummary(){const e=this.pendingOperations.filter(n=>n.type==="order").length,r=this.pendingOperations.filter(n=>n.type==="prescription").length;return{orders:e,prescriptions:r,total:this.pendingOperations.length}}static clearPendingOperations(){this.pendingOperations=[],console.log("🗑️ Cleared all pending operations")}static async syncToDatabase(){if(this.pendingOperations.length===0)return{success:!0,stored:"database"};const e=await this.retryPendingOperations();return e.failed===0?(console.log(`✅ Successfully synced ${e.completed} operations to database`),{success:!0,stored:"database"}):(console.warn(`⚠️ Partially synced: ${e.completed} succeeded, ${e.failed} failed`),{success:!0,stored:"both",error:`${e.failed} operations still pending`})}};om.pendingOperations=[];let Kn=om;const wj=R.createContext(void 0),kT=t=>({id:t.id,name:t.name,description:t.description||"",category:t.category,price:parseFloat(t.price),stock:t.stock,minStock:t.minStock,manufacturer:t.manufacturer,expiryDate:t.expiryDate,requiresPrescription:t.requiresPrescription||!1,batchNumber:t.batchNumber}),TT=t=>{var e;return{id:t.id,name:t.name,email:t.email,phone:t.phone,address:t.address,dateOfBirth:t.dateOfBirth,allergies:t.allergies||[],prescriptionHistory:t.prescriptionHistory||[],orderHistory:t.orderHistory||[],healthStatus:t.healthStatus||{chronicConditions:[],emergencyContact:{name:"",phone:"",relationship:""}},membershipTier:t.membershipTier||"bronze",joinDate:((e=t.joinDate)==null?void 0:e.toISOString())||new Date().toISOString(),totalSpent:parseFloat(t.totalSpent||"0")}},ET=t=>{var e,r;return{id:t.id,customerId:t.customerId,customerName:t.customerName,pharmacistId:t.pharmacistId||void 0,pharmacistName:t.pharmacistName||void 0,medications:t.medications||[],status:t.status,uploadDate:((e=t.uploadDate)==null?void 0:e.toISOString())||new Date().toISOString(),validationDate:(r=t.validationDate)==null?void 0:r.toISOString(),notes:t.notes||void 0,imageUrl:t.imageUrl||void 0,totalAmount:t.totalAmount?parseFloat(t.totalAmount):void 0}},LT=t=>{var e,r,n,a;return{id:t.id,customerId:t.customerId,customerName:t.customerName,items:t.items||[],total:parseFloat(t.total),status:t.status,orderDate:((e=t.orderDate)==null?void 0:e.toISOString())||new Date().toISOString(),shippingAddress:t.shippingAddress,paymentMethod:t.paymentMethod,paymentStatus:t.paymentStatus,trackingNumber:t.trackingNumber,deliveryDate:(r=t.deliveryDate)==null?void 0:r.toISOString(),shippingInfo:t.shippingInfo,estimatedDelivery:(n=t.estimatedDelivery)==null?void 0:n.toISOString(),actualDelivery:(a=t.actualDelivery)==null?void 0:a.toISOString(),shipperLocation:t.shipperLocation,trackingHistory:t.trackingHistory}};function lt(){const t=R.useContext(wj);if(t===void 0)throw new Error("useData must be used within a DataProvider");return t}function AT({children:t}){const[e,r]=R.useState([]),[n,a]=R.useState([]),[o,c]=R.useState([]),[u,h]=R.useState([]),[f,m]=R.useState([]),[v,w]=R.useState([]),[N,g]=R.useState(!1),[y,j]=R.useState(!0),[_,b]=R.useState(0),P=3,B=async()=>{try{if(console.log("🔄 Loading data from database..."),console.log("📊 Environment check:",{nodeEnv:void 0,viteDatabaseUrl:"Present",isDev:!1,isProd:!0}),j(!0),!await wt.healthCheck())throw new Error("Database health check failed");console.log("✅ Connected to Neon database, loading data..."),g(!0),b(0);const[ue,ae,pe,Re]=await Promise.all([wt.getAllProducts(),wt.getAllCustomers(),wt.getAllPrescriptions(),wt.getAllOrders()]);r(ue.map(kT)),h(ae.map(TT)),a(pe.map(ET)),c(Re.map(LT)),console.log(`✅ Database data loaded successfully:
        - Products: ${ue.length}
        - Customers: ${ae.length}
        - Prescriptions: ${pe.length}
        - Orders: ${Re.length}`),j(!1)}catch(ee){console.error("❌ Failed to load data from database:",ee),g(!1),j(!1),r([]),h([]),a([]),c([]),b(ue=>ue+1),_<P?(console.log(`⏳ Retrying database connection in 5 seconds... (Attempt ${_+1}/${P})`),setTimeout(()=>{B()},5e3)):console.error("❌ Max connection attempts reached. Database connection failed permanently.")}};R.useEffect(()=>{console.log("🚀 DataProvider mounting..."),console.log("🔍 Environment Variables Check:",{viteDatabaseUrl:"postgresql://neondb_owner:npg_Ft5wrU2equCd@ep-dry-breeze-a15awvf5-pooler.ap-southeast-1.aws.neon.tech/neondb?sslmode=require&channel_binding=require".substring(0,20)+"...",isProduction:!0,isDevelopment:!1}),B()},[]);const $=async()=>{console.log("🔄 Refreshing data from database..."),j(!0);try{await B(),console.log("✅ Data refresh completed")}catch(ee){console.error("❌ Data refresh failed:",ee),j(!1)}},k=async()=>{console.log("🔌 Attempting to reconnect to database...");try{return b(0),await wt.healthCheck()?(console.log("✅ Database reconnection successful"),g(!0),await B(),!0):(console.log("❌ Database reconnection failed"),g(!1),!1)}catch(ee){return console.error("❌ Database reconnection error:",ee),g(!1),!1}},I=async ee=>{try{N&&await wt.updateProduct(ee.id,{name:ee.name,description:ee.description,category:ee.category,price:ee.price.toString(),stock:ee.stock,minStock:ee.minStock,manufacturer:ee.manufacturer,expiryDate:ee.expiryDate,requiresPrescription:ee.requiresPrescription,batchNumber:ee.batchNumber}),r(ue=>ue.map(ae=>ae.id===ee.id?ee:ae))}catch(ue){console.error("Error updating product:",ue),r(ae=>ae.map(pe=>pe.id===ee.id?ee:pe))}},T=async ee=>{const ue=`prod-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,ae={...ee,id:ue};console.log("🔄 Adding product:",{id:ae.id,name:ae.name,category:ae.category,price:ae.price,stock:ae.stock,isConnectedToDatabase:N});try{if(N){console.log("📡 Attempting to save to database...");const pe=await wt.createProduct({id:ae.id,name:ae.name,description:ae.description,category:ae.category,price:ae.price.toString(),stock:ae.stock,minStock:ae.minStock,manufacturer:ae.manufacturer,expiryDate:ae.expiryDate,requiresPrescription:ae.requiresPrescription,batchNumber:ae.batchNumber,createdAt:new Date,updatedAt:new Date});if(pe){console.log("✅ Product saved to database successfully!");const Re={id:pe.id,name:pe.name,description:pe.description||"",category:pe.category,price:parseFloat(pe.price),stock:pe.stock,minStock:pe.minStock,manufacturer:pe.manufacturer,expiryDate:pe.expiryDate||"",requiresPrescription:pe.requiresPrescription||!1,batchNumber:pe.batchNumber||""};return r($t=>[Re,...$t]),console.log("✅ Product stored in database:",Re.id),{success:!0,stored:"database"}}else console.log("⚠️ Database returned null, falling back to local storage")}else console.log("⚠️ Database not connected, storing locally");return r(pe=>[ae,...pe]),console.log("⚠️ Product stored locally (will sync when database is available):",ae.id),{success:!0,stored:"local"}}catch(pe){return console.error("❌ Error adding product:",pe),r(Re=>[ae,...Re]),{success:!1,stored:"local",error:"Failed to add product to database"}}},D=async ee=>{const ue=`pres-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,ae={...ee,id:ue},pe=await Kn.storePrescription(ae);return a(Re=>[ae,...Re]),pe},U=async ee=>{const ue=await Kn.updatePrescription(ee);return a(ae=>ae.map(pe=>pe.id===ee.id?ee:pe)),ue},V=async ee=>{const ue=`ORD-${Date.now()}-${Math.random().toString(36).substr(2,4).toUpperCase()}`,ae={...ee,id:ue},pe=await Kn.storeOrder(ae);return c(Re=>[ae,...Re]),pe},z=async ee=>{const ue=await Kn.updateOrder(ee);return c(ae=>ae.map(pe=>pe.id===ee.id?ee:pe)),ue},q=async(ee,ue)=>{const ae=o.find(Re=>Re.id===ee);if(!ae)return{success:!1,error:"Order not found",stored:"local"};const pe={...ae,...ue};return z(pe)},Q=async ee=>{const ue=`cust-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,ae={id:ue,...ee};console.log("🔄 Adding customer:",{id:ue,name:ee.name,email:ee.email,isConnectedToDatabase:N});try{if(N){if(console.log("🔍 Checking for existing customer with email:",ee.email),(await wt.getAllCustomers()).find($t=>$t.email===ee.email)){console.log("⚠️ Customer with email already exists, skipping creation:",ee.email);return}console.log("📡 Attempting to save customer to database..."),await wt.createCustomer({id:ue,name:ee.name,email:ee.email,phone:ee.phone,address:ee.address,dateOfBirth:ee.dateOfBirth,allergies:ee.allergies,prescriptionHistory:ee.prescriptionHistory,orderHistory:ee.orderHistory,healthStatus:ee.healthStatus,membershipTier:ee.membershipTier,totalSpent:ee.totalSpent.toString()}),console.log("✅ Customer saved to database successfully!")}else console.log("⚠️ Database not connected, storing locally");h(pe=>[ae,...pe]),console.log("✅ Customer added to local state")}catch(pe){throw console.error("❌ Error adding customer:",pe),h(Re=>[ae,...Re]),pe}},te=async ee=>{try{N&&await wt.updateCustomer(ee.id,{name:ee.name,email:ee.email,phone:ee.phone,address:ee.address,allergies:ee.allergies,healthStatus:ee.healthStatus,membershipTier:ee.membershipTier,totalSpent:ee.totalSpent.toString()}),h(ue=>ue.map(ae=>ae.id===ee.id?ee:ae))}catch(ue){console.error("Error updating customer:",ue),h(ae=>ae.map(pe=>pe.id===ee.id?ee:pe))}},de=()=>Kn.getPendingOperationsCount(),re=async()=>await Kn.syncToDatabase(),Z=async(ee,ue,ae)=>{try{const pe=o.find(fr=>fr.id===ee),Re=f.find(fr=>fr.id===ue);if(!pe||!Re)throw new Error("Order or shipper not found");const $t={...pe,assignedShipperId:ue,assignedShipper:Re,routeData:ae,status:"assigned"};return c(fr=>fr.map(fn=>fn.id===ee?$t:fn)),{success:!0,stored:"local"}}catch(pe){return console.error("Error assigning shipper:",pe),{success:!1,error:pe instanceof Error?pe.message:"Unknown error",stored:"local"}}},ne=async(ee,ue)=>{try{const ae=f.find(Re=>Re.id===ee);if(!ae)throw new Error("Shipper not found");const pe={...ae,currentLocation:ue};return m(Re=>Re.map($t=>$t.id===ee?pe:$t)),{success:!0,stored:"local"}}catch(ae){return console.error("Error updating shipper location:",ae),{success:!1,error:ae instanceof Error?ae.message:"Unknown error",stored:"local"}}},ie=async ee=>{try{const ue=`shipper-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,ae={...ee,id:ue};return m(pe=>[...pe,ae]),{success:!0,stored:"local"}}catch(ue){return console.error("Error adding shipper:",ue),{success:!1,error:ue instanceof Error?ue.message:"Unknown error",stored:"local"}}},K=async ee=>{try{if(!f.find(ae=>ae.id===ee.id))throw new Error("Shipper not found");return m(ae=>ae.map(pe=>pe.id===ee.id?ee:pe)),{success:!0,stored:"local"}}catch(ue){return console.error("Error updating shipper:",ue),{success:!1,error:ue instanceof Error?ue.message:"Unknown error",stored:"local"}}},fe=async ee=>{try{const ue=`branch-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,ae={...ee,id:ue};return w(pe=>[...pe,ae]),{success:!0,stored:"local"}}catch(ue){return console.error("Error adding branch:",ue),{success:!1,error:ue instanceof Error?ue.message:"Unknown error",stored:"local"}}},Ae=async ee=>{try{if(!v.find(ae=>ae.id===ee.id))throw new Error("Branch not found");return w(ae=>ae.map(pe=>pe.id===ee.id?ee:pe)),{success:!0,stored:"local"}}catch(ue){return console.error("Error updating branch:",ue),{success:!1,error:ue instanceof Error?ue.message:"Unknown error",stored:"local"}}};return s.jsx(wj.Provider,{value:{products:e,prescriptions:n,orders:o,customers:u,shippers:f,branches:v,addProduct:T,updateProduct:I,addPrescription:D,updatePrescription:U,addOrder:V,updateOrder:z,updateShippingInfo:q,addCustomer:Q,updateCustomer:te,assignShipper:Z,updateShipperLocation:ne,addShipper:ie,updateShipper:K,addBranch:fe,updateBranch:Ae,isConnectedToDatabase:N,isLoading:y,refreshData:$,forceReconnectDatabase:k,getPendingOperationsCount:de,syncPendingOperations:re},children:t})}const bj=R.createContext(void 0);function ws(){const t=R.useContext(bj);if(t===void 0)throw new Error("useNotifications must be used within a NotificationProvider");return t}function MT({children:t}){const[e,r]=R.useState([]),n=e.filter(f=>!f.read).length,a=f=>{const m={...f,id:`notif-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:new Date().toISOString(),read:!1};r(v=>[m,...v]),f.type==="success"&&setTimeout(()=>{u(m.id)},5e3)},o=f=>{r(m=>m.map(v=>v.id===f?{...v,read:!0}:v))},c=()=>{r(f=>f.map(m=>({...m,read:!0})))},u=f=>{r(m=>m.filter(v=>v.id!==f))},h=()=>{r([])};return s.jsx(bj.Provider,{value:{notifications:e,unreadCount:n,addNotification:a,markAsRead:o,markAllAsRead:c,removeNotification:u,clearAllNotifications:h},children:t})}const _j=R.createContext(void 0);function Co(){const t=R.useContext(_j);if(t===void 0)throw new Error("useActivity must be used within an ActivityProvider");return t}function IT({children:t}){const{user:e}=pt(),[r,n]=R.useState([]),a=R.useCallback((u,h,f,m)=>{if(!e)return;const v={id:`activity-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,type:u,action:h,description:f,userName:e.name,userRole:e.role,timestamp:new Date,metadata:m};n(w=>[v,...w].slice(0,100)),console.log("📝 Activity logged:",v)},[e]),o=R.useCallback((u=10)=>r.slice(0,u),[r]),c=R.useCallback(()=>{n([])},[]);return s.jsx(_j.Provider,{value:{activities:r,addActivity:a,getRecentActivities:o,clearActivities:c},children:t})}/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var DT={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OT=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),ge=(t,e)=>{const r=R.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:o=2,absoluteStrokeWidth:c,className:u="",children:h,...f},m)=>R.createElement("svg",{ref:m,...DT,width:a,height:a,stroke:n,strokeWidth:c?Number(o)*24/Number(a):o,className:["lucide",`lucide-${OT(t)}`,u].join(" "),...f},[...e.map(([v,w])=>R.createElement(v,w)),...Array.isArray(h)?h:[h]]));return r.displayName=`${t}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cd=ge("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=ge("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=ge("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nj=ge("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=ge("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RT=ge("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mg=ge("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jj=ge("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BT=ge("BellRing",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ig=ge("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=ge("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sj=ge("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $T=ge("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=ge("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cj=ge("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=ge("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pj=ge("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zT=ge("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bn=ge("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FT=ge("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wh=ge("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=ge("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UT=ge("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qT=ge("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HT=ge("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ud=ge("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=ge("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=ge("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wc=ge("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VT=ge("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QT=ge("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=ge("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=ge("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Og=ge("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZT=ge("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KT=ge("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Po=ge("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GT=ge("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kj=ge("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mc=ge("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=ge("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YT=ge("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rg=ge("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=ge("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=ge("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pc=ge("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=ge("Pill",[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=ge("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=ge("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xi=ge("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=ge("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tj=ge("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bh=ge("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _h=ge("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=ge("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=ge("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zc=ge("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XT=ge("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5h0c-1.4 0-2.5-1.1-2.5-2.5V2",key:"187lwq"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eE=ge("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tE=ge("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bg=ge("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rE=ge("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=ge("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ur=ge("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $g=ge("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nE=ge("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=ge("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $n=ge("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=ge("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Il=ge("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sm=ge("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ej=ge("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rr=ge("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sE=ge("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);function iE({onBackToLogin:t}){const[e,r]=R.useState({name:"",email:"",password:"",confirmPassword:"",role:"customer"}),[n,a]=R.useState(""),[o,c]=R.useState(!1),{register:u}=pt(),h=async m=>{if(m.preventDefault(),a(""),e.password!==e.confirmPassword){a("Passwords do not match");return}if(e.password.length<6){a("Password must be at least 6 characters long");return}c(!0);const v=await u(e.email,e.password,e.name,e.role);v.success||(a(v.error||"Registration failed"),c(!1))},f=m=>{r(v=>({...v,[m.target.name]:m.target.value}))};return s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"max-w-md w-full space-y-8",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-r from-blue-600 to-green-600 rounded-full flex items-center justify-center mb-4",children:s.jsx(nm,{className:"h-10 w-10 text-white"})}),s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Account"}),s.jsx("p",{className:"text-gray-600",children:"Join Long Chau PMS"})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[s.jsxs("form",{onSubmit:h,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"name",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Full Name"}),s.jsx("input",{id:"name",name:"name",type:"text",value:e.name,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your full name",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),s.jsx("input",{id:"email",name:"email",type:"email",value:e.email,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your email",required:!0})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded-lg text-sm",children:[s.jsx("strong",{children:"Customer Registration:"})," This form is for customer accounts only. Pharmacist and Manager accounts are created by administrators directly in the database."]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password"}),s.jsx("input",{id:"password",name:"password",type:"password",value:e.password,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your password",required:!0,minLength:6})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Confirm Password"}),s.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",value:e.confirmPassword,onChange:f,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Confirm your password",required:!0,minLength:6})]}),n&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg text-sm",children:n}),s.jsx("button",{type:"submit",disabled:o,className:"w-full bg-gradient-to-r from-blue-600 to-green-600 text-white py-3 px-4 rounded-lg font-semibold hover:from-blue-700 hover:to-green-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:o?s.jsxs(s.Fragment,{children:[s.jsx(Po,{className:"animate-spin h-5 w-5 mr-2"}),"Creating Account..."]}):"Create Account"})]}),s.jsx("div",{className:"mt-6 pt-6 border-t border-gray-100",children:s.jsxs("button",{onClick:t,className:"w-full flex items-center justify-center text-gray-600 hover:text-gray-800 transition-colors",children:[s.jsx(Nj,{className:"h-4 w-4 mr-2"}),"Back to Login"]})})]})]})})}function aE(){const[t,e]=R.useState(""),[r,n]=R.useState(""),[a,o]=R.useState(""),[c,u]=R.useState(!1),{login:h,isLoading:f}=pt(),m=async v=>{v.preventDefault(),o(""),await h(t,r)||o("Invalid email or password")};return c?s.jsx(iE,{onBackToLogin:()=>u(!1)}):s.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center p-4",children:s.jsxs("div",{className:"max-w-md w-full space-y-8",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto h-20 w-20 bg-gradient-to-r from-blue-600 to-green-600 rounded-full flex items-center justify-center mb-4",children:s.jsx(Tj,{className:"h-10 w-10 text-white"})}),s.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Long Chau PMS"}),s.jsx("p",{className:"text-gray-600",children:"Pharmacy Management System"})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[s.jsxs("form",{onSubmit:m,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email Address"}),s.jsx("input",{id:"email",type:"email",value:t,onChange:v=>e(v.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your email",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Password"}),s.jsx("input",{id:"password",type:"password",value:r,onChange:v=>n(v.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your password",required:!0})]}),a&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg text-sm",children:a}),s.jsx("button",{type:"submit",disabled:f,className:"w-full bg-gradient-to-r from-blue-600 to-green-600 text-white py-3 px-4 rounded-lg font-semibold hover:from-blue-700 hover:to-green-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:f?s.jsxs(s.Fragment,{children:[s.jsx(Po,{className:"animate-spin h-5 w-5 mr-2"}),"Signing In..."]}):"Sign In"})]}),s.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-4",children:[s.jsx("h4",{className:"text-sm font-semibold text-blue-800 mb-2",children:"Demo Credentials"}),s.jsxs("div",{className:"text-xs text-blue-700 space-y-1",children:[s.jsxs("div",{children:[s.jsx("strong",{children:"Admin:"})," admin@longchau.com / admin123"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Shipper 1:"})," shipper1@longchau.com / shipper123"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Shipper 2:"})," shipper2@longchau.com / shipper123"]}),s.jsxs("div",{children:[s.jsx("strong",{children:"Shipper 3:"})," shipper3@longchau.com / shipper123"]})]})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4 text-center",children:"Don't have an account?"}),s.jsx("button",{onClick:()=>u(!0),className:"w-full text-center p-3 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors text-blue-600 hover:text-blue-700 font-medium",children:"Create New Account"})]})]})]})})}function oE(){const[t,e]=R.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[r,n]=R.useState({current:!1,new:!1,confirm:!1}),[a,o]=R.useState(""),[c,u]=R.useState(""),[h,f]=R.useState(!1),{changePassword:m,user:v}=pt(),w=async y=>{if(y.preventDefault(),o(""),u(""),t.newPassword!==t.confirmPassword){o("New passwords do not match");return}if(t.newPassword.length<6){o("New password must be at least 6 characters long");return}if(t.currentPassword===t.newPassword){o("New password must be different from current password");return}f(!0);const j=await m(t.currentPassword,t.newPassword);j.success?(u("Password changed successfully!"),e({currentPassword:"",newPassword:"",confirmPassword:""})):o(j.error||"Failed to change password"),f(!1)},N=y=>{e(j=>({...j,[y.target.name]:y.target.value})),a&&o(""),c&&u("")},g=y=>{n(j=>({...j,[y]:!j[y]}))};return!v||v.role!=="customer"?s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded-lg",children:s.jsxs("p",{children:[s.jsx("strong",{children:"Access Restricted:"})," Password changes are only available for customer accounts. Staff password changes must be done by administrators."]})}):s.jsx("div",{className:"max-w-md mx-auto",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 border border-gray-100",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"mx-auto h-12 w-12 bg-gradient-to-r from-blue-600 to-green-600 rounded-full flex items-center justify-center mb-4",children:s.jsx(GT,{className:"h-6 w-6 text-white"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Change Password"}),s.jsx("p",{className:"text-gray-600",children:"Update your account password"})]}),s.jsxs("form",{onSubmit:w,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Current Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"currentPassword",name:"currentPassword",type:r.current?"text":"password",value:t.currentPassword,onChange:N,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter current password",required:!0}),s.jsx("button",{type:"button",onClick:()=>g("current"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:r.current?s.jsx(ud,{className:"h-5 w-5"}):s.jsx(us,{className:"h-5 w-5"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-semibold text-gray-700 mb-2",children:"New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"newPassword",name:"newPassword",type:r.new?"text":"password",value:t.newPassword,onChange:N,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter new password",required:!0,minLength:6}),s.jsx("button",{type:"button",onClick:()=>g("new"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:r.new?s.jsx(ud,{className:"h-5 w-5"}):s.jsx(us,{className:"h-5 w-5"})})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-semibold text-gray-700 mb-2",children:"Confirm New Password"}),s.jsxs("div",{className:"relative",children:[s.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:r.confirm?"text":"password",value:t.confirmPassword,onChange:N,className:"w-full px-4 py-3 pr-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Confirm new password",required:!0,minLength:6}),s.jsx("button",{type:"button",onClick:()=>g("confirm"),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:r.confirm?s.jsx(ud,{className:"h-5 w-5"}):s.jsx(us,{className:"h-5 w-5"})})]})]}),a&&s.jsx("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg text-sm",children:a}),c&&s.jsx("div",{className:"bg-green-50 border border-green-200 text-green-600 px-4 py-3 rounded-lg text-sm",children:c}),s.jsx("button",{type:"submit",disabled:h,className:"w-full bg-gradient-to-r from-blue-600 to-green-600 text-white py-3 px-4 rounded-lg font-semibold hover:from-blue-700 hover:to-green-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:h?s.jsxs(s.Fragment,{children:[s.jsx(Po,{className:"animate-spin h-5 w-5 mr-2"}),"Changing Password..."]}):"Change Password"})]}),s.jsx("div",{className:"mt-6 text-center",children:s.jsx("p",{className:"text-sm text-gray-600",children:"Make sure to use a strong password with at least 6 characters."})})]})})}function Lj({compact:t=!1}){const{isConnectedToDatabase:e,getPendingOperationsCount:r,syncPendingOperations:n,forceReconnectDatabase:a}=lt(),[o,c]=R.useState(0),[u,h]=R.useState(!1),[f,m]=R.useState("");R.useEffect(()=>{const N=()=>{c(r())};N();const g=setInterval(N,2e3);return()=>clearInterval(g)},[r]);const v=async()=>{h(!0);try{const N=await n();N.success?N.stored==="database"?m("All data synced to database successfully!"):m(`Partial sync: ${N.error}`):m("Sync failed. Data stored locally."),c(r())}catch{m("Sync error occurred.")}finally{h(!1),setTimeout(()=>m(""),3e3)}},w=async()=>{h(!0);try{await a()}finally{h(!1)}};return t?s.jsx("div",{className:"flex items-center space-x-2",children:e?s.jsxs("div",{className:"flex items-center space-x-1 text-green-600",children:[s.jsx(br,{className:"h-4 w-4"}),s.jsx("span",{className:"text-xs font-medium",children:"DB Connected"})]}):s.jsxs("div",{className:"flex items-center space-x-1 text-orange-600",children:[s.jsx(Il,{className:"h-4 w-4"}),s.jsx("span",{className:"text-xs font-medium",children:"Local Storage"}),o>0&&s.jsx("span",{className:"bg-orange-100 text-orange-700 px-1.5 py-0.5 rounded-full text-xs font-medium",children:o})]})}):s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:`p-2 rounded-lg ${e?"bg-green-100 text-green-600":"bg-orange-100 text-orange-600"}`,children:e?s.jsx(br,{className:"h-5 w-5"}):s.jsx(Il,{className:"h-5 w-5"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-gray-900",children:e?"Database Connected":"Database Offline"}),s.jsx("p",{className:"text-sm text-gray-600",children:e?"All data is being stored in the database":`Data is stored locally${o>0?` (${o} operations pending)`:""}`})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[!e&&s.jsxs("button",{onClick:w,disabled:u,className:"flex items-center space-x-1 bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 text-sm",children:[s.jsx(fs,{className:`h-4 w-4 ${u?"animate-spin":""}`}),s.jsx("span",{children:"Reconnect"})]}),o>0&&s.jsxs("button",{onClick:v,disabled:u,className:"flex items-center space-x-1 bg-orange-600 text-white px-3 py-2 rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50 text-sm",children:[s.jsx(RT,{className:`h-4 w-4 ${u?"animate-spin":""}`}),s.jsxs("span",{children:["Sync (",o,")"]})]})]})]}),f&&s.jsx("div",{className:`mt-3 p-2 rounded-lg text-sm ${f.includes("successfully")?"bg-green-50 text-green-700 border border-green-200":"bg-orange-50 text-orange-700 border border-orange-200"}`,children:s.jsxs("div",{className:"flex items-center space-x-2",children:[f.includes("successfully")?s.jsx(Lt,{className:"h-4 w-4"}):s.jsx(Rn,{className:"h-4 w-4"}),s.jsx("span",{children:f})]})}),s.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[e?s.jsx(sm,{className:"h-4 w-4 text-green-500"}):s.jsx(Il,{className:"h-4 w-4 text-red-500"}),s.jsxs("span",{className:"text-gray-600",children:["Connection: ",s.jsx("span",{className:e?"text-green-600 font-medium":"text-red-600 font-medium",children:e?"Active":"Offline"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Bn,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-gray-600",children:["Pending: ",s.jsxs("span",{className:o>0?"text-orange-600 font-medium":"text-green-600 font-medium",children:[o," operations"]})]})]})]})]})}class jn{static async saveCustomerHealthInfo(e){try{const r=e.id||`health-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,n=await ce.insert(hi).values({id:r,customerId:e.customerId,bloodType:e.bloodType,height:e.height,weight:e.weight?e.weight.toString():void 0,allergies:e.allergies||[],chronicConditions:e.chronicConditions||[],currentMedications:e.currentMedications||[],emergencyContactName:e.emergencyContactName,emergencyContactPhone:e.emergencyContactPhone,emergencyContactRelationship:e.emergencyContactRelationship,insuranceProvider:e.insuranceProvider,insurancePolicyNumber:e.insurancePolicyNumber}).returning();return n[0]?{...e,id:n[0].id}:null}catch(r){return console.error("Error saving customer health info:",r),null}}static async getCustomerHealthInfo(e){try{const r=await ce.select().from(hi).where(Le(hi.customerId,e)).limit(1);if(r.length===0)return null;const n=r[0];return{id:n.id,customerId:n.customerId,bloodType:n.bloodType||void 0,height:n.height||void 0,weight:n.weight?parseFloat(n.weight):void 0,allergies:n.allergies||[],chronicConditions:n.chronicConditions||[],currentMedications:n.currentMedications||[],emergencyContactName:n.emergencyContactName||void 0,emergencyContactPhone:n.emergencyContactPhone||void 0,emergencyContactRelationship:n.emergencyContactRelationship||void 0,insuranceProvider:n.insuranceProvider||void 0,insurancePolicyNumber:n.insurancePolicyNumber||void 0}}catch(r){return console.error("Error getting customer health info:",r),null}}static async updateCustomerHealthInfo(e,r){try{return await ce.update(hi).set({bloodType:r.bloodType,height:r.height,weight:r.weight?r.weight.toString():void 0,allergies:r.allergies,chronicConditions:r.chronicConditions,currentMedications:r.currentMedications,emergencyContactName:r.emergencyContactName,emergencyContactPhone:r.emergencyContactPhone,emergencyContactRelationship:r.emergencyContactRelationship,insuranceProvider:r.insuranceProvider,insurancePolicyNumber:r.insurancePolicyNumber,updatedAt:new Date}).where(Le(hi.customerId,e)),!0}catch(n){return console.error("Error updating customer health info:",n),!1}}static async saveCustomerOrderItems(e){try{const r=e.map(n=>({id:n.id||`order-item-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,customerId:n.customerId,orderId:n.orderId,productId:n.productId,productName:n.productName,productCategory:n.productCategory,quantity:n.quantity,unitPrice:n.unitPrice.toString(),totalPrice:n.totalPrice.toString(),therapeuticClass:n.therapeuticClass,activeIngredients:n.activeIngredients||[],orderDate:n.orderDate,orderStatus:n.orderStatus}));return await ce.insert(Aa).values(r),!0}catch(r){return console.error("Error saving customer order items:",r),!1}}static async getCustomerOrderHistory(e,r=50){try{return(await ce.select().from(Aa).where(Le(Aa.customerId,e)).orderBy(Er(Aa.orderDate)).limit(r)).map(a=>({id:a.id,customerId:a.customerId,orderId:a.orderId,productId:a.productId,productName:a.productName,productCategory:a.productCategory,quantity:a.quantity,unitPrice:parseFloat(a.unitPrice),totalPrice:parseFloat(a.totalPrice),therapeuticClass:a.therapeuticClass||void 0,activeIngredients:a.activeIngredients||[],orderDate:a.orderDate,orderStatus:a.orderStatus}))}catch(n){return console.error("Error getting customer order history:",n),[]}}static async updateCustomerPurchasePatterns(e){try{const r=await this.getCustomerOrderHistory(e,1e3),n={};r.forEach(o=>{n[o.productCategory]||(n[o.productCategory]=[]),n[o.productCategory].push(o)});const a=[];for(const[o,c]of Object.entries(n)){const u=c.reduce((P,B)=>P+B.quantity,0),h=c.reduce((P,B)=>P+B.totalPrice,0),f=c.length,m=u/f,v=c.map(P=>new Date(P.orderDate)).sort(),w=v[0],N=v[v.length-1],g={spring:0,summer:0,autumn:0,winter:0};c.forEach(P=>{const B=new Date(P.orderDate).getMonth();B>=2&&B<=4?g.spring++:B>=5&&B<=7?g.summer++:B>=8&&B<=10?g.autumn++:g.winter++});const y=(Date.now()-N.getTime())/(1e3*60*60*24),j=Math.max(0,100-y/30*10),_=Math.min(100,f*10),b=j*.4+_*.6;a.push({customerId:e,productCategory:o,purchaseFrequency:f,totalQuantity:u,totalAmount:h,averageQuantityPerOrder:m,lastPurchaseDate:N,firstPurchaseDate:w,preferenceScore:b,seasonalPattern:g})}if(await ce.delete(Ls).where(Le(Ls.customerId,e)),a.length>0){const o=a.map(c=>({id:`pattern-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,customerId:c.customerId,productCategory:c.productCategory,purchaseFrequency:c.purchaseFrequency,totalQuantity:c.totalQuantity,totalAmount:c.totalAmount.toString(),averageQuantityPerOrder:c.averageQuantityPerOrder.toString(),lastPurchaseDate:c.lastPurchaseDate,firstPurchaseDate:c.firstPurchaseDate,preferenceScore:c.preferenceScore.toString(),seasonalPattern:c.seasonalPattern}));await ce.insert(Ls).values(o)}return!0}catch(r){return console.error("Error updating customer purchase patterns:",r),!1}}static async getCustomerPurchasePatterns(e){try{return(await ce.select().from(Ls).where(Le(Ls.customerId,e)).orderBy(Er(Ls.preferenceScore))).map(n=>({id:n.id,customerId:n.customerId,productCategory:n.productCategory,purchaseFrequency:n.purchaseFrequency||0,totalQuantity:n.totalQuantity||0,totalAmount:parseFloat(n.totalAmount||"0"),averageQuantityPerOrder:parseFloat(n.averageQuantityPerOrder||"0"),lastPurchaseDate:n.lastPurchaseDate||void 0,firstPurchaseDate:n.firstPurchaseDate||void 0,preferenceScore:parseFloat(n.preferenceScore||"0"),seasonalPattern:n.seasonalPattern||{spring:0,summer:0,autumn:0,winter:0}}))}catch(r){return console.error("Error getting customer purchase patterns:",r),[]}}static async getCompleteCustomerProfile(e){try{const r=await ce.select().from(tt).where(Le(tt.id,e)).limit(1);if(r.length===0)return null;const n=r[0],a=await this.getCustomerHealthInfo(e),o=await this.getCustomerOrderHistory(e),c=await this.getCustomerPurchasePatterns(e);return{customer:n,healthInfo:a,orderHistory:o,purchasePatterns:c}}catch(r){return console.error("Error getting complete customer profile:",r),null}}}function gl(t){if(!t)return null;if(typeof t=="object")return t;if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.warn("Failed to parse JSON:",e,"Data:",t),null}return null}class Qr{static async getCustomerByEmail(e){try{const r=await ce.select().from(tt).where(Le(tt.email,e)).limit(1);return r.length===0?(console.log("No customer found with email:",e),null):{id:r[0].id,name:r[0].name,email:r[0].email}}catch(r){return console.error("Error finding customer by email:",r),null}}async getPersonalizedRecommendations(e,r){try{console.log("🔍 Getting personalized recommendations for customer:",e),console.log("📊 Total products available:",r.length);const n=await Qr.getCustomerProfile(e);if(!n)return console.log("❌ No customer profile found for ID:",e),[];console.log("✅ Customer profile found:",{name:n.name,email:n.email,totalOrders:n.totalOrders,preferredCategories:n.preferredCategories});const a=await Qr.analyzeCustomerHabits(e);console.log("📈 Order history analyzed:",a.length,"orders");const o=await Qr.getHealthInsights(e);console.log("🏥 Health insights generated:",o.length);const c=[],u=await Qr.getHealthBasedRecommendations(n,r);console.log("🏥 Health-based recommendations:",u.length),c.push(...u);const h=await Qr.getComplementaryRecommendations(a,r);console.log("🔗 Complementary recommendations:",h.length),c.push(...h),console.log("🎯 Total recommendations before sorting:",c.length);const f=c.sort((m,v)=>v.score-m.score).slice(0,10);return console.log("✅ Final recommendations returned:",f.length),f}catch(n){return console.error("❌ Error getting personalized recommendations:",n),[]}}async generateHealthInsights(e){return Qr.getHealthInsights(e)}static async getCustomerProfile(e){var r;try{console.log("🔍 Getting customer profile from database for:",e);const n=await jn.getCompleteCustomerProfile(e);if(!n)return console.log("❌ No customer profile found"),null;const{customer:a,healthInfo:o,orderHistory:c,purchasePatterns:u}=n;console.log("✅ Customer profile retrieved:",{customerName:a.name,orderHistoryItems:c.length,purchasePatterns:u.length,hasHealthInfo:!!o});const h=c.length,f=c.reduce((j,_)=>j+_.totalPrice,0),m=h>0?f/h:0,v=(r=c[0])==null?void 0:r.orderDate.toISOString(),w=u.sort((j,_)=>_.preferenceScore-j.preferenceScore).slice(0,5).map(j=>j.productCategory),N=j=>{const _=new Date(j),b=new Date;let P=b.getFullYear()-_.getFullYear();const B=b.getMonth()-_.getMonth();return(B<0||B===0&&b.getDate()<_.getDate())&&P--,P},g=a.healthStatus?a.healthStatus:{},y=a.dateOfBirth?N(a.dateOfBirth):void 0;return{id:a.id,name:a.name,email:a.email,age:y,gender:o!=null&&o.bloodType?"male":g.gender||void 0,healthConditions:(o==null?void 0:o.chronicConditions)||[],allergies:(o==null?void 0:o.allergies)||a.allergies||[],chronicConditions:(o==null?void 0:o.chronicConditions)||[],preferredCategories:w,totalOrders:h,averageOrderValue:m,lastOrderDate:v,purchasePatterns:u,healthInfo:o||void 0}}catch(n){return console.error("❌ Error getting customer profile:",n),null}}static async analyzeCustomerHabits(e){try{console.log("📈 Analyzing customer habits from database for:",e);const r=await jn.getCustomerOrderHistory(e);console.log("✅ Retrieved order items:",r.length);const n={};r.forEach(o=>{n[o.orderId]||(n[o.orderId]=[]),n[o.orderId].push(o)});const a=[];for(const[o,c]of Object.entries(n)){const u=c[0],h=c.map(v=>({id:v.productId,name:v.productName,category:v.productCategory,quantity:v.quantity,price:v.unitPrice,therapeuticClass:v.therapeuticClass,activeIngredients:v.activeIngredients||[]})),f=await this.determineOrderFrequencyFromDatabase(c,e),m=c.reduce((v,w)=>v+w.totalPrice,0);a.push({orderId:o,date:u.orderDate.toISOString(),products:h,totalAmount:m,frequency:f})}return console.log("✅ Analyzed order history:",a.length,"orders"),a.sort((o,c)=>new Date(c.date).getTime()-new Date(o.date).getTime())}catch(r){return console.error("❌ Error analyzing customer habits:",r),[]}}static async determineOrderFrequencyFromDatabase(e,r){try{const n=await jn.getCustomerPurchasePatterns(r),a=[...new Set(e.map(u=>u.productCategory))];let o=0,c=0;for(const u of a){const h=n.find(f=>f.productCategory===u);h&&(o=Math.max(o,h.purchaseFrequency),c++)}return o>=5||c>=3?"chronic":o>=2?"regular":"one-time"}catch(n){return console.warn("Error determining order frequency from database:",n),"one-time"}}static async generateRecommendations(e){try{const r=await this.getCustomerProfile(e),n=await this.analyzeCustomerHabits(e);if(!r)return[];const a=await ce.select().from(Zt),o=[],c=this.getSimilarProductRecommendations(n,a,r);o.push(...c);const u=this.getHealthBasedRecommendations(r,a);o.push(...u);const h=this.getComplementaryRecommendations(n,a);o.push(...h);const f=this.getTrendingRecommendations(r,a);return o.push(...f),this.removeDuplicatesAndSort(o).slice(0,12)}catch(r){return console.error("❌ Error generating recommendations:",r),[]}}static async getHealthInsights(e){try{const r=await this.getCustomerProfile(e),n=await this.analyzeCustomerHabits(e);if(!r)return[];const a=[];if(r.chronicConditions)for(const u of r.chronicConditions){const h=this.analyzeChronicCondition(u,n);h&&a.push(h)}const o=this.analyzeMedicationPatterns(n);a.push(...o);const c=this.analyzeHealthTrends(n,r);return a.push(...c),a}catch(r){return console.error("❌ Error getting health insights:",r),[]}}static determineOrderFrequency(e,r){if(!e.items)return"one-time";try{let n;if(typeof e.items=="string")n=JSON.parse(e.items);else if(typeof e.items=="object")n=e.items;else return"one-time";if(!Array.isArray(n))return"one-time";const a=n.map(c=>c.productId||c.id);let o=0;for(const c of r)if(c.id!==e.id&&c.items)try{let u;if(typeof c.items=="string")u=JSON.parse(c.items);else if(typeof c.items=="object")u=c.items;else continue;if(!Array.isArray(u))continue;const h=u.map(m=>m.productId||m.id);a.filter(m=>h.includes(m)).length>0&&o++}catch(u){console.warn("Error parsing order items in frequency check:",u)}return o>=3?"chronic":o>=1?"regular":"one-time"}catch(n){return console.warn("Error in determineOrderFrequency:",n),"one-time"}}static getSimilarProductRecommendations(e,r,n){const a=[],o=new Set;return e.forEach(c=>{c.products.forEach(u=>{o.add(u.id)})}),r.forEach(c=>{var f;if(o.has(c.id)||c.stockQuantity<=0)return;let u=0;const h=[];(f=n.preferredCategories)!=null&&f.includes(c.category)&&(u+=30,h.push(`Popular in your preferred category: ${c.category}`)),c.price<=n.averageOrderValue*1.5&&(u+=20,h.push("Within your typical price range")),u>25&&a.push({product:{id:c.id,name:c.name,category:c.category,price:c.price,description:c.description||"",therapeuticClass:c.therapeuticClass,activeIngredients:gl(c.activeIngredients)||[],stockQuantity:c.stockQuantity},score:u,reasons:h,recommendationType:"similar",confidence:Math.min(u/50,1)})}),a}static getHealthBasedRecommendations(e,r){const n=[];if(!e.healthConditions&&!e.chronicConditions)return n;const a=[...e.healthConditions||[],...e.chronicConditions||[]];return r.forEach(o=>{if(o.stockQuantity<=0)return;let c=0;const u=[];a.forEach(h=>{o.therapeuticClass&&this.isRelevantForCondition(h,o.therapeuticClass)&&(c+=40,u.push(`Recommended for ${h}`)),o.description&&o.description.toLowerCase().includes(h.toLowerCase())&&(c+=20,u.push(`May help with ${h}`))}),e.age&&(e.age>=60&&o.category==="Senior Health"&&(c+=25,u.push("Senior health supplement")),e.age<=30&&o.category==="Vitamins"&&(c+=15,u.push("Young adult wellness"))),c>30&&n.push({product:{id:o.id,name:o.name,category:o.category,price:o.price,description:o.description||"",therapeuticClass:o.therapeuticClass,activeIngredients:gl(o.activeIngredients)||[],stockQuantity:o.stockQuantity},score:c,reasons:u,recommendationType:"health-based",confidence:Math.min(c/60,1)})}),n}static getComplementaryRecommendations(e,r){const n=[],a=new Set;e.slice(0,5).forEach(c=>{c.products.forEach(u=>{a.add(u.category)})});const o={"Pain Relief":["Digestive Health","Sleep Aid"],Antibiotics:["Probiotics","Digestive Health"],"Blood Pressure":["Heart Health","Kidney Health"],Diabetes:["Heart Health","Kidney Health","Eye Care"],Vitamins:["Minerals","Digestive Health"],"Skin Care":["Vitamins","Anti-inflammatory"]};return r.forEach(c=>{if(c.stockQuantity<=0)return;let u=0;const h=[],f=c.category;a.forEach(m=>{var w;const v=m;(w=o[v])!=null&&w.includes(f)&&(u+=35,h.push(`Complements your recent ${v} purchase`))}),u>20&&n.push({product:{id:c.id,name:c.name,category:c.category,price:c.price,description:c.description||"",therapeuticClass:c.therapeuticClass,activeIngredients:gl(c.activeIngredients)||[],stockQuantity:c.stockQuantity},score:u,reasons:h,recommendationType:"complementary",confidence:Math.min(u/40,1)})}),n}static getTrendingRecommendations(e,r){const n=[],a=["Vitamins","Immune Support","Mental Health","Digestive Health"];return r.forEach(o=>{if(o.stockQuantity<=0)return;let c=0;const u=[];a.includes(o.category)&&(c+=25,u.push("Currently trending in your area"));const h=new Date().getMonth();(h>=10||h<=2)&&["Immune Support","Vitamins","Cold & Flu"].includes(o.category)&&(c+=20,u.push("Popular during winter season")),c>20&&n.push({product:{id:o.id,name:o.name,category:o.category,price:o.price,description:o.description||"",therapeuticClass:o.therapeuticClass,activeIngredients:gl(o.activeIngredients)||[],stockQuantity:o.stockQuantity},score:c,reasons:u,recommendationType:"trending",confidence:Math.min(c/45,1)})}),n}static isRelevantForCondition(e,r){return({diabetes:["Antidiabetic","Insulin","Blood Sugar"],hypertension:["Antihypertensive","ACE Inhibitor","Beta Blocker"],arthritis:["Anti-inflammatory","Pain Relief","NSAID"],depression:["Antidepressant","Mental Health","Mood Stabilizer"],anxiety:["Anxiolytic","Mental Health","Sedative"],asthma:["Bronchodilator","Respiratory","Anti-inflammatory"]}[e.toLowerCase()]||[]).some(o=>r.includes(o))}static analyzeChronicCondition(e,r){var u,h;const n=r.filter(f=>f.products.some(m=>this.isRelevantForCondition(e,m.therapeuticClass||"")));if(n.length===0)return null;const a=n.length,o=(u=n[0])==null?void 0:u.date;let c="low";return a>=5?c="high":a>=3&&(c="medium"),{condition:e,severity:c,recommendedActions:["Maintain regular medication schedule","Monitor symptoms regularly","Consult healthcare provider for adjustments"],suggestedProducts:((h=n[0])==null?void 0:h.products.map(f=>f.name))||[],lastRelatedPurchase:o,frequency:a}}static analyzeMedicationPatterns(e){const r=[],n={};return e.forEach(a=>{a.products.forEach(o=>{o.therapeuticClass&&(n[o.therapeuticClass]=(n[o.therapeuticClass]||0)+1)})}),Object.entries(n).forEach(([a,o])=>{o>=3&&r.push({condition:`Regular ${a} use`,severity:o>=5?"high":"medium",recommendedActions:["Continue as prescribed","Monitor for side effects","Schedule regular check-ups"],suggestedProducts:[],frequency:o})}),r}static analyzeHealthTrends(e,r){const n=[],a=["Vitamins","Supplements","Immune Support"],o=e.filter(c=>c.products.some(u=>a.includes(u.category)));return o.length>=3&&n.push({condition:"Wellness-focused lifestyle",severity:"low",recommendedActions:["Continue preventive care approach","Consider annual health checkups","Maintain balanced diet"],suggestedProducts:["Multivitamins","Omega-3","Probiotics"],frequency:o.length}),n}static removeDuplicatesAndSort(e){const r=new Set;return e.filter(a=>r.has(a.product.id)?!1:(r.add(a.product.id),!0)).sort((a,o)=>o.score-a.score)}}class lE{static async migrateCustomerHealthData(){var e,r,n,a,o;try{console.log("🔄 Starting customer health data migration...");const c=await ce.select().from(tt);for(const u of c)if(u.healthStatus){const h=u.healthStatus,f={customerId:u.id,bloodType:h.bloodType,height:h.height,weight:h.weight,allergies:u.allergies||[],chronicConditions:h.chronicConditions||[],currentMedications:h.currentMedications||[],emergencyContactName:(e=h.emergencyContact)==null?void 0:e.name,emergencyContactPhone:(r=h.emergencyContact)==null?void 0:r.phone,emergencyContactRelationship:(n=h.emergencyContact)==null?void 0:n.relationship,insuranceProvider:(a=h.insurance)==null?void 0:a.provider,insurancePolicyNumber:(o=h.insurance)==null?void 0:o.policyNumber};await jn.saveCustomerHealthInfo(f),console.log(`✅ Migrated health data for customer: ${u.name}`)}console.log("✅ Customer health data migration completed")}catch(c){console.error("❌ Error migrating customer health data:",c)}}static async migrateOrderData(){try{console.log("🔄 Starting order data migration...");const e=await ce.select().from(Ut);for(const r of e)if(r.items&&r.customerId)try{let n;if(typeof r.items=="string")n=JSON.parse(r.items);else if(typeof r.items=="object")n=r.items;else continue;if(Array.isArray(n)){const a=n.map(o=>({customerId:r.customerId,orderId:r.id,productId:o.productId||o.id||`unknown-${Date.now()}`,productName:o.name||"Unknown Product",productCategory:o.category||"General",quantity:o.quantity||1,unitPrice:parseFloat(o.price)||0,totalPrice:(parseFloat(o.price)||0)*(o.quantity||1),therapeuticClass:o.therapeuticClass,activeIngredients:o.activeIngredients||[],orderDate:r.createdAt||new Date,orderStatus:r.status||"completed"}));await jn.saveCustomerOrderItems(a),console.log(`✅ Migrated order items for order: ${r.id}`)}}catch(n){console.warn(`⚠️ Failed to migrate order ${r.id}:`,n)}console.log("✅ Order data migration completed")}catch(e){console.error("❌ Error migrating order data:",e)}}static async generateAllCustomerPurchasePatterns(){try{console.log("🔄 Generating purchase patterns for all customers...");const e=await ce.select().from(tt);for(const r of e)await jn.updateCustomerPurchasePatterns(r.id),console.log(`✅ Generated purchase patterns for customer: ${r.name}`);console.log("✅ Purchase patterns generation completed")}catch(e){console.error("❌ Error generating purchase patterns:",e)}}static async runCompleteMigration(){console.log("🚀 Starting complete database migration..."),await this.migrateCustomerHealthData(),await this.migrateOrderData(),await this.generateAllCustomerPurchasePatterns(),console.log("🎉 Complete database migration finished!")}static async createSampleDataForCustomer(e){try{console.log("🔄 Creating sample data for customer:",e);const r=await ce.select().from(tt).where(Le(tt.email,e)).limit(1);if(r.length===0){console.log("❌ Customer not found with email:",e);return}const n=r[0],a={customerId:n.id,bloodType:"A+",height:170,weight:70,allergies:["Penicillin","Shellfish"],chronicConditions:["Hypertension","Diabetes Type 2"],currentMedications:[{name:"Lisinopril",dosage:"10mg",frequency:"Once daily",startDate:"2024-01-15",prescribedBy:"Dr. Smith"},{name:"Metformin",dosage:"500mg",frequency:"Twice daily",startDate:"2024-02-01",prescribedBy:"Dr. Johnson"}],emergencyContactName:"Jane Doe",emergencyContactPhone:"+84 123 456 789",emergencyContactRelationship:"spouse",insuranceProvider:"Vietnam Health Insurance",insurancePolicyNumber:"VHI123456789"};await jn.saveCustomerHealthInfo(a);const o=Date.now(),c=[{id:`order-${o}-1`,customerId:n.id,customerName:n.name,items:JSON.stringify([{productId:"prod-lisinopril",name:"Lisinopril 10mg",price:"25000",quantity:30}]),total:"750000",status:"completed",shippingAddress:"123 Main Street, Ho Chi Minh City",paymentMethod:"cod",paymentStatus:"paid",orderDate:new Date(Date.now()-30*24*60*60*1e3)},{id:`order-${o}-2`,customerId:n.id,customerName:n.name,items:JSON.stringify([{productId:"prod-metformin",name:"Metformin 500mg",price:"15000",quantity:60}]),total:"900000",status:"completed",shippingAddress:"123 Main Street, Ho Chi Minh City",paymentMethod:"cod",paymentStatus:"paid",orderDate:new Date(Date.now()-15*24*60*60*1e3)},{id:`order-${o}-3`,customerId:n.id,customerName:n.name,items:JSON.stringify([{productId:"prod-vitamin-d",name:"Vitamin D3 1000IU",price:"35000",quantity:30}]),total:"1050000",status:"completed",shippingAddress:"123 Main Street, Ho Chi Minh City",paymentMethod:"cod",paymentStatus:"paid",orderDate:new Date(Date.now()-7*24*60*60*1e3)}];await ce.insert(Ut).values(c),console.log("✅ Created sample orders");const u=[{customerId:n.id,orderId:`order-${o}-1`,productId:"prod-lisinopril",productName:"Lisinopril 10mg",productCategory:"Cardiovascular",quantity:30,unitPrice:25e3,totalPrice:75e4,therapeuticClass:"ACE Inhibitor",activeIngredients:["Lisinopril"],orderDate:new Date(Date.now()-30*24*60*60*1e3),orderStatus:"completed"},{customerId:n.id,orderId:`order-${o}-2`,productId:"prod-metformin",productName:"Metformin 500mg",productCategory:"Diabetes",quantity:60,unitPrice:15e3,totalPrice:9e5,therapeuticClass:"Biguanide",activeIngredients:["Metformin HCl"],orderDate:new Date(Date.now()-15*24*60*60*1e3),orderStatus:"completed"},{customerId:n.id,orderId:`order-${o}-3`,productId:"prod-vitamin-d",productName:"Vitamin D3 1000IU",productCategory:"Vitamins",quantity:30,unitPrice:35e3,totalPrice:105e4,therapeuticClass:"Vitamin Supplement",activeIngredients:["Cholecalciferol"],orderDate:new Date(Date.now()-7*24*60*60*1e3),orderStatus:"completed"}];await jn.saveCustomerOrderItems(u),await jn.updateCustomerPurchasePatterns(n.id),console.log("✅ Sample data created successfully for customer:",n.name)}catch(r){console.error("❌ Error creating sample data:",r)}}}const cE=()=>{const{user:t}=pt(),{products:e,addCustomer:r}=lt(),[n,a]=R.useState([]),[o,c]=R.useState(!0),[u,h]=R.useState(null),[f,m]=R.useState(!1),v=new Qr;R.useEffect(()=>{t!=null&&t.id&&t.role==="customer"&&g()},[t]);const w=async()=>{if(t)try{const y={name:t.name,email:t.email,phone:"+84 123 456 789",address:"Ho Chi Minh City, Vietnam",dateOfBirth:"1990-01-01",joinDate:new Date().toISOString(),allergies:[],prescriptionHistory:[],orderHistory:[],healthStatus:{bloodType:"A+",height:170,weight:70,chronicConditions:[],emergencyContact:{name:"Emergency Contact",phone:"+84 123 456 789",relationship:"family"}},membershipTier:"bronze",totalSpent:0};await r(y),console.log("✅ Customer record created for user:",t.email),await g()}catch(y){console.error("❌ Failed to create customer record:",y)}},N=async()=>{if(t){m(!0);try{console.log("🔄 Creating sample health and order data for user...");let y=await Qr.getCustomerByEmail(t.email);y||(await w(),y=await Qr.getCustomerByEmail(t.email)),y&&(await lE.createSampleDataForCustomer(t.email),console.log("✅ Sample data created successfully"),await g())}catch(y){console.error("❌ Failed to create sample data:",y)}finally{m(!1)}}};R.useEffect(()=>{t!=null&&t.id&&t.role==="customer"&&g()},[t]);const g=async()=>{try{c(!0),console.log("🔍 Loading recommendations for user:",{id:t.id,email:t.email,name:t.name,role:t.role});let y=await Qr.getCustomerByEmail(t.email);if(!y){console.log("❌ No customer record found for user email:",t.email),console.log("💡 This means the user exists in the users table but not in the customers table"),console.log("🔧 For testing, you can create a customer record manually or through the admin interface"),h(!1),a([]);return}if(console.log("✅ Found customer:",y),h(!0),console.log("📊 Available products for recommendations:",e.length),e.length===0){console.log("⚠️ No products available for recommendations. Please seed the product database."),a([]);return}const j=await v.getPersonalizedRecommendations(y.id,e);console.log("🎯 Generated recommendations:",j.length),a(j.slice(0,3))}catch(y){console.error("❌ Failed to load recommendations:",y),h(!1)}finally{c(!1)}};return(t==null?void 0:t.role)!=="customer"?null:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recommended for You"}),s.jsx("span",{className:"text-sm text-blue-600 hover:text-blue-800 cursor-pointer",children:"View All"})]}),o?s.jsx("div",{className:"space-y-3",children:[1,2,3].map(y=>s.jsx("div",{className:"animate-pulse",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]})},y))}):n.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx("div",{className:"text-gray-400 text-2xl mb-2",children:"🛍️"}),s.jsx("p",{className:"text-gray-500 text-sm mb-3",children:u===!1?"No customer record found for your account":"Complete a few orders to get personalized recommendations"}),u===!1&&s.jsxs("div",{className:"space-y-2",children:[s.jsx("button",{onClick:w,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 text-sm",children:"Create Customer Record"}),s.jsx("button",{onClick:N,disabled:f,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 text-sm disabled:opacity-50",children:f?"Creating Sample Data...":"Create Sample Health & Order Data"})]}),u===!0&&n.length===0&&s.jsx("button",{onClick:N,disabled:f,className:"mb-3 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 text-sm disabled:opacity-50",children:f?"Creating Sample Data...":"Add Sample Health & Order Data"}),s.jsxs("div",{className:"text-xs text-gray-400 space-y-1",children:[s.jsx("p",{children:"Debug Info:"}),s.jsxs("p",{children:["• User Email: ",t==null?void 0:t.email]}),s.jsxs("p",{children:["• User Role: ",t==null?void 0:t.role]}),s.jsxs("p",{children:["• Customer Exists: ",u===null?"Checking...":u?"Yes":"No"]}),s.jsxs("p",{children:["• Available Products: ",e.length]}),s.jsx("p",{children:"• Check browser console for detailed logs"})]})]}):s.jsx("div",{className:"space-y-3",children:n.map((y,j)=>s.jsxs("div",{className:"flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-lg cursor-pointer",children:[s.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsxs("span",{className:"text-blue-600 font-semibold text-sm",children:[y.score,"%"]})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900 text-sm",children:y.product.name}),s.jsx("p",{className:"text-gray-500 text-xs",children:y.reasons[0]}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsxs("span",{className:"text-blue-600 font-semibold",children:["$",y.product.price]}),s.jsx("button",{className:"text-xs bg-blue-600 text-white px-2 py-1 rounded hover:bg-blue-700",children:"Add to Cart"})]})]})]},j))})]})};function uE(){const{user:t}=pt(),{products:e,prescriptions:r,orders:n,customers:a}=lt(),{addNotification:o}=ws(),{getRecentActivities:c}=Co(),[u,h]=R.useState({onlineUsers:1,activeOrders:0,systemLoad:0,uptime:0}),f=c(8);R.useEffect(()=>{const j=n.filter(_=>_.status==="pending"||_.status==="confirmed"||_.status==="assigned").length;h({onlineUsers:1,activeOrders:j,systemLoad:Math.random()*50+25,uptime:Math.floor(Date.now()/1e3/60)%1440})},[n]);const m=j=>{const b={prescription:{icon:Jn,color:"text-blue-500"},product:{icon:Ot,color:"text-green-500"},order:{icon:kn,color:"text-purple-500"},customer:{icon:Yt,color:"text-orange-500"},user:{icon:Yt,color:"text-indigo-500"},system:{icon:cd,color:"text-gray-500"}}[j.type]||{icon:cd,color:"text-gray-500"},P=new Date,B=new Date(j.timestamp),$=P.getTime()-B.getTime(),k=Math.floor($/(1e3*60)),I=Math.floor($/(1e3*60*60)),T=Math.floor($/(1e3*60*60*24));let D;return k<1?D="Just now":k<60?D=`${k}m ago`:I<24?D=`${I}h ago`:D=`${T}d ago`,{...b,timeString:D}},v=r.filter(j=>j.status==="pending").length,w=e.filter(j=>j.stock<=j.minStock).length,N=n.reduce((j,_)=>j+_.total,0),g=a.length,y=(t==null?void 0:t.role)==="customer"?[{name:"My Orders",value:n.filter(j=>j.customerId===t.id).length,icon:kn,color:"bg-purple-500",bgColor:"bg-purple-50",textColor:"text-purple-700"},{name:"My Prescriptions",value:r.filter(j=>j.customerId===t.id).length,icon:Jn,color:"bg-blue-500",bgColor:"bg-blue-50",textColor:"text-blue-700"},{name:"Loyalty Points",value:"2,450",icon:Zc,color:"bg-yellow-500",bgColor:"bg-yellow-50",textColor:"text-yellow-700"},{name:"Next Refill",value:"3 days",icon:Zs,color:"bg-green-500",bgColor:"bg-green-50",textColor:"text-green-700"}]:[{name:"Pending Prescriptions",value:v,icon:Jn,color:"bg-yellow-500",bgColor:"bg-yellow-50",textColor:"text-yellow-700"},{name:"Low Stock Items",value:w,icon:Rn,color:"bg-red-500",bgColor:"bg-red-50",textColor:"text-red-700"},{name:"Total Revenue",value:`₫${N.toLocaleString()}`,icon:Kc,color:"bg-green-500",bgColor:"bg-green-50",textColor:"text-green-700"},{name:"Active Customers",value:g,icon:Yt,color:"bg-blue-500",bgColor:"bg-blue-50",textColor:"text-blue-700"}];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Welcome back, ",t==null?void 0:t.name,"!"]}),s.jsx("p",{className:"text-gray-600",children:(t==null?void 0:t.role)==="customer"?"Here's your health and order overview.":"Here's what's happening at Long Chau Pharmacy today."})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-sm text-gray-500",children:"Today Date"}),s.jsx("p",{className:"text-lg font-semibold text-gray-900",children:new Date().toLocaleDateString("vi-VN")}),s.jsxs("div",{className:"flex items-center justify-end space-x-2 mt-1",children:[s.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-xs text-green-600",children:"Live"})]})]})]}),s.jsx(Lj,{}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:y.map(j=>s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:j.name}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:j.value})]}),s.jsx("div",{className:`${j.bgColor} p-3 rounded-lg`,children:s.jsx(j.icon,{className:`h-6 w-6 ${j.textColor}`})})]})},j.name))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(cd,{className:"h-5 w-5 mr-2 text-blue-500"}),"Live Activity Feed"]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(fs,{className:"h-4 w-4 text-gray-400 animate-spin"}),s.jsx("span",{className:"text-xs text-gray-500",children:"Auto-updating"})]})]}),s.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:f.map(j=>{const _=m(j),b=_.icon;return s.jsxs("div",{className:"flex items-start space-x-3 p-3 hover:bg-gray-50 rounded-lg transition-colors animate-fadeIn",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(b,{className:`h-5 w-5 ${_.color}`})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:j.action}),s.jsxs("p",{className:"text-sm text-gray-500",children:[j.userName," (",j.userRole,")"]})]}),s.jsx("div",{className:"flex-shrink-0",children:s.jsx("p",{className:"text-xs text-gray-400",children:_.timeString})})]},j.id)})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(sE,{className:"h-5 w-5 mr-2 text-yellow-500"}),"Live Stats"]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"text-gray-600",children:"Online Users"}),s.jsx("span",{className:"font-medium text-green-600",children:u.onlineUsers})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.min(u.onlineUsers/70*100,100)}%`}})})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"text-gray-600",children:"Active Orders"}),s.jsx("span",{className:"font-medium text-blue-600",children:u.activeOrders})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-1000",style:{width:`${Math.min(u.activeOrders/20*100,100)}%`}})})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[s.jsx("span",{className:"text-gray-600",children:"System Load"}),s.jsxs("span",{className:"font-medium text-purple-600",children:[u.systemLoad,"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-purple-500 h-2 rounded-full transition-all duration-1000",style:{width:`${u.systemLoad}%`}})})]}),s.jsx("div",{className:"pt-2 border-t",children:s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Uptime"}),s.jsxs("span",{className:"font-medium text-gray-900",children:[Math.floor(u.uptime/3600),"h ",Math.floor(u.uptime%3600/60),"m"]})]})})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:(t==null?void 0:t.role)==="customer"?s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:"p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors text-left flex items-center space-x-3",children:[s.jsx(kn,{className:"h-5 w-5 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Shop Medicines"})]}),s.jsxs("button",{className:"p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors text-left flex items-center space-x-3",children:[s.jsx(Jn,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Upload Prescription"})]}),s.jsxs("button",{className:"p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors text-left flex items-center space-x-3",children:[s.jsx(rm,{className:"h-5 w-5 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Health Profile"})]}),s.jsxs("button",{className:"p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors text-left flex items-center space-x-3",children:[s.jsx(wh,{className:"h-5 w-5 text-orange-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Payment History"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("button",{className:"p-3 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors text-left flex items-center space-x-3",children:[s.jsx(Jn,{className:"h-5 w-5 text-blue-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Validate Prescription"})]}),s.jsxs("button",{className:"p-3 bg-green-50 hover:bg-green-100 rounded-lg transition-colors text-left flex items-center space-x-3",children:[s.jsx(Ot,{className:"h-5 w-5 text-green-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Update Inventory"})]}),s.jsxs("button",{className:"p-3 bg-purple-50 hover:bg-purple-100 rounded-lg transition-colors text-left flex items-center space-x-3",children:[s.jsx(kn,{className:"h-5 w-5 text-purple-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Process Orders"})]}),s.jsxs("button",{className:"p-3 bg-orange-50 hover:bg-orange-100 rounded-lg transition-colors text-left flex items-center space-x-3",children:[s.jsx(Yt,{className:"h-5 w-5 text-orange-600"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Customer Support"})]})]})})]}),(t==null?void 0:t.role)==="customer"&&s.jsx(cE,{})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"System Status"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Lt,{className:"h-5 w-5 text-green-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Prescription System"}),s.jsx("p",{className:"text-xs text-green-600",children:"Operational"})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Lt,{className:"h-5 w-5 text-green-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Inventory System"}),s.jsx("p",{className:"text-xs text-green-600",children:"Operational"})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Bn,{className:"h-5 w-5 text-yellow-500 animate-pulse"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Payment Gateway"}),s.jsx("p",{className:"text-xs text-yellow-600",children:"Maintenance"})]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Lt,{className:"h-5 w-5 text-green-500"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Notification Service"}),s.jsx("p",{className:"text-xs text-green-600",children:"Operational"})]})]})]})]})]})}function dE(){const{user:t}=pt(),{prescriptions:e,updatePrescription:r}=lt(),{addNotification:n}=ws(),[a,o]=R.useState(""),[c,u]=R.useState("all"),[h,f]=R.useState(null),[m,v]=R.useState(""),[w,N]=R.useState(!1),[g,y]=R.useState(null),[j,_]=R.useState(null),[b,P]=R.useState([{productName:"",dosage:"",quantity:1,instructions:""}]),[B,$]=R.useState(!1),k=e.filter(re=>{const Z=re.customerName.toLowerCase().includes(a.toLowerCase())||re.id.toLowerCase().includes(a.toLowerCase()),ne=c==="all"||re.status===c,ie=(t==null?void 0:t.role)==="customer"?re.customerId===t.id:!0;return Z&&ne&&ie}),I=(re,Z,ne)=>{const ie=e.find(fe=>fe.id===re);if(!ie)return;const K={...ie,status:Z,pharmacistId:t==null?void 0:t.id,pharmacistName:t==null?void 0:t.name,validationDate:new Date().toISOString(),notes:ne||ie.notes};r(K),f(null),v(""),n({type:Z==="validated"?"success":"warning",title:`Prescription ${Z}`,message:`Prescription ${ie.id} has been ${Z} for ${ie.customerName}`,actionUrl:"/prescriptions"})},{addPrescription:T,customers:D}=lt(),U=re=>{var ne;const Z=(ne=re.target.files)==null?void 0:ne[0];if(Z){y(Z);const ie=new FileReader;ie.onload=K=>{var fe;_((fe=K.target)==null?void 0:fe.result)},ie.readAsDataURL(Z)}},V=()=>{P([...b,{productName:"",dosage:"",quantity:1,instructions:""}])},z=(re,Z,ne)=>{const ie=b.map((K,fe)=>fe===re?{...K,[Z]:ne}:K);P(ie)},q=re=>{P(b.filter((Z,ne)=>ne!==re))},Q=re=>{if(re.preventDefault(),!t)return;const Z=D.find(K=>K.id===t.id);if(!Z)return;const ne=b.filter(K=>K.productName.trim()&&K.dosage.trim());if(ne.length===0){alert("Please add at least one medication.");return}const ie={customerId:t.id,customerName:Z.name,medications:ne.map(K=>({productId:"",productName:K.productName,dosage:K.dosage,quantity:K.quantity,instructions:K.instructions})),status:"pending",uploadDate:new Date().toISOString(),imageUrl:j||void 0};T(ie),n({type:"success",title:"Prescription Uploaded Successfully!",message:`Your prescription has been submitted for review. Reference ID: ${ie.customerId}-${Date.now()}`,actionUrl:"/prescriptions"}),y(null),_(null),P([{productName:"",dosage:"",quantity:1,instructions:""}]),$(!0),N(!1),setTimeout(()=>$(!1),3e3)},te=re=>{switch(re){case"pending":return s.jsx(Bn,{className:"h-4 w-4 text-yellow-500"});case"validated":return s.jsx(Lt,{className:"h-4 w-4 text-green-500"});case"dispensed":return s.jsx(Lt,{className:"h-4 w-4 text-blue-500"});case"rejected":return s.jsx(Ej,{className:"h-4 w-4 text-red-500"});default:return s.jsx(Bn,{className:"h-4 w-4 text-gray-500"})}},de=re=>{switch(re){case"pending":return"bg-yellow-100 text-yellow-800";case"validated":return"bg-green-100 text-green-800";case"dispensed":return"bg-blue-100 text-blue-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return s.jsxs("div",{className:"space-y-6",children:[B&&s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center space-x-3",children:[s.jsx(Lt,{className:"h-6 w-6 text-green-600"}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Prescription Uploaded Successfully!"}),s.jsx("p",{className:"text-sm text-green-700",children:"Your prescription has been submitted for pharmacist review."})]})]}),(t==null?void 0:t.role)==="customer"&&w&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl p-6 max-w-2xl w-full mx-4 max-h-screen overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Upload Prescription"}),s.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(Rr,{className:"h-6 w-6"})})]}),s.jsxs("form",{onSubmit:Q,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Prescription Image"}),s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:U,className:"hidden",id:"prescription-upload"}),s.jsx("label",{htmlFor:"prescription-upload",className:"cursor-pointer",children:j?s.jsxs("div",{className:"space-y-3",children:[s.jsx("img",{src:j,alt:"Prescription preview",className:"max-h-40 mx-auto rounded-lg"}),s.jsx("p",{className:"text-sm text-gray-600",children:"Click to change image"})]}):s.jsxs("div",{className:"space-y-3",children:[s.jsx(Cj,{className:"h-12 w-12 text-gray-400 mx-auto"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Upload prescription image"}),s.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG up to 10MB"})]})]})})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Medications"}),s.jsx("button",{type:"button",onClick:V,className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"+ Add Medication"})]}),s.jsx("div",{className:"space-y-4",children:b.map((re,Z)=>s.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Medication ",Z+1]}),b.length>1&&s.jsx("button",{type:"button",onClick:()=>q(Z),className:"text-red-600 hover:text-red-800 text-sm",children:"Remove"})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx("input",{type:"text",placeholder:"Medication name",value:re.productName,onChange:ne=>z(Z,"productName",ne.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),s.jsx("input",{type:"text",placeholder:"Dosage (e.g., 500mg)",value:re.dosage,onChange:ne=>z(Z,"dosage",ne.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[s.jsx("input",{type:"number",placeholder:"Quantity",value:re.quantity,onChange:ne=>z(Z,"quantity",parseInt(ne.target.value)||1),min:"1",className:"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),s.jsx("input",{type:"text",placeholder:"Instructions",value:re.instructions,onChange:ne=>z(Z,"instructions",ne.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]},Z))})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center justify-center space-x-2",children:[s.jsx($g,{className:"h-4 w-4"}),s.jsx("span",{children:"Submit Prescription"})]}),s.jsx("button",{type:"button",onClick:()=>N(!1),className:"px-6 py-3 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Prescription Management"}),s.jsx("p",{className:"text-gray-600",children:(t==null?void 0:t.role)==="customer"?"View and upload your prescriptions":"Validate and manage patient prescriptions"})]}),(t==null?void 0:t.role)==="customer"&&s.jsxs("button",{onClick:()=>N(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx($g,{className:"h-4 w-4"}),s.jsx("span",{children:"Upload Prescription"})]})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search prescriptions...",value:a,onChange:re=>o(re.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Wc,{className:"h-4 w-4 text-gray-400"}),s.jsxs("select",{value:c,onChange:re=>u(re.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"validated",children:"Validated"}),s.jsx("option",{value:"dispensed",children:"Dispensed"}),s.jsx("option",{value:"rejected",children:"Rejected"})]})]})]}),s.jsxs("div",{className:"text-sm text-gray-500",children:[k.length," prescription(s) found"]})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100",children:k.length===0?s.jsxs("div",{className:"p-12 text-center",children:[s.jsx(Jn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No prescriptions found"}),s.jsx("p",{className:"text-gray-500",children:(t==null?void 0:t.role)==="customer"?"Upload your first prescription to get started.":"No prescriptions match your current filters."})]}):s.jsx("div",{className:"divide-y divide-gray-100",children:k.map(re=>s.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[te(re.status),s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${de(re.status)}`,children:re.status.charAt(0).toUpperCase()+re.status.slice(1)})]}),s.jsxs("span",{className:"text-sm text-gray-500",children:["ID: ",re.id]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx($n,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"text-sm font-medium text-gray-900",children:re.customerName})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Zs,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-sm text-gray-600",children:["Uploaded: ",new Date(re.uploadDate).toLocaleDateString("vi-VN")]})]}),re.pharmacistName&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx($n,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-sm text-gray-600",children:["Pharmacist: ",re.pharmacistName]})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(JT,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Medications:"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:re.medications.map((Z,ne)=>s.jsxs("div",{className:"text-sm bg-gray-50 rounded-lg p-3",children:[s.jsx("div",{className:"font-medium text-gray-900",children:Z.productName}),s.jsxs("div",{className:"text-gray-600",children:[Z.dosage," • Qty: ",Z.quantity]}),Z.instructions&&s.jsx("div",{className:"text-xs text-gray-500 mt-1",children:Z.instructions})]},ne))})]}),re.notes&&s.jsxs("div",{className:"mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(YT,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Pharmacist Notes:"})]}),s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:s.jsx("p",{className:"text-sm text-blue-800",children:re.notes})})]})]}),s.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[re.imageUrl&&s.jsx("button",{onClick:()=>window.open(re.imageUrl,"_blank"),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"View prescription image",children:s.jsx(us,{className:"h-4 w-4"})}),(t==null?void 0:t.role)!=="customer"&&re.status==="pending"&&s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{onClick:()=>I(re.id,"validated"),className:"bg-green-600 text-white px-3 py-1 rounded-lg hover:bg-green-700 transition-colors text-sm flex items-center space-x-1",children:[s.jsx(Pj,{className:"h-3 w-3"}),s.jsx("span",{children:"Approve"})]}),s.jsxs("button",{onClick:()=>I(re.id,"rejected","Requires clarification"),className:"bg-red-600 text-white px-3 py-1 rounded-lg hover:bg-red-700 transition-colors text-sm flex items-center space-x-1",children:[s.jsx(Rr,{className:"h-3 w-3"}),s.jsx("span",{children:"Reject"})]})]})]})]})},re.id))})})]})}function hE(){const{user:t}=pt(),{products:e,updateProduct:r,addProduct:n}=lt(),{addNotification:a}=ws(),{addActivity:o}=Co(),[c,u]=R.useState(""),[h,f]=R.useState("all"),[m,v]=R.useState(!1),[w,N]=R.useState(!1),[g,y]=R.useState(!1),[j,_]=R.useState(null),[b,P]=R.useState(0),B=(t==null?void 0:t.role)==="pharmacist"||(t==null?void 0:t.role)==="manager",$=[...new Set(e.map(z=>z.category))],k=e.filter(z=>{const q=z.name.toLowerCase().includes(c.toLowerCase())||z.manufacturer.toLowerCase().includes(c.toLowerCase()),Q=h==="all"||z.category===h,te=!m||z.stock<=z.minStock;return q&&Q&&te}),I=(z,q)=>{const Q=e.find(te=>te.id===z);if(Q){const te=Q.stock;r({...Q,stock:q}),o("product","Updated product stock",`Updated stock for "${Q.name}" from ${te} to ${q}`,{productName:Q.name,amount:q-te}),a({title:"Stock Updated",message:`Stock updated for ${Q.name}`,type:"success"})}},T=z=>{_(z),P(z.stock),y(!0)},D=()=>{j&&(I(j.id,b),y(!1),_(null))},U=async z=>{try{await n(z),o("product","Added new product",`Product "${z.name}" was added to inventory`,{productName:z.name,amount:z.stock}),N(!1),a({title:"Product Added",message:`${z.name} has been added to inventory`,type:"success"})}catch(q){console.error("Error adding product:",q),a({title:"Error",message:"Failed to add product. Please try again.",type:"error"})}},V=z=>z.stock===0?{color:"text-red-600",bg:"bg-red-100",label:"Out of Stock"}:z.stock<=z.minStock?{color:"text-yellow-600",bg:"bg-yellow-100",label:"Low Stock"}:{color:"text-green-600",bg:"bg-green-100",label:"In Stock"};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Inventory Management"}),s.jsx("p",{className:"text-gray-600",children:B?"Manage product stock levels and add new products":"View product inventory information"})]}),B&&s.jsxs("button",{onClick:()=>N(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(Di,{className:"h-4 w-4"}),s.jsx("span",{children:"Add Product"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Products"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:e.length})]}),s.jsx(Ot,{className:"h-8 w-8 text-blue-500"})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Low Stock Items"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:e.filter(z=>z.stock<=z.minStock).length})]}),s.jsx(rE,{className:"h-8 w-8 text-red-500"})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Out of Stock"}),s.jsx("p",{className:"text-2xl font-bold text-red-600",children:e.filter(z=>z.stock===0).length})]}),s.jsx(Rn,{className:"h-8 w-8 text-red-500"})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Value"}),s.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["₫",e.reduce((z,q)=>z+q.price*q.stock,0).toLocaleString()]})]}),s.jsx(Kc,{className:"h-8 w-8 text-green-500"})]})})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search products...",value:c,onChange:z=>u(z.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Wc,{className:"h-4 w-4 text-gray-400"}),s.jsxs("select",{value:h,onChange:z=>f(z.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Categories"}),$.map(z=>s.jsx("option",{value:z,children:z},z))]})]})]}),s.jsxs("label",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",checked:m,onChange:z=>v(z.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Show only low stock items"})]})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Product"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expiry Date"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:k.map(z=>{const q=V(z);return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:z.name}),s.jsx("div",{className:"text-sm text-gray-500",children:z.manufacturer}),s.jsxs("div",{className:"text-xs text-gray-400",children:["Batch: ",z.batchNumber]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full",children:z.category})}),s.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["₫",z.price.toLocaleString()]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-900",children:z.stock}),s.jsxs("span",{className:"text-xs text-gray-500",children:["/ ",z.minStock," min"]}),z.stock<=z.minStock&&s.jsx(Rn,{className:"h-4 w-4 text-yellow-500"})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${q.bg} ${q.color}`,children:q.label})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(z.expiryDate).toLocaleDateString("vi-VN")}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm space-x-2",children:B?s.jsx("div",{className:"flex items-center space-x-2",children:s.jsxs("button",{onClick:()=>T(z),className:"text-blue-600 hover:text-blue-800 transition-colors flex items-center space-x-1",title:"Update Stock",children:[s.jsx(ea,{className:"h-4 w-4"}),s.jsx("span",{className:"text-xs",children:"Stock"})]})}):s.jsx("span",{className:"text-gray-400 text-xs",children:"View Only"})})]},z.id)})})]})})}),k.length===0&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center",children:[s.jsx(Ot,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No products found"}),s.jsx("p",{className:"text-gray-500",children:"Try adjusting your search criteria or add new products to inventory."})]}),s.jsx(fE,{isOpen:w,onClose:()=>N(!1),onSubmit:U,addNotification:a}),s.jsx(mE,{isOpen:g,onClose:()=>y(!1),product:j,newStock:b,setNewStock:P,onSubmit:D})]})}function fE({isOpen:t,onClose:e,onSubmit:r,addNotification:n}){const[a,o]=R.useState({name:"",description:"",category:"",price:"",stock:"",minStock:"",manufacturer:"",expiryDate:"",requiresPrescription:!1,batchNumber:""}),[c,u]=R.useState(!1),h=["Medicines","Vitamins & Supplements","Personal Care","First Aid","Baby Care","Health Devices","Beauty & Cosmetics"],f=async m=>{if(m.preventDefault(),!c){if(!a.name||!a.category||!a.price||!a.stock){n({title:"Validation Error",message:"Please fill in all required fields",type:"error"});return}u(!0);try{const v={name:a.name,description:a.description,category:a.category,price:parseFloat(a.price),stock:parseInt(a.stock),minStock:parseInt(a.minStock)||10,manufacturer:a.manufacturer,expiryDate:a.expiryDate,requiresPrescription:a.requiresPrescription,batchNumber:a.batchNumber},w=await r(v);if(console.log("📋 Product submission result:",w),w.success){const N=w.stored==="database"?`${a.name} has been added to inventory and saved to database`:`${a.name} has been added to inventory (saved locally)`;n({title:"Product Added",message:N,type:"success"}),o({name:"",description:"",category:"",price:"",stock:"",minStock:"",manufacturer:"",expiryDate:"",requiresPrescription:!1,batchNumber:""}),e()}else n({title:"Error",message:w.error||"Failed to add product",type:"error"})}catch{n({title:"Error",message:"Failed to add product",type:"error"})}finally{u(!1)}}};return t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsx("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Product"}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Rr,{className:"h-6 w-6"})})]}),s.jsxs("form",{onSubmit:f,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Name *"}),s.jsx("input",{type:"text",value:a.name,onChange:m=>o({...a,name:m.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),s.jsxs("select",{value:a.category,onChange:m=>o({...a,category:m.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[s.jsx("option",{value:"",children:"Select Category"}),h.map(m=>s.jsx("option",{value:m,children:m},m))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price (₫) *"}),s.jsx("input",{type:"number",value:a.price,onChange:m=>o({...a,price:m.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,min:"0",step:"100"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Initial Stock *"}),s.jsx("input",{type:"number",value:a.stock,onChange:m=>o({...a,stock:m.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,min:"0"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Stock Level"}),s.jsx("input",{type:"number",value:a.minStock,onChange:m=>o({...a,minStock:m.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0",placeholder:"10"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Manufacturer"}),s.jsx("input",{type:"text",value:a.manufacturer,onChange:m=>o({...a,manufacturer:m.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Date"}),s.jsx("input",{type:"date",value:a.expiryDate,onChange:m=>o({...a,expiryDate:m.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Batch Number"}),s.jsx("input",{type:"text",value:a.batchNumber,onChange:m=>o({...a,batchNumber:m.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),s.jsx("textarea",{value:a.description,onChange:m=>o({...a,description:m.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"requiresPrescription",checked:a.requiresPrescription,onChange:m=>o({...a,requiresPrescription:m.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("label",{htmlFor:"requiresPrescription",className:"ml-2 text-sm text-gray-700",children:"Requires Prescription"})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4",children:[s.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsxs("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center space-x-2",children:[c?s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):s.jsx(Xi,{className:"h-4 w-4"}),s.jsx("span",{children:c?"Adding...":"Add Product"})]})]})]})]})})}):null}function mE({isOpen:t,onClose:e,product:r,newStock:n,setNewStock:a,onSubmit:o}){return!t||!r?null:s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsx("div",{className:"bg-white rounded-xl max-w-md w-full",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Update Stock"}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Rr,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h3",{className:"font-medium text-gray-900",children:r.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Current stock: ",r.stock]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Minimum required: ",r.minStock]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Stock Level"}),s.jsx("input",{type:"number",value:n,onChange:c=>a(parseInt(c.target.value)||0),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"0"})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[s.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsxs("button",{onClick:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[s.jsx(Xi,{className:"h-4 w-4"}),s.jsx("span",{children:"Update Stock"})]})]})]})})})}const pE=()=>{const{orders:t,updateOrder:e}=lt(),[r,n]=R.useState([]),[a,o]=R.useState([]),[c,u]=R.useState(null),[h,f]=R.useState("");R.useEffect(()=>{const N=t.filter(y=>y.status==="pending"),g=t.filter(y=>y.status==="confirmed"&&y.paymentStatus==="pending");n(N),o(g)},[t]);const m=async N=>{try{f(N);const g=t.find(y=>y.id===N);g&&await e({...g,status:"confirmed"}),alert("✅ Order confirmed! Customer can now proceed with payment.")}catch(g){console.error("Error confirming order:",g),alert("❌ Failed to confirm order. Please try again.")}finally{f("")}},v=async N=>{const g=prompt("Please enter rejection reason:");if(g)try{const y=t.find(j=>j.id===N);y&&await e({...y,status:"cancelled",deliveryNotes:`Rejected by pharmacist: ${g}`}),alert("❌ Order rejected and customer has been notified.")}catch(y){console.error("Error rejecting order:",y),alert("❌ Failed to reject order. Please try again.")}},w=(N,g=!1)=>s.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm",children:[s.jsxs("div",{className:"flex justify-between items-start mb-3",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold text-gray-900",children:["Order #",N.id]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Customer: ",N.customerName]}),s.jsx("p",{className:"text-sm text-gray-500",children:new Date(N.orderDate).toLocaleDateString("vi-VN")})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"font-semibold text-lg",children:["₫",N.total.toLocaleString("vi-VN")]}),s.jsx("div",{className:`text-sm px-2 py-1 rounded ${N.status==="pending"?"bg-yellow-100 text-yellow-800":N.status==="confirmed"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:N.status.toUpperCase()})]})]}),s.jsxs("div",{className:"mb-3",children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Items:"}),s.jsx("div",{className:"space-y-1",children:Array.isArray(N.items)?N.items.map((y,j)=>s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsxs("span",{children:[y.name," x",y.quantity]}),s.jsxs("span",{children:["₫",(y.price*y.quantity).toLocaleString("vi-VN")]})]},j)):s.jsx("div",{className:"text-sm text-gray-500",children:"No items details available"})})]}),s.jsx("div",{className:"mb-3",children:s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx("span",{className:"font-medium",children:"Delivery:"})," ",N.shippingAddress]})}),s.jsxs("div",{className:"flex space-x-2",children:[g&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>m(N.id),disabled:h===N.id,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:h===N.id?"⏳ Confirming...":"✅ Confirm Order"}),s.jsx("button",{onClick:()=>v(N.id),className:"flex-1 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"❌ Reject"})]}),!g&&s.jsx("button",{onClick:()=>u(N),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"📋 View Details"})]})]},N.id);return s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Pharmacist Order Management"}),s.jsx("p",{className:"text-gray-600",children:"Review and confirm customer orders before payment processing"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-yellow-800",children:r.length}),s.jsx("div",{className:"text-yellow-700",children:"Pending Review"})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-800",children:a.length}),s.jsx("div",{className:"text-blue-700",children:"Awaiting Payment"})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-2xl font-bold text-green-800",children:t.filter(N=>N.paymentStatus==="paid").length}),s.jsx("div",{className:"text-green-700",children:"Paid Orders"})]})]}),s.jsxs("div",{className:"mb-8",children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:["🔍 Orders Pending Review (",r.length,")"]}),r.length===0?s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[s.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:"📋"}),s.jsx("p",{className:"text-gray-600",children:"No orders pending review"})]}):s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:r.map(N=>w(N,!0))})]}),s.jsxs("div",{className:"mb-8",children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:["💳 Confirmed Orders Awaiting Payment (",a.length,")"]}),a.length===0?s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-8 text-center",children:[s.jsx("div",{className:"text-gray-400 text-4xl mb-2",children:"💳"}),s.jsx("p",{className:"text-gray-600",children:"No confirmed orders awaiting payment"})]}):s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:a.map(N=>w(N,!1))})]}),c&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-screen overflow-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("h3",{className:"text-xl font-semibold",children:["Order Details #",c.id]}),s.jsx("button",{onClick:()=>u(null),className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Customer"}),s.jsx("p",{className:"text-gray-900",children:c.customerName})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Order Date"}),s.jsx("p",{className:"text-gray-900",children:new Date(c.orderDate).toLocaleString("vi-VN")})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),s.jsx("span",{className:`inline-block px-2 py-1 rounded text-sm ${c.status==="confirmed"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:c.status.toUpperCase()})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Payment Status"}),s.jsx("span",{className:`inline-block px-2 py-1 rounded text-sm ${c.paymentStatus==="pending"?"bg-yellow-100 text-yellow-800":c.paymentStatus==="paid"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c.paymentStatus.toUpperCase()})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Shipping Address"}),s.jsx("p",{className:"text-gray-900",children:c.shippingAddress})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Items"}),s.jsxs("div",{className:"bg-gray-50 rounded p-3",children:[Array.isArray(c.items)?c.items.map((N,g)=>s.jsxs("div",{className:"flex justify-between py-1",children:[s.jsxs("span",{children:[N.name," x",N.quantity]}),s.jsxs("span",{children:["₫",(N.price*N.quantity).toLocaleString("vi-VN")]})]},g)):s.jsx("p",{className:"text-gray-500",children:"No item details available"}),s.jsxs("div",{className:"border-t pt-2 mt-2 font-semibold",children:["Total: ₫",c.total.toLocaleString("vi-VN")]})]})]})]})]})})})]})},gE="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Ha=(t=21)=>{let e="",r=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=gE[r[t]&63];return e};class Dl{static async initiatePayment(e){try{const r=Ha(),n={id:r,orderId:e.orderId,customerId:e.customerId,amount:e.amount.toString(),currency:e.currency||"VND",paymentMethod:e.paymentMethod,gatewayProvider:e.gatewayProvider,paymentStatus:"pending",securityCode:Ha(8),ipAddress:"",userAgent:""};switch(await ce.insert(Ye).values(n),e.paymentMethod){case"cod":return await this.handleCODPayment(r);case"vnpay":return await this.handleVNPayPayment(r,e);case"momo":return await this.handleMoMoPayment(r,e);case"zalopay":return await this.handleZaloPayPayment(r,e);case"bank_transfer":return await this.handleBankTransferPayment(r,e);default:throw new Error(`Unsupported payment method: ${e.paymentMethod}`)}}catch(r){return console.error("Payment initiation error:",r),{success:!1,transactionId:"",error:r instanceof Error?r.message:"Payment initiation failed"}}}static async handleCODPayment(e){return await ce.update(Ye).set({paymentStatus:"pending",processedAt:new Date}).where(Le(Ye.id,e)),{success:!0,transactionId:e,message:"Cash on Delivery order confirmed. Pay when you receive your items."}}static async handleVNPayPayment(e,r){try{const n=await this.getGatewayConfig("vnpay");if(!n)throw new Error("VNPay configuration not found");const a={vnp_Version:"2.1.0",vnp_Command:"pay",vnp_TmnCode:n.merchantId,vnp_Amount:Math.round(r.amount*100),vnp_CreateDate:new Date().toISOString().replace(/[-:]/g,"").split(".")[0],vnp_CurrCode:"VND",vnp_IpAddr:"127.0.0.1",vnp_Locale:"vn",vnp_OrderInfo:`Payment for order ${r.orderId}`,vnp_OrderType:"other",vnp_ReturnUrl:r.returnUrl||"http://localhost:5182/payment/return",vnp_TxnRef:e},o=this.generateVNPayUrl(a,n.secretKey||"");return await ce.update(Ye).set({paymentStatus:"processing",gatewayResponse:a}).where(Le(Ye.id,e)),{success:!0,transactionId:e,paymentUrl:o,message:"Redirect to VNPay for payment"}}catch(n){return console.error("VNPay payment error:",n),{success:!1,transactionId:e,error:"VNPay payment setup failed"}}}static async handleMoMoPayment(e,r){try{const n=await this.getGatewayConfig("momo");if(!n)throw new Error("MoMo configuration not found");const a={partnerCode:n.merchantId,requestId:e,amount:r.amount,orderId:r.orderId,orderInfo:`Payment for order ${r.orderId}`,redirectUrl:r.returnUrl||"http://localhost:5182/payment/return",ipnUrl:"http://localhost:5182/api/payment/momo/callback",requestType:"payWithATM",extraData:"",lang:"en"},o=`https://test-payment.momo.vn/gw_payment/transactionProcessor?${new URLSearchParams(a).toString()}`;return await ce.update(Ye).set({paymentStatus:"processing",gatewayResponse:a}).where(Le(Ye.id,e)),{success:!0,transactionId:e,paymentUrl:o,message:"Redirect to MoMo for payment"}}catch(n){return console.error("MoMo payment error:",n),{success:!1,transactionId:e,error:"MoMo payment setup failed"}}}static async handleZaloPayPayment(e,r){var n;try{const a=await this.getGatewayConfig("zalopay");if(!a)throw new Error("ZaloPay configuration not found");const o={app_id:a.merchantId,app_trans_id:e,app_user:((n=r.customerInfo)==null?void 0:n.name)||"customer",amount:r.amount,description:`Payment for order ${r.orderId}`,bank_code:"",callback_url:"http://localhost:5182/api/payment/zalopay/callback"},c="https://sb-openapi.zalopay.vn/v2/create";return await ce.update(Ye).set({paymentStatus:"processing",gatewayResponse:o}).where(Le(Ye.id,e)),{success:!0,transactionId:e,paymentUrl:c,message:"Redirect to ZaloPay for payment"}}catch(a){return console.error("ZaloPay payment error:",a),{success:!1,transactionId:e,error:"ZaloPay payment setup failed"}}}static async handleBankTransferPayment(e,r){const n={bankName:"Vietcombank",accountNumber:"1234567890",accountName:"Long Chau Pharmacy",transferContent:`PAYMENT ${e}`,amount:r.amount};return await ce.update(Ye).set({paymentStatus:"pending",gatewayResponse:n}).where(Le(Ye.id,e)),{success:!0,transactionId:e,message:"Bank transfer instructions generated. Please complete the transfer to confirm your order."}}static async processPaymentCallback(e,r){var n;try{let a,o;switch(e){case"vnpay":a=r.vnp_TxnRef,o=r.vnp_ResponseCode==="00"?"completed":"failed";break;case"momo":a=r.requestId,o=r.resultCode===0?"completed":"failed";break;case"zalopay":a=r.app_trans_id,o=r.return_code===1?"completed":"failed";break;default:throw new Error(`Unsupported provider: ${e}`)}return await ce.update(Ye).set({paymentStatus:o,processedAt:new Date,gatewayTransactionId:r.transaction_id||r.orderId,gatewayResponse:r}).where(Le(Ye.id,a)),o==="completed"&&(await ce.update(Ut).set({paymentStatus:"paid",status:"confirmed"}).where(Le(Ut.id,((n=await this.getTransactionOrder(a))==null?void 0:n.orderId)||"")),await this.generateReceipt(a)),!0}catch(a){return console.error("Payment callback processing error:",a),!1}}static async processRefund(e){try{const r=await ce.select().from(Ye).where(Le(Ye.id,e.transactionId)).limit(1);if(r.length===0)throw new Error("Transaction not found");const n=r[0];return await ce.update(Ye).set({paymentStatus:"refunded",refundAmount:e.amount.toString(),refundDate:new Date,refundReason:e.reason}).where(Le(Ye.id,e.transactionId)),await this.generateRefundReceipt(e.transactionId,e.amount),{success:!0,transactionId:e.transactionId,message:"Refund processed successfully"}}catch(r){return console.error("Refund processing error:",r),{success:!1,transactionId:e.transactionId,error:r instanceof Error?r.message:"Refund failed"}}}static async generateReceipt(e){try{const r=await this.getTransactionDetails(e);if(!r)throw new Error("Transaction not found");const n=Ha(),a=`RC-${Date.now()}-${Math.random().toString(36).substr(2,4).toUpperCase()}`,o={id:n,orderId:r.orderId,paymentTransactionId:e,customerId:r.customerId,receiptNumber:a,type:"sale",subtotal:r.amount,taxAmount:"0",discountAmount:"0",totalAmount:r.amount,items:[],taxRate:"0",qrCode:`RECEIPT-${a}`};await ce.insert(fi).values(o);const c=await this.generateReceiptPDF(o);return await ce.update(fi).set({pdfUrl:c}).where(Le(fi.id,n)),n}catch(r){throw console.error("Receipt generation error:",r),r}}static async getGatewayConfig(e){const r=await ce.select().from(Ml).where(dc(Le(Ml.provider,e),Le(Ml.isActive,!0))).limit(1);return r.length>0?r[0]:null}static async getTransactionOrder(e){const r=await ce.select().from(Ye).where(Le(Ye.id,e)).limit(1);return r.length>0?r[0]:null}static async getTransactionDetails(e){const r=await ce.select().from(Ye).where(Le(Ye.id,e)).limit(1);return r.length>0?r[0]:null}static generateVNPayUrl(e,r){return`https://sandbox.vnpayment.vn/paymentv2/vpcpay.html?${new URLSearchParams(e).toString()}`}static async generateReceiptPDF(e){return`https://receipts.longchau.com/${e.receiptNumber}.pdf`}static async generateRefundReceipt(e,r){return await this.generateReceipt(e)}static async getCustomerPaymentHistory(e){return await ce.select().from(Ye).where(Le(Ye.customerId,e)).orderBy(Ye.createdAt)}static async getReceipt(e){const r=await ce.select().from(fi).where(Le(fi.id,e)).limit(1);return r.length>0?r[0]:null}}const yE=({orderId:t,customerId:e,amount:r,orderDetails:n,onPaymentSuccess:a,onPaymentError:o,onCancel:c})=>{const[u,h]=R.useState(""),[f,m]=R.useState(!1),[v,w]=R.useState(!1),[N,g]=R.useState(null),y=[{id:"cod",name:"Cash on Delivery",icon:"💵",description:"Pay when you receive your order",available:!0},{id:"vnpay",name:"VNPay",icon:"🏦",description:"Vietnamese payment gateway",available:!0},{id:"momo",name:"MoMo E-Wallet",icon:"📱",description:"Pay with MoMo mobile wallet",available:!0},{id:"zalopay",name:"ZaloPay",icon:"⚡",description:"Pay with ZaloPay e-wallet",available:!0},{id:"bank_transfer",name:"Bank Transfer",icon:"🏧",description:"Direct bank transfer",available:!0}],j=async()=>{if(!u){o("Please select a payment method");return}m(!0);try{const _={orderId:t,customerId:e,amount:r,paymentMethod:u,gatewayProvider:u==="cod"?void 0:u,returnUrl:`${window.location.origin}/payment/return`,description:`Payment for order ${t}`,customerInfo:n.customerInfo},b=await Dl.initiatePayment(_);b.success?u==="cod"?a(b.transactionId):u==="bank_transfer"?g(b):b.paymentUrl?window.location.href=b.paymentUrl:b.qrCode&&w(!0):o(b.error||"Payment failed")}catch(_){o(_ instanceof Error?_.message:"Payment failed")}finally{m(!1)}};return s.jsxs("div",{className:"max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-6",children:[s.jsxs("div",{className:"border-b pb-4 mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Complete Your Payment"}),s.jsxs("p",{className:"text-gray-600 mt-1",children:["Order #",t]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Order Summary"}),s.jsxs("div",{className:"space-y-2",children:[n.items.map((_,b)=>s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsxs("span",{children:[_.name," x",_.quantity]}),s.jsxs("span",{children:["₫",(_.price*_.quantity).toLocaleString("vi-VN")]})]},b)),s.jsx("div",{className:"border-t pt-2 mt-2",children:s.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[s.jsx("span",{children:"Total"}),s.jsxs("span",{children:["₫",r.toLocaleString("vi-VN")]})]})})]})]}),!N&&s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-4",children:"Select Payment Method"}),s.jsx("div",{className:"grid grid-cols-1 gap-3",children:y.map(_=>s.jsxs("label",{className:`flex items-center p-4 border rounded-lg cursor-pointer transition-colors ${u===_.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"} ${_.available?"":"opacity-50 cursor-not-allowed"}`,children:[s.jsx("input",{type:"radio",name:"paymentMethod",value:_.id,checked:u===_.id,onChange:b=>h(b.target.value),disabled:!_.available,className:"sr-only"}),s.jsxs("div",{className:"flex items-center w-full",children:[s.jsx("span",{className:"text-2xl mr-3",children:_.icon}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-gray-900",children:_.name}),s.jsx("div",{className:"text-sm text-gray-500",children:_.description})]}),u===_.id&&s.jsx("div",{className:"text-blue-500",children:s.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:s.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]})]},_.id))})]}),N&&s.jsxs("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"🏦 Bank Transfer Instructions"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-medium",children:"Bank Name:"}),s.jsx("span",{children:"Vietcombank"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-medium",children:"Account Number:"}),s.jsx("span",{className:"font-mono",children:"1234567890"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-medium",children:"Account Name:"}),s.jsx("span",{children:"Long Chau Pharmacy"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-medium",children:"Amount:"}),s.jsxs("span",{className:"font-semibold",children:["₫",r.toLocaleString("vi-VN")]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"font-medium",children:"Transfer Content:"}),s.jsxs("span",{className:"font-mono",children:["PAYMENT ",N.transactionId]})]})]}),s.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded border border-blue-200",children:s.jsx("p",{className:"text-sm text-blue-800",children:"⚠️ Please include the exact transfer content to ensure your payment is processed correctly. Your order will be confirmed once we receive the transfer."})})]}),v&&s.jsxs("div",{className:"mb-6 text-center bg-gray-50 rounded-lg p-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"📱 Scan QR Code to Pay"}),s.jsx("div",{className:"inline-block p-4 bg-white rounded-lg border-2 border-dashed border-gray-300",children:s.jsx("div",{className:"w-48 h-48 bg-gray-200 flex items-center justify-center text-gray-500",children:"QR Code Placeholder"})}),s.jsx("p",{className:"text-sm text-gray-600 mt-3",children:"Open your mobile wallet app and scan this QR code to complete payment"})]}),s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("button",{onClick:c,className:"flex-1 px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:f,children:"Cancel"}),!N&&s.jsx("button",{onClick:j,disabled:!u||f,className:`flex-1 px-6 py-3 rounded-lg font-medium transition-colors ${u&&!f?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,children:f?s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Processing..."]}):u==="cod"?"Confirm Order":"Proceed to Payment"}),N&&s.jsx("button",{onClick:()=>a(N.transactionId),className:"flex-1 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"I've Made the Transfer"})]}),s.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:s.jsx("p",{children:"🔒 Your payment information is secure and encrypted"})})]})};class zg{static generateHTMLReceipt(e){return`
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Receipt - ${e.receiptNumber}</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .receipt {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: bold;
        }
        .header p {
            margin: 5px 0 0 0;
            opacity: 0.9;
        }
        .content {
            padding: 30px;
        }
        .receipt-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e5e7eb;
        }
        .receipt-number {
            background: #f3f4f6;
            padding: 15px;
            border-radius: 8px;
            font-weight: bold;
            font-size: 1.2em;
        }
        .customer-info, .pharmacy-info {
            flex: 1;
        }
        .customer-info {
            margin-right: 30px;
        }
        .info-section h3 {
            color: #1f2937;
            margin: 0 0 10px 0;
            font-size: 1.1em;
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 5px;
        }
        .info-section p {
            margin: 5px 0;
            color: #6b7280;
        }
        .items-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        .items-table th {
            background: #f8fafc;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
        }
        .items-table td {
            padding: 15px;
            border-bottom: 1px solid #f3f4f6;
        }
        .items-table tr:hover {
            background: #f9fafb;
        }
        .prescription-item {
            background: #fef3c7 !important;
        }
        .prescription-badge {
            background: #f59e0b;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 500;
        }
        .totals {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .total-row {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 5px 0;
        }
        .total-row.final {
            border-top: 2px solid #2563eb;
            font-weight: bold;
            font-size: 1.2em;
            color: #2563eb;
            margin-top: 15px;
            padding-top: 15px;
        }
        .payment-info {
            background: #ecfdf5;
            border: 1px solid #10b981;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        .payment-status {
            color: #065f46;
            font-weight: 600;
        }
        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e5e7eb;
            color: #6b7280;
        }
        .qr-code {
            text-align: center;
            margin: 20px 0;
        }
        .notes {
            background: #fff7ed;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        @media print {
            body { background: white; }
            .receipt { box-shadow: none; }
        }
    </style>
</head>
<body>
    <div class="receipt">
        <div class="header">
            <h1>🏥 ${e.pharmacy.name}</h1>
            <p>Your Health, Our Priority</p>
        </div>
        
        <div class="content">
            <div class="receipt-info">
                <div class="receipt-number">
                    Receipt #${e.receiptNumber}
                    <br>
                    <small style="font-weight: normal; opacity: 0.7;">Order #${e.orderNumber}</small>
                    <br>
                    <small style="font-weight: normal; opacity: 0.7;">${e.date}</small>
                </div>
            </div>
            
            <div style="display: flex; gap: 30px; margin-bottom: 30px;">
                <div class="customer-info info-section">
                    <h3>👤 Customer Information</h3>
                    <p><strong>Name:</strong> ${e.customer.name}</p>
                    <p><strong>Email:</strong> ${e.customer.email}</p>
                    <p><strong>Phone:</strong> ${e.customer.phone}</p>
                    <p><strong>Address:</strong> ${e.customer.address}</p>
                </div>
                
                <div class="pharmacy-info info-section">
                    <h3>🏪 Pharmacy Information</h3>
                    <p><strong>Name:</strong> ${e.pharmacy.name}</p>
                    <p><strong>Address:</strong> ${e.pharmacy.address}</p>
                    <p><strong>Phone:</strong> ${e.pharmacy.phone}</p>
                    <p><strong>Email:</strong> ${e.pharmacy.email}</p>
                    <p><strong>License:</strong> ${e.pharmacy.license}</p>
                </div>
            </div>
            
            <table class="items-table">
                <thead>
                    <tr>
                        <th>Product Name</th>
                        <th>Qty</th>
                        <th>Unit Price</th>
                        <th>Total</th>
                        <th>Type</th>
                    </tr>
                </thead>
                <tbody>
                    ${e.items.map(r=>`
                    <tr ${r.prescription?'class="prescription-item"':""}>
                        <td>
                            <strong>${r.name}</strong>
                            ${r.prescription?'<br><span class="prescription-badge">Prescription</span>':""}
                        </td>
                        <td>${r.quantity}</td>
                        <td>₫${r.unitPrice.toLocaleString("vi-VN")}</td>
                        <td><strong>₫${r.totalPrice.toLocaleString("vi-VN")}</strong></td>
                        <td>${r.prescription?"🔒 Rx":"🛒 OTC"}</td>
                    </tr>
                    `).join("")}
                </tbody>
            </table>
            
            <div class="totals">
                <div class="total-row">
                    <span>Subtotal:</span>
                    <span>₫${e.payment.subtotal.toLocaleString("vi-VN")}</span>
                </div>
                ${e.payment.discount>0?`
                <div class="total-row">
                    <span>Discount:</span>
                    <span style="color: #dc2626;">-₫${e.payment.discount.toLocaleString("vi-VN")}</span>
                </div>
                `:""}
                ${e.payment.tax>0?`
                <div class="total-row">
                    <span>Tax (VAT):</span>
                    <span>₫${e.payment.tax.toLocaleString("vi-VN")}</span>
                </div>
                `:""}
                <div class="total-row final">
                    <span>Total Amount:</span>
                    <span>₫${e.payment.total.toLocaleString("vi-VN")}</span>
                </div>
            </div>
            
            <div class="payment-info">
                <div class="payment-status">
                    💳 Payment Method: ${this.getPaymentMethodDisplay(e.payment.method)}
                    <br>
                    ✅ Status: ${e.payment.status.toUpperCase()}
                </div>
            </div>
            
            ${e.notes?`
            <div class="notes">
                <strong>📝 Notes:</strong>
                <br>
                ${e.notes}
            </div>
            `:""}
            
            <div class="qr-code">
                <div style="border: 2px dashed #d1d5db; padding: 20px; border-radius: 8px; display: inline-block;">
                    <div style="width: 100px; height: 100px; background: #f3f4f6; display: flex; align-items: center; justify-content: center; border-radius: 4px;">
                        📱 QR Code
                    </div>
                    <p style="margin: 10px 0 0 0; font-size: 0.9em;">Scan to verify receipt</p>
                </div>
            </div>
            
            <div class="footer">
                <p><strong>Thank you for choosing ${e.pharmacy.name}!</strong></p>
                <p>For questions about this receipt, please contact us at ${e.pharmacy.phone}</p>
                <p style="font-size: 0.8em; margin-top: 15px;">
                    This is a digital receipt generated on ${new Date().toLocaleString("vi-VN")}
                </p>
            </div>
        </div>
    </div>
</body>
</html>
    `}static async generateOrderReceipt(e){try{const r={receiptNumber:`RC-${Date.now()}`,orderNumber:e,date:new Date().toLocaleDateString("vi-VN"),customer:{name:"Le Van C",email:"customer@gmail.com",phone:"+84 123 456 789",address:"123 Main Street, Ho Chi Minh City"},pharmacy:{name:"Long Chau Pharmacy",address:"456 Nguyen Trai, District 5, Ho Chi Minh City",phone:"+84 28 1234 5678",email:"info@longchau.com",license:"GPP-2024-001"},items:[{name:"Paracetamol 500mg",quantity:2,unitPrice:25e3,totalPrice:5e4,prescription:!1},{name:"Amoxicillin 250mg",quantity:1,unitPrice:75e3,totalPrice:75e3,prescription:!0}],payment:{method:"vnpay",subtotal:125e3,tax:0,discount:0,total:125e3,status:"completed"},notes:"Please take medications as prescribed by your doctor. Store in a cool, dry place."};return this.generateHTMLReceipt(r)}catch(r){throw console.error("Receipt generation error:",r),new Error("Failed to generate receipt")}}static getPaymentMethodDisplay(e){return{cod:"Cash on Delivery",vnpay:"VNPay",momo:"MoMo E-Wallet",zalopay:"ZaloPay",bank_transfer:"Bank Transfer",card:"Credit/Debit Card"}[e]||e.toUpperCase()}static generateTextReceipt(e){return`
🏥 ${e.pharmacy.name}
Receipt #${e.receiptNumber}
Order #${e.orderNumber}
Date: ${e.date}

👤 Customer: ${e.customer.name}
📧 Email: ${e.customer.email}

📦 Items:
${e.items.map(r=>`${r.name} x${r.quantity} - ₫${r.totalPrice.toLocaleString("vi-VN")}${r.prescription?" (Rx)":""}`).join(`
`)}

💰 Total: ₫${e.payment.total.toLocaleString("vi-VN")}
💳 Payment: ${this.getPaymentMethodDisplay(e.payment.method)}
✅ Status: ${e.payment.status.toUpperCase()}

Thank you for choosing ${e.pharmacy.name}!
For support: ${e.pharmacy.phone}
    `.trim()}}const xE=({receiptId:t,orderId:e,transactionId:r,onClose:n})=>{const[a,o]=R.useState(null),[c,u]=R.useState(!0),[h,f]=R.useState(""),[m,v]=R.useState("");R.useEffect(()=>{w()},[t,e,r]);const w=async()=>{try{u(!0);let j;if(t)j=await Dl.getReceipt(t);else if(e){const _=await zg.generateOrderReceipt(e);v(_),u(!1);return}else if(r){const _=await Dl.generateReceipt(r);j=await Dl.getReceipt(_)}if(j){o(j);const _=await zg.generateOrderReceipt(j.orderId);v(_)}else f("Receipt not found")}catch(j){console.error("Error loading receipt:",j),f("Failed to load receipt")}finally{u(!1)}},N=()=>{const j=window.open("","_blank");j&&(j.document.write(m),j.document.close(),j.focus(),j.print())},g=()=>{const j=new Blob([m],{type:"text/html"}),_=URL.createObjectURL(j),b=document.createElement("a");b.href=_,b.download=`receipt-${(a==null?void 0:a.receiptNumber)||"unknown"}.html`,document.body.appendChild(b),b.click(),document.body.removeChild(b),URL.revokeObjectURL(_)},y=async()=>{try{alert("Receipt sent to your email address!")}catch{alert("Failed to send email. Please try again.")}};return c?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsx("div",{className:"bg-white rounded-lg p-8 max-w-md w-full mx-4",children:s.jsxs("div",{className:"flex items-center justify-center",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-4 text-lg",children:"Loading receipt..."})]})})}):h?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsx("div",{className:"bg-white rounded-lg p-8 max-w-md w-full mx-4",children:s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"⚠️"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Error"}),s.jsx("p",{className:"text-gray-600 mb-4",children:h}),s.jsx("button",{onClick:n,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Close"})]})})}):s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-screen flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Receipt ",(a==null?void 0:a.receiptNumber)||"Preview"]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:N,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 flex items-center",title:"Print Receipt",children:"🖨️ Print"}),s.jsx("button",{onClick:g,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex items-center",title:"Download Receipt",children:"📄 Download"}),s.jsx("button",{onClick:y,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 flex items-center",title:"Email Receipt",children:"📧 Email"}),s.jsx("button",{onClick:n,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",title:"Close",children:"✕"})]})]}),s.jsx("div",{className:"flex-1 overflow-auto",children:s.jsx("div",{className:"receipt-container",dangerouslySetInnerHTML:{__html:m}})}),s.jsx("div",{className:"border-t p-4 bg-gray-50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-sm text-gray-600",children:a&&s.jsxs(s.Fragment,{children:["Generated: ",new Date(a.generatedAt).toLocaleString("vi-VN"),a.sentToCustomer&&s.jsx("span",{className:"ml-4 text-green-600",children:"✅ Sent to customer"})]})}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>window.location.href=`mailto:?subject=Receipt ${a==null?void 0:a.receiptNumber}&body=Please find your receipt attached.`,className:"text-sm text-blue-600 hover:text-blue-800",children:"Share via Email"}),s.jsx("span",{className:"text-gray-300",children:"|"}),s.jsx("button",{onClick:()=>{navigator.share&&navigator.share({title:`Receipt ${a==null?void 0:a.receiptNumber}`,text:"Your pharmacy receipt",url:window.location.href})},className:"text-sm text-blue-600 hover:text-blue-800",children:"Share"})]})]})})]})})},vE=()=>{const{user:t}=pt(),{orders:e,updateOrder:r}=lt(),[n,a]=R.useState([]),[o,c]=R.useState(null),[u,h]=R.useState(""),[f,m]=R.useState("all");R.useEffect(()=>{if(t!=null&&t.email){const b=e.filter(P=>P.customerName===t.name||P.customerId===t.id);a(b)}},[e,t]);const v=n.filter(b=>{switch(f){case"pending":return b.status==="pending";case"confirmed":return b.status==="confirmed"&&b.paymentStatus==="pending";case"paid":return b.paymentStatus==="paid";default:return!0}}),w=async(b,P)=>{try{const B=n.find($=>$.id===P);B&&await r({...B,paymentStatus:"paid",status:"confirmed"}),c(null),h(b),alert("🎉 Payment successful! Your order is being processed.")}catch(B){console.error("Error updating order after payment:",B)}},N=b=>{alert(`❌ Payment failed: ${b}`)},g=(b,P)=>b==="cancelled"?"bg-red-100 text-red-800":P==="paid"?"bg-green-100 text-green-800":b==="confirmed"?"bg-blue-100 text-blue-800":b==="pending"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",y=(b,P)=>b==="cancelled"?"Cancelled":P==="paid"?"Paid":b==="confirmed"&&P==="pending"?"Ready for Payment":b==="pending"?"Pending Pharmacist Review":b,j=b=>b.status==="confirmed"&&b.paymentStatus==="pending",_=b=>s.jsxs("div",{className:"bg-white border rounded-lg p-6 shadow-sm",children:[s.jsxs("div",{className:"flex justify-between items-start mb-4",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"font-semibold text-gray-900 text-lg",children:["Order #",b.id]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Placed on ",new Date(b.orderDate).toLocaleDateString("vi-VN")]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Delivery to: ",b.shippingAddress]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"font-semibold text-xl text-gray-900",children:["₫",b.total.toLocaleString("vi-VN")]}),s.jsx("span",{className:`inline-block px-3 py-1 rounded-full text-sm font-medium ${g(b.status,b.paymentStatus)}`,children:y(b.status,b.paymentStatus)})]})]}),s.jsxs("div",{className:"mb-4",children:[s.jsx("h4",{className:"font-medium text-gray-700 mb-2",children:"Items:"}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-3",children:Array.isArray(b.items)?b.items.map((P,B)=>s.jsxs("div",{className:"flex justify-between items-center py-1",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-medium",children:P.productName||P.name}),P.prescription&&s.jsx("span",{className:"ml-2 px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:"Prescription"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"font-medium",children:["₫",(P.price*P.quantity).toLocaleString("vi-VN")]}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Qty: ",P.quantity]})]})]},B)):s.jsx("div",{className:"text-sm text-gray-500",children:"No item details available"})})]}),b.status==="pending"&&s.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-yellow-600 mr-2",children:"⏳"}),s.jsx("span",{className:"text-yellow-800 font-medium",children:"Waiting for pharmacist review"})]}),s.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Our pharmacist is reviewing your order. You'll be able to pay once it's confirmed."})]}),j(b)&&s.jsxs("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-green-600 mr-2",children:"✅"}),s.jsx("span",{className:"text-green-800 font-medium",children:"Order confirmed - Ready for payment"})]}),s.jsx("p",{className:"text-green-700 text-sm mt-1",children:"Your order has been confirmed by our pharmacist. You can now proceed with payment."})]}),b.status==="cancelled"&&s.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-red-600 mr-2",children:"❌"}),s.jsx("span",{className:"text-red-800 font-medium",children:"Order Cancelled"})]}),s.jsx("p",{className:"text-red-700 text-sm mt-1",children:"This order has been cancelled."})]}),b.paymentStatus==="paid"&&s.jsxs("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-blue-600 mr-2",children:"🎉"}),s.jsx("span",{className:"text-blue-800 font-medium",children:"Payment completed"})]}),s.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"Your order is being prepared for delivery."})]}),s.jsxs("div",{className:"flex space-x-3",children:[j(b)&&s.jsx("button",{onClick:()=>c(b),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"💳 Pay Now"}),b.paymentStatus==="paid"&&s.jsx("button",{onClick:()=>h(b.id),className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium",children:"🧾 View Receipt"}),b.status==="pending"&&s.jsx("button",{disabled:!0,className:"flex-1 px-4 py-2 bg-gray-300 text-gray-500 rounded-lg cursor-not-allowed font-medium",children:"⏳ Awaiting Review"})]})]},b.id);return s.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"My Orders"}),s.jsx("p",{className:"text-gray-600",children:"Track your orders and make payments"})]}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-xl font-bold text-yellow-800",children:n.filter(b=>b.status==="pending").length}),s.jsx("div",{className:"text-yellow-700 text-sm",children:"Pending Review"})]}),s.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-xl font-bold text-blue-800",children:n.filter(b=>b.status==="confirmed"&&b.paymentStatus==="pending").length}),s.jsx("div",{className:"text-blue-700 text-sm",children:"Ready to Pay"})]}),s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-xl font-bold text-green-800",children:n.filter(b=>b.paymentStatus==="paid").length}),s.jsx("div",{className:"text-green-700 text-sm",children:"Paid"})]}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[s.jsx("div",{className:"text-xl font-bold text-gray-800",children:n.length}),s.jsx("div",{className:"text-gray-700 text-sm",children:"Total Orders"})]})]}),s.jsx("div",{className:"border-b border-gray-200 mb-6",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{key:"all",label:"All Orders",count:n.length},{key:"pending",label:"Pending",count:n.filter(b=>b.status==="pending").length},{key:"confirmed",label:"Ready to Pay",count:n.filter(b=>b.status==="confirmed"&&b.paymentStatus==="pending").length},{key:"paid",label:"Paid",count:n.filter(b=>b.paymentStatus==="paid").length}].map(b=>s.jsxs("button",{onClick:()=>m(b.key),className:`py-2 px-1 border-b-2 font-medium text-sm ${f===b.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[b.label," (",b.count,")"]},b.key))})}),v.length===0?s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-12 text-center",children:[s.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"📦"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders found"}),s.jsx("p",{className:"text-gray-600",children:f==="all"?"You haven't placed any orders yet.":`No orders in ${f} status.`})]}):s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:v.map(b=>_(b))}),o&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsx("div",{className:"max-w-2xl w-full",children:s.jsx(yE,{orderId:o.id,customerId:(t==null?void 0:t.id)||"",amount:o.total,orderDetails:{items:o.items,total:o.total,customerInfo:{name:(t==null?void 0:t.name)||"",email:(t==null?void 0:t.email)||"",phone:"+84 123 456 789"}},onPaymentSuccess:b=>w(b,o.id),onPaymentError:N,onCancel:()=>c(null)})})}),u&&s.jsx(xE,{orderId:u,onClose:()=>h("")})]})},wE=()=>{const{addOrder:t}=lt(),{user:e}=pt(),[r,n]=R.useState(!1),a=[{productId:"med-001",productName:"Paracetamol 500mg",quantity:2,price:15e3,prescription:!1},{productId:"med-002",productName:"Amoxicillin 250mg",quantity:1,price:45e3,prescription:!0},{productId:"med-003",productName:"Vitamin D3",quantity:1,price:25e3,prescription:!1}],o=async()=>{if(!e){alert("Please log in to create an order");return}n(!0);try{const c=Ha(),u=a.reduce((f,m)=>f+m.price*m.quantity,0),h={id:c,customerId:e.id||Ha(),customerName:e.name||"Demo Customer",items:a,total:u,status:"pending",orderDate:new Date().toISOString(),shippingAddress:"123 Demo Street, Ho Chi Minh City, Vietnam",paymentMethod:"cod",paymentStatus:"pending"};await t(h),alert("🎉 Sample order created! Check the Pharmacist View to confirm it, then Customer View to pay.")}catch(c){console.error("Error creating sample order:",c),alert("❌ Failed to create order")}finally{n(!1)}};return s.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 max-w-2xl mx-auto",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"🧪 Pharmacy Workflow Demo"}),s.jsx("p",{className:"text-gray-600",children:"Test the complete pharmacy workflow: Order → Pharmacist Review → Customer Payment"})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Sample Order Items:"}),s.jsx("div",{className:"space-y-2",children:a.map((c,u)=>s.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"font-medium",children:c.productName}),c.prescription&&s.jsx("span",{className:"ml-2 px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded",children:"Prescription Required"})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("div",{className:"font-medium",children:["₫",(c.price*c.quantity).toLocaleString("vi-VN")]}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Qty: ",c.quantity]})]})]},u))}),s.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:s.jsxs("div",{className:"flex justify-between items-center font-bold text-lg",children:[s.jsx("span",{children:"Total:"}),s.jsxs("span",{children:["₫",a.reduce((c,u)=>c+u.price*u.quantity,0).toLocaleString("vi-VN")]})]})})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Workflow Steps:"}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"w-6 h-6 bg-blue-100 text-blue-800 rounded-full flex items-center justify-center text-sm font-bold mr-3",children:"1"}),s.jsx("span",{children:"Customer places order (status: pending)"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"w-6 h-6 bg-yellow-100 text-yellow-800 rounded-full flex items-center justify-center text-sm font-bold mr-3",children:"2"}),s.jsx("span",{children:"Pharmacist reviews and confirms order"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"w-6 h-6 bg-green-100 text-green-800 rounded-full flex items-center justify-center text-sm font-bold mr-3",children:"3"}),s.jsx("span",{children:"Customer can now pay for confirmed order"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"w-6 h-6 bg-purple-100 text-purple-800 rounded-full flex items-center justify-center text-sm font-bold mr-3",children:"4"}),s.jsx("span",{children:"Receipt is generated after payment"})]})]})]}),s.jsx("button",{onClick:o,disabled:r,className:"w-full px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 font-medium flex items-center justify-center space-x-2",children:r?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),s.jsx("span",{children:"Creating Order..."})]}):s.jsxs(s.Fragment,{children:[s.jsx("span",{children:"🛒"}),s.jsx("span",{children:"Create Sample Order"})]})}),s.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("p",{className:"text-blue-800 text-sm",children:[s.jsx("strong",{children:"💡 Tip:"})," After creating the order, switch between views to test:",s.jsx("br",{}),"• ",s.jsx("strong",{children:"Pharmacist View:"})," Review and confirm the order",s.jsx("br",{}),"• ",s.jsx("strong",{children:"Customer View:"})," Pay for confirmed orders",s.jsx("br",{}),"• ",s.jsx("strong",{children:"Admin View:"})," Overall order management"]})})]})};function bE(){const{user:t}=pt(),{orders:e,updateOrder:r}=lt(),{addNotification:n}=ws(),{addActivity:a}=Co(),[o,c]=R.useState(""),[u,h]=R.useState("all"),[f,m]=R.useState(null),[v,w]=R.useState(!1);if((t==null?void 0:t.role)==="customer")return s.jsx(vE,{});if((t==null?void 0:t.role)==="pharmacist")return s.jsx(pE,{});const[N,g]=R.useState("admin"),[y,j]=R.useState(!1),[_,b]=R.useState(""),[P,B]=R.useState(!1),$=e.filter(q=>{const Q=q.customerName.toLowerCase().includes(o.toLowerCase())||q.id.toLowerCase().includes(o.toLowerCase()),te=u==="all"||q.status===u,de=(t==null?void 0:t.role)==="customer"?q.customerId===t.id:!0;return Q&&te&&de}),k=q=>{switch(q){case"pending":return s.jsx(Bn,{className:"h-4 w-4 text-yellow-500"});case"confirmed":return s.jsx(Ot,{className:"h-4 w-4 text-blue-500"});case"shipped":return s.jsx(ur,{className:"h-4 w-4 text-purple-500"});case"delivered":return s.jsx(Lt,{className:"h-4 w-4 text-green-500"});case"cancelled":return s.jsx(Ej,{className:"h-4 w-4 text-red-500"});default:return s.jsx(Bn,{className:"h-4 w-4 text-gray-500"})}},I=q=>{switch(q){case"pending":return"bg-yellow-100 text-yellow-800";case"confirmed":return"bg-blue-100 text-blue-800";case"shipped":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},T=q=>{m(q),b(q.status),w(!0)},D=q=>{m(q),j(!0)},U=async()=>{if(!(!f||P)){B(!0);try{const q={...f,status:_},Q=await r(q);Q.success?(a("order","Updated order status",`Order #${f.id} status changed to ${_}`,{orderId:f.id,status:_,amount:f.total}),n({title:"Order Status Updated",message:`Order ${f.id} status changed to ${_}`,type:"success"}),w(!1),m(null)):n({title:"Update Failed",message:Q.error||"Failed to update order status",type:"error"})}catch{n({title:"Update Failed",message:"An error occurred while updating the order",type:"error"})}finally{B(!1)}}},V=q=>({pending:"confirmed",confirmed:"shipped",shipped:"delivered"})[q],z=[{label:"Total Orders",value:e.length,color:"text-blue-600"},{label:"Pending",value:e.filter(q=>q.status==="pending").length,color:"text-yellow-600"},{label:"Confirmed",value:e.filter(q=>q.status==="confirmed").length,color:"text-blue-600"},{label:"Delivered",value:e.filter(q=>q.status==="delivered").length,color:"text-green-600"}];return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Order Management"}),s.jsx("p",{className:"text-gray-600",children:(t==null?void 0:t.role)==="customer"?"Track your orders and order history":"Manage customer orders and shipments"})]})}),s.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-1 inline-flex mb-6",children:[s.jsx("button",{onClick:()=>g("demo"),className:`px-4 py-2 rounded-md font-medium text-sm transition-colors ${N==="demo"?"bg-green-600 text-white":"text-gray-600 hover:text-gray-900"}`,children:"🧪 Demo Workflow"}),s.jsxs("button",{onClick:()=>g("admin"),className:`px-4 py-2 rounded-md font-medium text-sm transition-colors ${N==="admin"?"bg-blue-600 text-white":"text-gray-600 hover:text-gray-900"}`,children:[s.jsx(kn,{className:"h-4 w-4 inline-block mr-2"}),"Admin Management"]})]}),N==="demo"&&s.jsx(wE,{}),N==="admin"&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:z.map((q,Q)=>s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:`text-2xl font-bold ${q.color}`,children:q.value}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:q.label})]})},Q))}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search orders...",value:o,onChange:q=>c(q.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Wc,{className:"h-4 w-4 text-gray-400"}),s.jsxs("select",{value:u,onChange:q=>h(q.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Status"}),s.jsx("option",{value:"pending",children:"Pending"}),s.jsx("option",{value:"confirmed",children:"Confirmed"}),s.jsx("option",{value:"shipped",children:"Shipped"}),s.jsx("option",{value:"delivered",children:"Delivered"}),s.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]})})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order ID"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Items"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order Date"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:$.map(q=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm font-medium text-gray-900",children:q.id})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm text-gray-900",children:q.customerName})}),s.jsx("td",{className:"px-6 py-4",children:s.jsxs("div",{className:"text-sm text-gray-900",children:[q.items.slice(0,2).map((Q,te)=>s.jsxs("div",{className:"mb-1",children:[Q.productName," x",Q.quantity]},te)),q.items.length>2&&s.jsxs("div",{className:"text-xs text-gray-500",children:["+",q.items.length-2," more items"]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["₫",q.total.toLocaleString()]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[k(q.status),s.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${I(q.status)}`,children:q.status.charAt(0).toUpperCase()+q.status.slice(1)})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(q.orderDate).toLocaleDateString("vi-VN")}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm space-x-2",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>D(q),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"View Details",children:s.jsx(us,{className:"h-4 w-4"})}),((t==null?void 0:t.role)==="pharmacist"||(t==null?void 0:t.role)==="manager")&&q.status!=="delivered"&&q.status!=="cancelled"&&s.jsx("button",{onClick:()=>T(q),className:"text-green-600 hover:text-green-800 transition-colors",title:"Update Status",children:s.jsx(ea,{className:"h-4 w-4"})}),((t==null?void 0:t.role)==="pharmacist"||(t==null?void 0:t.role)==="manager")&&V(q.status)&&s.jsxs("button",{onClick:async()=>{const Q=V(q.status);m(q),b(Q),B(!0);try{const te={...q,status:Q},de=await r(te);de.success?n({title:"Order Status Updated",message:`Order ${q.id} marked as ${Q}`,type:"success"}):n({title:"Update Failed",message:de.error||"Failed to update order status",type:"error"})}catch{n({title:"Update Failed",message:"An error occurred while updating the order",type:"error"})}finally{B(!1)}},className:"text-purple-600 hover:text-purple-800 transition-colors flex items-center space-x-1",title:`Mark as ${V(q.status)}`,children:[s.jsx(tm,{className:"h-4 w-4"}),s.jsx("span",{className:"text-xs capitalize",children:V(q.status)})]})]})})]},q.id))})]})})}),$.length===0&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center",children:[s.jsx(kn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No orders found"}),s.jsx("p",{className:"text-gray-500",children:(t==null?void 0:t.role)==="customer"?"You haven't placed any orders yet.":"No orders match your current filters."})]}),s.jsx(_E,{isOpen:y,onClose:()=>j(!1),order:f}),s.jsx(NE,{isOpen:v,onClose:()=>w(!1),order:f,newStatus:_,setNewStatus:b,onSubmit:U,isUpdating:P})]})]})}function _E({isOpen:t,onClose:e,order:r}){return!t||!r?null:s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsx("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Order Details"}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Rr,{className:"h-6 w-6"})})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Order Information"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Order ID:"})," ",r.id]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Date:"})," ",new Date(r.orderDate).toLocaleDateString("vi-VN")]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Status:"}),s.jsx("span",{className:`ml-2 px-2 py-1 text-xs font-medium rounded-full bg-${r.status==="pending"?"yellow":r.status==="confirmed"?"blue":r.status==="shipped"?"purple":r.status==="delivered"?"green":"red"}-100 text-${r.status==="pending"?"yellow":r.status==="confirmed"?"blue":r.status==="shipped"?"purple":r.status==="delivered"?"green":"red"}-800`,children:r.status.charAt(0).toUpperCase()+r.status.slice(1)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Total:"})," ₫",r.total.toLocaleString()]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Customer Information"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Name:"})," ",r.customerName]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Address:"})," ",r.shippingAddress]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Payment:"})," ",r.paymentMethod.toUpperCase()]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-medium",children:"Payment Status:"}),s.jsx("span",{className:`ml-2 px-2 py-1 text-xs font-medium rounded-full ${r.paymentStatus==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:r.paymentStatus.charAt(0).toUpperCase()+r.paymentStatus.slice(1)})]})]})]})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Order Items"}),s.jsx("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Quantity"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Price"}),s.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Total"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.items.map((n,a)=>s.jsxs("tr",{children:[s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:n.productName}),s.jsx("td",{className:"px-4 py-3 text-sm text-gray-900",children:n.quantity}),s.jsxs("td",{className:"px-4 py-3 text-sm text-gray-900",children:["₫",n.price.toLocaleString()]}),s.jsxs("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:["₫",(n.price*n.quantity).toLocaleString()]})]},a))})]})})]})]}),s.jsx("div",{className:"flex items-center justify-end space-x-3 mt-6",children:s.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"})})]})})})}function NE({isOpen:t,onClose:e,order:r,newStatus:n,setNewStatus:a,onSubmit:o,isUpdating:c}){if(!t||!r)return null;const u=[{value:"pending",label:"Pending",description:"Order is awaiting confirmation"},{value:"confirmed",label:"Confirmed",description:"Order has been confirmed and is being prepared"},{value:"shipped",label:"Shipped",description:"Order has been shipped and is on the way"},{value:"delivered",label:"Delivered",description:"Order has been successfully delivered"},{value:"cancelled",label:"Cancelled",description:"Order has been cancelled"}];return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsx("div",{className:"bg-white rounded-xl max-w-md w-full",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Update Order Status"}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Rr,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"mb-4",children:[s.jsxs("h3",{className:"font-medium text-gray-900",children:["Order #",r.id]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Customer: ",r.customerName]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Current Status: ",s.jsx("span",{className:"capitalize font-medium",children:r.status})]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Status"}),s.jsx("div",{className:"space-y-2",children:u.map(h=>s.jsxs("label",{className:"flex items-center space-x-3 p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[s.jsx("input",{type:"radio",name:"status",value:h.value,checked:n===h.value,onChange:f=>a(f.target.value),className:"text-blue-600 focus:ring-blue-500"}),s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:h.label}),s.jsx("div",{className:"text-sm text-gray-500",children:h.description})]})]},h.value))})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-3",children:[s.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsxs("button",{onClick:o,disabled:c||n===r.status,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center space-x-2",children:[c?s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):s.jsx(Xi,{className:"h-4 w-4"}),s.jsx("span",{children:c?"Updating...":"Update Status"})]})]})]})})})}function jE(){const{products:t,customers:e,addOrder:r,updateProduct:n,refreshData:a,forceReconnectDatabase:o,isConnectedToDatabase:c}=lt(),{user:u}=pt(),{addNotification:h}=ws(),[f,m]=R.useState(""),[v,w]=R.useState("all"),[N,g]=R.useState([]),[y,j]=R.useState(!1),[_,b]=R.useState(""),[P,B]=R.useState("cod"),[$,k]=R.useState(null),[I,T]=R.useState(!1),[D,U]=R.useState(""),V=[...new Set(t.map(K=>K.category))],z=t.filter(K=>{const fe=K.name.toLowerCase().includes(f.toLowerCase())||K.manufacturer.toLowerCase().includes(f.toLowerCase()),Ae=v==="all"||K.category===v,ee=K.stock>0;return fe&&Ae&&ee}),q=K=>{const fe=N.find(Ae=>Ae.productId===K.id);fe?fe.quantity<K.stock&&(g(Ae=>Ae.map(ee=>ee.productId===K.id?{...ee,quantity:ee.quantity+1}:ee)),h({title:"Cart Updated",message:`Increased quantity of ${K.name} in cart`,type:"info"})):(g(Ae=>[...Ae,{productId:K.id,productName:K.name,price:K.price,quantity:1,stock:K.stock}]),h({title:"Item Added to Cart",message:`${K.name} has been added to your cart`,type:"success"}))},Q=(K,fe)=>{if(fe<=0){te(K);return}g(Ae=>Ae.map(ee=>ee.productId===K?{...ee,quantity:Math.min(fe,ee.stock)}:ee))},te=K=>{g(fe=>fe.filter(Ae=>Ae.productId!==K))},de=()=>N.reduce((K,fe)=>K+fe.price*fe.quantity,0),re=()=>N.reduce((K,fe)=>K+fe.quantity,0),Z=async()=>{if(!u||N.length===0){alert("Please add items to your cart before placing an order.");return}const K=e.find(fe=>fe.id===u.id);if(!K){alert("Customer information not found. Please try logging in again.");return}T(!0),U("");try{const fe=`ORD-${Date.now()}-${Math.random().toString(36).substr(2,4).toUpperCase()}`,Ae={customerId:u.id,customerName:K.name,items:N.map(ue=>({productId:ue.productId,productName:ue.productName,quantity:ue.quantity,price:ue.price})),total:de(),status:"pending",orderDate:new Date().toISOString(),shippingAddress:_||K.address,paymentMethod:P,paymentStatus:"pending"},ee=await r(Ae);N.forEach(ue=>{const ae=t.find(pe=>pe.id===ue.productId);if(ae){const pe={...ae,stock:ae.stock-ue.quantity};n(pe)}}),ee.stored==="database"?(U(`✅ Order ${fe} successfully stored in database`),h({title:"Order Placed Successfully",message:`Your order ${fe} has been placed and stored in database. Total: ₫${de().toLocaleString()}`,type:"success"})):(U(`⚠️ Order ${fe} stored locally (will sync when database is available)`),h({title:"Order Placed (Local Storage)",message:`Your order ${fe} has been placed and stored locally. Total: ₫${de().toLocaleString()}`,type:"warning"})),g([]),j(!1),k(fe),setTimeout(()=>{k(null),U("")},8e3)}catch(fe){console.error("Error during checkout:",fe),U("❌ Error placing order. Please try again."),setTimeout(()=>U(""),5e3)}finally{T(!1)}},ne=K=>N.some(fe=>fe.productId===K),ie=K=>{const fe=N.find(Ae=>Ae.productId===K);return fe?fe.quantity:0};return s.jsxs("div",{className:"space-y-6",children:[$&&s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center space-x-3",children:[s.jsx(Lt,{className:"h-6 w-6 text-green-600"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-sm font-medium text-green-800",children:"Order Placed Successfully!"}),s.jsxs("p",{className:"text-sm text-green-700",children:["Your order #",$," has been placed and will be processed soon."]})]}),s.jsxs(oc,{to:"/orders",className:"bg-green-600 text-white px-3 py-1 rounded-lg text-sm hover:bg-green-700 transition-colors flex items-center space-x-1",children:[s.jsx(us,{className:"h-4 w-4"}),s.jsx("span",{children:"View Orders"})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Long Châu Pharmacy"}),s.jsx("p",{className:"text-gray-600",children:"Shop for medicines and health products"})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{onClick:a,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:[s.jsx(fs,{className:"h-4 w-4"}),s.jsx("span",{children:"Refresh"})]}),!c&&s.jsxs("button",{onClick:o,className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors flex items-center space-x-2",children:[s.jsx(fs,{className:"h-4 w-4"}),s.jsx("span",{children:"Connect DB"})]})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${c?"bg-green-500":"bg-red-500"}`}),s.jsx("span",{className:"text-sm text-gray-600",children:c?"Database Connected":"Using Mock Data"})]}),s.jsxs(oc,{to:"/orders",className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center space-x-2",children:[s.jsx(us,{className:"h-4 w-4"}),s.jsx("span",{children:"My Orders"})]}),s.jsxs("button",{onClick:()=>j(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2 relative",children:[s.jsx(kn,{className:"h-4 w-4"}),s.jsx("span",{children:"Cart"}),re()>0&&s.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:re()})]})]})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"relative",children:[s.jsx(dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search products...",value:f,onChange:K=>m(K.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-80"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(Wc,{className:"h-4 w-4 text-gray-400"}),s.jsxs("select",{value:v,onChange:K=>w(K.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"all",children:"All Categories"}),V.map(K=>s.jsx("option",{value:K,children:K},K))]})]})]})})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:z.map(K=>s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 line-clamp-2",children:K.name}),K.requiresPrescription&&s.jsx("span",{className:"bg-red-100 text-red-800 text-xs font-medium px-2 py-1 rounded-full ml-2",children:"Rx"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-2",children:K.manufacturer}),s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("span",{className:"bg-gray-100 text-gray-800 text-xs font-medium px-2 py-1 rounded-full",children:K.category}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(Zc,{className:"h-4 w-4 text-yellow-400 fill-current"}),s.jsx("span",{className:"text-sm text-gray-600",children:"4.5"})]})]}),s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("div",{children:s.jsxs("span",{className:"text-xl font-bold text-blue-600",children:["₫",K.price.toLocaleString()]})}),s.jsxs("span",{className:"text-sm text-gray-500",children:["Stock: ",K.stock]})]}),ne(K.id)?s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>Q(K.id,ie(K.id)-1),className:"p-1 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors",children:s.jsx(Rg,{className:"h-4 w-4"})}),s.jsx("span",{className:"font-medium",children:ie(K.id)}),s.jsx("button",{onClick:()=>Q(K.id,ie(K.id)+1),disabled:ie(K.id)>=K.stock,className:"p-1 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Di,{className:"h-4 w-4"})})]}),s.jsx("button",{onClick:()=>te(K.id),className:"text-red-600 hover:text-red-800 transition-colors",children:s.jsx(Bg,{className:"h-4 w-4"})})]}):s.jsxs("button",{onClick:()=>q(K),disabled:K.stock===0,className:"w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[s.jsx(Di,{className:"h-4 w-4"}),s.jsx("span",{children:"Add to Cart"})]})]})},K.id))}),z.length===0&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center",children:[s.jsx(Ot,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No products found"}),s.jsx("p",{className:"text-gray-500",children:"Try adjusting your search criteria."})]}),y&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Shopping Cart"}),s.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:"×"})]})}),s.jsx("div",{className:"p-6 overflow-y-auto max-h-96",children:N.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(kn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"Your cart is empty"})]}):s.jsx("div",{className:"space-y-4",children:N.map(K=>s.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:K.productName}),s.jsxs("p",{className:"text-sm text-gray-600",children:["₫",K.price.toLocaleString()," each"]})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("button",{onClick:()=>Q(K.productId,K.quantity-1),className:"p-1 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors",children:s.jsx(Rg,{className:"h-4 w-4"})}),s.jsx("span",{className:"font-medium w-8 text-center",children:K.quantity}),s.jsx("button",{onClick:()=>Q(K.productId,K.quantity+1),disabled:K.quantity>=K.stock,className:"p-1 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:s.jsx(Di,{className:"h-4 w-4"})})]}),s.jsxs("span",{className:"font-medium text-blue-600 w-20 text-right",children:["₫",(K.price*K.quantity).toLocaleString()]}),s.jsx("button",{onClick:()=>te(K.productId),className:"text-red-600 hover:text-red-800 transition-colors",children:s.jsx(Bg,{className:"h-4 w-4"})})]})]},K.productId))})}),N.length>0&&s.jsxs("div",{className:"p-6 border-t border-gray-200 space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(vt,{className:"h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Shipping address (optional)",value:_,onChange:K=>b(K.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(wh,{className:"h-4 w-4 text-gray-400"}),s.jsxs("select",{value:P,onChange:K=>B(K.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"cod",children:"Cash on Delivery"}),s.jsx("option",{value:"card",children:"Credit/Debit Card"}),s.jsx("option",{value:"bank_transfer",children:"Bank Transfer"})]})]})]}),s.jsxs("div",{className:"flex items-center justify-between text-xl font-bold",children:[s.jsx("span",{children:"Total:"}),s.jsxs("span",{className:"text-blue-600",children:["₫",de().toLocaleString()]})]}),s.jsx("button",{onClick:Z,disabled:N.length===0||I,className:"w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:I?s.jsxs(s.Fragment,{children:[s.jsx(Xi,{className:"h-4 w-4 animate-spin"}),s.jsxs("span",{children:["Saving to ",c?"Database":"Local Storage","..."]})]}):N.length===0?"Cart is Empty":s.jsxs(s.Fragment,{children:[s.jsx(wh,{className:"h-4 w-4"}),s.jsx("span",{children:"Place Order"})]})}),D&&s.jsx("div",{className:`p-3 rounded-lg text-sm ${D.includes("✅")?"bg-green-50 text-green-700 border border-green-200":D.includes("⚠️")?"bg-orange-50 text-orange-700 border border-orange-200":"bg-red-50 text-red-700 border border-red-200"}`,children:D}),s.jsx("div",{className:"border-t pt-4",children:s.jsx(Lj,{compact:!0})})]})]})})]})}function SE(){var _,b,P,B,$,k,I;const{customers:t,addCustomer:e}=lt(),{user:r}=pt(),{addNotification:n}=ws(),{addActivity:a}=Co(),[o,c]=R.useState(""),[u,h]=R.useState("management"),[f,m]=R.useState(null),[v,w]=R.useState(!1),N=(r==null?void 0:r.role)==="pharmacist"||(r==null?void 0:r.role)==="manager",g=async T=>{try{await e(T),a("customer","Added new customer",`Customer "${T.name}" was added to the system`,{customerName:T.name}),w(!1)}catch(D){console.error("Error adding customer:",D),n({title:"Error",message:"Failed to add customer. Please try again.",type:"error"})}};Qa.useEffect(()=>{(r==null?void 0:r.role)==="customer"&&h("shopping")},[r]);const y=t.filter(T=>T.name.toLowerCase().includes(o.toLowerCase())||T.email.toLowerCase().includes(o.toLowerCase())||T.phone.includes(o)),j=T=>{m(T),h("profile")};return u==="profile"&&f?s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("button",{onClick:()=>h("management"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[s.jsx(Nj,{className:"h-5 w-5"}),s.jsx("span",{children:"Back to Customer Management"})]})}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Customer Profile"}),s.jsx("button",{onClick:()=>h("management"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Rr,{className:"h-5 w-5 text-gray-500"})})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-xl font-bold",children:f.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:f.name}),s.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${f.membershipTier==="bronze"?"text-amber-600 bg-amber-50":f.membershipTier==="silver"?"text-gray-600 bg-gray-50":f.membershipTier==="gold"?"text-yellow-600 bg-yellow-50":"text-purple-600 bg-purple-50"}`,children:[s.jsx(Yt,{className:"h-4 w-4 mr-1"}),((_=f.membershipTier)==null?void 0:_.toUpperCase())||"BRONZE"," MEMBER"]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(Yt,{className:"h-5 w-5 mr-2 text-blue-600"}),"Personal Information"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(mc,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:f.email})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(pc,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:f.phone})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(vt,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:f.address})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Zs,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:new Date(f.dateOfBirth).toLocaleDateString("vi-VN")})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(_h,{className:"h-5 w-5 mr-2 text-red-600"}),"Health Information"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[((b=f.healthStatus)==null?void 0:b.bloodType)&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Blood Type:"}),s.jsx("span",{className:"font-medium text-red-600",children:f.healthStatus.bloodType})]}),((P=f.healthStatus)==null?void 0:P.height)&&((B=f.healthStatus)==null?void 0:B.weight)&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Height:"}),s.jsxs("span",{className:"font-medium",children:[f.healthStatus.height," cm"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Weight:"}),s.jsxs("span",{className:"font-medium",children:[f.healthStatus.weight," kg"]})]})]})]})]}),s.jsxs("div",{className:"space-y-4 lg:col-span-2",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Medical Alerts"}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600 block mb-2",children:"Allergies:"}),(($=f.allergies)==null?void 0:$.length)>0?s.jsx("div",{className:"flex flex-wrap gap-2",children:f.allergies.map((T,D)=>s.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full",children:T},D))}):s.jsx("span",{className:"text-gray-500 text-sm",children:"No known allergies"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600 block mb-2",children:"Chronic Conditions:"}),((I=(k=f.healthStatus)==null?void 0:k.chronicConditions)==null?void 0:I.length)>0?s.jsx("div",{className:"flex flex-wrap gap-2",children:f.healthStatus.chronicConditions.map((T,D)=>s.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full",children:T},D))}):s.jsx("span",{className:"text-gray-500 text-sm",children:"No chronic conditions"})]})]})]})]})]})]})]}):u==="shopping"?s.jsxs("div",{className:"space-y-6",children:[(r==null?void 0:r.role)!=="customer"&&s.jsx("div",{className:"flex justify-end",children:s.jsxs("button",{onClick:()=>h("management"),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center space-x-2",children:[s.jsx(nE,{className:"h-4 w-4"}),s.jsx("span",{children:"Switch to Management"})]})}),s.jsx(jE,{})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Customer Management"}),s.jsx("p",{className:"text-gray-600",children:"Manage customer information and history"})]}),s.jsxs("div",{className:"flex space-x-3",children:[(r==null?void 0:r.role)==="customer"&&s.jsxs("button",{onClick:()=>h("shopping"),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:[s.jsx(_h,{className:"h-4 w-4"}),s.jsx("span",{children:"Shop Now"})]}),N&&s.jsxs("button",{onClick:()=>w(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(Di,{className:"h-4 w-4"}),s.jsx("span",{children:"Add Customer"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Customers"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]}),s.jsx(Yt,{className:"h-8 w-8 text-blue-500"})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active This Month"}),s.jsx("p",{className:"text-2xl font-bold text-green-600",children:Math.floor(t.length*.7)})]}),s.jsx(Yt,{className:"h-8 w-8 text-green-500"})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"New This Week"}),s.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Math.floor(t.length*.1)})]}),s.jsx(Yt,{className:"h-8 w-8 text-blue-500"})]})}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"VIP Customers"}),s.jsx("p",{className:"text-2xl font-bold text-purple-600",children:Math.floor(t.length*.15)})]}),s.jsx(Yt,{className:"h-8 w-8 text-purple-500"})]})})]}),s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"relative",children:[s.jsx(dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search customers...",value:o,onChange:T=>c(T.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full md:w-96"})]})}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map(T=>s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"flex items-start justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"h-12 w-12 bg-gradient-to-r from-blue-600 to-green-600 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-white font-semibold text-lg",children:T.name.split(" ").map(D=>D[0]).join("").substring(0,2)})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:T.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",T.id]})]})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsx("button",{onClick:()=>j(T),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"View Profile",children:s.jsx(us,{className:"h-4 w-4"})}),s.jsx("button",{className:"text-gray-600 hover:text-gray-800 transition-colors",children:s.jsx(ea,{className:"h-4 w-4"})})]})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[s.jsx(mc,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"text-gray-700",children:T.email})]}),s.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[s.jsx(pc,{className:"h-4 w-4 text-gray-400"}),s.jsx("span",{className:"text-gray-700",children:T.phone})]}),s.jsxs("div",{className:"flex items-start space-x-3 text-sm",children:[s.jsx(vt,{className:"h-4 w-4 text-gray-400 mt-0.5"}),s.jsx("span",{className:"text-gray-700 flex-1",children:T.address})]}),s.jsxs("div",{className:"flex items-center space-x-3 text-sm",children:[s.jsx(Zs,{className:"h-4 w-4 text-gray-400"}),s.jsxs("span",{className:"text-gray-700",children:["Born: ",new Date(T.dateOfBirth).toLocaleDateString("vi-VN")]})]})]}),T.allergies.length>0&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100",children:[s.jsx("p",{className:"text-xs font-medium text-gray-600 mb-2",children:"ALLERGIES"}),s.jsx("div",{className:"flex flex-wrap gap-1",children:T.allergies.map((D,U)=>s.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-red-100 text-red-800 rounded-full",children:D},U))})]}),s.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-100 flex justify-between text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Prescriptions"}),s.jsx("p",{className:"font-semibold text-gray-900",children:T.prescriptionHistory.length})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-500",children:"Orders"}),s.jsx("p",{className:"font-semibold text-gray-900",children:T.orderHistory.length})]})]})]},T.id))}),y.length===0&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-12 text-center",children:[s.jsx(Yt,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No customers found"}),s.jsx("p",{className:"text-gray-500",children:"Try adjusting your search criteria or add new customers."})]}),s.jsx(CE,{isOpen:v,onClose:()=>w(!1),onSubmit:g,addNotification:n})]})}function CE({isOpen:t,onClose:e,onSubmit:r,addNotification:n}){const[a,o]=R.useState({name:"",email:"",phone:"",address:"",dateOfBirth:"",allergies:[],healthStatus:{bloodType:"",height:"",weight:"",chronicConditions:[],emergencyContact:{name:"",phone:"",relationship:""},insurance:{provider:"",policyNumber:"",expiryDate:""}},membershipTier:"bronze"}),[c,u]=R.useState(!1),h=async f=>{if(f.preventDefault(),!c){if(!a.name||!a.email||!a.phone){n({title:"Validation Error",message:"Please fill in all required fields (Name, Email, Phone)",type:"error"});return}u(!0);try{const m={name:a.name,email:a.email,phone:a.phone,address:a.address,dateOfBirth:a.dateOfBirth,allergies:a.allergies,prescriptionHistory:[],orderHistory:[],healthStatus:{...a.healthStatus,height:a.healthStatus.height?parseInt(a.healthStatus.height):void 0,weight:a.healthStatus.weight?parseInt(a.healthStatus.weight):void 0},membershipTier:a.membershipTier,joinDate:new Date().toISOString(),totalSpent:0};await r(m),n({title:"Customer Added",message:`${a.name} has been added to the system`,type:"success"}),o({name:"",email:"",phone:"",address:"",dateOfBirth:"",allergies:[],healthStatus:{bloodType:"",height:"",weight:"",chronicConditions:[],emergencyContact:{name:"",phone:"",relationship:""},insurance:{provider:"",policyNumber:"",expiryDate:""}},membershipTier:"bronze"}),e()}catch{n({title:"Error",message:"Failed to add customer",type:"error"})}finally{u(!1)}}};return t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:s.jsx("div",{className:"bg-white rounded-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Customer"}),s.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600",children:s.jsx(Rr,{className:"h-6 w-6"})})]}),s.jsxs("form",{onSubmit:h,className:"space-y-6",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx($n,{className:"h-5 w-5 mr-2"}),"Basic Information"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name *"}),s.jsx("input",{type:"text",value:a.name,onChange:f=>o({...a,name:f.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),s.jsx("input",{type:"email",value:a.email,onChange:f=>o({...a,email:f.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number *"}),s.jsx("input",{type:"tel",value:a.phone,onChange:f=>o({...a,phone:f.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date of Birth"}),s.jsx("input",{type:"date",value:a.dateOfBirth,onChange:f=>o({...a,dateOfBirth:f.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{className:"md:col-span-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),s.jsx("textarea",{value:a.address,onChange:f=>o({...a,address:f.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:2})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Membership Tier"}),s.jsxs("select",{value:a.membershipTier,onChange:f=>o({...a,membershipTier:f.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"bronze",children:"Bronze"}),s.jsx("option",{value:"silver",children:"Silver"}),s.jsx("option",{value:"gold",children:"Gold"}),s.jsx("option",{value:"platinum",children:"Platinum"})]})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(rm,{className:"h-5 w-5 mr-2"}),"Health Information (Optional)"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Blood Type"}),s.jsxs("select",{value:a.healthStatus.bloodType,onChange:f=>o({...a,healthStatus:{...a.healthStatus,bloodType:f.target.value}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"",children:"Select Blood Type"}),s.jsx("option",{value:"A+",children:"A+"}),s.jsx("option",{value:"A-",children:"A-"}),s.jsx("option",{value:"B+",children:"B+"}),s.jsx("option",{value:"B-",children:"B-"}),s.jsx("option",{value:"AB+",children:"AB+"}),s.jsx("option",{value:"AB-",children:"AB-"}),s.jsx("option",{value:"O+",children:"O+"}),s.jsx("option",{value:"O-",children:"O-"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Height (cm)"}),s.jsx("input",{type:"number",value:a.healthStatus.height,onChange:f=>o({...a,healthStatus:{...a.healthStatus,height:f.target.value}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"50",max:"250"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Weight (kg)"}),s.jsx("input",{type:"number",value:a.healthStatus.weight,onChange:f=>o({...a,healthStatus:{...a.healthStatus,weight:f.target.value}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",min:"10",max:"300"})]})]})]}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(bh,{className:"h-5 w-5 mr-2"}),"Emergency Contact (Optional)"]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Name"}),s.jsx("input",{type:"text",value:a.healthStatus.emergencyContact.name,onChange:f=>o({...a,healthStatus:{...a.healthStatus,emergencyContact:{...a.healthStatus.emergencyContact,name:f.target.value}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Phone"}),s.jsx("input",{type:"tel",value:a.healthStatus.emergencyContact.phone,onChange:f=>o({...a,healthStatus:{...a.healthStatus,emergencyContact:{...a.healthStatus.emergencyContact,phone:f.target.value}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Relationship"}),s.jsx("input",{type:"text",value:a.healthStatus.emergencyContact.relationship,onChange:f=>o({...a,healthStatus:{...a.healthStatus,emergencyContact:{...a.healthStatus.emergencyContact,relationship:f.target.value}}}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Spouse, Parent, Sibling"})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-3 pt-4",children:[s.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),s.jsxs("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center space-x-2",children:[c?s.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):s.jsx(Xi,{className:"h-4 w-4"}),s.jsx("span",{children:c?"Adding...":"Add Customer"})]})]})]})]})})}):null}function PE(){const{products:t,prescriptions:e,orders:r,customers:n}=lt(),[a,o]=R.useState("30"),c=r.reduce((m,v)=>m+v.total,0);r.length>0&&c/r.length;const u=t.map(m=>({...m,sold:Math.floor(Math.random()*100)})).sort((m,v)=>v.sold-m.sold).slice(0,5),h=[{month:"Jan",revenue:25e6,orders:120,prescriptions:85},{month:"Feb",revenue:28e6,orders:135,prescriptions:92},{month:"Mar",revenue:32e6,orders:150,prescriptions:110},{month:"Apr",revenue:3e7,orders:142,prescriptions:95},{month:"May",revenue:35e6,orders:165,prescriptions:125},{month:"Jun",revenue:38e6,orders:180,prescriptions:140}],f=[{label:"Total Revenue",value:`₫${c.toLocaleString()}`,change:"+12.5%",trend:"up",icon:UT,color:"text-green-600"},{label:"Total Orders",value:r.length,change:"+8.2%",trend:"up",icon:Ot,color:"text-blue-600"},{label:"Active Customers",value:n.length,change:"+15.3%",trend:"up",icon:Yt,color:"text-purple-600"},{label:"Prescriptions Processed",value:e.length,change:"+5.7%",trend:"up",icon:Jn,color:"text-orange-600"}];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Reports & Analytics"}),s.jsx("p",{className:"text-gray-600",children:"Business insights and performance metrics"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("select",{value:a,onChange:m=>o(m.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[s.jsx("option",{value:"7",children:"Last 7 days"}),s.jsx("option",{value:"30",children:"Last 30 days"}),s.jsx("option",{value:"90",children:"Last 3 months"}),s.jsx("option",{value:"365",children:"Last year"})]}),s.jsxs("button",{className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[s.jsx(qT,{className:"h-4 w-4"}),s.jsx("span",{children:"Export Report"})]})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:f.map((m,v)=>s.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:m.label}),s.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:m.value}),s.jsxs("div",{className:"flex items-center mt-2",children:[s.jsx(Kc,{className:"h-4 w-4 text-green-500 mr-1"}),s.jsx("span",{className:"text-sm font-medium text-green-600",children:m.change}),s.jsx("span",{className:"text-sm text-gray-500 ml-1",children:"vs last period"})]})]}),s.jsx("div",{className:"bg-gray-50 p-3 rounded-lg",children:s.jsx(m.icon,{className:`h-6 w-6 ${m.color}`})})]})},v))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Revenue Trend"}),s.jsx(jj,{className:"h-5 w-5 text-gray-400"})]}),s.jsx("div",{className:"space-y-4",children:h.map((m,v)=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-gray-600 w-12",children:m.month}),s.jsx("div",{className:"flex-1 mx-4",children:s.jsx("div",{className:"bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:`${m.revenue/4e7*100}%`}})})}),s.jsxs("span",{className:"text-sm font-semibold text-gray-900 w-24 text-right",children:["₫",(m.revenue/1e6).toFixed(1),"M"]})]},v))})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Top Selling Products"}),s.jsx(Ot,{className:"h-5 w-5 text-gray-400"})]}),s.jsx("div",{className:"space-y-4",children:u.map((m,v)=>s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx("span",{className:"text-sm font-semibold text-blue-600",children:v+1})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:m.name}),s.jsx("p",{className:"text-sm text-gray-500",children:m.category})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:[m.sold," sold"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["₫",m.price.toLocaleString()]})]})]},m.id))})]})]}),s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Monthly Performance"}),s.jsx(Zs,{className:"h-5 w-5 text-gray-400"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-600",children:"Month"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-600",children:"Revenue"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-600",children:"Orders"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-600",children:"Prescriptions"}),s.jsx("th",{className:"text-left py-3 px-4 text-sm font-medium text-gray-600",children:"Avg. Order Value"})]})}),s.jsx("tbody",{children:h.map((m,v)=>s.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[s.jsxs("td",{className:"py-3 px-4 text-sm font-medium text-gray-900",children:[m.month," 2024"]}),s.jsxs("td",{className:"py-3 px-4 text-sm text-gray-900",children:["₫",m.revenue.toLocaleString()]}),s.jsx("td",{className:"py-3 px-4 text-sm text-gray-900",children:m.orders}),s.jsx("td",{className:"py-3 px-4 text-sm text-gray-900",children:m.prescriptions}),s.jsxs("td",{className:"py-3 px-4 text-sm text-gray-900",children:["₫",(m.revenue/m.orders).toLocaleString()]})]},v))})]})})]})]})}function kE(){const{user:t}=pt(),{orders:e}=lt(),[r,n]=R.useState(null),[a,o]=R.useState(!1),c=e.filter(f=>f.customerId===(t==null?void 0:t.id)&&(f.status==="assigned"||f.status==="delivered")&&f.trackingNumber);R.useEffect(()=>{const f=setInterval(()=>{r&&r.status==="shipped"&&n(m=>({...m,shipperLocation:{...m.shipperLocation,timestamp:new Date().toISOString()}}))},3e4);return()=>clearInterval(f)},[r]);const u=f=>{switch(f){case"shipped":return s.jsx(ur,{className:"h-5 w-5 text-blue-500"});case"delivered":return s.jsx(Lt,{className:"h-5 w-5 text-green-500"});default:return s.jsx(Ot,{className:"h-5 w-5 text-gray-500"})}},h=f=>f.actualDelivery?`Delivered: ${new Date(f.actualDelivery).toLocaleString()}`:f.estimatedDelivery?`Estimated: ${new Date(f.estimatedDelivery).toLocaleString()}`:"Estimating delivery time...";return!t||t.role!=="customer"?s.jsx("div",{className:"p-6 text-center",children:s.jsx("p",{className:"text-gray-500",children:"Shipping tracking is only available for customers."})}):c.length===0?s.jsxs("div",{className:"p-6 text-center",children:[s.jsx(Ot,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Trackable Orders"}),s.jsx("p",{className:"text-gray-500",children:"You don't have any orders currently being shipped."})]}):s.jsxs("div",{className:"bg-white",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[s.jsx(ur,{className:"h-6 w-6 mr-2 text-blue-500"}),"Track Your Orders"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor your shipments in real-time"})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 p-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Your Shipments"}),c.map(f=>s.jsx("div",{className:`p-4 border rounded-lg cursor-pointer transition-all ${(r==null?void 0:r.id)===f.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>n(f),children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[u(f.status),s.jsxs("span",{className:"font-semibold text-gray-900",children:["Order #",f.id]}),s.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${f.status==="delivered"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:f.status.toUpperCase()})]}),s.jsxs("div",{className:"mt-2 space-y-1",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx(Ot,{className:"h-3 w-3 inline mr-1"}),f.items.length," item(s) • $",f.total]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx(Zs,{className:"h-3 w-3 inline mr-1"}),h(f)]}),f.trackingNumber&&s.jsxs("p",{className:"text-sm text-gray-600",children:[s.jsx(qi,{className:"h-3 w-3 inline mr-1"}),"Tracking: ",f.trackingNumber]})]})]}),(r==null?void 0:r.id)===f.id&&s.jsx(tm,{className:"h-5 w-5 text-blue-500 mt-1"})]})},f.id))]}),s.jsx("div",{children:r?s.jsxs("div",{className:"space-y-6",children:[r.shippingInfo&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsxs("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[s.jsx($n,{className:"h-4 w-4 mr-2"}),"Your Delivery Person"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"text-sm",children:[s.jsx("strong",{children:"Name:"})," ",r.shippingInfo.shipperName]}),s.jsxs("p",{className:"text-sm",children:[s.jsx("strong",{children:"Phone:"}),s.jsx("a",{href:`tel:${r.shippingInfo.shipperPhone}`,className:"text-blue-600 hover:text-blue-800 ml-1",children:r.shippingInfo.shipperPhone})]}),s.jsxs("p",{className:"text-sm",children:[s.jsx("strong",{children:"Vehicle:"})," ",r.shippingInfo.vehicleType," (",r.shippingInfo.vehicleNumber,")"]}),s.jsxs("p",{className:"text-sm",children:[s.jsx("strong",{children:"ETA:"})," ",r.shippingInfo.estimatedTime]})]})]}),r.shipperLocation&&s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsxs("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center",children:[s.jsx(vt,{className:"h-4 w-4 mr-2 text-blue-500"}),"Current Location"]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-sm text-gray-700",children:r.shipperLocation.address}),s.jsxs("p",{className:"text-xs text-gray-500",children:[s.jsx(Bn,{className:"h-3 w-3 inline mr-1"}),"Last updated: ",new Date(r.shipperLocation.timestamp).toLocaleString()]}),s.jsxs("button",{onClick:()=>o(!a),className:"flex items-center text-blue-600 hover:text-blue-800 text-sm",children:[s.jsx(qi,{className:"h-3 w-3 mr-1"}),a?"Hide Map":"View on Map"]})]})]}),a&&r.shipperLocation&&s.jsx("div",{className:"bg-gray-100 rounded-lg p-4 h-64 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(vt,{className:"h-12 w-12 text-blue-500 mx-auto mb-2"}),s.jsx("p",{className:"text-gray-600",children:"Interactive Map"}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Lat: ",r.shipperLocation.latitude.toFixed(6)]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Lng: ",r.shipperLocation.longitude.toFixed(6)]}),s.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"In a real implementation, this would show Google Maps or similar"})]})}),r.trackingHistory&&r.trackingHistory.length>0&&s.jsxs("div",{className:"bg-white rounded-lg border p-4",children:[s.jsxs("h4",{className:"font-semibold text-gray-900 mb-4 flex items-center",children:[s.jsx(fs,{className:"h-4 w-4 mr-2"}),"Tracking History"]}),s.jsx("div",{className:"space-y-3",children:r.trackingHistory.map((f,m)=>s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${m===0?"bg-blue-500":"bg-gray-300"}`})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"text-sm font-medium text-gray-900",children:f.description}),s.jsx("p",{className:"text-xs text-gray-500",children:f.location.address}),s.jsx("p",{className:"text-xs text-gray-400",children:new Date(f.timestamp).toLocaleString()})]})]},m))})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Order Items"}),s.jsxs("div",{className:"space-y-2",children:[r.items.map((f,m)=>s.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-gray-100 last:border-0",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium",children:f.productName}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Qty: ",f.quantity]})]}),s.jsxs("p",{className:"text-sm font-semibold",children:["$",f.price]})]},m)),s.jsx("div",{className:"pt-2 border-t",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-semibold",children:"Total:"}),s.jsxs("span",{className:"font-semibold text-lg",children:["$",r.total]})]})})]})]})]}):s.jsxs("div",{className:"bg-gray-50 rounded-lg p-8 text-center",children:[s.jsx(ur,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Select an Order"}),s.jsx("p",{className:"text-gray-500",children:"Choose an order from the list to track its delivery status and location."})]})})]})]})}function TE(){const{user:t}=pt(),{orders:e,shippers:r,updateShippingInfo:n,updateOrder:a}=lt(),{addNotification:o}=ws(),{addActivity:c}=Co(),[u,h]=R.useState(null),[f,m]=R.useState(!1),[v,w]=R.useState(!1),[N,g]=R.useState(""),y=r.filter($=>$.isAvailable&&!e.some(k=>k.assignedShipperId===$.id&&["shipped","in_transit"].includes(k.status))),j=e.filter($=>$.status==="confirmed"||$.status==="assigned"),_=(t==null?void 0:t.role)==="pharmacist"||(t==null?void 0:t.role)==="manager",b=async()=>{var $,k,I,T,D,U;if(!(!u||!N||v)){w(!0);try{const V=r.find(te=>te.id===N);if(!V){o({title:"Assignment Failed",message:"Selected shipper not found",type:"error"}),w(!1);return}const z=u.trackingNumber||`TRK${Date.now().toString().slice(-8)}`,q={shippingInfo:{shipperName:V.name,shipperPhone:V.phone,vehicleType:V.vehicleType,vehicleNumber:V.vehicleNumber,estimatedTime:"2-3 hours"},shipperLocation:{latitude:(($=V.currentLocation)==null?void 0:$.latitude)||14.5995,longitude:((k=V.currentLocation)==null?void 0:k.longitude)||120.9842,address:((I=V.currentLocation)==null?void 0:I.address)||"Longchau Pharmacy",timestamp:new Date().toISOString()},trackingHistory:[{timestamp:new Date().toISOString(),status:"shipped",location:{latitude:((T=V.currentLocation)==null?void 0:T.latitude)||14.5995,longitude:((D=V.currentLocation)==null?void 0:D.longitude)||120.9842,address:((U=V.currentLocation)==null?void 0:U.address)||"Longchau Pharmacy"},description:`Package picked up by ${V.name}`}],estimatedDelivery:new Date(Date.now()+2*60*60*1e3).toISOString(),assignedShipperId:N},Q=await n(u.id,q);if(Q.success){if(u.status==="confirmed"){const te={...u,status:"shipped",trackingNumber:z,assignedShipperId:N};await a(te)}c("order","Assigned shipper",`Order #${u.id} assigned to ${V.name}`,{orderId:u.id,status:"shipped"}),o({title:"Shipper Assigned",message:`${V.name} has been assigned to deliver Order #${u.id}`,type:"success"}),m(!1),g("")}else o({title:"Assignment Failed",message:Q.error||"Failed to assign shipper",type:"error"})}catch{o({title:"Assignment Failed",message:"An error occurred while assigning the shipper",type:"error"})}finally{w(!1)}}},P=async $=>{const k=[{lat:14.5995,lng:120.9842,address:"Longchau Pharmacy, Manila"},{lat:14.6042,lng:120.9822,address:"Taft Avenue, Manila"},{lat:14.6091,lng:120.9794,address:"UN Avenue, Manila"},{lat:14.6137,lng:120.9765,address:"Pedro Gil Street, Manila"}],I=k[Math.floor(Math.random()*k.length)],T=e.find(D=>D.id===$);if(T&&T.trackingHistory){const D={timestamp:new Date().toISOString(),status:"in_transit",location:{latitude:I.lat,longitude:I.lng,address:I.address},description:"Package is on the way"},U={shipperLocation:{latitude:I.lat,longitude:I.lng,address:I.address,timestamp:new Date().toISOString()},trackingHistory:[D,...T.trackingHistory]};(await n($,U)).success&&o({title:"Location Updated",message:`Shipper location updated for Order #${$}`,type:"success"})}},B=$=>{h($),g(""),m(!0)};return _?s.jsxs("div",{className:"bg-white",children:[s.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[s.jsx(ur,{className:"h-6 w-6 mr-2 text-blue-500"}),"Shipping Management"]}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Assign shippers and track deliveries"})]}),s.jsx("div",{className:"p-6",children:j.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Ot,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Orders to Ship"}),s.jsx("p",{className:"text-gray-500",children:"All orders are either pending confirmation or already delivered."})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Order"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Shipper"}),s.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map($=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["#",$.id]}),s.jsxs("div",{className:"text-sm text-gray-500",children:["$",$.total]})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:$.customerName}),s.jsx("div",{className:"text-sm text-gray-500",children:$.shippingAddress})]})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${$.status==="confirmed"?"bg-yellow-100 text-yellow-800":$.status==="assigned"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:$.status.toUpperCase()})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:$.shippingInfo?s.jsxs("div",{children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:$.shippingInfo.shipperName}),s.jsxs("div",{className:"text-sm text-gray-500",children:[$.shippingInfo.vehicleType," - ",$.shippingInfo.vehicleNumber]})]}):s.jsx("span",{className:"text-sm text-gray-400",children:"Not assigned"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.jsx("div",{className:"flex space-x-2",children:$.shippingInfo?s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>B($),className:"text-gray-600 hover:text-gray-900 flex items-center",children:[s.jsx(ea,{className:"h-4 w-4 mr-1"}),"Edit"]}),$.status==="assigned"&&s.jsxs("button",{onClick:()=>P($.id),className:"text-green-600 hover:text-green-900 flex items-center",children:[s.jsx(fs,{className:"h-4 w-4 mr-1"}),"Update Location"]})]}):s.jsxs("button",{onClick:()=>B($),className:"text-blue-600 hover:text-blue-900 flex items-center",children:[s.jsx(Di,{className:"h-4 w-4 mr-1"}),"Assign"]})})})]},$.id))})]})})}),f&&s.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:s.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:[s.jsxs("div",{className:"flex justify-between items-center mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:u!=null&&u.shippingInfo?"Edit Shipper":"Assign Shipper"}),s.jsx("button",{onClick:()=>{m(!1),g("")},className:"text-gray-400 hover:text-gray-600",children:s.jsx(Rr,{className:"h-5 w-5"})})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[s.jsx($n,{className:"h-4 w-4 inline mr-1"}),"Select Shipper"]}),s.jsxs("select",{value:N,onChange:$=>g($.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[s.jsx("option",{value:"",children:"Choose a shipper..."}),y.map($=>s.jsxs("option",{value:$.id,children:[$.name," - ",$.vehicleType," (",$.vehicleNumber,")"]},$.id))]}),y.length===0&&s.jsx("p",{className:"text-sm text-red-600 mt-1",children:"No available shippers. All shippers are currently assigned or unavailable."})]}),N&&s.jsx("div",{className:"bg-gray-50 p-3 rounded-md",children:(()=>{const $=r.find(k=>k.id===N);return $?s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"Shipper Details"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Name:"}),s.jsx("span",{className:"ml-1 font-medium",children:$.name})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Phone:"}),s.jsx("span",{className:"ml-1 font-medium",children:$.phone})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Vehicle:"}),s.jsx("span",{className:"ml-1 font-medium",children:$.vehicleType})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"License:"}),s.jsx("span",{className:"ml-1 font-medium",children:$.vehicleNumber})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Rating:"}),s.jsxs("span",{className:"ml-1 font-medium",children:["⭐ ",$.rating.toFixed(1)]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Deliveries:"}),s.jsx("span",{className:"ml-1 font-medium",children:$.totalDeliveries})]})]}),$.currentLocation&&s.jsxs("div",{className:"pt-2 border-t",children:[s.jsx("span",{className:"text-gray-600",children:"Current Location:"}),s.jsx("span",{className:"ml-1 text-sm",children:$.currentLocation.address})]})]}):null})()})]}),s.jsxs("div",{className:"flex justify-end space-x-2 mt-6",children:[s.jsx("button",{onClick:()=>{m(!1),g("")},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",children:"Cancel"}),s.jsxs("button",{onClick:b,disabled:v||!N,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:[s.jsx(Xi,{className:"h-4 w-4 mr-1"}),v?"Assigning...":"Assign Shipper"]})]})]})})]}):s.jsxs("div",{className:"p-6 text-center",children:[s.jsx(ur,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Restricted"}),s.jsx("p",{className:"text-gray-500",children:"Only pharmacists and managers can manage shipping."})]})}const wc=class wc{static async reverseGeocode(e,r){try{const a=await fetch(`${this.NOMINATIM_API}/reverse?format=json&lat=${e}&lon=${r}&addressdetails=1&accept-language=vi,en`,{headers:{"User-Agent":"LongChau-PMS/1.0"}});if(a.ok){const o=await a.json();if(o&&o.address)return{success:!0,address:this.parseNominatimAddress(o,e,r)}}}catch(a){console.warn("Nominatim API failed, using fallback:",a)}return{success:!0,address:this.findNearestAddress(e,r)}}static async geocode(e){try{const n=await fetch(`${this.NOMINATIM_API}/search?format=json&q=${encodeURIComponent(e)}, Vietnam&addressdetails=1&limit=1&accept-language=vi,en`,{headers:{"User-Agent":"LongChau-PMS/1.0"}});if(n.ok){const a=await n.json();if(a&&a.length>0){const o=a[0],c=parseFloat(o.lat),u=parseFloat(o.lon);return{success:!0,address:this.parseNominatimAddress(o,c,u)}}}}catch(n){console.warn("Nominatim geocoding failed, using fallback:",n)}const r=this.searchAddressDatabase(e);return r?{success:!0,address:r}:{success:!1,error:"Address not found"}}static parseNominatimAddress(e,r,n){const a=e.address||{};return{street:a.house_number&&a.road?`${a.house_number} ${a.road}`:a.road||"Unknown Street",ward:a.suburb||a.neighbourhood||a.quarter||"Unknown Ward",district:a.city_district||a.county||a.state_district||"Unknown District",city:a.city||a.town||a.village||"Unknown City",province:a.state||a.province||"Unknown Province",fullAddress:e.display_name||"Unknown Address",coordinates:{latitude:r,longitude:n}}}static findNearestAddress(e,r){let n=this.VIETNAM_ADDRESSES[0],a=this.calculateDistance(e,r,n.coordinates.latitude,n.coordinates.longitude);for(const o of this.VIETNAM_ADDRESSES){const c=this.calculateDistance(e,r,o.coordinates.latitude,o.coordinates.longitude);c<a&&(a=c,n=o)}return{...n,fullAddress:`${n.street}, ${n.ward}, ${n.district}, ${n.city}, ${n.province}`}}static searchAddressDatabase(e){const r=e.toLowerCase();for(const n of this.VIETNAM_ADDRESSES)if(`${n.street} ${n.ward} ${n.district} ${n.city} ${n.province}`.toLowerCase().includes(r)||r.includes(n.city.toLowerCase()))return{...n,fullAddress:`${n.street}, ${n.ward}, ${n.district}, ${n.city}, ${n.province}`};return null}static calculateDistance(e,r,n,a){const c=this.toRadians(n-e),u=this.toRadians(a-r),h=Math.sin(c/2)*Math.sin(c/2)+Math.cos(this.toRadians(e))*Math.cos(this.toRadians(n))*Math.sin(u/2)*Math.sin(u/2);return 6371*(2*Math.atan2(Math.sqrt(h),Math.sqrt(1-h)))}static toRadians(e){return e*(Math.PI/180)}static getRandomVietnameseAddress(){const e=Math.floor(Math.random()*this.VIETNAM_ADDRESSES.length),r=this.VIETNAM_ADDRESSES[e];return{...r,fullAddress:`${r.street}, ${r.ward}, ${r.district}, ${r.city}, ${r.province}`}}static getAddressesByCity(e){return this.VIETNAM_ADDRESSES.filter(r=>r.city.toLowerCase().includes(e.toLowerCase())).map(r=>({...r,fullAddress:`${r.street}, ${r.ward}, ${r.district}, ${r.city}, ${r.province}`}))}static validateVietnamesePhone(e){return[/^(\+84|84|0)(3|5|7|8|9)([0-9]{8})$/,/^(\+84|84|0)(2)([0-9]{9})$/].some(n=>n.test(e.replace(/\s+/g,"")))}static formatAddress(e){return`${e.street}, ${e.ward}, ${e.district}, ${e.city}`}};wc.NOMINATIM_API="https://nominatim.openstreetmap.org",wc.VIETNAM_ADDRESSES=[{street:"123 Nguyen Hue",ward:"Ben Nghe",district:"District 1",city:"Ho Chi Minh City",province:"Ho Chi Minh City",coordinates:{latitude:10.8231,longitude:106.6297}},{street:"456 Le Loi",ward:"Ben Thanh",district:"District 1",city:"Ho Chi Minh City",province:"Ho Chi Minh City",coordinates:{latitude:10.8205,longitude:106.625}},{street:"789 Dong Khoi",ward:"Ben Nghe",district:"District 1",city:"Ho Chi Minh City",province:"Ho Chi Minh City",coordinates:{latitude:10.8224,longitude:106.6289}},{street:"321 Vo Van Tan",ward:"Vo Thi Sau",district:"District 3",city:"Ho Chi Minh City",province:"Ho Chi Minh City",coordinates:{latitude:10.7889,longitude:106.6917}},{street:"654 Cach Mang Thang Tam",ward:"Ward 6",district:"District 3",city:"Ho Chi Minh City",province:"Ho Chi Minh City",coordinates:{latitude:10.7831,longitude:106.6734}},{street:"88 Hoan Kiem",ward:"Hang Bong",district:"Hoan Kiem District",city:"Hanoi",province:"Hanoi",coordinates:{latitude:21.0285,longitude:105.8542}},{street:"234 Ba Dinh",ward:"Kim Ma",district:"Ba Dinh District",city:"Hanoi",province:"Hanoi",coordinates:{latitude:21.0333,longitude:105.834}},{street:"567 Dong Da",ward:"Lang Ha",district:"Dong Da District",city:"Hanoi",province:"Hanoi",coordinates:{latitude:21.0136,longitude:105.8175}},{street:"111 Han River",ward:"An Hai Bac",district:"Son Tra District",city:"Da Nang",province:"Da Nang",coordinates:{latitude:16.0471,longitude:108.2068}},{street:"222 Beach Road",ward:"My An",district:"Ngu Hanh Son District",city:"Da Nang",province:"Da Nang",coordinates:{latitude:16.0137,longitude:108.252}},{street:"333 Mekong Delta",ward:"Tan An",district:"Ninh Kieu District",city:"Can Tho",province:"Can Tho",coordinates:{latitude:10.0452,longitude:105.7469}},{street:"444 Floating Market",ward:"Cai Khe",district:"Ninh Kieu District",city:"Can Tho",province:"Can Tho",coordinates:{latitude:10.0302,longitude:105.7831}}];let Vt=wc;function Aj(t,e){const r=R.useRef(e);R.useEffect(function(){e!==r.current&&t.attributionControl!=null&&(r.current!=null&&t.attributionControl.removeAttribution(r.current),e!=null&&t.attributionControl.addAttribution(e)),r.current=e},[t,e])}const EE=1;function LE(t){return Object.freeze({__version:EE,map:t})}function Mj(t,e){return Object.freeze({...t,...e})}const Ij=R.createContext(null),Dj=Ij.Provider;function Gc(){const t=R.useContext(Ij);if(t==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return t}function Oj(t){function e(r,n){const{instance:a,context:o}=t(r).current;return R.useImperativeHandle(n,()=>a),r.children==null?null:Qa.createElement(Dj,{value:o},r.children)}return R.forwardRef(e)}function AE(t){function e(r,n){const[a,o]=R.useState(!1),{instance:c}=t(r,o).current;R.useImperativeHandle(n,()=>c),R.useEffect(function(){a&&c.update()},[c,a,r.children]);const u=c._contentNode;return u?i_.createPortal(r.children,u):null}return R.forwardRef(e)}function ME(t){function e(r,n){const{instance:a}=t(r).current;return R.useImperativeHandle(n,()=>a),null}return R.forwardRef(e)}function im(t,e){const r=R.useRef();R.useEffect(function(){return e!=null&&t.instance.on(e),r.current=e,function(){r.current!=null&&t.instance.off(r.current),r.current=null}},[t,e])}function Yc(t,e){const r=t.pane??e.pane;return r?{...t,pane:r}:t}function IE(t,e){return function(n,a){const o=Gc(),c=t(Yc(n,o),o);return Aj(o.map,n.attribution),im(c.current,n.eventHandlers),e(c.current,o,n,a),c}}var Nh={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(t,e){(function(r,n){n(e)})(nC,function(r){var n="1.9.4";function a(i){var l,d,p,S;for(d=1,p=arguments.length;d<p;d++){S=arguments[d];for(l in S)i[l]=S[l]}return i}var o=Object.create||function(){function i(){}return function(l){return i.prototype=l,new i}}();function c(i,l){var d=Array.prototype.slice;if(i.bind)return i.bind.apply(i,d.call(arguments,1));var p=d.call(arguments,2);return function(){return i.apply(l,p.length?p.concat(d.call(arguments)):arguments)}}var u=0;function h(i){return"_leaflet_id"in i||(i._leaflet_id=++u),i._leaflet_id}function f(i,l,d){var p,S,M,F;return F=function(){p=!1,S&&(M.apply(d,S),S=!1)},M=function(){p?S=arguments:(i.apply(d,arguments),setTimeout(F,l),p=!0)},M}function m(i,l,d){var p=l[1],S=l[0],M=p-S;return i===p&&d?i:((i-S)%M+M)%M+S}function v(){return!1}function w(i,l){if(l===!1)return i;var d=Math.pow(10,l===void 0?6:l);return Math.round(i*d)/d}function N(i){return i.trim?i.trim():i.replace(/^\s+|\s+$/g,"")}function g(i){return N(i).split(/\s+/)}function y(i,l){Object.prototype.hasOwnProperty.call(i,"options")||(i.options=i.options?o(i.options):{});for(var d in l)i.options[d]=l[d];return i.options}function j(i,l,d){var p=[];for(var S in i)p.push(encodeURIComponent(d?S.toUpperCase():S)+"="+encodeURIComponent(i[S]));return(!l||l.indexOf("?")===-1?"?":"&")+p.join("&")}var _=/\{ *([\w_ -]+) *\}/g;function b(i,l){return i.replace(_,function(d,p){var S=l[p];if(S===void 0)throw new Error("No value provided for variable "+d);return typeof S=="function"&&(S=S(l)),S})}var P=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"};function B(i,l){for(var d=0;d<i.length;d++)if(i[d]===l)return d;return-1}var $="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function k(i){return window["webkit"+i]||window["moz"+i]||window["ms"+i]}var I=0;function T(i){var l=+new Date,d=Math.max(0,16-(l-I));return I=l+d,window.setTimeout(i,d)}var D=window.requestAnimationFrame||k("RequestAnimationFrame")||T,U=window.cancelAnimationFrame||k("CancelAnimationFrame")||k("CancelRequestAnimationFrame")||function(i){window.clearTimeout(i)};function V(i,l,d){if(d&&D===T)i.call(l);else return D.call(window,c(i,l))}function z(i){i&&U.call(window,i)}var q={__proto__:null,extend:a,create:o,bind:c,get lastId(){return u},stamp:h,throttle:f,wrapNum:m,falseFn:v,formatNum:w,trim:N,splitWords:g,setOptions:y,getParamString:j,template:b,isArray:P,indexOf:B,emptyImageUrl:$,requestFn:D,cancelFn:U,requestAnimFrame:V,cancelAnimFrame:z};function Q(){}Q.extend=function(i){var l=function(){y(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},d=l.__super__=this.prototype,p=o(d);p.constructor=l,l.prototype=p;for(var S in this)Object.prototype.hasOwnProperty.call(this,S)&&S!=="prototype"&&S!=="__super__"&&(l[S]=this[S]);return i.statics&&a(l,i.statics),i.includes&&(te(i.includes),a.apply(null,[p].concat(i.includes))),a(p,i),delete p.statics,delete p.includes,p.options&&(p.options=d.options?o(d.options):{},a(p.options,i.options)),p._initHooks=[],p.callInitHooks=function(){if(!this._initHooksCalled){d.callInitHooks&&d.callInitHooks.call(this),this._initHooksCalled=!0;for(var M=0,F=p._initHooks.length;M<F;M++)p._initHooks[M].call(this)}},l},Q.include=function(i){var l=this.prototype.options;return a(this.prototype,i),i.options&&(this.prototype.options=l,this.mergeOptions(i.options)),this},Q.mergeOptions=function(i){return a(this.prototype.options,i),this},Q.addInitHook=function(i){var l=Array.prototype.slice.call(arguments,1),d=typeof i=="function"?i:function(){this[i].apply(this,l)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(d),this};function te(i){if(!(typeof L>"u"||!L||!L.Mixin)){i=P(i)?i:[i];for(var l=0;l<i.length;l++)i[l]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var de={on:function(i,l,d){if(typeof i=="object")for(var p in i)this._on(p,i[p],l);else{i=g(i);for(var S=0,M=i.length;S<M;S++)this._on(i[S],l,d)}return this},off:function(i,l,d){if(!arguments.length)delete this._events;else if(typeof i=="object")for(var p in i)this._off(p,i[p],l);else{i=g(i);for(var S=arguments.length===1,M=0,F=i.length;M<F;M++)S?this._off(i[M]):this._off(i[M],l,d)}return this},_on:function(i,l,d,p){if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}if(this._listens(i,l,d)===!1){d===this&&(d=void 0);var S={fn:l,ctx:d};p&&(S.once=!0),this._events=this._events||{},this._events[i]=this._events[i]||[],this._events[i].push(S)}},_off:function(i,l,d){var p,S,M;if(this._events&&(p=this._events[i],!!p)){if(arguments.length===1){if(this._firingCount)for(S=0,M=p.length;S<M;S++)p[S].fn=v;delete this._events[i];return}if(typeof l!="function"){console.warn("wrong listener type: "+typeof l);return}var F=this._listens(i,l,d);if(F!==!1){var Y=p[F];this._firingCount&&(Y.fn=v,this._events[i]=p=p.slice()),p.splice(F,1)}}},fire:function(i,l,d){if(!this.listens(i,d))return this;var p=a({},l,{type:i,target:this,sourceTarget:l&&l.sourceTarget||this});if(this._events){var S=this._events[i];if(S){this._firingCount=this._firingCount+1||1;for(var M=0,F=S.length;M<F;M++){var Y=S[M],X=Y.fn;Y.once&&this.off(i,X,Y.ctx),X.call(Y.ctx||this,p)}this._firingCount--}}return d&&this._propagateEvent(p),this},listens:function(i,l,d,p){typeof i!="string"&&console.warn('"string" type argument expected');var S=l;typeof l!="function"&&(p=!!l,S=void 0,d=void 0);var M=this._events&&this._events[i];if(M&&M.length&&this._listens(i,S,d)!==!1)return!0;if(p){for(var F in this._eventParents)if(this._eventParents[F].listens(i,l,d,p))return!0}return!1},_listens:function(i,l,d){if(!this._events)return!1;var p=this._events[i]||[];if(!l)return!!p.length;d===this&&(d=void 0);for(var S=0,M=p.length;S<M;S++)if(p[S].fn===l&&p[S].ctx===d)return S;return!1},once:function(i,l,d){if(typeof i=="object")for(var p in i)this._on(p,i[p],l,!0);else{i=g(i);for(var S=0,M=i.length;S<M;S++)this._on(i[S],l,d,!0)}return this},addEventParent:function(i){return this._eventParents=this._eventParents||{},this._eventParents[h(i)]=i,this},removeEventParent:function(i){return this._eventParents&&delete this._eventParents[h(i)],this},_propagateEvent:function(i){for(var l in this._eventParents)this._eventParents[l].fire(i.type,a({layer:i.target,propagatedFrom:i.target},i),!0)}};de.addEventListener=de.on,de.removeEventListener=de.clearAllEventListeners=de.off,de.addOneTimeEventListener=de.once,de.fireEvent=de.fire,de.hasEventListeners=de.listens;var re=Q.extend(de);function Z(i,l,d){this.x=d?Math.round(i):i,this.y=d?Math.round(l):l}var ne=Math.trunc||function(i){return i>0?Math.floor(i):Math.ceil(i)};Z.prototype={clone:function(){return new Z(this.x,this.y)},add:function(i){return this.clone()._add(ie(i))},_add:function(i){return this.x+=i.x,this.y+=i.y,this},subtract:function(i){return this.clone()._subtract(ie(i))},_subtract:function(i){return this.x-=i.x,this.y-=i.y,this},divideBy:function(i){return this.clone()._divideBy(i)},_divideBy:function(i){return this.x/=i,this.y/=i,this},multiplyBy:function(i){return this.clone()._multiplyBy(i)},_multiplyBy:function(i){return this.x*=i,this.y*=i,this},scaleBy:function(i){return new Z(this.x*i.x,this.y*i.y)},unscaleBy:function(i){return new Z(this.x/i.x,this.y/i.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ne(this.x),this.y=ne(this.y),this},distanceTo:function(i){i=ie(i);var l=i.x-this.x,d=i.y-this.y;return Math.sqrt(l*l+d*d)},equals:function(i){return i=ie(i),i.x===this.x&&i.y===this.y},contains:function(i){return i=ie(i),Math.abs(i.x)<=Math.abs(this.x)&&Math.abs(i.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function ie(i,l,d){return i instanceof Z?i:P(i)?new Z(i[0],i[1]):i==null?i:typeof i=="object"&&"x"in i&&"y"in i?new Z(i.x,i.y):new Z(i,l,d)}function K(i,l){if(i)for(var d=l?[i,l]:i,p=0,S=d.length;p<S;p++)this.extend(d[p])}K.prototype={extend:function(i){var l,d;if(!i)return this;if(i instanceof Z||typeof i[0]=="number"||"x"in i)l=d=ie(i);else if(i=fe(i),l=i.min,d=i.max,!l||!d)return this;return!this.min&&!this.max?(this.min=l.clone(),this.max=d.clone()):(this.min.x=Math.min(l.x,this.min.x),this.max.x=Math.max(d.x,this.max.x),this.min.y=Math.min(l.y,this.min.y),this.max.y=Math.max(d.y,this.max.y)),this},getCenter:function(i){return ie((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,i)},getBottomLeft:function(){return ie(this.min.x,this.max.y)},getTopRight:function(){return ie(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(i){var l,d;return typeof i[0]=="number"||i instanceof Z?i=ie(i):i=fe(i),i instanceof K?(l=i.min,d=i.max):l=d=i,l.x>=this.min.x&&d.x<=this.max.x&&l.y>=this.min.y&&d.y<=this.max.y},intersects:function(i){i=fe(i);var l=this.min,d=this.max,p=i.min,S=i.max,M=S.x>=l.x&&p.x<=d.x,F=S.y>=l.y&&p.y<=d.y;return M&&F},overlaps:function(i){i=fe(i);var l=this.min,d=this.max,p=i.min,S=i.max,M=S.x>l.x&&p.x<d.x,F=S.y>l.y&&p.y<d.y;return M&&F},isValid:function(){return!!(this.min&&this.max)},pad:function(i){var l=this.min,d=this.max,p=Math.abs(l.x-d.x)*i,S=Math.abs(l.y-d.y)*i;return fe(ie(l.x-p,l.y-S),ie(d.x+p,d.y+S))},equals:function(i){return i?(i=fe(i),this.min.equals(i.getTopLeft())&&this.max.equals(i.getBottomRight())):!1}};function fe(i,l){return!i||i instanceof K?i:new K(i,l)}function Ae(i,l){if(i)for(var d=l?[i,l]:i,p=0,S=d.length;p<S;p++)this.extend(d[p])}Ae.prototype={extend:function(i){var l=this._southWest,d=this._northEast,p,S;if(i instanceof ue)p=i,S=i;else if(i instanceof Ae){if(p=i._southWest,S=i._northEast,!p||!S)return this}else return i?this.extend(ae(i)||ee(i)):this;return!l&&!d?(this._southWest=new ue(p.lat,p.lng),this._northEast=new ue(S.lat,S.lng)):(l.lat=Math.min(p.lat,l.lat),l.lng=Math.min(p.lng,l.lng),d.lat=Math.max(S.lat,d.lat),d.lng=Math.max(S.lng,d.lng)),this},pad:function(i){var l=this._southWest,d=this._northEast,p=Math.abs(l.lat-d.lat)*i,S=Math.abs(l.lng-d.lng)*i;return new Ae(new ue(l.lat-p,l.lng-S),new ue(d.lat+p,d.lng+S))},getCenter:function(){return new ue((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ue(this.getNorth(),this.getWest())},getSouthEast:function(){return new ue(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(i){typeof i[0]=="number"||i instanceof ue||"lat"in i?i=ae(i):i=ee(i);var l=this._southWest,d=this._northEast,p,S;return i instanceof Ae?(p=i.getSouthWest(),S=i.getNorthEast()):p=S=i,p.lat>=l.lat&&S.lat<=d.lat&&p.lng>=l.lng&&S.lng<=d.lng},intersects:function(i){i=ee(i);var l=this._southWest,d=this._northEast,p=i.getSouthWest(),S=i.getNorthEast(),M=S.lat>=l.lat&&p.lat<=d.lat,F=S.lng>=l.lng&&p.lng<=d.lng;return M&&F},overlaps:function(i){i=ee(i);var l=this._southWest,d=this._northEast,p=i.getSouthWest(),S=i.getNorthEast(),M=S.lat>l.lat&&p.lat<d.lat,F=S.lng>l.lng&&p.lng<d.lng;return M&&F},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(i,l){return i?(i=ee(i),this._southWest.equals(i.getSouthWest(),l)&&this._northEast.equals(i.getNorthEast(),l)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ee(i,l){return i instanceof Ae?i:new Ae(i,l)}function ue(i,l,d){if(isNaN(i)||isNaN(l))throw new Error("Invalid LatLng object: ("+i+", "+l+")");this.lat=+i,this.lng=+l,d!==void 0&&(this.alt=+d)}ue.prototype={equals:function(i,l){if(!i)return!1;i=ae(i);var d=Math.max(Math.abs(this.lat-i.lat),Math.abs(this.lng-i.lng));return d<=(l===void 0?1e-9:l)},toString:function(i){return"LatLng("+w(this.lat,i)+", "+w(this.lng,i)+")"},distanceTo:function(i){return Re.distance(this,ae(i))},wrap:function(){return Re.wrapLatLng(this)},toBounds:function(i){var l=180*i/40075017,d=l/Math.cos(Math.PI/180*this.lat);return ee([this.lat-l,this.lng-d],[this.lat+l,this.lng+d])},clone:function(){return new ue(this.lat,this.lng,this.alt)}};function ae(i,l,d){return i instanceof ue?i:P(i)&&typeof i[0]!="object"?i.length===3?new ue(i[0],i[1],i[2]):i.length===2?new ue(i[0],i[1]):null:i==null?i:typeof i=="object"&&"lat"in i?new ue(i.lat,"lng"in i?i.lng:i.lon,i.alt):l===void 0?null:new ue(i,l,d)}var pe={latLngToPoint:function(i,l){var d=this.projection.project(i),p=this.scale(l);return this.transformation._transform(d,p)},pointToLatLng:function(i,l){var d=this.scale(l),p=this.transformation.untransform(i,d);return this.projection.unproject(p)},project:function(i){return this.projection.project(i)},unproject:function(i){return this.projection.unproject(i)},scale:function(i){return 256*Math.pow(2,i)},zoom:function(i){return Math.log(i/256)/Math.LN2},getProjectedBounds:function(i){if(this.infinite)return null;var l=this.projection.bounds,d=this.scale(i),p=this.transformation.transform(l.min,d),S=this.transformation.transform(l.max,d);return new K(p,S)},infinite:!1,wrapLatLng:function(i){var l=this.wrapLng?m(i.lng,this.wrapLng,!0):i.lng,d=this.wrapLat?m(i.lat,this.wrapLat,!0):i.lat,p=i.alt;return new ue(d,l,p)},wrapLatLngBounds:function(i){var l=i.getCenter(),d=this.wrapLatLng(l),p=l.lat-d.lat,S=l.lng-d.lng;if(p===0&&S===0)return i;var M=i.getSouthWest(),F=i.getNorthEast(),Y=new ue(M.lat-p,M.lng-S),X=new ue(F.lat-p,F.lng-S);return new Ae(Y,X)}},Re=a({},pe,{wrapLng:[-180,180],R:6371e3,distance:function(i,l){var d=Math.PI/180,p=i.lat*d,S=l.lat*d,M=Math.sin((l.lat-i.lat)*d/2),F=Math.sin((l.lng-i.lng)*d/2),Y=M*M+Math.cos(p)*Math.cos(S)*F*F,X=2*Math.atan2(Math.sqrt(Y),Math.sqrt(1-Y));return this.R*X}}),$t=6378137,fr={R:$t,MAX_LATITUDE:85.0511287798,project:function(i){var l=Math.PI/180,d=this.MAX_LATITUDE,p=Math.max(Math.min(d,i.lat),-d),S=Math.sin(p*l);return new Z(this.R*i.lng*l,this.R*Math.log((1+S)/(1-S))/2)},unproject:function(i){var l=180/Math.PI;return new ue((2*Math.atan(Math.exp(i.y/this.R))-Math.PI/2)*l,i.x*l/this.R)},bounds:function(){var i=$t*Math.PI;return new K([-i,-i],[i,i])}()};function fn(i,l,d,p){if(P(i)){this._a=i[0],this._b=i[1],this._c=i[2],this._d=i[3];return}this._a=i,this._b=l,this._c=d,this._d=p}fn.prototype={transform:function(i,l){return this._transform(i.clone(),l)},_transform:function(i,l){return l=l||1,i.x=l*(this._a*i.x+this._b),i.y=l*(this._c*i.y+this._d),i},untransform:function(i,l){return l=l||1,new Z((i.x/l-this._b)/this._a,(i.y/l-this._d)/this._c)}};function mn(i,l,d,p){return new fn(i,l,d,p)}var Br=a({},Re,{code:"EPSG:3857",projection:fr,transformation:function(){var i=.5/(Math.PI*fr.R);return mn(i,.5,-i,.5)}()}),Fn=a({},Br,{code:"EPSG:900913"});function ko(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function ra(i,l){var d="",p,S,M,F,Y,X;for(p=0,M=i.length;p<M;p++){for(Y=i[p],S=0,F=Y.length;S<F;S++)X=Y[S],d+=(S?"L":"M")+X.x+" "+X.y;d+=l?Ne.svg?"z":"x":""}return d||"M0 0"}var Un=document.documentElement.style,bs="ActiveXObject"in window,To=bs&&!document.addEventListener,Xs="msLaunchUri"in navigator&&!("documentMode"in document),pn=Xr("webkit"),rr=Xr("android"),_s=Xr("android 2")||Xr("android 3"),tu=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),$r=rr&&Xr("Google")&&tu<537&&!("AudioNode"in window),ei=!!window.opera,x=!Xs&&Xr("chrome"),C=Xr("gecko")&&!pn&&!ei&&!bs,E=!x&&Xr("safari"),H=Xr("phantom"),G="OTransition"in Un,se=navigator.platform.indexOf("Win")===0,me=bs&&"transition"in Un,Qe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!_s,dt="MozPerspective"in Un,Ke=!window.L_DISABLE_3D&&(me||Qe||dt)&&!G&&!H,He=typeof orientation<"u"||Xr("mobile"),ct=He&&pn,$j=He&&Qe,lm=!window.PointerEvent&&window.MSPointerEvent,cm=!!(window.PointerEvent||lm),um="ontouchstart"in window||!!window.TouchEvent,zj=!window.L_NO_TOUCH&&(um||cm),Fj=He&&ei,Uj=He&&C,qj=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Hj=function(){var i=!1;try{var l=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("testPassiveEventSupport",v,l),window.removeEventListener("testPassiveEventSupport",v,l)}catch{}return i}(),Vj=function(){return!!document.createElement("canvas").getContext}(),ru=!!(document.createElementNS&&ko("svg").createSVGRect),Qj=!!ru&&function(){var i=document.createElement("div");return i.innerHTML="<svg/>",(i.firstChild&&i.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Wj=!ru&&function(){try{var i=document.createElement("div");i.innerHTML='<v:shape adj="1"/>';var l=i.firstChild;return l.style.behavior="url(#default#VML)",l&&typeof l.adj=="object"}catch{return!1}}(),Zj=navigator.platform.indexOf("Mac")===0,Kj=navigator.platform.indexOf("Linux")===0;function Xr(i){return navigator.userAgent.toLowerCase().indexOf(i)>=0}var Ne={ie:bs,ielt9:To,edge:Xs,webkit:pn,android:rr,android23:_s,androidStock:$r,opera:ei,chrome:x,gecko:C,safari:E,phantom:H,opera12:G,win:se,ie3d:me,webkit3d:Qe,gecko3d:dt,any3d:Ke,mobile:He,mobileWebkit:ct,mobileWebkit3d:$j,msPointer:lm,pointer:cm,touch:zj,touchNative:um,mobileOpera:Fj,mobileGecko:Uj,retina:qj,passiveEvents:Hj,canvas:Vj,svg:ru,vml:Wj,inlineSvg:Qj,mac:Zj,linux:Kj},dm=Ne.msPointer?"MSPointerDown":"pointerdown",hm=Ne.msPointer?"MSPointerMove":"pointermove",fm=Ne.msPointer?"MSPointerUp":"pointerup",mm=Ne.msPointer?"MSPointerCancel":"pointercancel",nu={touchstart:dm,touchmove:hm,touchend:fm,touchcancel:mm},pm={touchstart:tS,touchmove:Eo,touchend:Eo,touchcancel:Eo},ti={},gm=!1;function Gj(i,l,d){return l==="touchstart"&&eS(),pm[l]?(d=pm[l].bind(this,d),i.addEventListener(nu[l],d,!1),d):(console.warn("wrong event specified:",l),v)}function Yj(i,l,d){if(!nu[l]){console.warn("wrong event specified:",l);return}i.removeEventListener(nu[l],d,!1)}function Jj(i){ti[i.pointerId]=i}function Xj(i){ti[i.pointerId]&&(ti[i.pointerId]=i)}function ym(i){delete ti[i.pointerId]}function eS(){gm||(document.addEventListener(dm,Jj,!0),document.addEventListener(hm,Xj,!0),document.addEventListener(fm,ym,!0),document.addEventListener(mm,ym,!0),gm=!0)}function Eo(i,l){if(l.pointerType!==(l.MSPOINTER_TYPE_MOUSE||"mouse")){l.touches=[];for(var d in ti)l.touches.push(ti[d]);l.changedTouches=[l],i(l)}}function tS(i,l){l.MSPOINTER_TYPE_TOUCH&&l.pointerType===l.MSPOINTER_TYPE_TOUCH&&Mt(l),Eo(i,l)}function rS(i){var l={},d,p;for(p in i)d=i[p],l[p]=d&&d.bind?d.bind(i):d;return i=l,l.type="dblclick",l.detail=2,l.isTrusted=!1,l._simulated=!0,l}var nS=200;function sS(i,l){i.addEventListener("dblclick",l);var d=0,p;function S(M){if(M.detail!==1){p=M.detail;return}if(!(M.pointerType==="mouse"||M.sourceCapabilities&&!M.sourceCapabilities.firesTouchEvents)){var F=_m(M);if(!(F.some(function(X){return X instanceof HTMLLabelElement&&X.attributes.for})&&!F.some(function(X){return X instanceof HTMLInputElement||X instanceof HTMLSelectElement}))){var Y=Date.now();Y-d<=nS?(p++,p===2&&l(rS(M))):p=1,d=Y}}}return i.addEventListener("click",S),{dblclick:l,simDblclick:S}}function iS(i,l){i.removeEventListener("dblclick",l.dblclick),i.removeEventListener("click",l.simDblclick)}var su=Mo(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),na=Mo(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),xm=na==="webkitTransition"||na==="OTransition"?na+"End":"transitionend";function vm(i){return typeof i=="string"?document.getElementById(i):i}function sa(i,l){var d=i.style[l]||i.currentStyle&&i.currentStyle[l];if((!d||d==="auto")&&document.defaultView){var p=document.defaultView.getComputedStyle(i,null);d=p?p[l]:null}return d==="auto"?null:d}function Ve(i,l,d){var p=document.createElement(i);return p.className=l||"",d&&d.appendChild(p),p}function st(i){var l=i.parentNode;l&&l.removeChild(i)}function Lo(i){for(;i.firstChild;)i.removeChild(i.firstChild)}function ri(i){var l=i.parentNode;l&&l.lastChild!==i&&l.appendChild(i)}function ni(i){var l=i.parentNode;l&&l.firstChild!==i&&l.insertBefore(i,l.firstChild)}function iu(i,l){if(i.classList!==void 0)return i.classList.contains(l);var d=Ao(i);return d.length>0&&new RegExp("(^|\\s)"+l+"(\\s|$)").test(d)}function Ie(i,l){if(i.classList!==void 0)for(var d=g(l),p=0,S=d.length;p<S;p++)i.classList.add(d[p]);else if(!iu(i,l)){var M=Ao(i);au(i,(M?M+" ":"")+l)}}function ht(i,l){i.classList!==void 0?i.classList.remove(l):au(i,N((" "+Ao(i)+" ").replace(" "+l+" "," ")))}function au(i,l){i.className.baseVal===void 0?i.className=l:i.className.baseVal=l}function Ao(i){return i.correspondingElement&&(i=i.correspondingElement),i.className.baseVal===void 0?i.className:i.className.baseVal}function jr(i,l){"opacity"in i.style?i.style.opacity=l:"filter"in i.style&&aS(i,l)}function aS(i,l){var d=!1,p="DXImageTransform.Microsoft.Alpha";try{d=i.filters.item(p)}catch{if(l===1)return}l=Math.round(l*100),d?(d.Enabled=l!==100,d.Opacity=l):i.style.filter+=" progid:"+p+"(opacity="+l+")"}function Mo(i){for(var l=document.documentElement.style,d=0;d<i.length;d++)if(i[d]in l)return i[d];return!1}function Ns(i,l,d){var p=l||new Z(0,0);i.style[su]=(Ne.ie3d?"translate("+p.x+"px,"+p.y+"px)":"translate3d("+p.x+"px,"+p.y+"px,0)")+(d?" scale("+d+")":"")}function gt(i,l){i._leaflet_pos=l,Ne.any3d?Ns(i,l):(i.style.left=l.x+"px",i.style.top=l.y+"px")}function js(i){return i._leaflet_pos||new Z(0,0)}var ia,aa,ou;if("onselectstart"in document)ia=function(){Me(window,"selectstart",Mt)},aa=function(){Ge(window,"selectstart",Mt)};else{var oa=Mo(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);ia=function(){if(oa){var i=document.documentElement.style;ou=i[oa],i[oa]="none"}},aa=function(){oa&&(document.documentElement.style[oa]=ou,ou=void 0)}}function lu(){Me(window,"dragstart",Mt)}function cu(){Ge(window,"dragstart",Mt)}var Io,uu;function du(i){for(;i.tabIndex===-1;)i=i.parentNode;i.style&&(Do(),Io=i,uu=i.style.outlineStyle,i.style.outlineStyle="none",Me(window,"keydown",Do))}function Do(){Io&&(Io.style.outlineStyle=uu,Io=void 0,uu=void 0,Ge(window,"keydown",Do))}function wm(i){do i=i.parentNode;while((!i.offsetWidth||!i.offsetHeight)&&i!==document.body);return i}function hu(i){var l=i.getBoundingClientRect();return{x:l.width/i.offsetWidth||1,y:l.height/i.offsetHeight||1,boundingClientRect:l}}var oS={__proto__:null,TRANSFORM:su,TRANSITION:na,TRANSITION_END:xm,get:vm,getStyle:sa,create:Ve,remove:st,empty:Lo,toFront:ri,toBack:ni,hasClass:iu,addClass:Ie,removeClass:ht,setClass:au,getClass:Ao,setOpacity:jr,testProp:Mo,setTransform:Ns,setPosition:gt,getPosition:js,get disableTextSelection(){return ia},get enableTextSelection(){return aa},disableImageDrag:lu,enableImageDrag:cu,preventOutline:du,restoreOutline:Do,getSizedParentNode:wm,getScale:hu};function Me(i,l,d,p){if(l&&typeof l=="object")for(var S in l)mu(i,S,l[S],d);else{l=g(l);for(var M=0,F=l.length;M<F;M++)mu(i,l[M],d,p)}return this}var en="_leaflet_events";function Ge(i,l,d,p){if(arguments.length===1)bm(i),delete i[en];else if(l&&typeof l=="object")for(var S in l)pu(i,S,l[S],d);else if(l=g(l),arguments.length===2)bm(i,function(Y){return B(l,Y)!==-1});else for(var M=0,F=l.length;M<F;M++)pu(i,l[M],d,p);return this}function bm(i,l){for(var d in i[en]){var p=d.split(/\d/)[0];(!l||l(p))&&pu(i,p,null,null,d)}}var fu={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function mu(i,l,d,p){var S=l+h(d)+(p?"_"+h(p):"");if(i[en]&&i[en][S])return this;var M=function(Y){return d.call(p||i,Y||window.event)},F=M;!Ne.touchNative&&Ne.pointer&&l.indexOf("touch")===0?M=Gj(i,l,M):Ne.touch&&l==="dblclick"?M=sS(i,M):"addEventListener"in i?l==="touchstart"||l==="touchmove"||l==="wheel"||l==="mousewheel"?i.addEventListener(fu[l]||l,M,Ne.passiveEvents?{passive:!1}:!1):l==="mouseenter"||l==="mouseleave"?(M=function(Y){Y=Y||window.event,yu(i,Y)&&F(Y)},i.addEventListener(fu[l],M,!1)):i.addEventListener(l,F,!1):i.attachEvent("on"+l,M),i[en]=i[en]||{},i[en][S]=M}function pu(i,l,d,p,S){S=S||l+h(d)+(p?"_"+h(p):"");var M=i[en]&&i[en][S];if(!M)return this;!Ne.touchNative&&Ne.pointer&&l.indexOf("touch")===0?Yj(i,l,M):Ne.touch&&l==="dblclick"?iS(i,M):"removeEventListener"in i?i.removeEventListener(fu[l]||l,M,!1):i.detachEvent("on"+l,M),i[en][S]=null}function Ss(i){return i.stopPropagation?i.stopPropagation():i.originalEvent?i.originalEvent._stopped=!0:i.cancelBubble=!0,this}function gu(i){return mu(i,"wheel",Ss),this}function la(i){return Me(i,"mousedown touchstart dblclick contextmenu",Ss),i._leaflet_disable_click=!0,this}function Mt(i){return i.preventDefault?i.preventDefault():i.returnValue=!1,this}function Cs(i){return Mt(i),Ss(i),this}function _m(i){if(i.composedPath)return i.composedPath();for(var l=[],d=i.target;d;)l.push(d),d=d.parentNode;return l}function Nm(i,l){if(!l)return new Z(i.clientX,i.clientY);var d=hu(l),p=d.boundingClientRect;return new Z((i.clientX-p.left)/d.x-l.clientLeft,(i.clientY-p.top)/d.y-l.clientTop)}var lS=Ne.linux&&Ne.chrome?window.devicePixelRatio:Ne.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function jm(i){return Ne.edge?i.wheelDeltaY/2:i.deltaY&&i.deltaMode===0?-i.deltaY/lS:i.deltaY&&i.deltaMode===1?-i.deltaY*20:i.deltaY&&i.deltaMode===2?-i.deltaY*60:i.deltaX||i.deltaZ?0:i.wheelDelta?(i.wheelDeltaY||i.wheelDelta)/2:i.detail&&Math.abs(i.detail)<32765?-i.detail*20:i.detail?i.detail/-32765*60:0}function yu(i,l){var d=l.relatedTarget;if(!d)return!0;try{for(;d&&d!==i;)d=d.parentNode}catch{return!1}return d!==i}var cS={__proto__:null,on:Me,off:Ge,stopPropagation:Ss,disableScrollPropagation:gu,disableClickPropagation:la,preventDefault:Mt,stop:Cs,getPropagationPath:_m,getMousePosition:Nm,getWheelDelta:jm,isExternalTarget:yu,addListener:Me,removeListener:Ge},Sm=re.extend({run:function(i,l,d,p){this.stop(),this._el=i,this._inProgress=!0,this._duration=d||.25,this._easeOutPower=1/Math.max(p||.5,.2),this._startPos=js(i),this._offset=l.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=V(this._animate,this),this._step()},_step:function(i){var l=+new Date-this._startTime,d=this._duration*1e3;l<d?this._runFrame(this._easeOut(l/d),i):(this._runFrame(1),this._complete())},_runFrame:function(i,l){var d=this._startPos.add(this._offset.multiplyBy(i));l&&d._round(),gt(this._el,d),this.fire("step")},_complete:function(){z(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(i){return 1-Math.pow(1-i,this._easeOutPower)}}),Ue=re.extend({options:{crs:Br,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(i,l){l=y(this,l),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(i),this._initLayout(),this._onResize=c(this._onResize,this),this._initEvents(),l.maxBounds&&this.setMaxBounds(l.maxBounds),l.zoom!==void 0&&(this._zoom=this._limitZoom(l.zoom)),l.center&&l.zoom!==void 0&&this.setView(ae(l.center),l.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=na&&Ne.any3d&&!Ne.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Me(this._proxy,xm,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(i,l,d){if(l=l===void 0?this._zoom:this._limitZoom(l),i=this._limitCenter(ae(i),l,this.options.maxBounds),d=d||{},this._stop(),this._loaded&&!d.reset&&d!==!0){d.animate!==void 0&&(d.zoom=a({animate:d.animate},d.zoom),d.pan=a({animate:d.animate,duration:d.duration},d.pan));var p=this._zoom!==l?this._tryAnimatedZoom&&this._tryAnimatedZoom(i,l,d.zoom):this._tryAnimatedPan(i,d.pan);if(p)return clearTimeout(this._sizeTimer),this}return this._resetView(i,l,d.pan&&d.pan.noMoveStart),this},setZoom:function(i,l){return this._loaded?this.setView(this.getCenter(),i,{zoom:l}):(this._zoom=i,this)},zoomIn:function(i,l){return i=i||(Ne.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+i,l)},zoomOut:function(i,l){return i=i||(Ne.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-i,l)},setZoomAround:function(i,l,d){var p=this.getZoomScale(l),S=this.getSize().divideBy(2),M=i instanceof Z?i:this.latLngToContainerPoint(i),F=M.subtract(S).multiplyBy(1-1/p),Y=this.containerPointToLatLng(S.add(F));return this.setView(Y,l,{zoom:d})},_getBoundsCenterZoom:function(i,l){l=l||{},i=i.getBounds?i.getBounds():ee(i);var d=ie(l.paddingTopLeft||l.padding||[0,0]),p=ie(l.paddingBottomRight||l.padding||[0,0]),S=this.getBoundsZoom(i,!1,d.add(p));if(S=typeof l.maxZoom=="number"?Math.min(l.maxZoom,S):S,S===1/0)return{center:i.getCenter(),zoom:S};var M=p.subtract(d).divideBy(2),F=this.project(i.getSouthWest(),S),Y=this.project(i.getNorthEast(),S),X=this.unproject(F.add(Y).divideBy(2).add(M),S);return{center:X,zoom:S}},fitBounds:function(i,l){if(i=ee(i),!i.isValid())throw new Error("Bounds are not valid.");var d=this._getBoundsCenterZoom(i,l);return this.setView(d.center,d.zoom,l)},fitWorld:function(i){return this.fitBounds([[-90,-180],[90,180]],i)},panTo:function(i,l){return this.setView(i,this._zoom,{pan:l})},panBy:function(i,l){if(i=ie(i).round(),l=l||{},!i.x&&!i.y)return this.fire("moveend");if(l.animate!==!0&&!this.getSize().contains(i))return this._resetView(this.unproject(this.project(this.getCenter()).add(i)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Sm,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),l.noMoveStart||this.fire("movestart"),l.animate!==!1){Ie(this._mapPane,"leaflet-pan-anim");var d=this._getMapPanePos().subtract(i).round();this._panAnim.run(this._mapPane,d,l.duration||.25,l.easeLinearity)}else this._rawPanBy(i),this.fire("move").fire("moveend");return this},flyTo:function(i,l,d){if(d=d||{},d.animate===!1||!Ne.any3d)return this.setView(i,l,d);this._stop();var p=this.project(this.getCenter()),S=this.project(i),M=this.getSize(),F=this._zoom;i=ae(i),l=l===void 0?F:l;var Y=Math.max(M.x,M.y),X=Y*this.getZoomScale(F,l),le=S.distanceTo(p)||1,ye=1.42,Ce=ye*ye;function Be(yt){var Wo=yt?-1:1,YS=yt?X:Y,JS=X*X-Y*Y+Wo*Ce*Ce*le*le,XS=2*YS*Ce*le,ku=JS/XS,ip=Math.sqrt(ku*ku+1)-ku,eC=ip<1e-9?-18:Math.log(ip);return eC}function Wt(yt){return(Math.exp(yt)-Math.exp(-yt))/2}function St(yt){return(Math.exp(yt)+Math.exp(-yt))/2}function Cr(yt){return Wt(yt)/St(yt)}var nr=Be(0);function ci(yt){return Y*(St(nr)/St(nr+ye*yt))}function WS(yt){return Y*(St(nr)*Cr(nr+ye*yt)-Wt(nr))/Ce}function ZS(yt){return 1-Math.pow(1-yt,1.5)}var KS=Date.now(),np=(Be(1)-nr)/ye,GS=d.duration?1e3*d.duration:1e3*np*.8;function sp(){var yt=(Date.now()-KS)/GS,Wo=ZS(yt)*np;yt<=1?(this._flyToFrame=V(sp,this),this._move(this.unproject(p.add(S.subtract(p).multiplyBy(WS(Wo)/le)),F),this.getScaleZoom(Y/ci(Wo),F),{flyTo:!0})):this._move(i,l)._moveEnd(!0)}return this._moveStart(!0,d.noMoveStart),sp.call(this),this},flyToBounds:function(i,l){var d=this._getBoundsCenterZoom(i,l);return this.flyTo(d.center,d.zoom,l)},setMaxBounds:function(i){return i=ee(i),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),i.isValid()?(this.options.maxBounds=i,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(i){var l=this.options.minZoom;return this.options.minZoom=i,this._loaded&&l!==i&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(i):this},setMaxZoom:function(i){var l=this.options.maxZoom;return this.options.maxZoom=i,this._loaded&&l!==i&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(i):this},panInsideBounds:function(i,l){this._enforcingBounds=!0;var d=this.getCenter(),p=this._limitCenter(d,this._zoom,ee(i));return d.equals(p)||this.panTo(p,l),this._enforcingBounds=!1,this},panInside:function(i,l){l=l||{};var d=ie(l.paddingTopLeft||l.padding||[0,0]),p=ie(l.paddingBottomRight||l.padding||[0,0]),S=this.project(this.getCenter()),M=this.project(i),F=this.getPixelBounds(),Y=fe([F.min.add(d),F.max.subtract(p)]),X=Y.getSize();if(!Y.contains(M)){this._enforcingBounds=!0;var le=M.subtract(Y.getCenter()),ye=Y.extend(M).getSize().subtract(X);S.x+=le.x<0?-ye.x:ye.x,S.y+=le.y<0?-ye.y:ye.y,this.panTo(this.unproject(S),l),this._enforcingBounds=!1}return this},invalidateSize:function(i){if(!this._loaded)return this;i=a({animate:!1,pan:!0},i===!0?{animate:!0}:i);var l=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var d=this.getSize(),p=l.divideBy(2).round(),S=d.divideBy(2).round(),M=p.subtract(S);return!M.x&&!M.y?this:(i.animate&&i.pan?this.panBy(M):(i.pan&&this._rawPanBy(M),this.fire("move"),i.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(c(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:l,newSize:d}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(i){if(i=this._locateOptions=a({timeout:1e4,watch:!1},i),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var l=c(this._handleGeolocationResponse,this),d=c(this._handleGeolocationError,this);return i.watch?this._locationWatchId=navigator.geolocation.watchPosition(l,d,i):navigator.geolocation.getCurrentPosition(l,d,i),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(i){if(this._container._leaflet_id){var l=i.code,d=i.message||(l===1?"permission denied":l===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:l,message:"Geolocation error: "+d+"."})}},_handleGeolocationResponse:function(i){if(this._container._leaflet_id){var l=i.coords.latitude,d=i.coords.longitude,p=new ue(l,d),S=p.toBounds(i.coords.accuracy*2),M=this._locateOptions;if(M.setView){var F=this.getBoundsZoom(S);this.setView(p,M.maxZoom?Math.min(F,M.maxZoom):F)}var Y={latlng:p,bounds:S,timestamp:i.timestamp};for(var X in i.coords)typeof i.coords[X]=="number"&&(Y[X]=i.coords[X]);this.fire("locationfound",Y)}},addHandler:function(i,l){if(!l)return this;var d=this[i]=new l(this);return this._handlers.push(d),this.options[i]&&d.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),st(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(z(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var i;for(i in this._layers)this._layers[i].remove();for(i in this._panes)st(this._panes[i]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(i,l){var d="leaflet-pane"+(i?" leaflet-"+i.replace("Pane","")+"-pane":""),p=Ve("div",d,l||this._mapPane);return i&&(this._panes[i]=p),p},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var i=this.getPixelBounds(),l=this.unproject(i.getBottomLeft()),d=this.unproject(i.getTopRight());return new Ae(l,d)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(i,l,d){i=ee(i),d=ie(d||[0,0]);var p=this.getZoom()||0,S=this.getMinZoom(),M=this.getMaxZoom(),F=i.getNorthWest(),Y=i.getSouthEast(),X=this.getSize().subtract(d),le=fe(this.project(Y,p),this.project(F,p)).getSize(),ye=Ne.any3d?this.options.zoomSnap:1,Ce=X.x/le.x,Be=X.y/le.y,Wt=l?Math.max(Ce,Be):Math.min(Ce,Be);return p=this.getScaleZoom(Wt,p),ye&&(p=Math.round(p/(ye/100))*(ye/100),p=l?Math.ceil(p/ye)*ye:Math.floor(p/ye)*ye),Math.max(S,Math.min(M,p))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(i,l){var d=this._getTopLeftPoint(i,l);return new K(d,d.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(i){return this.options.crs.getProjectedBounds(i===void 0?this.getZoom():i)},getPane:function(i){return typeof i=="string"?this._panes[i]:i},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(i,l){var d=this.options.crs;return l=l===void 0?this._zoom:l,d.scale(i)/d.scale(l)},getScaleZoom:function(i,l){var d=this.options.crs;l=l===void 0?this._zoom:l;var p=d.zoom(i*d.scale(l));return isNaN(p)?1/0:p},project:function(i,l){return l=l===void 0?this._zoom:l,this.options.crs.latLngToPoint(ae(i),l)},unproject:function(i,l){return l=l===void 0?this._zoom:l,this.options.crs.pointToLatLng(ie(i),l)},layerPointToLatLng:function(i){var l=ie(i).add(this.getPixelOrigin());return this.unproject(l)},latLngToLayerPoint:function(i){var l=this.project(ae(i))._round();return l._subtract(this.getPixelOrigin())},wrapLatLng:function(i){return this.options.crs.wrapLatLng(ae(i))},wrapLatLngBounds:function(i){return this.options.crs.wrapLatLngBounds(ee(i))},distance:function(i,l){return this.options.crs.distance(ae(i),ae(l))},containerPointToLayerPoint:function(i){return ie(i).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(i){return ie(i).add(this._getMapPanePos())},containerPointToLatLng:function(i){var l=this.containerPointToLayerPoint(ie(i));return this.layerPointToLatLng(l)},latLngToContainerPoint:function(i){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ae(i)))},mouseEventToContainerPoint:function(i){return Nm(i,this._container)},mouseEventToLayerPoint:function(i){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(i))},mouseEventToLatLng:function(i){return this.layerPointToLatLng(this.mouseEventToLayerPoint(i))},_initContainer:function(i){var l=this._container=vm(i);if(l){if(l._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Me(l,"scroll",this._onScroll,this),this._containerId=h(l)},_initLayout:function(){var i=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ne.any3d,Ie(i,"leaflet-container"+(Ne.touch?" leaflet-touch":"")+(Ne.retina?" leaflet-retina":"")+(Ne.ielt9?" leaflet-oldie":"")+(Ne.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var l=sa(i,"position");l!=="absolute"&&l!=="relative"&&l!=="fixed"&&l!=="sticky"&&(i.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var i=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),gt(this._mapPane,new Z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ie(i.markerPane,"leaflet-zoom-hide"),Ie(i.shadowPane,"leaflet-zoom-hide"))},_resetView:function(i,l,d){gt(this._mapPane,new Z(0,0));var p=!this._loaded;this._loaded=!0,l=this._limitZoom(l),this.fire("viewprereset");var S=this._zoom!==l;this._moveStart(S,d)._move(i,l)._moveEnd(S),this.fire("viewreset"),p&&this.fire("load")},_moveStart:function(i,l){return i&&this.fire("zoomstart"),l||this.fire("movestart"),this},_move:function(i,l,d,p){l===void 0&&(l=this._zoom);var S=this._zoom!==l;return this._zoom=l,this._lastCenter=i,this._pixelOrigin=this._getNewPixelOrigin(i),p?d&&d.pinch&&this.fire("zoom",d):((S||d&&d.pinch)&&this.fire("zoom",d),this.fire("move",d)),this},_moveEnd:function(i){return i&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return z(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(i){gt(this._mapPane,this._getMapPanePos().subtract(i))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(i){this._targets={},this._targets[h(this._container)]=this;var l=i?Ge:Me;l(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&l(window,"resize",this._onResize,this),Ne.any3d&&this.options.transform3DLimit&&(i?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){z(this._resizeRequest),this._resizeRequest=V(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var i=this._getMapPanePos();Math.max(Math.abs(i.x),Math.abs(i.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(i,l){for(var d=[],p,S=l==="mouseout"||l==="mouseover",M=i.target||i.srcElement,F=!1;M;){if(p=this._targets[h(M)],p&&(l==="click"||l==="preclick")&&this._draggableMoved(p)){F=!0;break}if(p&&p.listens(l,!0)&&(S&&!yu(M,i)||(d.push(p),S))||M===this._container)break;M=M.parentNode}return!d.length&&!F&&!S&&this.listens(l,!0)&&(d=[this]),d},_isClickDisabled:function(i){for(;i&&i!==this._container;){if(i._leaflet_disable_click)return!0;i=i.parentNode}},_handleDOMEvent:function(i){var l=i.target||i.srcElement;if(!(!this._loaded||l._leaflet_disable_events||i.type==="click"&&this._isClickDisabled(l))){var d=i.type;d==="mousedown"&&du(l),this._fireDOMEvent(i,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(i,l,d){if(i.type==="click"){var p=a({},i);p.type="preclick",this._fireDOMEvent(p,p.type,d)}var S=this._findEventTargets(i,l);if(d){for(var M=[],F=0;F<d.length;F++)d[F].listens(l,!0)&&M.push(d[F]);S=M.concat(S)}if(S.length){l==="contextmenu"&&Mt(i);var Y=S[0],X={originalEvent:i};if(i.type!=="keypress"&&i.type!=="keydown"&&i.type!=="keyup"){var le=Y.getLatLng&&(!Y._radius||Y._radius<=10);X.containerPoint=le?this.latLngToContainerPoint(Y.getLatLng()):this.mouseEventToContainerPoint(i),X.layerPoint=this.containerPointToLayerPoint(X.containerPoint),X.latlng=le?Y.getLatLng():this.layerPointToLatLng(X.layerPoint)}for(F=0;F<S.length;F++)if(S[F].fire(l,X,!0),X.originalEvent._stopped||S[F].options.bubblingMouseEvents===!1&&B(this._mouseEvents,l)!==-1)return}},_draggableMoved:function(i){return i=i.dragging&&i.dragging.enabled()?i:this,i.dragging&&i.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var i=0,l=this._handlers.length;i<l;i++)this._handlers[i].disable()},whenReady:function(i,l){return this._loaded?i.call(l||this,{target:this}):this.on("load",i,l),this},_getMapPanePos:function(){return js(this._mapPane)||new Z(0,0)},_moved:function(){var i=this._getMapPanePos();return i&&!i.equals([0,0])},_getTopLeftPoint:function(i,l){var d=i&&l!==void 0?this._getNewPixelOrigin(i,l):this.getPixelOrigin();return d.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(i,l){var d=this.getSize()._divideBy(2);return this.project(i,l)._subtract(d)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(i,l,d){var p=this._getNewPixelOrigin(d,l);return this.project(i,l)._subtract(p)},_latLngBoundsToNewLayerBounds:function(i,l,d){var p=this._getNewPixelOrigin(d,l);return fe([this.project(i.getSouthWest(),l)._subtract(p),this.project(i.getNorthWest(),l)._subtract(p),this.project(i.getSouthEast(),l)._subtract(p),this.project(i.getNorthEast(),l)._subtract(p)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(i){return this.latLngToLayerPoint(i).subtract(this._getCenterLayerPoint())},_limitCenter:function(i,l,d){if(!d)return i;var p=this.project(i,l),S=this.getSize().divideBy(2),M=new K(p.subtract(S),p.add(S)),F=this._getBoundsOffset(M,d,l);return Math.abs(F.x)<=1&&Math.abs(F.y)<=1?i:this.unproject(p.add(F),l)},_limitOffset:function(i,l){if(!l)return i;var d=this.getPixelBounds(),p=new K(d.min.add(i),d.max.add(i));return i.add(this._getBoundsOffset(p,l))},_getBoundsOffset:function(i,l,d){var p=fe(this.project(l.getNorthEast(),d),this.project(l.getSouthWest(),d)),S=p.min.subtract(i.min),M=p.max.subtract(i.max),F=this._rebound(S.x,-M.x),Y=this._rebound(S.y,-M.y);return new Z(F,Y)},_rebound:function(i,l){return i+l>0?Math.round(i-l)/2:Math.max(0,Math.ceil(i))-Math.max(0,Math.floor(l))},_limitZoom:function(i){var l=this.getMinZoom(),d=this.getMaxZoom(),p=Ne.any3d?this.options.zoomSnap:1;return p&&(i=Math.round(i/p)*p),Math.max(l,Math.min(d,i))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ht(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(i,l){var d=this._getCenterOffset(i)._trunc();return(l&&l.animate)!==!0&&!this.getSize().contains(d)?!1:(this.panBy(d,l),!0)},_createAnimProxy:function(){var i=this._proxy=Ve("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(i),this.on("zoomanim",function(l){var d=su,p=this._proxy.style[d];Ns(this._proxy,this.project(l.center,l.zoom),this.getZoomScale(l.zoom,1)),p===this._proxy.style[d]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){st(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var i=this.getCenter(),l=this.getZoom();Ns(this._proxy,this.project(i,l),this.getZoomScale(l,1))},_catchTransitionEnd:function(i){this._animatingZoom&&i.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(i,l,d){if(this._animatingZoom)return!0;if(d=d||{},!this._zoomAnimated||d.animate===!1||this._nothingToAnimate()||Math.abs(l-this._zoom)>this.options.zoomAnimationThreshold)return!1;var p=this.getZoomScale(l),S=this._getCenterOffset(i)._divideBy(1-1/p);return d.animate!==!0&&!this.getSize().contains(S)?!1:(V(function(){this._moveStart(!0,d.noMoveStart||!1)._animateZoom(i,l,!0)},this),!0)},_animateZoom:function(i,l,d,p){this._mapPane&&(d&&(this._animatingZoom=!0,this._animateToCenter=i,this._animateToZoom=l,Ie(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:i,zoom:l,noUpdate:p}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(c(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ht(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function uS(i,l){return new Ue(i,l)}var zr=Q.extend({options:{position:"topright"},initialize:function(i){y(this,i)},getPosition:function(){return this.options.position},setPosition:function(i){var l=this._map;return l&&l.removeControl(this),this.options.position=i,l&&l.addControl(this),this},getContainer:function(){return this._container},addTo:function(i){this.remove(),this._map=i;var l=this._container=this.onAdd(i),d=this.getPosition(),p=i._controlCorners[d];return Ie(l,"leaflet-control"),d.indexOf("bottom")!==-1?p.insertBefore(l,p.firstChild):p.appendChild(l),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(st(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(i){this._map&&i&&i.screenX>0&&i.screenY>0&&this._map.getContainer().focus()}}),ca=function(i){return new zr(i)};Ue.include({addControl:function(i){return i.addTo(this),this},removeControl:function(i){return i.remove(),this},_initControlPos:function(){var i=this._controlCorners={},l="leaflet-",d=this._controlContainer=Ve("div",l+"control-container",this._container);function p(S,M){var F=l+S+" "+l+M;i[S+M]=Ve("div",F,d)}p("top","left"),p("top","right"),p("bottom","left"),p("bottom","right")},_clearControlPos:function(){for(var i in this._controlCorners)st(this._controlCorners[i]);st(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Cm=zr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(i,l,d,p){return d<p?-1:p<d?1:0}},initialize:function(i,l,d){y(this,d),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var p in i)this._addLayer(i[p],p);for(p in l)this._addLayer(l[p],p,!0)},onAdd:function(i){this._initLayout(),this._update(),this._map=i,i.on("zoomend",this._checkDisabledLayers,this);for(var l=0;l<this._layers.length;l++)this._layers[l].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(i){return zr.prototype.addTo.call(this,i),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var i=0;i<this._layers.length;i++)this._layers[i].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(i,l){return this._addLayer(i,l),this._map?this._update():this},addOverlay:function(i,l){return this._addLayer(i,l,!0),this._map?this._update():this},removeLayer:function(i){i.off("add remove",this._onLayerChange,this);var l=this._getLayer(h(i));return l&&this._layers.splice(this._layers.indexOf(l),1),this._map?this._update():this},expand:function(){Ie(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var i=this._map.getSize().y-(this._container.offsetTop+50);return i<this._section.clientHeight?(Ie(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=i+"px"):ht(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ht(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var i="leaflet-control-layers",l=this._container=Ve("div",i),d=this.options.collapsed;l.setAttribute("aria-haspopup",!0),la(l),gu(l);var p=this._section=Ve("section",i+"-list");d&&(this._map.on("click",this.collapse,this),Me(l,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var S=this._layersLink=Ve("a",i+"-toggle",l);S.href="#",S.title="Layers",S.setAttribute("role","button"),Me(S,{keydown:function(M){M.keyCode===13&&this._expandSafely()},click:function(M){Mt(M),this._expandSafely()}},this),d||this.expand(),this._baseLayersList=Ve("div",i+"-base",p),this._separator=Ve("div",i+"-separator",p),this._overlaysList=Ve("div",i+"-overlays",p),l.appendChild(p)},_getLayer:function(i){for(var l=0;l<this._layers.length;l++)if(this._layers[l]&&h(this._layers[l].layer)===i)return this._layers[l]},_addLayer:function(i,l,d){this._map&&i.on("add remove",this._onLayerChange,this),this._layers.push({layer:i,name:l,overlay:d}),this.options.sortLayers&&this._layers.sort(c(function(p,S){return this.options.sortFunction(p.layer,S.layer,p.name,S.name)},this)),this.options.autoZIndex&&i.setZIndex&&(this._lastZIndex++,i.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Lo(this._baseLayersList),Lo(this._overlaysList),this._layerControlInputs=[];var i,l,d,p,S=0;for(d=0;d<this._layers.length;d++)p=this._layers[d],this._addItem(p),l=l||p.overlay,i=i||!p.overlay,S+=p.overlay?0:1;return this.options.hideSingleBase&&(i=i&&S>1,this._baseLayersList.style.display=i?"":"none"),this._separator.style.display=l&&i?"":"none",this},_onLayerChange:function(i){this._handlingClick||this._update();var l=this._getLayer(h(i.target)),d=l.overlay?i.type==="add"?"overlayadd":"overlayremove":i.type==="add"?"baselayerchange":null;d&&this._map.fire(d,l)},_createRadioElement:function(i,l){var d='<input type="radio" class="leaflet-control-layers-selector" name="'+i+'"'+(l?' checked="checked"':"")+"/>",p=document.createElement("div");return p.innerHTML=d,p.firstChild},_addItem:function(i){var l=document.createElement("label"),d=this._map.hasLayer(i.layer),p;i.overlay?(p=document.createElement("input"),p.type="checkbox",p.className="leaflet-control-layers-selector",p.defaultChecked=d):p=this._createRadioElement("leaflet-base-layers_"+h(this),d),this._layerControlInputs.push(p),p.layerId=h(i.layer),Me(p,"click",this._onInputClick,this);var S=document.createElement("span");S.innerHTML=" "+i.name;var M=document.createElement("span");l.appendChild(M),M.appendChild(p),M.appendChild(S);var F=i.overlay?this._overlaysList:this._baseLayersList;return F.appendChild(l),this._checkDisabledLayers(),l},_onInputClick:function(){if(!this._preventClick){var i=this._layerControlInputs,l,d,p=[],S=[];this._handlingClick=!0;for(var M=i.length-1;M>=0;M--)l=i[M],d=this._getLayer(l.layerId).layer,l.checked?p.push(d):l.checked||S.push(d);for(M=0;M<S.length;M++)this._map.hasLayer(S[M])&&this._map.removeLayer(S[M]);for(M=0;M<p.length;M++)this._map.hasLayer(p[M])||this._map.addLayer(p[M]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var i=this._layerControlInputs,l,d,p=this._map.getZoom(),S=i.length-1;S>=0;S--)l=i[S],d=this._getLayer(l.layerId).layer,l.disabled=d.options.minZoom!==void 0&&p<d.options.minZoom||d.options.maxZoom!==void 0&&p>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var i=this._section;this._preventClick=!0,Me(i,"click",Mt),this.expand();var l=this;setTimeout(function(){Ge(i,"click",Mt),l._preventClick=!1})}}),dS=function(i,l,d){return new Cm(i,l,d)},xu=zr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(i){var l="leaflet-control-zoom",d=Ve("div",l+" leaflet-bar"),p=this.options;return this._zoomInButton=this._createButton(p.zoomInText,p.zoomInTitle,l+"-in",d,this._zoomIn),this._zoomOutButton=this._createButton(p.zoomOutText,p.zoomOutTitle,l+"-out",d,this._zoomOut),this._updateDisabled(),i.on("zoomend zoomlevelschange",this._updateDisabled,this),d},onRemove:function(i){i.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(i){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(i.shiftKey?3:1))},_zoomOut:function(i){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(i.shiftKey?3:1))},_createButton:function(i,l,d,p,S){var M=Ve("a",d,p);return M.innerHTML=i,M.href="#",M.title=l,M.setAttribute("role","button"),M.setAttribute("aria-label",l),la(M),Me(M,"click",Cs),Me(M,"click",S,this),Me(M,"click",this._refocusOnMap,this),M},_updateDisabled:function(){var i=this._map,l="leaflet-disabled";ht(this._zoomInButton,l),ht(this._zoomOutButton,l),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||i._zoom===i.getMinZoom())&&(Ie(this._zoomOutButton,l),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||i._zoom===i.getMaxZoom())&&(Ie(this._zoomInButton,l),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ue.mergeOptions({zoomControl:!0}),Ue.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new xu,this.addControl(this.zoomControl))});var hS=function(i){return new xu(i)},Pm=zr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(i){var l="leaflet-control-scale",d=Ve("div",l),p=this.options;return this._addScales(p,l+"-line",d),i.on(p.updateWhenIdle?"moveend":"move",this._update,this),i.whenReady(this._update,this),d},onRemove:function(i){i.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(i,l,d){i.metric&&(this._mScale=Ve("div",l,d)),i.imperial&&(this._iScale=Ve("div",l,d))},_update:function(){var i=this._map,l=i.getSize().y/2,d=i.distance(i.containerPointToLatLng([0,l]),i.containerPointToLatLng([this.options.maxWidth,l]));this._updateScales(d)},_updateScales:function(i){this.options.metric&&i&&this._updateMetric(i),this.options.imperial&&i&&this._updateImperial(i)},_updateMetric:function(i){var l=this._getRoundNum(i),d=l<1e3?l+" m":l/1e3+" km";this._updateScale(this._mScale,d,l/i)},_updateImperial:function(i){var l=i*3.2808399,d,p,S;l>5280?(d=l/5280,p=this._getRoundNum(d),this._updateScale(this._iScale,p+" mi",p/d)):(S=this._getRoundNum(l),this._updateScale(this._iScale,S+" ft",S/l))},_updateScale:function(i,l,d){i.style.width=Math.round(this.options.maxWidth*d)+"px",i.innerHTML=l},_getRoundNum:function(i){var l=Math.pow(10,(Math.floor(i)+"").length-1),d=i/l;return d=d>=10?10:d>=5?5:d>=3?3:d>=2?2:1,l*d}}),fS=function(i){return new Pm(i)},mS='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',vu=zr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ne.inlineSvg?mS+" ":"")+"Leaflet</a>"},initialize:function(i){y(this,i),this._attributions={}},onAdd:function(i){i.attributionControl=this,this._container=Ve("div","leaflet-control-attribution"),la(this._container);for(var l in i._layers)i._layers[l].getAttribution&&this.addAttribution(i._layers[l].getAttribution());return this._update(),i.on("layeradd",this._addAttribution,this),this._container},onRemove:function(i){i.off("layeradd",this._addAttribution,this)},_addAttribution:function(i){i.layer.getAttribution&&(this.addAttribution(i.layer.getAttribution()),i.layer.once("remove",function(){this.removeAttribution(i.layer.getAttribution())},this))},setPrefix:function(i){return this.options.prefix=i,this._update(),this},addAttribution:function(i){return i?(this._attributions[i]||(this._attributions[i]=0),this._attributions[i]++,this._update(),this):this},removeAttribution:function(i){return i?(this._attributions[i]&&(this._attributions[i]--,this._update()),this):this},_update:function(){if(this._map){var i=[];for(var l in this._attributions)this._attributions[l]&&i.push(l);var d=[];this.options.prefix&&d.push(this.options.prefix),i.length&&d.push(i.join(", ")),this._container.innerHTML=d.join(' <span aria-hidden="true">|</span> ')}}});Ue.mergeOptions({attributionControl:!0}),Ue.addInitHook(function(){this.options.attributionControl&&new vu().addTo(this)});var pS=function(i){return new vu(i)};zr.Layers=Cm,zr.Zoom=xu,zr.Scale=Pm,zr.Attribution=vu,ca.layers=dS,ca.zoom=hS,ca.scale=fS,ca.attribution=pS;var tn=Q.extend({initialize:function(i){this._map=i},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});tn.addTo=function(i,l){return i.addHandler(l,this),this};var gS={Events:de},km=Ne.touch?"touchstart mousedown":"mousedown",qn=re.extend({options:{clickTolerance:3},initialize:function(i,l,d,p){y(this,p),this._element=i,this._dragStartTarget=l||i,this._preventOutline=d},enable:function(){this._enabled||(Me(this._dragStartTarget,km,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(qn._dragging===this&&this.finishDrag(!0),Ge(this._dragStartTarget,km,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(i){if(this._enabled&&(this._moved=!1,!iu(this._element,"leaflet-zoom-anim"))){if(i.touches&&i.touches.length!==1){qn._dragging===this&&this.finishDrag();return}if(!(qn._dragging||i.shiftKey||i.which!==1&&i.button!==1&&!i.touches)&&(qn._dragging=this,this._preventOutline&&du(this._element),lu(),ia(),!this._moving)){this.fire("down");var l=i.touches?i.touches[0]:i,d=wm(this._element);this._startPoint=new Z(l.clientX,l.clientY),this._startPos=js(this._element),this._parentScale=hu(d);var p=i.type==="mousedown";Me(document,p?"mousemove":"touchmove",this._onMove,this),Me(document,p?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(i){if(this._enabled){if(i.touches&&i.touches.length>1){this._moved=!0;return}var l=i.touches&&i.touches.length===1?i.touches[0]:i,d=new Z(l.clientX,l.clientY)._subtract(this._startPoint);!d.x&&!d.y||Math.abs(d.x)+Math.abs(d.y)<this.options.clickTolerance||(d.x/=this._parentScale.x,d.y/=this._parentScale.y,Mt(i),this._moved||(this.fire("dragstart"),this._moved=!0,Ie(document.body,"leaflet-dragging"),this._lastTarget=i.target||i.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ie(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(d),this._moving=!0,this._lastEvent=i,this._updatePosition())}},_updatePosition:function(){var i={originalEvent:this._lastEvent};this.fire("predrag",i),gt(this._element,this._newPos),this.fire("drag",i)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(i){ht(document.body,"leaflet-dragging"),this._lastTarget&&(ht(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ge(document,"mousemove touchmove",this._onMove,this),Ge(document,"mouseup touchend touchcancel",this._onUp,this),cu(),aa();var l=this._moved&&this._moving;this._moving=!1,qn._dragging=!1,l&&this.fire("dragend",{noInertia:i,distance:this._newPos.distanceTo(this._startPos)})}});function Tm(i,l,d){var p,S=[1,4,2,8],M,F,Y,X,le,ye,Ce,Be;for(M=0,ye=i.length;M<ye;M++)i[M]._code=Ps(i[M],l);for(Y=0;Y<4;Y++){for(Ce=S[Y],p=[],M=0,ye=i.length,F=ye-1;M<ye;F=M++)X=i[M],le=i[F],X._code&Ce?le._code&Ce||(Be=Oo(le,X,Ce,l,d),Be._code=Ps(Be,l),p.push(Be)):(le._code&Ce&&(Be=Oo(le,X,Ce,l,d),Be._code=Ps(Be,l),p.push(Be)),p.push(X));i=p}return i}function Em(i,l){var d,p,S,M,F,Y,X,le,ye;if(!i||i.length===0)throw new Error("latlngs not passed");Sr(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var Ce=ae([0,0]),Be=ee(i),Wt=Be.getNorthWest().distanceTo(Be.getSouthWest())*Be.getNorthEast().distanceTo(Be.getNorthWest());Wt<1700&&(Ce=wu(i));var St=i.length,Cr=[];for(d=0;d<St;d++){var nr=ae(i[d]);Cr.push(l.project(ae([nr.lat-Ce.lat,nr.lng-Ce.lng])))}for(Y=X=le=0,d=0,p=St-1;d<St;p=d++)S=Cr[d],M=Cr[p],F=S.y*M.x-M.y*S.x,X+=(S.x+M.x)*F,le+=(S.y+M.y)*F,Y+=F*3;Y===0?ye=Cr[0]:ye=[X/Y,le/Y];var ci=l.unproject(ie(ye));return ae([ci.lat+Ce.lat,ci.lng+Ce.lng])}function wu(i){for(var l=0,d=0,p=0,S=0;S<i.length;S++){var M=ae(i[S]);l+=M.lat,d+=M.lng,p++}return ae([l/p,d/p])}var yS={__proto__:null,clipPolygon:Tm,polygonCenter:Em,centroid:wu};function Lm(i,l){if(!l||!i.length)return i.slice();var d=l*l;return i=wS(i,d),i=vS(i,d),i}function Am(i,l,d){return Math.sqrt(ua(i,l,d,!0))}function xS(i,l,d){return ua(i,l,d)}function vS(i,l){var d=i.length,p=typeof Uint8Array<"u"?Uint8Array:Array,S=new p(d);S[0]=S[d-1]=1,bu(i,S,l,0,d-1);var M,F=[];for(M=0;M<d;M++)S[M]&&F.push(i[M]);return F}function bu(i,l,d,p,S){var M=0,F,Y,X;for(Y=p+1;Y<=S-1;Y++)X=ua(i[Y],i[p],i[S],!0),X>M&&(F=Y,M=X);M>d&&(l[F]=1,bu(i,l,d,p,F),bu(i,l,d,F,S))}function wS(i,l){for(var d=[i[0]],p=1,S=0,M=i.length;p<M;p++)bS(i[p],i[S])>l&&(d.push(i[p]),S=p);return S<M-1&&d.push(i[M-1]),d}var Mm;function Im(i,l,d,p,S){var M=p?Mm:Ps(i,d),F=Ps(l,d),Y,X,le;for(Mm=F;;){if(!(M|F))return[i,l];if(M&F)return!1;Y=M||F,X=Oo(i,l,Y,d,S),le=Ps(X,d),Y===M?(i=X,M=le):(l=X,F=le)}}function Oo(i,l,d,p,S){var M=l.x-i.x,F=l.y-i.y,Y=p.min,X=p.max,le,ye;return d&8?(le=i.x+M*(X.y-i.y)/F,ye=X.y):d&4?(le=i.x+M*(Y.y-i.y)/F,ye=Y.y):d&2?(le=X.x,ye=i.y+F*(X.x-i.x)/M):d&1&&(le=Y.x,ye=i.y+F*(Y.x-i.x)/M),new Z(le,ye,S)}function Ps(i,l){var d=0;return i.x<l.min.x?d|=1:i.x>l.max.x&&(d|=2),i.y<l.min.y?d|=4:i.y>l.max.y&&(d|=8),d}function bS(i,l){var d=l.x-i.x,p=l.y-i.y;return d*d+p*p}function ua(i,l,d,p){var S=l.x,M=l.y,F=d.x-S,Y=d.y-M,X=F*F+Y*Y,le;return X>0&&(le=((i.x-S)*F+(i.y-M)*Y)/X,le>1?(S=d.x,M=d.y):le>0&&(S+=F*le,M+=Y*le)),F=i.x-S,Y=i.y-M,p?F*F+Y*Y:new Z(S,M)}function Sr(i){return!P(i[0])||typeof i[0][0]!="object"&&typeof i[0][0]<"u"}function Dm(i){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Sr(i)}function Om(i,l){var d,p,S,M,F,Y,X,le;if(!i||i.length===0)throw new Error("latlngs not passed");Sr(i)||(console.warn("latlngs are not flat! Only the first ring will be used"),i=i[0]);var ye=ae([0,0]),Ce=ee(i),Be=Ce.getNorthWest().distanceTo(Ce.getSouthWest())*Ce.getNorthEast().distanceTo(Ce.getNorthWest());Be<1700&&(ye=wu(i));var Wt=i.length,St=[];for(d=0;d<Wt;d++){var Cr=ae(i[d]);St.push(l.project(ae([Cr.lat-ye.lat,Cr.lng-ye.lng])))}for(d=0,p=0;d<Wt-1;d++)p+=St[d].distanceTo(St[d+1])/2;if(p===0)le=St[0];else for(d=0,M=0;d<Wt-1;d++)if(F=St[d],Y=St[d+1],S=F.distanceTo(Y),M+=S,M>p){X=(M-p)/S,le=[Y.x-X*(Y.x-F.x),Y.y-X*(Y.y-F.y)];break}var nr=l.unproject(ie(le));return ae([nr.lat+ye.lat,nr.lng+ye.lng])}var _S={__proto__:null,simplify:Lm,pointToSegmentDistance:Am,closestPointOnSegment:xS,clipSegment:Im,_getEdgeIntersection:Oo,_getBitCode:Ps,_sqClosestPointOnSegment:ua,isFlat:Sr,_flat:Dm,polylineCenter:Om},_u={project:function(i){return new Z(i.lng,i.lat)},unproject:function(i){return new ue(i.y,i.x)},bounds:new K([-180,-90],[180,90])},Nu={R:6378137,R_MINOR:6356752314245179e-9,bounds:new K([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(i){var l=Math.PI/180,d=this.R,p=i.lat*l,S=this.R_MINOR/d,M=Math.sqrt(1-S*S),F=M*Math.sin(p),Y=Math.tan(Math.PI/4-p/2)/Math.pow((1-F)/(1+F),M/2);return p=-d*Math.log(Math.max(Y,1e-10)),new Z(i.lng*l*d,p)},unproject:function(i){for(var l=180/Math.PI,d=this.R,p=this.R_MINOR/d,S=Math.sqrt(1-p*p),M=Math.exp(-i.y/d),F=Math.PI/2-2*Math.atan(M),Y=0,X=.1,le;Y<15&&Math.abs(X)>1e-7;Y++)le=S*Math.sin(F),le=Math.pow((1-le)/(1+le),S/2),X=Math.PI/2-2*Math.atan(M*le)-F,F+=X;return new ue(F*l,i.x*l/d)}},NS={__proto__:null,LonLat:_u,Mercator:Nu,SphericalMercator:fr},jS=a({},Re,{code:"EPSG:3395",projection:Nu,transformation:function(){var i=.5/(Math.PI*Nu.R);return mn(i,.5,-i,.5)}()}),Rm=a({},Re,{code:"EPSG:4326",projection:_u,transformation:mn(1/180,1,-1/180,.5)}),SS=a({},pe,{projection:_u,transformation:mn(1,0,-1,0),scale:function(i){return Math.pow(2,i)},zoom:function(i){return Math.log(i)/Math.LN2},distance:function(i,l){var d=l.lng-i.lng,p=l.lat-i.lat;return Math.sqrt(d*d+p*p)},infinite:!0});pe.Earth=Re,pe.EPSG3395=jS,pe.EPSG3857=Br,pe.EPSG900913=Fn,pe.EPSG4326=Rm,pe.Simple=SS;var Fr=re.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(i){return i.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(i){return i&&i.removeLayer(this),this},getPane:function(i){return this._map.getPane(i?this.options[i]||i:this.options.pane)},addInteractiveTarget:function(i){return this._map._targets[h(i)]=this,this},removeInteractiveTarget:function(i){return delete this._map._targets[h(i)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(i){var l=i.target;if(l.hasLayer(this)){if(this._map=l,this._zoomAnimated=l._zoomAnimated,this.getEvents){var d=this.getEvents();l.on(d,this),this.once("remove",function(){l.off(d,this)},this)}this.onAdd(l),this.fire("add"),l.fire("layeradd",{layer:this})}}});Ue.include({addLayer:function(i){if(!i._layerAdd)throw new Error("The provided object is not a Layer.");var l=h(i);return this._layers[l]?this:(this._layers[l]=i,i._mapToAdd=this,i.beforeAdd&&i.beforeAdd(this),this.whenReady(i._layerAdd,i),this)},removeLayer:function(i){var l=h(i);return this._layers[l]?(this._loaded&&i.onRemove(this),delete this._layers[l],this._loaded&&(this.fire("layerremove",{layer:i}),i.fire("remove")),i._map=i._mapToAdd=null,this):this},hasLayer:function(i){return h(i)in this._layers},eachLayer:function(i,l){for(var d in this._layers)i.call(l,this._layers[d]);return this},_addLayers:function(i){i=i?P(i)?i:[i]:[];for(var l=0,d=i.length;l<d;l++)this.addLayer(i[l])},_addZoomLimit:function(i){(!isNaN(i.options.maxZoom)||!isNaN(i.options.minZoom))&&(this._zoomBoundLayers[h(i)]=i,this._updateZoomLevels())},_removeZoomLimit:function(i){var l=h(i);this._zoomBoundLayers[l]&&(delete this._zoomBoundLayers[l],this._updateZoomLevels())},_updateZoomLevels:function(){var i=1/0,l=-1/0,d=this._getZoomSpan();for(var p in this._zoomBoundLayers){var S=this._zoomBoundLayers[p].options;i=S.minZoom===void 0?i:Math.min(i,S.minZoom),l=S.maxZoom===void 0?l:Math.max(l,S.maxZoom)}this._layersMaxZoom=l===-1/0?void 0:l,this._layersMinZoom=i===1/0?void 0:i,d!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var si=Fr.extend({initialize:function(i,l){y(this,l),this._layers={};var d,p;if(i)for(d=0,p=i.length;d<p;d++)this.addLayer(i[d])},addLayer:function(i){var l=this.getLayerId(i);return this._layers[l]=i,this._map&&this._map.addLayer(i),this},removeLayer:function(i){var l=i in this._layers?i:this.getLayerId(i);return this._map&&this._layers[l]&&this._map.removeLayer(this._layers[l]),delete this._layers[l],this},hasLayer:function(i){var l=typeof i=="number"?i:this.getLayerId(i);return l in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(i){var l=Array.prototype.slice.call(arguments,1),d,p;for(d in this._layers)p=this._layers[d],p[i]&&p[i].apply(p,l);return this},onAdd:function(i){this.eachLayer(i.addLayer,i)},onRemove:function(i){this.eachLayer(i.removeLayer,i)},eachLayer:function(i,l){for(var d in this._layers)i.call(l,this._layers[d]);return this},getLayer:function(i){return this._layers[i]},getLayers:function(){var i=[];return this.eachLayer(i.push,i),i},setZIndex:function(i){return this.invoke("setZIndex",i)},getLayerId:function(i){return h(i)}}),CS=function(i,l){return new si(i,l)},gn=si.extend({addLayer:function(i){return this.hasLayer(i)?this:(i.addEventParent(this),si.prototype.addLayer.call(this,i),this.fire("layeradd",{layer:i}))},removeLayer:function(i){return this.hasLayer(i)?(i in this._layers&&(i=this._layers[i]),i.removeEventParent(this),si.prototype.removeLayer.call(this,i),this.fire("layerremove",{layer:i})):this},setStyle:function(i){return this.invoke("setStyle",i)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var i=new Ae;for(var l in this._layers){var d=this._layers[l];i.extend(d.getBounds?d.getBounds():d.getLatLng())}return i}}),PS=function(i,l){return new gn(i,l)},ii=Q.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(i){y(this,i)},createIcon:function(i){return this._createIcon("icon",i)},createShadow:function(i){return this._createIcon("shadow",i)},_createIcon:function(i,l){var d=this._getIconUrl(i);if(!d){if(i==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var p=this._createImg(d,l&&l.tagName==="IMG"?l:null);return this._setIconStyles(p,i),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),p},_setIconStyles:function(i,l){var d=this.options,p=d[l+"Size"];typeof p=="number"&&(p=[p,p]);var S=ie(p),M=ie(l==="shadow"&&d.shadowAnchor||d.iconAnchor||S&&S.divideBy(2,!0));i.className="leaflet-marker-"+l+" "+(d.className||""),M&&(i.style.marginLeft=-M.x+"px",i.style.marginTop=-M.y+"px"),S&&(i.style.width=S.x+"px",i.style.height=S.y+"px")},_createImg:function(i,l){return l=l||document.createElement("img"),l.src=i,l},_getIconUrl:function(i){return Ne.retina&&this.options[i+"RetinaUrl"]||this.options[i+"Url"]}});function kS(i){return new ii(i)}var da=ii.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(i){return typeof da.imagePath!="string"&&(da.imagePath=this._detectIconPath()),(this.options.imagePath||da.imagePath)+ii.prototype._getIconUrl.call(this,i)},_stripUrl:function(i){var l=function(d,p,S){var M=p.exec(d);return M&&M[S]};return i=l(i,/^url\((['"])?(.+)\1\)$/,2),i&&l(i,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var i=Ve("div","leaflet-default-icon-path",document.body),l=sa(i,"background-image")||sa(i,"backgroundImage");if(document.body.removeChild(i),l=this._stripUrl(l),l)return l;var d=document.querySelector('link[href$="leaflet.css"]');return d?d.href.substring(0,d.href.length-11-1):""}}),Bm=tn.extend({initialize:function(i){this._marker=i},addHooks:function(){var i=this._marker._icon;this._draggable||(this._draggable=new qn(i,i,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ie(i,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ht(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(i){var l=this._marker,d=l._map,p=this._marker.options.autoPanSpeed,S=this._marker.options.autoPanPadding,M=js(l._icon),F=d.getPixelBounds(),Y=d.getPixelOrigin(),X=fe(F.min._subtract(Y).add(S),F.max._subtract(Y).subtract(S));if(!X.contains(M)){var le=ie((Math.max(X.max.x,M.x)-X.max.x)/(F.max.x-X.max.x)-(Math.min(X.min.x,M.x)-X.min.x)/(F.min.x-X.min.x),(Math.max(X.max.y,M.y)-X.max.y)/(F.max.y-X.max.y)-(Math.min(X.min.y,M.y)-X.min.y)/(F.min.y-X.min.y)).multiplyBy(p);d.panBy(le,{animate:!1}),this._draggable._newPos._add(le),this._draggable._startPos._add(le),gt(l._icon,this._draggable._newPos),this._onDrag(i),this._panRequest=V(this._adjustPan.bind(this,i))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(i){this._marker.options.autoPan&&(z(this._panRequest),this._panRequest=V(this._adjustPan.bind(this,i)))},_onDrag:function(i){var l=this._marker,d=l._shadow,p=js(l._icon),S=l._map.layerPointToLatLng(p);d&&gt(d,p),l._latlng=S,i.latlng=S,i.oldLatLng=this._oldLatLng,l.fire("move",i).fire("drag",i)},_onDragEnd:function(i){z(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",i)}}),Ro=Fr.extend({options:{icon:new da,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(i,l){y(this,l),this._latlng=ae(i)},onAdd:function(i){this._zoomAnimated=this._zoomAnimated&&i.options.markerZoomAnimation,this._zoomAnimated&&i.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(i){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&i.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(i){var l=this._latlng;return this._latlng=ae(i),this.update(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},setZIndexOffset:function(i){return this.options.zIndexOffset=i,this.update()},getIcon:function(){return this.options.icon},setIcon:function(i){return this.options.icon=i,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var i=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(i)}return this},_initIcon:function(){var i=this.options,l="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),d=i.icon.createIcon(this._icon),p=!1;d!==this._icon&&(this._icon&&this._removeIcon(),p=!0,i.title&&(d.title=i.title),d.tagName==="IMG"&&(d.alt=i.alt||"")),Ie(d,l),i.keyboard&&(d.tabIndex="0",d.setAttribute("role","button")),this._icon=d,i.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Me(d,"focus",this._panOnFocus,this);var S=i.icon.createShadow(this._shadow),M=!1;S!==this._shadow&&(this._removeShadow(),M=!0),S&&(Ie(S,l),S.alt=""),this._shadow=S,i.opacity<1&&this._updateOpacity(),p&&this.getPane().appendChild(this._icon),this._initInteraction(),S&&M&&this.getPane(i.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ge(this._icon,"focus",this._panOnFocus,this),st(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&st(this._shadow),this._shadow=null},_setPos:function(i){this._icon&&gt(this._icon,i),this._shadow&&gt(this._shadow,i),this._zIndex=i.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(i){this._icon&&(this._icon.style.zIndex=this._zIndex+i)},_animateZoom:function(i){var l=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center).round();this._setPos(l)},_initInteraction:function(){if(this.options.interactive&&(Ie(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Bm)){var i=this.options.draggable;this.dragging&&(i=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Bm(this),i&&this.dragging.enable()}},setOpacity:function(i){return this.options.opacity=i,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var i=this.options.opacity;this._icon&&jr(this._icon,i),this._shadow&&jr(this._shadow,i)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var i=this._map;if(i){var l=this.options.icon.options,d=l.iconSize?ie(l.iconSize):ie(0,0),p=l.iconAnchor?ie(l.iconAnchor):ie(0,0);i.panInside(this._latlng,{paddingTopLeft:p,paddingBottomRight:d.subtract(p)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function TS(i,l){return new Ro(i,l)}var Hn=Fr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(i){this._renderer=i.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(i){return y(this,i),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&i&&Object.prototype.hasOwnProperty.call(i,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Bo=Hn.extend({options:{fill:!0,radius:10},initialize:function(i,l){y(this,l),this._latlng=ae(i),this._radius=this.options.radius},setLatLng:function(i){var l=this._latlng;return this._latlng=ae(i),this.redraw(),this.fire("move",{oldLatLng:l,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(i){return this.options.radius=this._radius=i,this.redraw()},getRadius:function(){return this._radius},setStyle:function(i){var l=i&&i.radius||this._radius;return Hn.prototype.setStyle.call(this,i),this.setRadius(l),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var i=this._radius,l=this._radiusY||i,d=this._clickTolerance(),p=[i+d,l+d];this._pxBounds=new K(this._point.subtract(p),this._point.add(p))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(i){return i.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function ES(i,l){return new Bo(i,l)}var ju=Bo.extend({initialize:function(i,l,d){if(typeof l=="number"&&(l=a({},d,{radius:l})),y(this,l),this._latlng=ae(i),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(i){return this._mRadius=i,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var i=[this._radius,this._radiusY||this._radius];return new Ae(this._map.layerPointToLatLng(this._point.subtract(i)),this._map.layerPointToLatLng(this._point.add(i)))},setStyle:Hn.prototype.setStyle,_project:function(){var i=this._latlng.lng,l=this._latlng.lat,d=this._map,p=d.options.crs;if(p.distance===Re.distance){var S=Math.PI/180,M=this._mRadius/Re.R/S,F=d.project([l+M,i]),Y=d.project([l-M,i]),X=F.add(Y).divideBy(2),le=d.unproject(X).lat,ye=Math.acos((Math.cos(M*S)-Math.sin(l*S)*Math.sin(le*S))/(Math.cos(l*S)*Math.cos(le*S)))/S;(isNaN(ye)||ye===0)&&(ye=M/Math.cos(Math.PI/180*l)),this._point=X.subtract(d.getPixelOrigin()),this._radius=isNaN(ye)?0:X.x-d.project([le,i-ye]).x,this._radiusY=X.y-F.y}else{var Ce=p.unproject(p.project(this._latlng).subtract([this._mRadius,0]));this._point=d.latLngToLayerPoint(this._latlng),this._radius=this._point.x-d.latLngToLayerPoint(Ce).x}this._updateBounds()}});function LS(i,l,d){return new ju(i,l,d)}var yn=Hn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(i,l){y(this,l),this._setLatLngs(i)},getLatLngs:function(){return this._latlngs},setLatLngs:function(i){return this._setLatLngs(i),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(i){for(var l=1/0,d=null,p=ua,S,M,F=0,Y=this._parts.length;F<Y;F++)for(var X=this._parts[F],le=1,ye=X.length;le<ye;le++){S=X[le-1],M=X[le];var Ce=p(i,S,M,!0);Ce<l&&(l=Ce,d=p(i,S,M))}return d&&(d.distance=Math.sqrt(l)),d},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Om(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(i,l){return l=l||this._defaultShape(),i=ae(i),l.push(i),this._bounds.extend(i),this.redraw()},_setLatLngs:function(i){this._bounds=new Ae,this._latlngs=this._convertLatLngs(i)},_defaultShape:function(){return Sr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(i){for(var l=[],d=Sr(i),p=0,S=i.length;p<S;p++)d?(l[p]=ae(i[p]),this._bounds.extend(l[p])):l[p]=this._convertLatLngs(i[p]);return l},_project:function(){var i=new K;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,i),this._bounds.isValid()&&i.isValid()&&(this._rawPxBounds=i,this._updateBounds())},_updateBounds:function(){var i=this._clickTolerance(),l=new Z(i,i);this._rawPxBounds&&(this._pxBounds=new K([this._rawPxBounds.min.subtract(l),this._rawPxBounds.max.add(l)]))},_projectLatlngs:function(i,l,d){var p=i[0]instanceof ue,S=i.length,M,F;if(p){for(F=[],M=0;M<S;M++)F[M]=this._map.latLngToLayerPoint(i[M]),d.extend(F[M]);l.push(F)}else for(M=0;M<S;M++)this._projectLatlngs(i[M],l,d)},_clipPoints:function(){var i=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}var l=this._parts,d,p,S,M,F,Y,X;for(d=0,S=0,M=this._rings.length;d<M;d++)for(X=this._rings[d],p=0,F=X.length;p<F-1;p++)Y=Im(X[p],X[p+1],i,p,!0),Y&&(l[S]=l[S]||[],l[S].push(Y[0]),(Y[1]!==X[p+1]||p===F-2)&&(l[S].push(Y[1]),S++))}},_simplifyPoints:function(){for(var i=this._parts,l=this.options.smoothFactor,d=0,p=i.length;d<p;d++)i[d]=Lm(i[d],l)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(i,l){var d,p,S,M,F,Y,X=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(d=0,M=this._parts.length;d<M;d++)for(Y=this._parts[d],p=0,F=Y.length,S=F-1;p<F;S=p++)if(!(!l&&p===0)&&Am(i,Y[S],Y[p])<=X)return!0;return!1}});function AS(i,l){return new yn(i,l)}yn._flat=Dm;var ai=yn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Em(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(i){var l=yn.prototype._convertLatLngs.call(this,i),d=l.length;return d>=2&&l[0]instanceof ue&&l[0].equals(l[d-1])&&l.pop(),l},_setLatLngs:function(i){yn.prototype._setLatLngs.call(this,i),Sr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Sr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var i=this._renderer._bounds,l=this.options.weight,d=new Z(l,l);if(i=new K(i.min.subtract(d),i.max.add(d)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(i))){if(this.options.noClip){this._parts=this._rings;return}for(var p=0,S=this._rings.length,M;p<S;p++)M=Tm(this._rings[p],i,!0),M.length&&this._parts.push(M)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(i){var l=!1,d,p,S,M,F,Y,X,le;if(!this._pxBounds||!this._pxBounds.contains(i))return!1;for(M=0,X=this._parts.length;M<X;M++)for(d=this._parts[M],F=0,le=d.length,Y=le-1;F<le;Y=F++)p=d[F],S=d[Y],p.y>i.y!=S.y>i.y&&i.x<(S.x-p.x)*(i.y-p.y)/(S.y-p.y)+p.x&&(l=!l);return l||yn.prototype._containsPoint.call(this,i,!0)}});function MS(i,l){return new ai(i,l)}var xn=gn.extend({initialize:function(i,l){y(this,l),this._layers={},i&&this.addData(i)},addData:function(i){var l=P(i)?i:i.features,d,p,S;if(l){for(d=0,p=l.length;d<p;d++)S=l[d],(S.geometries||S.geometry||S.features||S.coordinates)&&this.addData(S);return this}var M=this.options;if(M.filter&&!M.filter(i))return this;var F=$o(i,M);return F?(F.feature=Uo(i),F.defaultOptions=F.options,this.resetStyle(F),M.onEachFeature&&M.onEachFeature(i,F),this.addLayer(F)):this},resetStyle:function(i){return i===void 0?this.eachLayer(this.resetStyle,this):(i.options=a({},i.defaultOptions),this._setLayerStyle(i,this.options.style),this)},setStyle:function(i){return this.eachLayer(function(l){this._setLayerStyle(l,i)},this)},_setLayerStyle:function(i,l){i.setStyle&&(typeof l=="function"&&(l=l(i.feature)),i.setStyle(l))}});function $o(i,l){var d=i.type==="Feature"?i.geometry:i,p=d?d.coordinates:null,S=[],M=l&&l.pointToLayer,F=l&&l.coordsToLatLng||Su,Y,X,le,ye;if(!p&&!d)return null;switch(d.type){case"Point":return Y=F(p),$m(M,i,Y,l);case"MultiPoint":for(le=0,ye=p.length;le<ye;le++)Y=F(p[le]),S.push($m(M,i,Y,l));return new gn(S);case"LineString":case"MultiLineString":return X=zo(p,d.type==="LineString"?0:1,F),new yn(X,l);case"Polygon":case"MultiPolygon":return X=zo(p,d.type==="Polygon"?1:2,F),new ai(X,l);case"GeometryCollection":for(le=0,ye=d.geometries.length;le<ye;le++){var Ce=$o({geometry:d.geometries[le],type:"Feature",properties:i.properties},l);Ce&&S.push(Ce)}return new gn(S);case"FeatureCollection":for(le=0,ye=d.features.length;le<ye;le++){var Be=$o(d.features[le],l);Be&&S.push(Be)}return new gn(S);default:throw new Error("Invalid GeoJSON object.")}}function $m(i,l,d,p){return i?i(l,d):new Ro(d,p&&p.markersInheritOptions&&p)}function Su(i){return new ue(i[1],i[0],i[2])}function zo(i,l,d){for(var p=[],S=0,M=i.length,F;S<M;S++)F=l?zo(i[S],l-1,d):(d||Su)(i[S]),p.push(F);return p}function Cu(i,l){return i=ae(i),i.alt!==void 0?[w(i.lng,l),w(i.lat,l),w(i.alt,l)]:[w(i.lng,l),w(i.lat,l)]}function Fo(i,l,d,p){for(var S=[],M=0,F=i.length;M<F;M++)S.push(l?Fo(i[M],Sr(i[M])?0:l-1,d,p):Cu(i[M],p));return!l&&d&&S.length>0&&S.push(S[0].slice()),S}function oi(i,l){return i.feature?a({},i.feature,{geometry:l}):Uo(l)}function Uo(i){return i.type==="Feature"||i.type==="FeatureCollection"?i:{type:"Feature",properties:{},geometry:i}}var Pu={toGeoJSON:function(i){return oi(this,{type:"Point",coordinates:Cu(this.getLatLng(),i)})}};Ro.include(Pu),ju.include(Pu),Bo.include(Pu),yn.include({toGeoJSON:function(i){var l=!Sr(this._latlngs),d=Fo(this._latlngs,l?1:0,!1,i);return oi(this,{type:(l?"Multi":"")+"LineString",coordinates:d})}}),ai.include({toGeoJSON:function(i){var l=!Sr(this._latlngs),d=l&&!Sr(this._latlngs[0]),p=Fo(this._latlngs,d?2:l?1:0,!0,i);return l||(p=[p]),oi(this,{type:(d?"Multi":"")+"Polygon",coordinates:p})}}),si.include({toMultiPoint:function(i){var l=[];return this.eachLayer(function(d){l.push(d.toGeoJSON(i).geometry.coordinates)}),oi(this,{type:"MultiPoint",coordinates:l})},toGeoJSON:function(i){var l=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(l==="MultiPoint")return this.toMultiPoint(i);var d=l==="GeometryCollection",p=[];return this.eachLayer(function(S){if(S.toGeoJSON){var M=S.toGeoJSON(i);if(d)p.push(M.geometry);else{var F=Uo(M);F.type==="FeatureCollection"?p.push.apply(p,F.features):p.push(F)}}}),d?oi(this,{geometries:p,type:"GeometryCollection"}):{type:"FeatureCollection",features:p}}});function zm(i,l){return new xn(i,l)}var IS=zm,qo=Fr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(i,l,d){this._url=i,this._bounds=ee(l),y(this,d)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ie(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){st(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(i){return this.options.opacity=i,this._image&&this._updateOpacity(),this},setStyle:function(i){return i.opacity&&this.setOpacity(i.opacity),this},bringToFront:function(){return this._map&&ri(this._image),this},bringToBack:function(){return this._map&&ni(this._image),this},setUrl:function(i){return this._url=i,this._image&&(this._image.src=i),this},setBounds:function(i){return this._bounds=ee(i),this._map&&this._reset(),this},getEvents:function(){var i={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var i=this._url.tagName==="IMG",l=this._image=i?this._url:Ve("img");if(Ie(l,"leaflet-image-layer"),this._zoomAnimated&&Ie(l,"leaflet-zoom-animated"),this.options.className&&Ie(l,this.options.className),l.onselectstart=v,l.onmousemove=v,l.onload=c(this.fire,this,"load"),l.onerror=c(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),i){this._url=l.src;return}l.src=this._url,l.alt=this.options.alt},_animateZoom:function(i){var l=this._map.getZoomScale(i.zoom),d=this._map._latLngBoundsToNewLayerBounds(this._bounds,i.zoom,i.center).min;Ns(this._image,d,l)},_reset:function(){var i=this._image,l=new K(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),d=l.getSize();gt(i,l.min),i.style.width=d.x+"px",i.style.height=d.y+"px"},_updateOpacity:function(){jr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var i=this.options.errorOverlayUrl;i&&this._url!==i&&(this._url=i,this._image.src=i)},getCenter:function(){return this._bounds.getCenter()}}),DS=function(i,l,d){return new qo(i,l,d)},Fm=qo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var i=this._url.tagName==="VIDEO",l=this._image=i?this._url:Ve("video");if(Ie(l,"leaflet-image-layer"),this._zoomAnimated&&Ie(l,"leaflet-zoom-animated"),this.options.className&&Ie(l,this.options.className),l.onselectstart=v,l.onmousemove=v,l.onloadeddata=c(this.fire,this,"load"),i){for(var d=l.getElementsByTagName("source"),p=[],S=0;S<d.length;S++)p.push(d[S].src);this._url=d.length>0?p:[l.src];return}P(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(l.style,"objectFit")&&(l.style.objectFit="fill"),l.autoplay=!!this.options.autoplay,l.loop=!!this.options.loop,l.muted=!!this.options.muted,l.playsInline=!!this.options.playsInline;for(var M=0;M<this._url.length;M++){var F=Ve("source");F.src=this._url[M],l.appendChild(F)}}});function OS(i,l,d){return new Fm(i,l,d)}var Um=qo.extend({_initImage:function(){var i=this._image=this._url;Ie(i,"leaflet-image-layer"),this._zoomAnimated&&Ie(i,"leaflet-zoom-animated"),this.options.className&&Ie(i,this.options.className),i.onselectstart=v,i.onmousemove=v}});function RS(i,l,d){return new Um(i,l,d)}var rn=Fr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(i,l){i&&(i instanceof ue||P(i))?(this._latlng=ae(i),y(this,l)):(y(this,i),this._source=l),this.options.content&&(this._content=this.options.content)},openOn:function(i){return i=arguments.length?i:this._source._map,i.hasLayer(this)||i.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(i){return this._map?this.close():(arguments.length?this._source=i:i=this._source,this._prepareOpen(),this.openOn(i._map)),this},onAdd:function(i){this._zoomAnimated=i._zoomAnimated,this._container||this._initLayout(),i._fadeAnimated&&jr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),i._fadeAnimated&&jr(this._container,1),this.bringToFront(),this.options.interactive&&(Ie(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(i){i._fadeAnimated?(jr(this._container,0),this._removeTimeout=setTimeout(c(st,void 0,this._container),200)):st(this._container),this.options.interactive&&(ht(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(i){return this._latlng=ae(i),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(i){return this._content=i,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var i={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ri(this._container),this},bringToBack:function(){return this._map&&ni(this._container),this},_prepareOpen:function(i){var l=this._source;if(!l._map)return!1;if(l instanceof gn){l=null;var d=this._source._layers;for(var p in d)if(d[p]._map){l=d[p];break}if(!l)return!1;this._source=l}if(!i)if(l.getCenter)i=l.getCenter();else if(l.getLatLng)i=l.getLatLng();else if(l.getBounds)i=l.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(i),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var i=this._contentNode,l=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof l=="string")i.innerHTML=l;else{for(;i.hasChildNodes();)i.removeChild(i.firstChild);i.appendChild(l)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var i=this._map.latLngToLayerPoint(this._latlng),l=ie(this.options.offset),d=this._getAnchor();this._zoomAnimated?gt(this._container,i.add(d)):l=l.add(i).add(d);var p=this._containerBottom=-l.y,S=this._containerLeft=-Math.round(this._containerWidth/2)+l.x;this._container.style.bottom=p+"px",this._container.style.left=S+"px"}},_getAnchor:function(){return[0,0]}});Ue.include({_initOverlay:function(i,l,d,p){var S=l;return S instanceof i||(S=new i(p).setContent(l)),d&&S.setLatLng(d),S}}),Fr.include({_initOverlay:function(i,l,d,p){var S=d;return S instanceof i?(y(S,p),S._source=this):(S=l&&!p?l:new i(p,this),S.setContent(d)),S}});var Ho=rn.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(i){return i=arguments.length?i:this._source._map,!i.hasLayer(this)&&i._popup&&i._popup.options.autoClose&&i.removeLayer(i._popup),i._popup=this,rn.prototype.openOn.call(this,i)},onAdd:function(i){rn.prototype.onAdd.call(this,i),i.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Hn||this._source.on("preclick",Ss))},onRemove:function(i){rn.prototype.onRemove.call(this,i),i.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Hn||this._source.off("preclick",Ss))},getEvents:function(){var i=rn.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(i.preclick=this.close),this.options.keepInView&&(i.moveend=this._adjustPan),i},_initLayout:function(){var i="leaflet-popup",l=this._container=Ve("div",i+" "+(this.options.className||"")+" leaflet-zoom-animated"),d=this._wrapper=Ve("div",i+"-content-wrapper",l);if(this._contentNode=Ve("div",i+"-content",d),la(l),gu(this._contentNode),Me(l,"contextmenu",Ss),this._tipContainer=Ve("div",i+"-tip-container",l),this._tip=Ve("div",i+"-tip",this._tipContainer),this.options.closeButton){var p=this._closeButton=Ve("a",i+"-close-button",l);p.setAttribute("role","button"),p.setAttribute("aria-label","Close popup"),p.href="#close",p.innerHTML='<span aria-hidden="true">&#215;</span>',Me(p,"click",function(S){Mt(S),this.close()},this)}},_updateLayout:function(){var i=this._contentNode,l=i.style;l.width="",l.whiteSpace="nowrap";var d=i.offsetWidth;d=Math.min(d,this.options.maxWidth),d=Math.max(d,this.options.minWidth),l.width=d+1+"px",l.whiteSpace="",l.height="";var p=i.offsetHeight,S=this.options.maxHeight,M="leaflet-popup-scrolled";S&&p>S?(l.height=S+"px",Ie(i,M)):ht(i,M),this._containerWidth=this._container.offsetWidth},_animateZoom:function(i){var l=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center),d=this._getAnchor();gt(this._container,l.add(d))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var i=this._map,l=parseInt(sa(this._container,"marginBottom"),10)||0,d=this._container.offsetHeight+l,p=this._containerWidth,S=new Z(this._containerLeft,-d-this._containerBottom);S._add(js(this._container));var M=i.layerPointToContainerPoint(S),F=ie(this.options.autoPanPadding),Y=ie(this.options.autoPanPaddingTopLeft||F),X=ie(this.options.autoPanPaddingBottomRight||F),le=i.getSize(),ye=0,Ce=0;M.x+p+X.x>le.x&&(ye=M.x+p-le.x+X.x),M.x-ye-Y.x<0&&(ye=M.x-Y.x),M.y+d+X.y>le.y&&(Ce=M.y+d-le.y+X.y),M.y-Ce-Y.y<0&&(Ce=M.y-Y.y),(ye||Ce)&&(this.options.keepInView&&(this._autopanning=!0),i.fire("autopanstart").panBy([ye,Ce]))}},_getAnchor:function(){return ie(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),BS=function(i,l){return new Ho(i,l)};Ue.mergeOptions({closePopupOnClick:!0}),Ue.include({openPopup:function(i,l,d){return this._initOverlay(Ho,i,l,d).openOn(this),this},closePopup:function(i){return i=arguments.length?i:this._popup,i&&i.close(),this}}),Fr.include({bindPopup:function(i,l){return this._popup=this._initOverlay(Ho,this._popup,i,l),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(i){return this._popup&&(this instanceof gn||(this._popup._source=this),this._popup._prepareOpen(i||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(i){return this._popup&&this._popup.setContent(i),this},getPopup:function(){return this._popup},_openPopup:function(i){if(!(!this._popup||!this._map)){Cs(i);var l=i.layer||i.target;if(this._popup._source===l&&!(l instanceof Hn)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(i.latlng);return}this._popup._source=l,this.openPopup(i.latlng)}},_movePopup:function(i){this._popup.setLatLng(i.latlng)},_onKeyPress:function(i){i.originalEvent.keyCode===13&&this._openPopup(i)}});var Vo=rn.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(i){rn.prototype.onAdd.call(this,i),this.setOpacity(this.options.opacity),i.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(i){rn.prototype.onRemove.call(this,i),i.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var i=rn.prototype.getEvents.call(this);return this.options.permanent||(i.preclick=this.close),i},_initLayout:function(){var i="leaflet-tooltip",l=i+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ve("div",l),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+h(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(i){var l,d,p=this._map,S=this._container,M=p.latLngToContainerPoint(p.getCenter()),F=p.layerPointToContainerPoint(i),Y=this.options.direction,X=S.offsetWidth,le=S.offsetHeight,ye=ie(this.options.offset),Ce=this._getAnchor();Y==="top"?(l=X/2,d=le):Y==="bottom"?(l=X/2,d=0):Y==="center"?(l=X/2,d=le/2):Y==="right"?(l=0,d=le/2):Y==="left"?(l=X,d=le/2):F.x<M.x?(Y="right",l=0,d=le/2):(Y="left",l=X+(ye.x+Ce.x)*2,d=le/2),i=i.subtract(ie(l,d,!0)).add(ye).add(Ce),ht(S,"leaflet-tooltip-right"),ht(S,"leaflet-tooltip-left"),ht(S,"leaflet-tooltip-top"),ht(S,"leaflet-tooltip-bottom"),Ie(S,"leaflet-tooltip-"+Y),gt(S,i)},_updatePosition:function(){var i=this._map.latLngToLayerPoint(this._latlng);this._setPosition(i)},setOpacity:function(i){this.options.opacity=i,this._container&&jr(this._container,i)},_animateZoom:function(i){var l=this._map._latLngToNewLayerPoint(this._latlng,i.zoom,i.center);this._setPosition(l)},_getAnchor:function(){return ie(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),$S=function(i,l){return new Vo(i,l)};Ue.include({openTooltip:function(i,l,d){return this._initOverlay(Vo,i,l,d).openOn(this),this},closeTooltip:function(i){return i.close(),this}}),Fr.include({bindTooltip:function(i,l){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Vo,this._tooltip,i,l),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(i){if(!(!i&&this._tooltipHandlersAdded)){var l=i?"off":"on",d={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?d.add=this._openTooltip:(d.mouseover=this._openTooltip,d.mouseout=this.closeTooltip,d.click=this._openTooltip,this._map?this._addFocusListeners():d.add=this._addFocusListeners),this._tooltip.options.sticky&&(d.mousemove=this._moveTooltip),this[l](d),this._tooltipHandlersAdded=!i}},openTooltip:function(i){return this._tooltip&&(this instanceof gn||(this._tooltip._source=this),this._tooltip._prepareOpen(i)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(i){return this._tooltip&&this._tooltip.setContent(i),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(i){var l=typeof i.getElement=="function"&&i.getElement();l&&(Me(l,"focus",function(){this._tooltip._source=i,this.openTooltip()},this),Me(l,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(i){var l=typeof i.getElement=="function"&&i.getElement();l&&l.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(i){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var l=this;this._map.once("moveend",function(){l._openOnceFlag=!1,l._openTooltip(i)});return}this._tooltip._source=i.layer||i.target,this.openTooltip(this._tooltip.options.sticky?i.latlng:void 0)}},_moveTooltip:function(i){var l=i.latlng,d,p;this._tooltip.options.sticky&&i.originalEvent&&(d=this._map.mouseEventToContainerPoint(i.originalEvent),p=this._map.containerPointToLayerPoint(d),l=this._map.layerPointToLatLng(p)),this._tooltip.setLatLng(l)}});var qm=ii.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(i){var l=i&&i.tagName==="DIV"?i:document.createElement("div"),d=this.options;if(d.html instanceof Element?(Lo(l),l.appendChild(d.html)):l.innerHTML=d.html!==!1?d.html:"",d.bgPos){var p=ie(d.bgPos);l.style.backgroundPosition=-p.x+"px "+-p.y+"px"}return this._setIconStyles(l,"icon"),l},createShadow:function(){return null}});function zS(i){return new qm(i)}ii.Default=da;var ha=Fr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ne.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(i){y(this,i)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(i){i._addZoomLimit(this)},onRemove:function(i){this._removeAllTiles(),st(this._container),i._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ri(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(ni(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(i){return this.options.opacity=i,this._updateOpacity(),this},setZIndex:function(i){return this.options.zIndex=i,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var i=this._clampZoom(this._map.getZoom());i!==this._tileZoom&&(this._tileZoom=i,this._updateLevels()),this._update()}return this},getEvents:function(){var i={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),i.move=this._onMove),this._zoomAnimated&&(i.zoomanim=this._animateZoom),i},createTile:function(){return document.createElement("div")},getTileSize:function(){var i=this.options.tileSize;return i instanceof Z?i:new Z(i,i)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(i){for(var l=this.getPane().children,d=-i(-1/0,1/0),p=0,S=l.length,M;p<S;p++)M=l[p].style.zIndex,l[p]!==this._container&&M&&(d=i(d,+M));isFinite(d)&&(this.options.zIndex=d+i(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ne.ielt9){jr(this._container,this.options.opacity);var i=+new Date,l=!1,d=!1;for(var p in this._tiles){var S=this._tiles[p];if(!(!S.current||!S.loaded)){var M=Math.min(1,(i-S.loaded)/200);jr(S.el,M),M<1?l=!0:(S.active?d=!0:this._onOpaqueTile(S),S.active=!0)}}d&&!this._noPrune&&this._pruneTiles(),l&&(z(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this))}},_onOpaqueTile:v,_initContainer:function(){this._container||(this._container=Ve("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var i=this._tileZoom,l=this.options.maxZoom;if(i!==void 0){for(var d in this._levels)d=Number(d),this._levels[d].el.children.length||d===i?(this._levels[d].el.style.zIndex=l-Math.abs(i-d),this._onUpdateLevel(d)):(st(this._levels[d].el),this._removeTilesAtZoom(d),this._onRemoveLevel(d),delete this._levels[d]);var p=this._levels[i],S=this._map;return p||(p=this._levels[i]={},p.el=Ve("div","leaflet-tile-container leaflet-zoom-animated",this._container),p.el.style.zIndex=l,p.origin=S.project(S.unproject(S.getPixelOrigin()),i).round(),p.zoom=i,this._setZoomTransform(p,S.getCenter(),S.getZoom()),v(p.el.offsetWidth),this._onCreateLevel(p)),this._level=p,p}},_onUpdateLevel:v,_onRemoveLevel:v,_onCreateLevel:v,_pruneTiles:function(){if(this._map){var i,l,d=this._map.getZoom();if(d>this.options.maxZoom||d<this.options.minZoom){this._removeAllTiles();return}for(i in this._tiles)l=this._tiles[i],l.retain=l.current;for(i in this._tiles)if(l=this._tiles[i],l.current&&!l.active){var p=l.coords;this._retainParent(p.x,p.y,p.z,p.z-5)||this._retainChildren(p.x,p.y,p.z,p.z+2)}for(i in this._tiles)this._tiles[i].retain||this._removeTile(i)}},_removeTilesAtZoom:function(i){for(var l in this._tiles)this._tiles[l].coords.z===i&&this._removeTile(l)},_removeAllTiles:function(){for(var i in this._tiles)this._removeTile(i)},_invalidateAll:function(){for(var i in this._levels)st(this._levels[i].el),this._onRemoveLevel(Number(i)),delete this._levels[i];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(i,l,d,p){var S=Math.floor(i/2),M=Math.floor(l/2),F=d-1,Y=new Z(+S,+M);Y.z=+F;var X=this._tileCoordsToKey(Y),le=this._tiles[X];return le&&le.active?(le.retain=!0,!0):(le&&le.loaded&&(le.retain=!0),F>p?this._retainParent(S,M,F,p):!1)},_retainChildren:function(i,l,d,p){for(var S=2*i;S<2*i+2;S++)for(var M=2*l;M<2*l+2;M++){var F=new Z(S,M);F.z=d+1;var Y=this._tileCoordsToKey(F),X=this._tiles[Y];if(X&&X.active){X.retain=!0;continue}else X&&X.loaded&&(X.retain=!0);d+1<p&&this._retainChildren(S,M,d+1,p)}},_resetView:function(i){var l=i&&(i.pinch||i.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),l,l)},_animateZoom:function(i){this._setView(i.center,i.zoom,!0,i.noUpdate)},_clampZoom:function(i){var l=this.options;return l.minNativeZoom!==void 0&&i<l.minNativeZoom?l.minNativeZoom:l.maxNativeZoom!==void 0&&l.maxNativeZoom<i?l.maxNativeZoom:i},_setView:function(i,l,d,p){var S=Math.round(l);this.options.maxZoom!==void 0&&S>this.options.maxZoom||this.options.minZoom!==void 0&&S<this.options.minZoom?S=void 0:S=this._clampZoom(S);var M=this.options.updateWhenZooming&&S!==this._tileZoom;(!p||M)&&(this._tileZoom=S,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),S!==void 0&&this._update(i),d||this._pruneTiles(),this._noPrune=!!d),this._setZoomTransforms(i,l)},_setZoomTransforms:function(i,l){for(var d in this._levels)this._setZoomTransform(this._levels[d],i,l)},_setZoomTransform:function(i,l,d){var p=this._map.getZoomScale(d,i.zoom),S=i.origin.multiplyBy(p).subtract(this._map._getNewPixelOrigin(l,d)).round();Ne.any3d?Ns(i.el,S,p):gt(i.el,S)},_resetGrid:function(){var i=this._map,l=i.options.crs,d=this._tileSize=this.getTileSize(),p=this._tileZoom,S=this._map.getPixelWorldBounds(this._tileZoom);S&&(this._globalTileRange=this._pxBoundsToTileRange(S)),this._wrapX=l.wrapLng&&!this.options.noWrap&&[Math.floor(i.project([0,l.wrapLng[0]],p).x/d.x),Math.ceil(i.project([0,l.wrapLng[1]],p).x/d.y)],this._wrapY=l.wrapLat&&!this.options.noWrap&&[Math.floor(i.project([l.wrapLat[0],0],p).y/d.x),Math.ceil(i.project([l.wrapLat[1],0],p).y/d.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(i){var l=this._map,d=l._animatingZoom?Math.max(l._animateToZoom,l.getZoom()):l.getZoom(),p=l.getZoomScale(d,this._tileZoom),S=l.project(i,this._tileZoom).floor(),M=l.getSize().divideBy(p*2);return new K(S.subtract(M),S.add(M))},_update:function(i){var l=this._map;if(l){var d=this._clampZoom(l.getZoom());if(i===void 0&&(i=l.getCenter()),this._tileZoom!==void 0){var p=this._getTiledPixelBounds(i),S=this._pxBoundsToTileRange(p),M=S.getCenter(),F=[],Y=this.options.keepBuffer,X=new K(S.getBottomLeft().subtract([Y,-Y]),S.getTopRight().add([Y,-Y]));if(!(isFinite(S.min.x)&&isFinite(S.min.y)&&isFinite(S.max.x)&&isFinite(S.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var le in this._tiles){var ye=this._tiles[le].coords;(ye.z!==this._tileZoom||!X.contains(new Z(ye.x,ye.y)))&&(this._tiles[le].current=!1)}if(Math.abs(d-this._tileZoom)>1){this._setView(i,d);return}for(var Ce=S.min.y;Ce<=S.max.y;Ce++)for(var Be=S.min.x;Be<=S.max.x;Be++){var Wt=new Z(Be,Ce);if(Wt.z=this._tileZoom,!!this._isValidTile(Wt)){var St=this._tiles[this._tileCoordsToKey(Wt)];St?St.current=!0:F.push(Wt)}}if(F.sort(function(nr,ci){return nr.distanceTo(M)-ci.distanceTo(M)}),F.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Cr=document.createDocumentFragment();for(Be=0;Be<F.length;Be++)this._addTile(F[Be],Cr);this._level.el.appendChild(Cr)}}}},_isValidTile:function(i){var l=this._map.options.crs;if(!l.infinite){var d=this._globalTileRange;if(!l.wrapLng&&(i.x<d.min.x||i.x>d.max.x)||!l.wrapLat&&(i.y<d.min.y||i.y>d.max.y))return!1}if(!this.options.bounds)return!0;var p=this._tileCoordsToBounds(i);return ee(this.options.bounds).overlaps(p)},_keyToBounds:function(i){return this._tileCoordsToBounds(this._keyToTileCoords(i))},_tileCoordsToNwSe:function(i){var l=this._map,d=this.getTileSize(),p=i.scaleBy(d),S=p.add(d),M=l.unproject(p,i.z),F=l.unproject(S,i.z);return[M,F]},_tileCoordsToBounds:function(i){var l=this._tileCoordsToNwSe(i),d=new Ae(l[0],l[1]);return this.options.noWrap||(d=this._map.wrapLatLngBounds(d)),d},_tileCoordsToKey:function(i){return i.x+":"+i.y+":"+i.z},_keyToTileCoords:function(i){var l=i.split(":"),d=new Z(+l[0],+l[1]);return d.z=+l[2],d},_removeTile:function(i){var l=this._tiles[i];l&&(st(l.el),delete this._tiles[i],this.fire("tileunload",{tile:l.el,coords:this._keyToTileCoords(i)}))},_initTile:function(i){Ie(i,"leaflet-tile");var l=this.getTileSize();i.style.width=l.x+"px",i.style.height=l.y+"px",i.onselectstart=v,i.onmousemove=v,Ne.ielt9&&this.options.opacity<1&&jr(i,this.options.opacity)},_addTile:function(i,l){var d=this._getTilePos(i),p=this._tileCoordsToKey(i),S=this.createTile(this._wrapCoords(i),c(this._tileReady,this,i));this._initTile(S),this.createTile.length<2&&V(c(this._tileReady,this,i,null,S)),gt(S,d),this._tiles[p]={el:S,coords:i,current:!0},l.appendChild(S),this.fire("tileloadstart",{tile:S,coords:i})},_tileReady:function(i,l,d){l&&this.fire("tileerror",{error:l,tile:d,coords:i});var p=this._tileCoordsToKey(i);d=this._tiles[p],d&&(d.loaded=+new Date,this._map._fadeAnimated?(jr(d.el,0),z(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this)):(d.active=!0,this._pruneTiles()),l||(Ie(d.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:d.el,coords:i})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ne.ielt9||!this._map._fadeAnimated?V(this._pruneTiles,this):setTimeout(c(this._pruneTiles,this),250)))},_getTilePos:function(i){return i.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(i){var l=new Z(this._wrapX?m(i.x,this._wrapX):i.x,this._wrapY?m(i.y,this._wrapY):i.y);return l.z=i.z,l},_pxBoundsToTileRange:function(i){var l=this.getTileSize();return new K(i.min.unscaleBy(l).floor(),i.max.unscaleBy(l).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var i in this._tiles)if(!this._tiles[i].loaded)return!1;return!0}});function FS(i){return new ha(i)}var li=ha.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(i,l){this._url=i,l=y(this,l),l.detectRetina&&Ne.retina&&l.maxZoom>0?(l.tileSize=Math.floor(l.tileSize/2),l.zoomReverse?(l.zoomOffset--,l.minZoom=Math.min(l.maxZoom,l.minZoom+1)):(l.zoomOffset++,l.maxZoom=Math.max(l.minZoom,l.maxZoom-1)),l.minZoom=Math.max(0,l.minZoom)):l.zoomReverse?l.minZoom=Math.min(l.maxZoom,l.minZoom):l.maxZoom=Math.max(l.minZoom,l.maxZoom),typeof l.subdomains=="string"&&(l.subdomains=l.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(i,l){return this._url===i&&l===void 0&&(l=!0),this._url=i,l||this.redraw(),this},createTile:function(i,l){var d=document.createElement("img");return Me(d,"load",c(this._tileOnLoad,this,l,d)),Me(d,"error",c(this._tileOnError,this,l,d)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(d.referrerPolicy=this.options.referrerPolicy),d.alt="",d.src=this.getTileUrl(i),d},getTileUrl:function(i){var l={r:Ne.retina?"@2x":"",s:this._getSubdomain(i),x:i.x,y:i.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var d=this._globalTileRange.max.y-i.y;this.options.tms&&(l.y=d),l["-y"]=d}return b(this._url,a(l,this.options))},_tileOnLoad:function(i,l){Ne.ielt9?setTimeout(c(i,this,null,l),0):i(null,l)},_tileOnError:function(i,l,d){var p=this.options.errorTileUrl;p&&l.getAttribute("src")!==p&&(l.src=p),i(d,l)},_onTileRemove:function(i){i.tile.onload=null},_getZoomForUrl:function(){var i=this._tileZoom,l=this.options.maxZoom,d=this.options.zoomReverse,p=this.options.zoomOffset;return d&&(i=l-i),i+p},_getSubdomain:function(i){var l=Math.abs(i.x+i.y)%this.options.subdomains.length;return this.options.subdomains[l]},_abortLoading:function(){var i,l;for(i in this._tiles)if(this._tiles[i].coords.z!==this._tileZoom&&(l=this._tiles[i].el,l.onload=v,l.onerror=v,!l.complete)){l.src=$;var d=this._tiles[i].coords;st(l),delete this._tiles[i],this.fire("tileabort",{tile:l,coords:d})}},_removeTile:function(i){var l=this._tiles[i];if(l)return l.el.setAttribute("src",$),ha.prototype._removeTile.call(this,i)},_tileReady:function(i,l,d){if(!(!this._map||d&&d.getAttribute("src")===$))return ha.prototype._tileReady.call(this,i,l,d)}});function Hm(i,l){return new li(i,l)}var Vm=li.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(i,l){this._url=i;var d=a({},this.defaultWmsParams);for(var p in l)p in this.options||(d[p]=l[p]);l=y(this,l);var S=l.detectRetina&&Ne.retina?2:1,M=this.getTileSize();d.width=M.x*S,d.height=M.y*S,this.wmsParams=d},onAdd:function(i){this._crs=this.options.crs||i.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var l=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[l]=this._crs.code,li.prototype.onAdd.call(this,i)},getTileUrl:function(i){var l=this._tileCoordsToNwSe(i),d=this._crs,p=fe(d.project(l[0]),d.project(l[1])),S=p.min,M=p.max,F=(this._wmsVersion>=1.3&&this._crs===Rm?[S.y,S.x,M.y,M.x]:[S.x,S.y,M.x,M.y]).join(","),Y=li.prototype.getTileUrl.call(this,i);return Y+j(this.wmsParams,Y,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+F},setParams:function(i,l){return a(this.wmsParams,i),l||this.redraw(),this}});function US(i,l){return new Vm(i,l)}li.WMS=Vm,Hm.wms=US;var vn=Fr.extend({options:{padding:.1},initialize:function(i){y(this,i),h(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ie(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var i={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(i.zoomanim=this._onAnimZoom),i},_onAnimZoom:function(i){this._updateTransform(i.center,i.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(i,l){var d=this._map.getZoomScale(l,this._zoom),p=this._map.getSize().multiplyBy(.5+this.options.padding),S=this._map.project(this._center,l),M=p.multiplyBy(-d).add(S).subtract(this._map._getNewPixelOrigin(i,l));Ne.any3d?Ns(this._container,M,d):gt(this._container,M)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var i in this._layers)this._layers[i]._reset()},_onZoomEnd:function(){for(var i in this._layers)this._layers[i]._project()},_updatePaths:function(){for(var i in this._layers)this._layers[i]._update()},_update:function(){var i=this.options.padding,l=this._map.getSize(),d=this._map.containerPointToLayerPoint(l.multiplyBy(-i)).round();this._bounds=new K(d,d.add(l.multiplyBy(1+i*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Qm=vn.extend({options:{tolerance:0},getEvents:function(){var i=vn.prototype.getEvents.call(this);return i.viewprereset=this._onViewPreReset,i},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){vn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var i=this._container=document.createElement("canvas");Me(i,"mousemove",this._onMouseMove,this),Me(i,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Me(i,"mouseout",this._handleMouseOut,this),i._leaflet_disable_events=!0,this._ctx=i.getContext("2d")},_destroyContainer:function(){z(this._redrawRequest),delete this._ctx,st(this._container),Ge(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var i;this._redrawBounds=null;for(var l in this._layers)i=this._layers[l],i._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){vn.prototype._update.call(this);var i=this._bounds,l=this._container,d=i.getSize(),p=Ne.retina?2:1;gt(l,i.min),l.width=p*d.x,l.height=p*d.y,l.style.width=d.x+"px",l.style.height=d.y+"px",Ne.retina&&this._ctx.scale(2,2),this._ctx.translate(-i.min.x,-i.min.y),this.fire("update")}},_reset:function(){vn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(i){this._updateDashArray(i),this._layers[h(i)]=i;var l=i._order={layer:i,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=l),this._drawLast=l,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(i){this._requestRedraw(i)},_removePath:function(i){var l=i._order,d=l.next,p=l.prev;d?d.prev=p:this._drawLast=p,p?p.next=d:this._drawFirst=d,delete i._order,delete this._layers[h(i)],this._requestRedraw(i)},_updatePath:function(i){this._extendRedrawBounds(i),i._project(),i._update(),this._requestRedraw(i)},_updateStyle:function(i){this._updateDashArray(i),this._requestRedraw(i)},_updateDashArray:function(i){if(typeof i.options.dashArray=="string"){var l=i.options.dashArray.split(/[, ]+/),d=[],p,S;for(S=0;S<l.length;S++){if(p=Number(l[S]),isNaN(p))return;d.push(p)}i.options._dashArray=d}else i.options._dashArray=i.options.dashArray},_requestRedraw:function(i){this._map&&(this._extendRedrawBounds(i),this._redrawRequest=this._redrawRequest||V(this._redraw,this))},_extendRedrawBounds:function(i){if(i._pxBounds){var l=(i.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new K,this._redrawBounds.extend(i._pxBounds.min.subtract([l,l])),this._redrawBounds.extend(i._pxBounds.max.add([l,l]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var i=this._redrawBounds;if(i){var l=i.getSize();this._ctx.clearRect(i.min.x,i.min.y,l.x,l.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var i,l=this._redrawBounds;if(this._ctx.save(),l){var d=l.getSize();this._ctx.beginPath(),this._ctx.rect(l.min.x,l.min.y,d.x,d.y),this._ctx.clip()}this._drawing=!0;for(var p=this._drawFirst;p;p=p.next)i=p.layer,(!l||i._pxBounds&&i._pxBounds.intersects(l))&&i._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(i,l){if(this._drawing){var d,p,S,M,F=i._parts,Y=F.length,X=this._ctx;if(Y){for(X.beginPath(),d=0;d<Y;d++){for(p=0,S=F[d].length;p<S;p++)M=F[d][p],X[p?"lineTo":"moveTo"](M.x,M.y);l&&X.closePath()}this._fillStroke(X,i)}}},_updateCircle:function(i){if(!(!this._drawing||i._empty())){var l=i._point,d=this._ctx,p=Math.max(Math.round(i._radius),1),S=(Math.max(Math.round(i._radiusY),1)||p)/p;S!==1&&(d.save(),d.scale(1,S)),d.beginPath(),d.arc(l.x,l.y/S,p,0,Math.PI*2,!1),S!==1&&d.restore(),this._fillStroke(d,i)}},_fillStroke:function(i,l){var d=l.options;d.fill&&(i.globalAlpha=d.fillOpacity,i.fillStyle=d.fillColor||d.color,i.fill(d.fillRule||"evenodd")),d.stroke&&d.weight!==0&&(i.setLineDash&&i.setLineDash(l.options&&l.options._dashArray||[]),i.globalAlpha=d.opacity,i.lineWidth=d.weight,i.strokeStyle=d.color,i.lineCap=d.lineCap,i.lineJoin=d.lineJoin,i.stroke())},_onClick:function(i){for(var l=this._map.mouseEventToLayerPoint(i),d,p,S=this._drawFirst;S;S=S.next)d=S.layer,d.options.interactive&&d._containsPoint(l)&&(!(i.type==="click"||i.type==="preclick")||!this._map._draggableMoved(d))&&(p=d);this._fireEvent(p?[p]:!1,i)},_onMouseMove:function(i){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var l=this._map.mouseEventToLayerPoint(i);this._handleMouseHover(i,l)}},_handleMouseOut:function(i){var l=this._hoveredLayer;l&&(ht(this._container,"leaflet-interactive"),this._fireEvent([l],i,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(i,l){if(!this._mouseHoverThrottled){for(var d,p,S=this._drawFirst;S;S=S.next)d=S.layer,d.options.interactive&&d._containsPoint(l)&&(p=d);p!==this._hoveredLayer&&(this._handleMouseOut(i),p&&(Ie(this._container,"leaflet-interactive"),this._fireEvent([p],i,"mouseover"),this._hoveredLayer=p)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,i),this._mouseHoverThrottled=!0,setTimeout(c(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(i,l,d){this._map._fireDOMEvent(l,d||l.type,i)},_bringToFront:function(i){var l=i._order;if(l){var d=l.next,p=l.prev;if(d)d.prev=p;else return;p?p.next=d:d&&(this._drawFirst=d),l.prev=this._drawLast,this._drawLast.next=l,l.next=null,this._drawLast=l,this._requestRedraw(i)}},_bringToBack:function(i){var l=i._order;if(l){var d=l.next,p=l.prev;if(p)p.next=d;else return;d?d.prev=p:p&&(this._drawLast=p),l.prev=null,l.next=this._drawFirst,this._drawFirst.prev=l,this._drawFirst=l,this._requestRedraw(i)}}});function Wm(i){return Ne.canvas?new Qm(i):null}var fa=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(i){return document.createElement("<lvml:"+i+' class="lvml">')}}catch{}return function(i){return document.createElement("<"+i+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),qS={_initContainer:function(){this._container=Ve("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(vn.prototype._update.call(this),this.fire("update"))},_initPath:function(i){var l=i._container=fa("shape");Ie(l,"leaflet-vml-shape "+(this.options.className||"")),l.coordsize="1 1",i._path=fa("path"),l.appendChild(i._path),this._updateStyle(i),this._layers[h(i)]=i},_addPath:function(i){var l=i._container;this._container.appendChild(l),i.options.interactive&&i.addInteractiveTarget(l)},_removePath:function(i){var l=i._container;st(l),i.removeInteractiveTarget(l),delete this._layers[h(i)]},_updateStyle:function(i){var l=i._stroke,d=i._fill,p=i.options,S=i._container;S.stroked=!!p.stroke,S.filled=!!p.fill,p.stroke?(l||(l=i._stroke=fa("stroke")),S.appendChild(l),l.weight=p.weight+"px",l.color=p.color,l.opacity=p.opacity,p.dashArray?l.dashStyle=P(p.dashArray)?p.dashArray.join(" "):p.dashArray.replace(/( *, *)/g," "):l.dashStyle="",l.endcap=p.lineCap.replace("butt","flat"),l.joinstyle=p.lineJoin):l&&(S.removeChild(l),i._stroke=null),p.fill?(d||(d=i._fill=fa("fill")),S.appendChild(d),d.color=p.fillColor||p.color,d.opacity=p.fillOpacity):d&&(S.removeChild(d),i._fill=null)},_updateCircle:function(i){var l=i._point.round(),d=Math.round(i._radius),p=Math.round(i._radiusY||d);this._setPath(i,i._empty()?"M0 0":"AL "+l.x+","+l.y+" "+d+","+p+" 0,"+65535*360)},_setPath:function(i,l){i._path.v=l},_bringToFront:function(i){ri(i._container)},_bringToBack:function(i){ni(i._container)}},Qo=Ne.vml?fa:ko,ma=vn.extend({_initContainer:function(){this._container=Qo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Qo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){st(this._container),Ge(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){vn.prototype._update.call(this);var i=this._bounds,l=i.getSize(),d=this._container;(!this._svgSize||!this._svgSize.equals(l))&&(this._svgSize=l,d.setAttribute("width",l.x),d.setAttribute("height",l.y)),gt(d,i.min),d.setAttribute("viewBox",[i.min.x,i.min.y,l.x,l.y].join(" ")),this.fire("update")}},_initPath:function(i){var l=i._path=Qo("path");i.options.className&&Ie(l,i.options.className),i.options.interactive&&Ie(l,"leaflet-interactive"),this._updateStyle(i),this._layers[h(i)]=i},_addPath:function(i){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(i._path),i.addInteractiveTarget(i._path)},_removePath:function(i){st(i._path),i.removeInteractiveTarget(i._path),delete this._layers[h(i)]},_updatePath:function(i){i._project(),i._update()},_updateStyle:function(i){var l=i._path,d=i.options;l&&(d.stroke?(l.setAttribute("stroke",d.color),l.setAttribute("stroke-opacity",d.opacity),l.setAttribute("stroke-width",d.weight),l.setAttribute("stroke-linecap",d.lineCap),l.setAttribute("stroke-linejoin",d.lineJoin),d.dashArray?l.setAttribute("stroke-dasharray",d.dashArray):l.removeAttribute("stroke-dasharray"),d.dashOffset?l.setAttribute("stroke-dashoffset",d.dashOffset):l.removeAttribute("stroke-dashoffset")):l.setAttribute("stroke","none"),d.fill?(l.setAttribute("fill",d.fillColor||d.color),l.setAttribute("fill-opacity",d.fillOpacity),l.setAttribute("fill-rule",d.fillRule||"evenodd")):l.setAttribute("fill","none"))},_updatePoly:function(i,l){this._setPath(i,ra(i._parts,l))},_updateCircle:function(i){var l=i._point,d=Math.max(Math.round(i._radius),1),p=Math.max(Math.round(i._radiusY),1)||d,S="a"+d+","+p+" 0 1,0 ",M=i._empty()?"M0 0":"M"+(l.x-d)+","+l.y+S+d*2+",0 "+S+-d*2+",0 ";this._setPath(i,M)},_setPath:function(i,l){i._path.setAttribute("d",l)},_bringToFront:function(i){ri(i._path)},_bringToBack:function(i){ni(i._path)}});Ne.vml&&ma.include(qS);function Zm(i){return Ne.svg||Ne.vml?new ma(i):null}Ue.include({getRenderer:function(i){var l=i.options.renderer||this._getPaneRenderer(i.options.pane)||this.options.renderer||this._renderer;return l||(l=this._renderer=this._createRenderer()),this.hasLayer(l)||this.addLayer(l),l},_getPaneRenderer:function(i){if(i==="overlayPane"||i===void 0)return!1;var l=this._paneRenderers[i];return l===void 0&&(l=this._createRenderer({pane:i}),this._paneRenderers[i]=l),l},_createRenderer:function(i){return this.options.preferCanvas&&Wm(i)||Zm(i)}});var Km=ai.extend({initialize:function(i,l){ai.prototype.initialize.call(this,this._boundsToLatLngs(i),l)},setBounds:function(i){return this.setLatLngs(this._boundsToLatLngs(i))},_boundsToLatLngs:function(i){return i=ee(i),[i.getSouthWest(),i.getNorthWest(),i.getNorthEast(),i.getSouthEast()]}});function HS(i,l){return new Km(i,l)}ma.create=Qo,ma.pointsToPath=ra,xn.geometryToLayer=$o,xn.coordsToLatLng=Su,xn.coordsToLatLngs=zo,xn.latLngToCoords=Cu,xn.latLngsToCoords=Fo,xn.getFeature=oi,xn.asFeature=Uo,Ue.mergeOptions({boxZoom:!0});var Gm=tn.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane,this._resetStateTimeout=0,i.on("unload",this._destroy,this)},addHooks:function(){Me(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ge(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){st(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(i){if(!i.shiftKey||i.which!==1&&i.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),ia(),lu(),this._startPoint=this._map.mouseEventToContainerPoint(i),Me(document,{contextmenu:Cs,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(i){this._moved||(this._moved=!0,this._box=Ve("div","leaflet-zoom-box",this._container),Ie(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(i);var l=new K(this._point,this._startPoint),d=l.getSize();gt(this._box,l.min),this._box.style.width=d.x+"px",this._box.style.height=d.y+"px"},_finish:function(){this._moved&&(st(this._box),ht(this._container,"leaflet-crosshair")),aa(),cu(),Ge(document,{contextmenu:Cs,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(i){if(!(i.which!==1&&i.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(c(this._resetState,this),0);var l=new Ae(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(l).fire("boxzoomend",{boxZoomBounds:l})}},_onKeyDown:function(i){i.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ue.addInitHook("addHandler","boxZoom",Gm),Ue.mergeOptions({doubleClickZoom:!0});var Ym=tn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(i){var l=this._map,d=l.getZoom(),p=l.options.zoomDelta,S=i.originalEvent.shiftKey?d-p:d+p;l.options.doubleClickZoom==="center"?l.setZoom(S):l.setZoomAround(i.containerPoint,S)}});Ue.addInitHook("addHandler","doubleClickZoom",Ym),Ue.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Jm=tn.extend({addHooks:function(){if(!this._draggable){var i=this._map;this._draggable=new qn(i._mapPane,i._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),i.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),i.on("zoomend",this._onZoomEnd,this),i.whenReady(this._onZoomEnd,this))}Ie(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ht(this._map._container,"leaflet-grab"),ht(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var i=this._map;if(i._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var l=ee(this._map.options.maxBounds);this._offsetLimit=fe(this._map.latLngToContainerPoint(l.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(l.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;i.fire("movestart").fire("dragstart"),i.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(i){if(this._map.options.inertia){var l=this._lastTime=+new Date,d=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(d),this._times.push(l),this._prunePositions(l)}this._map.fire("move",i).fire("drag",i)},_prunePositions:function(i){for(;this._positions.length>1&&i-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var i=this._map.getSize().divideBy(2),l=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=l.subtract(i).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(i,l){return i-(i-l)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var i=this._draggable._newPos.subtract(this._draggable._startPos),l=this._offsetLimit;i.x<l.min.x&&(i.x=this._viscousLimit(i.x,l.min.x)),i.y<l.min.y&&(i.y=this._viscousLimit(i.y,l.min.y)),i.x>l.max.x&&(i.x=this._viscousLimit(i.x,l.max.x)),i.y>l.max.y&&(i.y=this._viscousLimit(i.y,l.max.y)),this._draggable._newPos=this._draggable._startPos.add(i)}},_onPreDragWrap:function(){var i=this._worldWidth,l=Math.round(i/2),d=this._initialWorldOffset,p=this._draggable._newPos.x,S=(p-l+d)%i+l-d,M=(p+l+d)%i-l-d,F=Math.abs(S+d)<Math.abs(M+d)?S:M;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=F},_onDragEnd:function(i){var l=this._map,d=l.options,p=!d.inertia||i.noInertia||this._times.length<2;if(l.fire("dragend",i),p)l.fire("moveend");else{this._prunePositions(+new Date);var S=this._lastPos.subtract(this._positions[0]),M=(this._lastTime-this._times[0])/1e3,F=d.easeLinearity,Y=S.multiplyBy(F/M),X=Y.distanceTo([0,0]),le=Math.min(d.inertiaMaxSpeed,X),ye=Y.multiplyBy(le/X),Ce=le/(d.inertiaDeceleration*F),Be=ye.multiplyBy(-Ce/2).round();!Be.x&&!Be.y?l.fire("moveend"):(Be=l._limitOffset(Be,l.options.maxBounds),V(function(){l.panBy(Be,{duration:Ce,easeLinearity:F,noMoveStart:!0,animate:!0})}))}}});Ue.addInitHook("addHandler","dragging",Jm),Ue.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Xm=tn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(i){this._map=i,this._setPanDelta(i.options.keyboardPanDelta),this._setZoomDelta(i.options.zoomDelta)},addHooks:function(){var i=this._map._container;i.tabIndex<=0&&(i.tabIndex="0"),Me(i,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ge(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var i=document.body,l=document.documentElement,d=i.scrollTop||l.scrollTop,p=i.scrollLeft||l.scrollLeft;this._map._container.focus(),window.scrollTo(p,d)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(i){var l=this._panKeys={},d=this.keyCodes,p,S;for(p=0,S=d.left.length;p<S;p++)l[d.left[p]]=[-1*i,0];for(p=0,S=d.right.length;p<S;p++)l[d.right[p]]=[i,0];for(p=0,S=d.down.length;p<S;p++)l[d.down[p]]=[0,i];for(p=0,S=d.up.length;p<S;p++)l[d.up[p]]=[0,-1*i]},_setZoomDelta:function(i){var l=this._zoomKeys={},d=this.keyCodes,p,S;for(p=0,S=d.zoomIn.length;p<S;p++)l[d.zoomIn[p]]=i;for(p=0,S=d.zoomOut.length;p<S;p++)l[d.zoomOut[p]]=-i},_addHooks:function(){Me(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ge(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(i){if(!(i.altKey||i.ctrlKey||i.metaKey)){var l=i.keyCode,d=this._map,p;if(l in this._panKeys){if(!d._panAnim||!d._panAnim._inProgress)if(p=this._panKeys[l],i.shiftKey&&(p=ie(p).multiplyBy(3)),d.options.maxBounds&&(p=d._limitOffset(ie(p),d.options.maxBounds)),d.options.worldCopyJump){var S=d.wrapLatLng(d.unproject(d.project(d.getCenter()).add(p)));d.panTo(S)}else d.panBy(p)}else if(l in this._zoomKeys)d.setZoom(d.getZoom()+(i.shiftKey?3:1)*this._zoomKeys[l]);else if(l===27&&d._popup&&d._popup.options.closeOnEscapeKey)d.closePopup();else return;Cs(i)}}});Ue.addInitHook("addHandler","keyboard",Xm),Ue.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ep=tn.extend({addHooks:function(){Me(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ge(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(i){var l=jm(i),d=this._map.options.wheelDebounceTime;this._delta+=l,this._lastMousePos=this._map.mouseEventToContainerPoint(i),this._startTime||(this._startTime=+new Date);var p=Math.max(d-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(c(this._performZoom,this),p),Cs(i)},_performZoom:function(){var i=this._map,l=i.getZoom(),d=this._map.options.zoomSnap||0;i._stop();var p=this._delta/(this._map.options.wheelPxPerZoomLevel*4),S=4*Math.log(2/(1+Math.exp(-Math.abs(p))))/Math.LN2,M=d?Math.ceil(S/d)*d:S,F=i._limitZoom(l+(this._delta>0?M:-M))-l;this._delta=0,this._startTime=null,F&&(i.options.scrollWheelZoom==="center"?i.setZoom(l+F):i.setZoomAround(this._lastMousePos,l+F))}});Ue.addInitHook("addHandler","scrollWheelZoom",ep);var VS=600;Ue.mergeOptions({tapHold:Ne.touchNative&&Ne.safari&&Ne.mobile,tapTolerance:15});var tp=tn.extend({addHooks:function(){Me(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ge(this._map._container,"touchstart",this._onDown,this)},_onDown:function(i){if(clearTimeout(this._holdTimeout),i.touches.length===1){var l=i.touches[0];this._startPos=this._newPos=new Z(l.clientX,l.clientY),this._holdTimeout=setTimeout(c(function(){this._cancel(),this._isTapValid()&&(Me(document,"touchend",Mt),Me(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",l))},this),VS),Me(document,"touchend touchcancel contextmenu",this._cancel,this),Me(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function i(){Ge(document,"touchend",Mt),Ge(document,"touchend touchcancel",i)},_cancel:function(){clearTimeout(this._holdTimeout),Ge(document,"touchend touchcancel contextmenu",this._cancel,this),Ge(document,"touchmove",this._onMove,this)},_onMove:function(i){var l=i.touches[0];this._newPos=new Z(l.clientX,l.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(i,l){var d=new MouseEvent(i,{bubbles:!0,cancelable:!0,view:window,screenX:l.screenX,screenY:l.screenY,clientX:l.clientX,clientY:l.clientY});d._simulated=!0,l.target.dispatchEvent(d)}});Ue.addInitHook("addHandler","tapHold",tp),Ue.mergeOptions({touchZoom:Ne.touch,bounceAtZoomLimits:!0});var rp=tn.extend({addHooks:function(){Ie(this._map._container,"leaflet-touch-zoom"),Me(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ht(this._map._container,"leaflet-touch-zoom"),Ge(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(i){var l=this._map;if(!(!i.touches||i.touches.length!==2||l._animatingZoom||this._zooming)){var d=l.mouseEventToContainerPoint(i.touches[0]),p=l.mouseEventToContainerPoint(i.touches[1]);this._centerPoint=l.getSize()._divideBy(2),this._startLatLng=l.containerPointToLatLng(this._centerPoint),l.options.touchZoom!=="center"&&(this._pinchStartLatLng=l.containerPointToLatLng(d.add(p)._divideBy(2))),this._startDist=d.distanceTo(p),this._startZoom=l.getZoom(),this._moved=!1,this._zooming=!0,l._stop(),Me(document,"touchmove",this._onTouchMove,this),Me(document,"touchend touchcancel",this._onTouchEnd,this),Mt(i)}},_onTouchMove:function(i){if(!(!i.touches||i.touches.length!==2||!this._zooming)){var l=this._map,d=l.mouseEventToContainerPoint(i.touches[0]),p=l.mouseEventToContainerPoint(i.touches[1]),S=d.distanceTo(p)/this._startDist;if(this._zoom=l.getScaleZoom(S,this._startZoom),!l.options.bounceAtZoomLimits&&(this._zoom<l.getMinZoom()&&S<1||this._zoom>l.getMaxZoom()&&S>1)&&(this._zoom=l._limitZoom(this._zoom)),l.options.touchZoom==="center"){if(this._center=this._startLatLng,S===1)return}else{var M=d._add(p)._divideBy(2)._subtract(this._centerPoint);if(S===1&&M.x===0&&M.y===0)return;this._center=l.unproject(l.project(this._pinchStartLatLng,this._zoom).subtract(M),this._zoom)}this._moved||(l._moveStart(!0,!1),this._moved=!0),z(this._animRequest);var F=c(l._move,l,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=V(F,this,!0),Mt(i)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,z(this._animRequest),Ge(document,"touchmove",this._onTouchMove,this),Ge(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ue.addInitHook("addHandler","touchZoom",rp),Ue.BoxZoom=Gm,Ue.DoubleClickZoom=Ym,Ue.Drag=Jm,Ue.Keyboard=Xm,Ue.ScrollWheelZoom=ep,Ue.TapHold=tp,Ue.TouchZoom=rp,r.Bounds=K,r.Browser=Ne,r.CRS=pe,r.Canvas=Qm,r.Circle=ju,r.CircleMarker=Bo,r.Class=Q,r.Control=zr,r.DivIcon=qm,r.DivOverlay=rn,r.DomEvent=cS,r.DomUtil=oS,r.Draggable=qn,r.Evented=re,r.FeatureGroup=gn,r.GeoJSON=xn,r.GridLayer=ha,r.Handler=tn,r.Icon=ii,r.ImageOverlay=qo,r.LatLng=ue,r.LatLngBounds=Ae,r.Layer=Fr,r.LayerGroup=si,r.LineUtil=_S,r.Map=Ue,r.Marker=Ro,r.Mixin=gS,r.Path=Hn,r.Point=Z,r.PolyUtil=yS,r.Polygon=ai,r.Polyline=yn,r.Popup=Ho,r.PosAnimation=Sm,r.Projection=NS,r.Rectangle=Km,r.Renderer=vn,r.SVG=ma,r.SVGOverlay=Um,r.TileLayer=li,r.Tooltip=Vo,r.Transformation=fn,r.Util=q,r.VideoOverlay=Fm,r.bind=c,r.bounds=fe,r.canvas=Wm,r.circle=LS,r.circleMarker=ES,r.control=ca,r.divIcon=zS,r.extend=a,r.featureGroup=PS,r.geoJSON=zm,r.geoJson=IS,r.gridLayer=FS,r.icon=kS,r.imageOverlay=DS,r.latLng=ae,r.latLngBounds=ee,r.layerGroup=CS,r.map=uS,r.marker=TS,r.point=ie,r.polygon=MS,r.polyline=AS,r.popup=BS,r.rectangle=HS,r.setOptions=y,r.stamp=h,r.svg=Zm,r.svgOverlay=RS,r.tileLayer=Hm,r.tooltip=$S,r.transformation=mn,r.version=n,r.videoOverlay=OS;var QS=window.L;r.noConflict=function(){return window.L=QS,this},window.L=r})})(Nh,Nh.exports);var ta=Nh.exports;const am=Qw(ta);function Jc(t,e,r){return Object.freeze({instance:t,context:e,container:r})}function Xc(t,e){return e==null?function(n,a){const o=R.useRef();return o.current||(o.current=t(n,a)),o}:function(n,a){const o=R.useRef();o.current||(o.current=t(n,a));const c=R.useRef(n),{instance:u}=o.current;return R.useEffect(function(){c.current!==n&&(e(u,n,c.current),c.current=n)},[u,n,a]),o}}function Rj(t,e){R.useEffect(function(){return(e.layerContainer??e.map).addLayer(t.instance),function(){var o;(o=e.layerContainer)==null||o.removeLayer(t.instance),e.map.removeLayer(t.instance)}},[e,t])}function Bj(t){return function(r){const n=Gc(),a=t(Yc(r,n),n);return Aj(n.map,r.attribution),im(a.current,r.eventHandlers),Rj(a.current,n),a}}function DE(t,e){const r=R.useRef();R.useEffect(function(){if(e.pathOptions!==r.current){const a=e.pathOptions??{};t.instance.setStyle(a),r.current=a}},[t,e])}function OE(t){return function(r){const n=Gc(),a=t(Yc(r,n),n);return im(a.current,r.eventHandlers),Rj(a.current,n),DE(a.current,r),a}}function RE(t,e){const r=Xc(t,e),n=Bj(r);return Oj(n)}function BE(t,e){const r=Xc(t),n=IE(r,e);return AE(n)}function $E(t,e){const r=Xc(t,e),n=OE(r);return Oj(n)}function zE(t,e){const r=Xc(t,e),n=Bj(r);return ME(n)}function FE(t,e,r){const{opacity:n,zIndex:a}=e;n!=null&&n!==r.opacity&&t.setOpacity(n),a!=null&&a!==r.zIndex&&t.setZIndex(a)}function UE(){return Gc().map}function jh(){return jh=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},jh.apply(this,arguments)}function qE({bounds:t,boundsOptions:e,center:r,children:n,className:a,id:o,placeholder:c,style:u,whenReady:h,zoom:f,...m},v){const[w]=R.useState({className:a,id:o,style:u}),[N,g]=R.useState(null);R.useImperativeHandle(v,()=>(N==null?void 0:N.map)??null,[N]);const y=R.useCallback(_=>{if(_!==null&&N===null){const b=new ta.Map(_,m);r!=null&&f!=null?b.setView(r,f):t!=null&&b.fitBounds(t,e),h!=null&&b.whenReady(h),g(LE(b))}},[]);R.useEffect(()=>()=>{N==null||N.map.remove()},[N]);const j=N?Qa.createElement(Dj,{value:N},n):c??null;return Qa.createElement("div",jh({},w,{ref:y}),j)}const HE=R.forwardRef(qE),Ca=RE(function({position:e,...r},n){const a=new ta.Marker(e,r);return Jc(a,Mj(n,{overlayContainer:a}))},function(e,r,n){r.position!==n.position&&e.setLatLng(r.position),r.icon!=null&&r.icon!==n.icon&&e.setIcon(r.icon),r.zIndexOffset!=null&&r.zIndexOffset!==n.zIndexOffset&&e.setZIndexOffset(r.zIndexOffset),r.opacity!=null&&r.opacity!==n.opacity&&e.setOpacity(r.opacity),e.dragging!=null&&r.draggable!==n.draggable&&(r.draggable===!0?e.dragging.enable():e.dragging.disable())}),VE=$E(function({positions:e,...r},n){const a=new ta.Polyline(e,r);return Jc(a,Mj(n,{overlayContainer:a}))},function(e,r,n){r.positions!==n.positions&&e.setLatLngs(r.positions)}),Pa=BE(function(e,r){const n=new ta.Popup(e,r.overlayContainer);return Jc(n,r)},function(e,r,{position:n},a){R.useEffect(function(){const{instance:c}=e;function u(f){f.popup===c&&(c.update(),a(!0))}function h(f){f.popup===c&&a(!1)}return r.map.on({popupopen:u,popupclose:h}),r.overlayContainer==null?(n!=null&&c.setLatLng(n),c.openOn(r.map)):r.overlayContainer.bindPopup(c),function(){var m;r.map.off({popupopen:u,popupclose:h}),(m=r.overlayContainer)==null||m.unbindPopup(),r.map.removeLayer(c)}},[e,r,a,n])}),QE=zE(function({url:e,...r},n){const a=new ta.TileLayer(e,Yc(r,n));return Jc(a,n)},function(e,r,n){FE(e,r,n);const{url:a}=r;a!=null&&a!==n.url&&e.setUrl(a)});delete am.Icon.Default.prototype._getIconUrl;am.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png"});const eu=(t,e)=>am.divIcon({html:`
    <div style="
      background-color: ${t};
      width: 30px;
      height: 30px;
      border-radius: 50%;
      border: 3px solid white;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.3);
      font-size: 14px;
    ">
      ${e}
    </div>
  `,className:"custom-div-icon",iconSize:[30,30],iconAnchor:[15,15],popupAnchor:[0,-15]}),WE=eu("#3b82f6","🏥"),ZE=eu("#10b981","🚚"),Fg=eu("#ef4444","📍"),KE=eu("#f59e0b","🔍");function GE({onMapClick:t}){const e=UE();return R.useEffect(()=>{const r=n=>{t(n.latlng.lat,n.latlng.lng)};return e.on("click",r),()=>{e.off("click",r)}},[e,t]),null}function YE({orders:t=[],selectedOrderId:e,onOrderSelect:r,showRoute:n=!0,centerLocation:a}){const[o,c]=R.useState(""),[u,h]=R.useState([]),[f,m]=R.useState(!1),[v,w]=R.useState(null),[N,g]=R.useState(null),j=a?[a.latitude,a.longitude]:[10.8231,106.6297],_=async k=>{if(!k.trim()){h([]);return}m(!0);try{const I=await Vt.geocode(k);if(I.success&&I.address){h([I.address]);return}const T=Vt.getAddressesByCity(k);h(T)}catch(I){console.error("Address search failed:",I),h([])}finally{m(!1)}},b=k=>{w(k),c(k.fullAddress),h([])},P=async(k,I)=>{try{const T=await Vt.reverseGeocode(k,I);T.success&&T.address?g({lat:k,lng:I,address:T.address}):g({lat:k,lng:I})}catch(T){console.error("Reverse geocoding failed:",T),g({lat:k,lng:I})}},B=k=>{var T,D;const I=[];return(T=k.originBranch)!=null&&T.location&&I.push([k.originBranch.location.latitude,k.originBranch.location.longitude]),(D=k.assignedShipper)!=null&&D.currentLocation&&I.push([k.assignedShipper.currentLocation.latitude,k.assignedShipper.currentLocation.longitude]),k.destinationLocation&&I.push([k.destinationLocation.latitude,k.destinationLocation.longitude]),I},$=k=>{switch(k){case"pending":return"#6b7280";case"confirmed":return"#f59e0b";case"assigned":return"#3b82f6";case"picked_up":return"#8b5cf6";case"in_transit":return"#f97316";case"delivered":return"#10b981";case"cancelled":return"#ef4444";default:return"#6b7280"}};return s.jsxs("div",{className:"bg-white rounded-lg border shadow-sm",children:[s.jsxs("div",{className:"p-4 border-b",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center mb-3",children:[s.jsx(vt,{className:"h-5 w-5 mr-2 text-blue-500"}),"Vietnam Delivery Map - OpenStreetMap"]}),s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"relative",children:[s.jsx(dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search addresses in Vietnam... (e.g., Ho Chi Minh City, District 1)",value:o,onChange:k=>{c(k.target.value),_(k.target.value)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"}),f&&s.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:s.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"})})]}),u.length>0&&s.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-40 overflow-y-auto",children:u.map((k,I)=>s.jsx("button",{onClick:()=>b(k),className:"w-full text-left px-4 py-2 hover:bg-gray-50 border-b border-gray-100 last:border-b-0",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(vt,{className:"h-4 w-4 text-blue-500 mt-0.5 mr-2 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"font-medium text-gray-900 text-sm",children:k.street}),s.jsxs("p",{className:"text-xs text-gray-600",children:[k.ward,", ",k.district,", ",k.city]})]})]})},I))})]}),s.jsxs("div",{className:"mt-2 flex gap-2",children:[s.jsx("button",{onClick:()=>{c("Ho Chi Minh City"),_("Ho Chi Minh City")},className:"px-3 py-1 bg-blue-100 text-blue-800 rounded text-xs hover:bg-blue-200",children:"HCMC"}),s.jsx("button",{onClick:()=>{c("Hanoi"),_("Hanoi")},className:"px-3 py-1 bg-blue-100 text-blue-800 rounded text-xs hover:bg-blue-200",children:"Hanoi"}),s.jsx("button",{onClick:()=>{c("Da Nang"),_("Da Nang")},className:"px-3 py-1 bg-blue-100 text-blue-800 rounded text-xs hover:bg-blue-200",children:"Da Nang"})]}),s.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[t.length," active deliveries • Click anywhere on map to get address"]})]}),s.jsx("div",{style:{height:"500px",width:"100%"},children:s.jsxs(HE,{center:j,zoom:13,style:{height:"100%",width:"100%"},zoomControl:!0,scrollWheelZoom:!0,children:[s.jsx(QE,{attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),s.jsx(GE,{onMapClick:P}),v&&s.jsx(Ca,{position:[v.coordinates.latitude,v.coordinates.longitude],icon:KE,children:s.jsx(Pa,{children:s.jsxs("div",{className:"p-2",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"🔍 Searched Location"}),s.jsx("p",{className:"text-sm text-gray-700",children:v.street}),s.jsxs("p",{className:"text-xs text-gray-600",children:[v.ward,", ",v.district]}),s.jsxs("p",{className:"text-xs text-gray-500",children:[v.city,", ",v.province]}),s.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["📍 ",v.coordinates.latitude.toFixed(4),", ",v.coordinates.longitude.toFixed(4)]})]})})}),N&&s.jsx(Ca,{position:[N.lat,N.lng],icon:Fg,children:s.jsx(Pa,{children:s.jsxs("div",{className:"p-2",children:[s.jsx("h4",{className:"font-medium text-gray-900",children:"📍 Clicked Location"}),N.address?s.jsxs(s.Fragment,{children:[s.jsx("p",{className:"text-sm text-gray-700",children:N.address.street}),s.jsxs("p",{className:"text-xs text-gray-600",children:[N.address.ward,", ",N.address.district]}),s.jsxs("p",{className:"text-xs text-gray-500",children:[N.address.city,", ",N.address.province]})]}):s.jsx("p",{className:"text-sm text-gray-700",children:"Getting address..."}),s.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["📍 ",N.lat.toFixed(4),", ",N.lng.toFixed(4)]})]})})}),t.map(k=>{var D;const I=e===k.id,T=$(k.status);return s.jsxs(Qa.Fragment,{children:[k.originBranch&&s.jsx(Ca,{position:[k.originBranch.location.latitude,k.originBranch.location.longitude],icon:WE,children:s.jsx(Pa,{children:s.jsxs("div",{className:"p-2",children:[s.jsxs("h4",{className:"font-medium text-gray-900 flex items-center",children:[s.jsx(Sj,{className:"h-4 w-4 mr-1"}),k.originBranch.name]}),s.jsx("p",{className:"text-sm text-gray-700",children:"Origin Branch"}),s.jsxs("p",{className:"text-xs text-gray-600",children:["Order: #",k.id]})]})})}),((D=k.assignedShipper)==null?void 0:D.currentLocation)&&s.jsx(Ca,{position:[k.assignedShipper.currentLocation.latitude,k.assignedShipper.currentLocation.longitude],icon:ZE,children:s.jsx(Pa,{children:s.jsxs("div",{className:"p-2",children:[s.jsxs("h4",{className:"font-medium text-gray-900 flex items-center",children:[s.jsx(ur,{className:"h-4 w-4 mr-1"}),k.assignedShipper.name]}),s.jsx("p",{className:"text-sm text-gray-700",children:"Shipper Location"}),s.jsxs("p",{className:"text-xs text-gray-600",children:["Order: #",k.id]}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Status: ",k.status]})]})})}),k.destinationLocation&&s.jsx(Ca,{position:[k.destinationLocation.latitude,k.destinationLocation.longitude],icon:Fg,children:s.jsx(Pa,{children:s.jsxs("div",{className:"p-2",children:[s.jsxs("h4",{className:"font-medium text-gray-900 flex items-center",children:[s.jsx(WT,{className:"h-4 w-4 mr-1"}),k.customerName]}),s.jsx("p",{className:"text-sm text-gray-700",children:"Delivery Address"}),s.jsx("p",{className:"text-xs text-gray-600",children:k.destinationLocation.address}),s.jsxs("p",{className:"text-xs text-gray-500",children:["Order: #",k.id]}),s.jsx("button",{onClick:()=>r==null?void 0:r(k.id),className:"mt-1 text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600",children:"Select Order"})]})})}),n&&s.jsx(VE,{positions:B(k),pathOptions:{color:T,weight:I?4:2,opacity:I?.8:.6,dashArray:k.status==="delivered"?void 0:"10, 10"}})]},k.id)})]})}),s.jsx("div",{className:"p-4 border-t bg-gray-50",children:s.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-4 h-4 bg-blue-500 rounded-full mr-2"}),s.jsx("span",{children:"🏥 Pharmacy Branch"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-4 h-4 bg-green-500 rounded-full mr-2"}),s.jsx("span",{children:"🚚 Shipper Location"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-4 h-4 bg-red-500 rounded-full mr-2"}),s.jsx("span",{children:"📍 Customer Address"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-4 h-4 bg-yellow-500 rounded-full mr-2"}),s.jsx("span",{children:"🔍 Searched Location"})]})]})})]})}const Ug={"Ho Chi Minh City":{lat:10.8231,lng:106.6297},Hanoi:{lat:21.0285,lng:105.8542},"Da Nang":{lat:16.0471,lng:108.2068},"Can Tho":{lat:10.0452,lng:105.7469},"Hai Phong":{lat:20.8449,lng:106.6881},"Bien Hoa":{lat:10.9447,lng:106.823},Hue:{lat:16.4637,lng:107.5909},"Nha Trang":{lat:12.2388,lng:109.1967},"Buon Ma Thuot":{lat:12.6667,lng:108.05},"Quy Nhon":{lat:13.7563,lng:109.2297}},Pr={north:23.393,south:8.18,east:109.464,west:102.145};function JE({orders:t=[],selectedOrderId:e,onOrderSelect:r,showRoute:n=!0,centerLocation:a}){const o=R.useRef(null),[c,u]=R.useState(e||null),[h,f]=R.useState(a||Ug["Ho Chi Minh City"]),[m,v]=R.useState(""),[w,N]=R.useState([]),[g,y]=R.useState(!1),[j,_]=R.useState(null),[b,P]=R.useState(!0),B=async z=>{if(!z.trim()){N([]);return}y(!0);try{const q=await Vt.geocode(z);if(q.success&&q.address){N([q.address]);return}const Q=Vt.getAddressesByCity(z);N(Q)}catch(q){console.error("Address search failed:",q),N([])}finally{y(!1)}},$=z=>{_(z),f({lat:z.coordinates.latitude,lng:z.coordinates.longitude}),v(z.fullAddress),N([])},k=async z=>{var Z;const q=(Z=o.current)==null?void 0:Z.getBoundingClientRect();if(!q)return;const Q=z.clientX-q.left,te=z.clientY-q.top,de=Pr.north-te/q.height*(Pr.north-Pr.south),re=Pr.west+Q/q.width*(Pr.east-Pr.west);try{const ne=await Vt.reverseGeocode(de,re);ne.success&&ne.address&&(_(ne.address),v(ne.address.fullAddress))}catch(ne){console.error("Reverse geocoding failed:",ne)}};R.useEffect(()=>{e&&u(e)},[e]);const I=z=>{u(z),r==null||r(z);const q=t.find(Q=>Q.id===z);q!=null&&q.destinationLocation&&f({lat:q.destinationLocation.latitude,lng:q.destinationLocation.longitude})},T=z=>{switch(z){case"pending":return"bg-gray-500";case"confirmed":return"bg-yellow-500";case"assigned":return"bg-blue-500";case"picked_up":return"bg-purple-500";case"in_transit":return"bg-orange-500";case"delivered":return"bg-green-500";case"cancelled":return"bg-red-500";default:return"bg-gray-500"}},D=(z,q,Q,te)=>{const re=(Q-z)*Math.PI/180,Z=(te-q)*Math.PI/180,ne=Math.sin(re/2)*Math.sin(re/2)+Math.cos(z*Math.PI/180)*Math.cos(Q*Math.PI/180)*Math.sin(Z/2)*Math.sin(Z/2);return 6371*(2*Math.atan2(Math.sqrt(ne),Math.sqrt(1-ne)))},U=(z,q,Q)=>{const te=(q-Pr.west)/(Pr.east-Pr.west)*Q.width,de=(Pr.north-z)/(Pr.north-Pr.south)*Q.height;return{x:te,y:de}},V={width:400,height:600};return s.jsxs("div",{className:"bg-white rounded-lg border shadow-sm",children:[s.jsxs("div",{className:"p-4 border-b",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(vt,{className:"h-5 w-5 mr-2 text-blue-500"}),"Vietnam Delivery Map"]}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[t.length," active deliveries • Real-time tracking"]}),s.jsxs("div",{className:"mt-3 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Map View:"}),s.jsx("button",{onClick:()=>P(!b),className:"flex items-center space-x-1 px-3 py-1 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:b?s.jsxs(s.Fragment,{children:[s.jsx(tE,{className:"h-4 w-4 text-blue-500"}),s.jsx("span",{className:"text-sm text-blue-600",children:"OpenStreetMap"})]}):s.jsxs(s.Fragment,{children:[s.jsx(eE,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-sm text-gray-600",children:"SVG Map"})]})})]}),s.jsx("div",{className:"text-xs text-gray-500",children:b?"Interactive map with real tiles":"Simple vector map"})]}),s.jsxs("div",{className:"mt-4 relative",children:[s.jsxs("div",{className:"relative",children:[s.jsx(dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search addresses in Vietnam... (e.g., Ho Chi Minh City, Nguyen Hue Street)",value:m,onChange:z=>{v(z.target.value),B(z.target.value)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"}),g&&s.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:s.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-blue-500 border-t-transparent rounded-full"})})]}),w.length>0&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:w.map((z,q)=>s.jsx("button",{onClick:()=>$(z),className:"w-full text-left px-4 py-3 hover:bg-gray-50 border-b border-gray-100 last:border-b-0 focus:bg-blue-50 focus:outline-none",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(vt,{className:"h-4 w-4 text-blue-500 mt-0.5 mr-2 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"font-medium text-gray-900 text-sm",children:z.street}),s.jsxs("p",{className:"text-xs text-gray-600",children:[z.ward,", ",z.district]}),s.jsxs("p",{className:"text-xs text-gray-500",children:[z.city,", ",z.province]})]})]})},q))}),j&&s.jsx("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(vt,{className:"h-4 w-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"font-medium text-blue-900 text-sm",children:j.street}),s.jsxs("p",{className:"text-xs text-blue-700",children:[j.ward,", ",j.district,", ",j.city]}),s.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["📍 ",j.coordinates.latitude.toFixed(4),", ",j.coordinates.longitude.toFixed(4)]})]})]})})]})]}),b?s.jsx(YE,{orders:t,selectedOrderId:e,onOrderSelect:r,showRoute:n,centerLocation:a}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"relative",children:[s.jsxs("svg",{ref:o,viewBox:`0 0 ${V.width} ${V.height}`,className:"w-full h-96 bg-blue-50 cursor-crosshair",onClick:k,children:[s.jsx("path",{d:"M80,50 L320,50 L350,80 L380,150 L370,200 L360,250 L350,300 L340,350 L320,400 L300,450 L280,500 L250,530 L200,550 L150,530 L120,500 L100,450 L90,400 L85,350 L80,300 L75,250 L70,200 L75,150 L80,100 Z",fill:"#e0f2fe",stroke:"#0369a1",strokeWidth:"2",className:"drop-shadow-sm"}),Object.entries(Ug).map(([z,q])=>{const Q=U(q.lat,q.lng,V);return s.jsxs("g",{children:[s.jsx("circle",{cx:Q.x,cy:Q.y,r:"3",fill:"#64748b",className:"opacity-50"}),s.jsx("text",{x:Q.x+5,y:Q.y-5,fontSize:"8",fill:"#374151",className:"text-xs font-medium",children:z})]},z)}),t.map(z=>{var de;if(!z.destinationLocation)return null;const q=U(z.destinationLocation.latitude,z.destinationLocation.longitude,V),Q=c===z.id,te=T(z.status);return s.jsxs("g",{children:[n&&z.originBranch&&(()=>{const re=U(z.originBranch.location.latitude,z.originBranch.location.longitude,V);return s.jsx("line",{x1:re.x,y1:re.y,x2:q.x,y2:q.y,stroke:Q?"#3b82f6":"#9ca3af",strokeWidth:Q?"3":"1",strokeDasharray:"5,5",className:"opacity-60"})})(),z.originBranch&&(()=>{const re=U(z.originBranch.location.latitude,z.originBranch.location.longitude,V);return s.jsxs("g",{children:[s.jsx("circle",{cx:re.x,cy:re.y,r:"6",fill:"#10b981",className:"drop-shadow-sm"}),s.jsx("circle",{cx:re.x,cy:re.y,r:"3",fill:"white"})]})})(),((de=z.assignedShipper)==null?void 0:de.currentLocation)&&(()=>{const re=U(z.assignedShipper.currentLocation.latitude,z.assignedShipper.currentLocation.longitude,V);return s.jsxs("g",{children:[s.jsx("circle",{cx:re.x,cy:re.y,r:"8",fill:"#3b82f6",className:"animate-pulse drop-shadow-sm"}),s.jsx("circle",{cx:re.x,cy:re.y,r:"4",fill:"white"})]})})(),s.jsx("circle",{cx:q.x,cy:q.y,r:Q?"10":"8",fill:te.replace("bg-","#"),className:`cursor-pointer transition-all duration-200 ${Q?"drop-shadow-lg":"drop-shadow-sm"} hover:r-12`,onClick:()=>I(z.id)}),s.jsx("circle",{cx:q.x,cy:q.y,r:Q?"5":"4",fill:"white"}),Q&&s.jsxs("text",{x:q.x,y:q.y-15,fontSize:"10",fill:"#374151",textAnchor:"middle",className:"font-semibold",children:["#",z.id]})]},z.id)}),j&&(()=>{const z=U(j.coordinates.latitude,j.coordinates.longitude,V);return s.jsxs("g",{children:[s.jsx("circle",{cx:z.x,cy:z.y,r:"12",fill:"#ef4444",className:"drop-shadow-lg animate-pulse"}),s.jsx("circle",{cx:z.x,cy:z.y,r:"6",fill:"white"}),s.jsx("circle",{cx:z.x,cy:z.y,r:"2",fill:"#ef4444"}),s.jsxs("text",{x:z.x,y:z.y-20,fontSize:"10",fill:"#374151",textAnchor:"middle",className:"font-semibold bg-white",children:["📍 ",j.city]})]})})()]}),s.jsx("div",{className:"absolute top-4 right-4 bg-white rounded-lg shadow-sm border p-2",children:s.jsx("div",{className:"flex flex-col space-y-2",children:s.jsx("button",{className:"p-1 hover:bg-gray-100 rounded text-gray-600",children:s.jsx(qi,{className:"h-4 w-4"})})})})]}),s.jsx("div",{className:"p-4 border-t bg-gray-50",children:s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:"Locations"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-gray-600",children:"Pharmacy Branch"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full animate-pulse"}),s.jsx("span",{className:"text-gray-600",children:"Shipper Location"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-gray-500 rounded-full"}),s.jsx("span",{className:"text-gray-600",children:"Customer Address"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:"Status"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-orange-500 rounded-full"}),s.jsx("span",{className:"text-gray-600",children:"In Transit"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),s.jsx("span",{className:"text-gray-600",children:"Delivered"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),s.jsx("span",{className:"text-gray-600",children:"Assigned"})]})]})]})}),c&&s.jsx("div",{className:"p-4 border-t",children:(()=>{const z=t.find(q=>q.id===c);return z?s.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[s.jsxs("h4",{className:"font-semibold text-gray-900 mb-2",children:["Order #",z.id]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Customer:"}),s.jsx("p",{className:"font-medium",children:z.customerName})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Status:"}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium text-white ${T(z.status)}`,children:z.status.toUpperCase()})]}),z.assignedShipper&&s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Shipper:"}),s.jsx("p",{className:"font-medium",children:z.assignedShipper.name})]}),z.destinationLocation&&s.jsxs("div",{children:[s.jsx("p",{className:"text-gray-600",children:"Distance:"}),s.jsx("p",{className:"font-medium",children:z.originBranch?`${D(z.originBranch.location.latitude,z.originBranch.location.longitude,z.destinationLocation.latitude,z.destinationLocation.longitude).toFixed(1)} km`:"Calculating..."})]})]})]}):null})()})]})]})}function XE(){const{orders:t,shippers:e,updateShipperLocation:r,updateOrder:n}=lt(),{user:a,logout:o}=pt(),[c,u]=R.useState(""),[h,f]=R.useState(!1),[m,v]=R.useState(null),[w,N]=R.useState(""),[g,y]=R.useState(null),[j,_]=R.useState(!1),b=e.find(T=>T.userId===(a==null?void 0:a.id)),P=t.filter(T=>T.assignedShipperId===(b==null?void 0:b.id)&&T.status!=="delivered"&&T.status!=="cancelled"),B=t.filter(T=>T.assignedShipperId===(b==null?void 0:b.id)&&T.status==="delivered");R.useEffect(()=>{if(!b)return;const T=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(U=>{const V={latitude:U.coords.latitude,longitude:U.coords.longitude,address:"Current location",timestamp:new Date().toISOString()};r(b.id,V)},U=>{console.error("Error getting location:",U)})};T();const D=setInterval(T,3e4);return()=>clearInterval(D)},[b,r]);const $=async(T,D)=>{try{const U=t.find(z=>z.id===T);if(!U)return;const V={...U,status:D,actualDelivery:D==="delivered"?new Date().toISOString():U.actualDelivery,deliveryProof:D==="delivered"&&m?{photos:[URL.createObjectURL(m)],notes:"Delivered by shipper with photo proof"}:U.deliveryProof};await n(V),D==="delivered"&&v(null)}catch(U){console.error("Error updating order status:",U)}},k=T=>{var U;const D=(U=T.target.files)==null?void 0:U[0];D&&v(D)},I=async()=>{if(w.trim()){_(!0);try{const T=await Vt.geocode(w);if(T.success&&T.address)y(T.address);else{const D=Vt.getAddressesByCity(w);D.length>0&&y(D[0])}}catch(T){console.error("Address search failed:",T)}finally{_(!1)}}};return b?s.jsxs("div",{className:"min-h-screen bg-gray-50",children:[s.jsx("div",{className:"bg-white shadow-sm border-b",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex justify-between items-center py-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(ur,{className:"h-8 w-8 text-blue-600 mr-3"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Shipper Dashboard"}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Welcome back, ",b.name]})]})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Zc,{className:"h-4 w-4 text-yellow-500 mr-1"}),b.rating.toFixed(1)," rating"]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[s.jsx(Ot,{className:"h-4 w-4 text-green-500 mr-1"}),b.totalDeliveries," deliveries"]}),s.jsxs("button",{onClick:o,className:"flex items-center px-3 py-2 text-sm text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg",children:[s.jsx(kj,{className:"h-4 w-4 mr-1"}),"Logout"]})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm border",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(Ot,{className:"h-5 w-5 text-blue-600"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active Orders"}),s.jsx("p",{className:"text-xl font-semibold text-gray-900",children:P.length})]})]})}),s.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm border",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:s.jsx(Lt,{className:"h-5 w-5 text-green-600"})}),s.jsxs("div",{className:"ml-3",children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Completed"}),s.jsx("p",{className:"text-xl font-semibold text-gray-900",children:B.length})]})]})})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[s.jsx("div",{className:"p-4 border-b",children:s.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(vt,{className:"h-5 w-5 mr-2 text-blue-500"}),"Address Lookup"]})}),s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex gap-2 mb-3",children:[s.jsx("input",{type:"text",placeholder:"Search for address...",value:w,onChange:T=>N(T.target.value),onKeyPress:T=>T.key==="Enter"&&I(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"}),s.jsx("button",{onClick:I,disabled:j||!w.trim(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 text-sm",children:j?"...":"Find"})]}),g&&s.jsx("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(vt,{className:"h-4 w-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0"}),s.jsxs("div",{className:"min-w-0 flex-1",children:[s.jsx("p",{className:"font-medium text-blue-900 text-sm",children:g.street}),s.jsxs("p",{className:"text-xs text-blue-700",children:[g.ward,", ",g.district]}),s.jsxs("p",{className:"text-xs text-blue-600",children:[g.city,", ",g.province]}),s.jsxs("p",{className:"text-xs text-blue-500 mt-1",children:["📍 ",g.coordinates.latitude.toFixed(4),", ",g.coordinates.longitude.toFixed(4)]})]})]})}),s.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2",children:[s.jsx("button",{onClick:()=>{N("Ho Chi Minh City"),I()},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"HCMC"}),s.jsx("button",{onClick:()=>{N("Hanoi"),I()},className:"px-3 py-1 bg-gray-100 text-gray-700 rounded text-xs hover:bg-gray-200",children:"Hanoi"})]})]})]}),s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[s.jsx("div",{className:"p-4 border-b",children:s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Active Deliveries"})}),s.jsx("div",{className:"p-4 space-y-4",children:P.length===0?s.jsxs("div",{className:"text-center py-8",children:[s.jsx(Ot,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-600",children:"No active deliveries"})]}):P.map(T=>s.jsxs("div",{className:`border rounded-lg p-4 cursor-pointer transition-colors ${c===T.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>u(T.id),children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"font-medium text-gray-900",children:["#",T.id]}),s.jsx("p",{className:"text-sm text-gray-600",children:T.customerName})]}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${T.status==="assigned"?"bg-blue-100 text-blue-800":T.status==="picked_up"?"bg-purple-100 text-purple-800":T.status==="in_transit"?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"}`,children:T.status.toUpperCase()})]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-2",children:[s.jsx(vt,{className:"h-4 w-4 mr-1"}),T.shippingAddress]}),s.jsxs("div",{className:"flex items-center text-sm text-gray-600 mb-3",children:[s.jsx(Bn,{className:"h-4 w-4 mr-1"}),"Est. delivery: ",T.estimatedDelivery?new Date(T.estimatedDelivery).toLocaleTimeString():"Not set"]}),s.jsxs("div",{className:"flex space-x-2",children:[T.status==="assigned"&&s.jsx("button",{onClick:D=>{D.stopPropagation(),$(T.id,"picked_up")},className:"flex-1 px-3 py-2 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700",children:"Pick Up"}),T.status==="picked_up"&&s.jsx("button",{onClick:D=>{D.stopPropagation(),$(T.id,"in_transit")},className:"flex-1 px-3 py-2 bg-purple-600 text-white text-sm rounded-lg hover:bg-purple-700",children:"Start Delivery"}),T.status==="in_transit"&&s.jsxs("div",{className:"flex-1 space-y-2",children:[s.jsx("input",{type:"file",accept:"image/*",onChange:k,className:"hidden",id:`proof-${T.id}`}),s.jsxs("label",{htmlFor:`proof-${T.id}`,className:"flex items-center justify-center px-3 py-2 bg-gray-600 text-white text-sm rounded-lg hover:bg-gray-700 cursor-pointer",children:[s.jsx(Cj,{className:"h-4 w-4 mr-1"}),m?"Photo Added":"Add Photo"]}),s.jsx("button",{onClick:D=>{D.stopPropagation(),$(T.id,"delivered")},disabled:!m,className:"w-full px-3 py-2 bg-green-600 text-white text-sm rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Mark Delivered"})]})]})]},T.id))})]})]}),s.jsx("div",{className:"lg:col-span-2",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border",children:[s.jsx("div",{className:"p-4 border-b",children:s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Delivery Map"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(qi,{className:"h-4 w-4 text-blue-500"}),s.jsx("span",{className:"text-sm text-gray-600",children:"Real-time tracking"})]})]})}),s.jsx("div",{className:"p-4",children:s.jsx(JE,{orders:P.map(T=>({id:T.id,customerName:T.customerName,destinationLocation:T.destinationLocation,originBranch:T.originBranch,assignedShipper:{name:b.name,currentLocation:b.currentLocation},status:T.status})),selectedOrderId:c,onOrderSelect:u,showRoute:!0,centerLocation:b.currentLocation?{latitude:b.currentLocation.latitude,longitude:b.currentLocation.longitude}:void 0})})]})})]})})]}):s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ur,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Shipper Profile Not Found"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Please contact your administrator to set up your shipper profile."}),s.jsx("button",{onClick:o,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Login"})]})})}function e6(){const[t,e]=R.useState(!1),[r,n]=R.useState(""),[a,o]=R.useState([]),c=async()=>{var f;e(!0),n("Creating shipper accounts..."),o([]);const u=[{email:"shipper1@longchau.com",password:"shipper123",name:"Nguyen Van Duc",role:"shipper"},{email:"shipper2@longchau.com",password:"shipper123",name:"Tran Van Minh",role:"shipper"},{email:"shipper3@longchau.com",password:"shipper123",name:"Le Van Nam",role:"shipper"}],h=[];for(const m of u){try{n(`Creating account for ${m.email}...`);const v=await on.createUser(m);v.success?h.push({email:m.email,success:!0,message:`Account created successfully! User ID: ${(f=v.user)==null?void 0:f.id}`}):h.push({email:m.email,success:!1,message:v.error||"Unknown error"})}catch(v){h.push({email:m.email,success:!1,message:v instanceof Error?v.message:"Failed to create account"})}o([...h])}n("Account creation completed!"),e(!1)};return s.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg",children:[s.jsxs("div",{className:"text-center mb-6",children:[s.jsx("div",{className:"mx-auto h-12 w-12 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:s.jsx(ur,{className:"h-6 w-6 text-blue-600"})}),s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Create Shipper Accounts"}),s.jsx("p",{className:"text-gray-600",children:"Add shipper user accounts to the database"})]}),s.jsx("button",{onClick:c,disabled:t,className:"w-full flex items-center justify-center px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors mb-6",children:t?s.jsxs(s.Fragment,{children:[s.jsx(Po,{className:"animate-spin h-5 w-5 mr-2"}),"Creating Accounts..."]}):s.jsxs(s.Fragment,{children:[s.jsx(nm,{className:"h-5 w-5 mr-2"}),"Create Shipper Accounts"]})}),r&&s.jsx("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsx("p",{className:"text-blue-800 text-sm",children:r})}),a.length>0&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Results:"}),a.map((u,h)=>s.jsx("div",{className:`p-3 rounded-lg border ${u.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:s.jsxs("div",{className:"flex items-start",children:[u.success?s.jsx(Lt,{className:"h-5 w-5 text-green-500 mt-0.5 mr-2 flex-shrink-0"}):s.jsx(Qc,{className:"h-5 w-5 text-red-500 mt-0.5 mr-2 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:`font-medium text-sm ${u.success?"text-green-800":"text-red-800"}`,children:u.email}),s.jsx("p",{className:`text-xs mt-1 ${u.success?"text-green-600":"text-red-600"}`,children:u.message})]})]})},h))]}),s.jsxs("div",{className:"mt-8 p-4 bg-gray-50 rounded-lg",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Account Details:"}),s.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("p",{children:"• shipper1@longchau.com - Nguyen Van Duc"}),s.jsx("p",{children:"• shipper2@longchau.com - Tran Van Minh"}),s.jsx("p",{children:"• shipper3@longchau.com - Le Van Nam"}),s.jsx("p",{className:"mt-2 font-medium",children:"Password for all accounts: shipper123"})]})]})]})}function qg(){const{addShipper:t,shippers:e,branches:r}=lt(),[n,a]=R.useState(!1),[o,c]=R.useState([]),u=f=>{c(m=>[...m,`${new Date().toLocaleTimeString()}: ${f}`])},h=async()=>{var f;a(!0),c([]);try{const v=(await on.getAllUsers()).filter(N=>N.role==="shipper");if(u(`Found ${v.length} shipper user accounts`),v.length===0){u("❌ No shipper user accounts found. Please create them first."),a(!1);return}const w=[{email:"shipper1@longchau.com",name:"Nguyen Van Duc",phone:"+84 90 123 4567",vehicleType:"motorcycle",vehicleNumber:"59A1-12345",licenseNumber:"DL123456789",currentLocation:{latitude:10.8231,longitude:106.6297,address:"District 1, Ho Chi Minh City",timestamp:new Date().toISOString()},isAvailable:!0,rating:4.8,totalDeliveries:245,emergencyContact:{name:"Nguyen Thi Mai",phone:"+84 90 987 6543",relationship:"spouse"}},{email:"shipper2@longchau.com",name:"Tran Van Minh",phone:"+84 91 234 5678",vehicleType:"motorcycle",vehicleNumber:"59X1-67890",licenseNumber:"DL987654321",currentLocation:{latitude:10.7892,longitude:106.6762,address:"District 3, Ho Chi Minh City",timestamp:new Date().toISOString()},isAvailable:!0,rating:4.7,totalDeliveries:189,emergencyContact:{name:"Tran Thi Hoa",phone:"+84 91 876 5432",relationship:"spouse"}},{email:"shipper3@longchau.com",name:"Le Van Nam",phone:"+84 92 345 6789",vehicleType:"motorcycle",vehicleNumber:"59B1-54321",licenseNumber:"DL555666777",currentLocation:{latitude:10.8503,longitude:106.7719,address:"Thu Duc City, Ho Chi Minh City",timestamp:new Date().toISOString()},isAvailable:!0,rating:4.9,totalDeliveries:312,emergencyContact:{name:"Le Van Long",phone:"+84 92 876 5432",relationship:"brother"}}];for(const N of w)try{const g=v.find(_=>_.email===N.email);if(!g){u(`⚠️ No user account found for ${N.email}`);continue}if(e.find(_=>_.userId===g.id)){u(`⚠️ Shipper profile already exists for ${N.email}`);continue}const j={...N,userId:g.id,branchId:((f=r[0])==null?void 0:f.id)||void 0};await t(j),u(`✅ Created shipper profile for ${N.email} (${g.id})`)}catch(g){u(`❌ Error creating profile for ${N.email}: ${g}`)}u("🎉 Shipper profile creation completed!")}catch(m){u(`❌ Error: ${m}`)}finally{a(!1)}};return s.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[s.jsx(ur,{className:"h-6 w-6 mr-3 text-blue-500"}),"Create Shipper Profiles"]}),s.jsxs("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:[s.jsx("p",{className:"text-blue-800 mb-2",children:"This tool creates shipper profiles linked to existing user accounts."}),s.jsx("p",{className:"text-blue-700 text-sm",children:"Make sure shipper user accounts exist before running this tool."})]}),s.jsx("div",{className:"mb-4",children:s.jsx("button",{onClick:h,disabled:n,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center",children:n?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin h-5 w-5 border-2 border-white border-t-transparent rounded-full mr-2"}),"Creating Profiles..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ur,{className:"h-5 w-5 mr-2"}),"Create Shipper Profiles"]})})}),s.jsxs("div",{className:"bg-black text-green-400 p-4 rounded font-mono text-sm max-h-96 overflow-y-auto",children:[s.jsx("div",{className:"text-white mb-2",children:"Console Output:"}),o.map((f,m)=>s.jsx("div",{children:f},m)),o.length===0&&s.jsx("div",{className:"text-gray-500",children:"No output yet..."})]}),s.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[s.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Current Status:"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Lt,{className:"h-4 w-4 text-green-500 mr-2"}),s.jsxs("span",{children:["Shippers: ",e.length," profiles"]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(Lt,{className:"h-4 w-4 text-blue-500 mr-2"}),s.jsxs("span",{children:["Branches: ",r.length," locations"]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(Qc,{className:"h-4 w-4 text-yellow-500 mr-2"}),s.jsx("span",{children:"Ready to create profiles"})]})]})]})]})}const t6=()=>{const[t,e]=R.useState(!1),[r,n]=R.useState(""),[a,o]=R.useState(null),c=()=>"prod_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),u=[{name:"Ibuprofen 400mg Tablets",description:"Fast-acting pain relief for headaches, muscle pain, and inflammation. Contains 400mg ibuprofen per tablet.",category:"Pain Relief",price:"12.99",stock:250,minStock:50,manufacturer:"Advil",expiryDate:"2026-12-31",requiresPrescription:!1,batchNumber:"IBU240301"},{name:"Acetaminophen 500mg Tablets",description:"Effective pain reliever and fever reducer. Safe for most adults and children over 12.",category:"Pain Relief",price:"8.99",stock:300,minStock:60,manufacturer:"Tylenol",expiryDate:"2026-11-30",requiresPrescription:!1,batchNumber:"ACE240201"},{name:"Naproxen 220mg Tablets",description:"Long-lasting relief from minor aches and pains. Lasts up to 12 hours.",category:"Pain Relief",price:"15.49",stock:180,minStock:40,manufacturer:"Aleve",expiryDate:"2027-01-15",requiresPrescription:!1,batchNumber:"NAP240401"},{name:"Aspirin 81mg Low Dose",description:"Low-dose aspirin for heart health and stroke prevention. Enteric coated.",category:"Cardiovascular",price:"9.99",stock:400,minStock:80,manufacturer:"Bayer",expiryDate:"2026-10-31",requiresPrescription:!1,batchNumber:"ASP240101"},{name:"DayQuil Cold & Flu Relief",description:"Multi-symptom relief for cold and flu. Non-drowsy daytime formula.",category:"Cold & Flu",price:"18.99",stock:120,minStock:30,manufacturer:"Vicks",expiryDate:"2026-09-30",requiresPrescription:!1,batchNumber:"DAY240501"},{name:"NyQuil Nighttime Cold & Flu",description:"Nighttime multi-symptom cold and flu relief. Helps you rest.",category:"Cold & Flu",price:"18.99",stock:110,minStock:25,manufacturer:"Vicks",expiryDate:"2026-09-30",requiresPrescription:!1,batchNumber:"NYQ240501"},{name:"Robitussin DM Cough Syrup",description:"Controls cough and thins mucus. Sugar-free formula available.",category:"Cold & Flu",price:"14.99",stock:90,minStock:20,manufacturer:"Robitussin",expiryDate:"2026-08-31",requiresPrescription:!1,batchNumber:"ROB240601"},{name:"Throat Lozenges Honey Lemon",description:"Soothing throat lozenges with honey and lemon. Pack of 20.",category:"Cold & Flu",price:"6.99",stock:200,minStock:40,manufacturer:"Halls",expiryDate:"2027-03-31",requiresPrescription:!1,batchNumber:"THR240701"},{name:"Claritin 24-Hour Allergy Relief",description:"Non-drowsy 24-hour allergy relief. Loratadine 10mg tablets.",category:"Allergy",price:"22.99",stock:150,minStock:30,manufacturer:"Claritin",expiryDate:"2026-12-31",requiresPrescription:!1,batchNumber:"CLA240801"},{name:"Zyrtec Allergy Tablets",description:"Fast-acting allergy relief. Cetirizine HCl 10mg.",category:"Allergy",price:"24.99",stock:140,minStock:28,manufacturer:"Zyrtec",expiryDate:"2027-01-31",requiresPrescription:!1,batchNumber:"ZYR240901"},{name:"Benadryl Allergy Ultratabs",description:"Fast relief from allergy symptoms. Diphenhydramine HCl 25mg.",category:"Allergy",price:"16.99",stock:180,minStock:35,manufacturer:"Benadryl",expiryDate:"2026-11-30",requiresPrescription:!1,batchNumber:"BEN241001"},{name:"Flonase Nasal Spray",description:"24-hour allergy relief nasal spray. Fluticasone propionate.",category:"Allergy",price:"28.99",stock:85,minStock:20,manufacturer:"Flonase",expiryDate:"2026-10-31",requiresPrescription:!1,batchNumber:"FLO241101"},{name:"Pepto-Bismol Liquid",description:"Relief from upset stomach, nausea, heartburn, and diarrhea.",category:"Digestive Health",price:"12.99",stock:100,minStock:25,manufacturer:"Pepto-Bismol",expiryDate:"2026-09-30",requiresPrescription:!1,batchNumber:"PEP241201"},{name:"Tums Extra Strength Antacid",description:"Fast relief from heartburn and acid indigestion. Calcium carbonate 750mg.",category:"Digestive Health",price:"8.99",stock:220,minStock:45,manufacturer:"Tums",expiryDate:"2027-02-28",requiresPrescription:!1,batchNumber:"TUM241301"},{name:"Imodium A-D Anti-Diarrheal",description:"Controls symptoms of diarrhea. Loperamide HCl 2mg.",category:"Digestive Health",price:"14.99",stock:75,minStock:20,manufacturer:"Imodium",expiryDate:"2026-12-31",requiresPrescription:!1,batchNumber:"IMO241401"},{name:"Metamucil Fiber Supplement",description:"Daily fiber supplement for digestive health. Psyllium husk powder.",category:"Digestive Health",price:"19.99",stock:60,minStock:15,manufacturer:"Metamucil",expiryDate:"2027-01-31",requiresPrescription:!1,batchNumber:"MET241501"},{name:"Vitamin D3 2000 IU Softgels",description:"Supports bone health and immune function. 120 softgels.",category:"Vitamins",price:"16.99",stock:180,minStock:40,manufacturer:"Nature Made",expiryDate:"2027-06-30",requiresPrescription:!1,batchNumber:"VD3241601"},{name:"Multivitamin for Adults",description:"Complete daily nutrition with essential vitamins and minerals.",category:"Vitamins",price:"24.99",stock:150,minStock:35,manufacturer:"Centrum",expiryDate:"2027-05-31",requiresPrescription:!1,batchNumber:"MUL241701"},{name:"Vitamin C 1000mg Tablets",description:"Immune support with high-potency Vitamin C. 100 tablets.",category:"Vitamins",price:"12.99",stock:200,minStock:50,manufacturer:"Emergen-C",expiryDate:"2027-04-30",requiresPrescription:!1,batchNumber:"VC1241801"},{name:"Omega-3 Fish Oil Capsules",description:"Heart and brain health support. EPA and DHA omega-3 fatty acids.",category:"Vitamins",price:"29.99",stock:120,minStock:30,manufacturer:"Nordic Naturals",expiryDate:"2026-12-31",requiresPrescription:!1,batchNumber:"OM3241901"},{name:"Calcium + Vitamin D Tablets",description:"Bone health support with calcium carbonate and vitamin D3.",category:"Vitamins",price:"18.99",stock:140,minStock:35,manufacturer:"Caltrate",expiryDate:"2027-03-31",requiresPrescription:!1,batchNumber:"CAL242001"},{name:"Lisinopril 10mg Tablets",description:"ACE inhibitor for high blood pressure and heart failure.",category:"Cardiovascular",price:"45.99",stock:80,minStock:20,manufacturer:"Zestril",expiryDate:"2026-11-30",requiresPrescription:!0,batchNumber:"LIS242101"},{name:"Metformin 500mg Tablets",description:"Type 2 diabetes medication. Helps control blood sugar levels.",category:"Diabetes",price:"32.99",stock:100,minStock:25,manufacturer:"Glucophage",expiryDate:"2026-10-31",requiresPrescription:!0,batchNumber:"MET242201"},{name:"Atorvastatin 20mg Tablets",description:"Cholesterol-lowering medication. Helps prevent heart disease.",category:"Cardiovascular",price:"55.99",stock:90,minStock:22,manufacturer:"Lipitor",expiryDate:"2026-12-31",requiresPrescription:!0,batchNumber:"ATO242301"},{name:"Amlodipine 5mg Tablets",description:"Calcium channel blocker for high blood pressure.",category:"Cardiovascular",price:"38.99",stock:85,minStock:20,manufacturer:"Norvasc",expiryDate:"2027-01-31",requiresPrescription:!0,batchNumber:"AML242401"}],h=async()=>{try{e(!0),n("Starting product seeding...");const f=10;let m=0;for(let w=0;w<u.length;w+=f){const g=u.slice(w,w+f).map(y=>({id:c(),...y}));await ce.insert(Zt).values(g),m+=g.length,n(`Inserted batch ${Math.floor(w/f)+1}: ${g.length} products`),await new Promise(y=>setTimeout(y,100))}const v=u.reduce((w,N)=>(w[N.category]=(w[N.category]||0)+1,w),{});o({success:!0,totalProducts:m,categorySummary:v}),n(`Successfully seeded ${m} products!`)}catch(f){console.error("Error seeding products:",f),n(`Error: ${f instanceof Error?f.message:"Unknown error"}`)}finally{e(!1)}};return s.jsx("div",{className:"max-w-4xl mx-auto p-6",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Product Database Seeder"}),s.jsxs("p",{className:"text-gray-600 mb-6",children:["Add a comprehensive set of pharmaceutical products to your database. This will add ",u.length," products across multiple categories including pain relief, vitamins, prescription medications, and more."]}),!a&&s.jsx("button",{onClick:h,disabled:t,className:`px-6 py-3 rounded-lg font-medium ${t?"bg-gray-400 cursor-not-allowed text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:t?"Seeding Products...":`Seed ${u.length} Products`}),r&&s.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:s.jsx("p",{className:"text-blue-800",children:r})}),a&&s.jsxs("div",{className:"mt-6 space-y-4",children:[s.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"✅ Seeding Completed!"}),s.jsxs("p",{className:"text-green-700",children:["Successfully added ",a.totalProducts," products to the database."]})]}),s.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"📊 Categories Added:"}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Object.entries(a.categorySummary).map(([f,m])=>s.jsxs("div",{className:"flex justify-between items-center bg-white p-2 rounded border",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:f}),s.jsx("span",{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:m})]},f))})]}),s.jsx("button",{onClick:()=>{o(null),n("")},className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Seed More Products"})]}),s.jsxs("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[s.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"⚠️ Important Notes:"}),s.jsxs("ul",{className:"text-yellow-700 text-sm space-y-1",children:[s.jsx("li",{children:"• This will add sample products with realistic pharmaceutical data"}),s.jsx("li",{children:"• Products include both prescription and over-the-counter medications"}),s.jsx("li",{children:"• Stock levels and expiry dates are set with realistic values"}),s.jsx("li",{children:"• Each product gets a unique ID and batch number"})]})]})]})})};function Hg(){const[t,e]=R.useState(!1),[r,n]=R.useState([]),{isConnectedToDatabase:a}=lt(),o=u=>{n(h=>[...h,`${new Date().toLocaleTimeString()}: ${u}`])},c=async()=>{var u;e(!0),n([]);try{o("🚀 Starting database migration..."),o("🔍 Checking orders table structure...");const h=["assigned_shipper_id","assigned_at","assigned_by","origin_branch_id","destination_location","route_data","estimated_distance","estimated_duration","shipping_info","estimated_delivery","actual_delivery","shipper_location","tracking_history","delivery_proof","customer_rating","delivery_notes"],f=["ALTER TABLE orders ADD COLUMN IF NOT EXISTS assigned_shipper_id TEXT REFERENCES shippers(id)","ALTER TABLE orders ADD COLUMN IF NOT EXISTS assigned_at TIMESTAMP","ALTER TABLE orders ADD COLUMN IF NOT EXISTS assigned_by TEXT REFERENCES users(id)","ALTER TABLE orders ADD COLUMN IF NOT EXISTS origin_branch_id TEXT REFERENCES branches(id)","ALTER TABLE orders ADD COLUMN IF NOT EXISTS destination_location JSONB","ALTER TABLE orders ADD COLUMN IF NOT EXISTS route_data JSONB","ALTER TABLE orders ADD COLUMN IF NOT EXISTS estimated_distance DECIMAL(8,2)","ALTER TABLE orders ADD COLUMN IF NOT EXISTS estimated_duration INTEGER","ALTER TABLE orders ADD COLUMN IF NOT EXISTS shipping_info JSONB","ALTER TABLE orders ADD COLUMN IF NOT EXISTS estimated_delivery TIMESTAMP","ALTER TABLE orders ADD COLUMN IF NOT EXISTS actual_delivery TIMESTAMP","ALTER TABLE orders ADD COLUMN IF NOT EXISTS shipper_location JSONB","ALTER TABLE orders ADD COLUMN IF NOT EXISTS tracking_history JSONB","ALTER TABLE orders ADD COLUMN IF NOT EXISTS delivery_proof JSONB","ALTER TABLE orders ADD COLUMN IF NOT EXISTS customer_rating INTEGER","ALTER TABLE orders ADD COLUMN IF NOT EXISTS delivery_notes TEXT"];for(let v=0;v<f.length;v++){const w=f[v],N=h[v];try{o(`📝 Adding column: ${N}...`),await ce.execute(w),o(`✅ Successfully added: ${N}`)}catch(g){(u=g.message)!=null&&u.includes("already exists")?o(`⚠️ Column ${N} already exists`):o(`❌ Error adding ${N}: ${g.message}`)}}o("🔍 Checking other required tables...");const m=[`CREATE TABLE IF NOT EXISTS users (
          id TEXT PRIMARY KEY,
          email VARCHAR(255) NOT NULL UNIQUE,
          password VARCHAR(255) NOT NULL,
          name VARCHAR(255) NOT NULL,
          role VARCHAR(50) NOT NULL,
          branch_id TEXT,
          professional_info JSONB,
          created_at TIMESTAMP DEFAULT NOW(),
          updated_at TIMESTAMP DEFAULT NOW()
        )`,`CREATE TABLE IF NOT EXISTS shippers (
          id TEXT PRIMARY KEY,
          user_id TEXT NOT NULL REFERENCES users(id),
          name VARCHAR(255) NOT NULL,
          email VARCHAR(255) NOT NULL,
          phone VARCHAR(20) NOT NULL,
          vehicle_type VARCHAR(50) NOT NULL,
          vehicle_number VARCHAR(20) NOT NULL,
          license_number VARCHAR(50) NOT NULL,
          current_location JSONB,
          is_available BOOLEAN DEFAULT true,
          rating DECIMAL(3,2) DEFAULT 5.00,
          total_deliveries INTEGER DEFAULT 0,
          branch_id TEXT,
          emergency_contact JSONB,
          created_at TIMESTAMP DEFAULT NOW(),
          updated_at TIMESTAMP DEFAULT NOW()
        )`,`CREATE TABLE IF NOT EXISTS branches (
          id TEXT PRIMARY KEY,
          name VARCHAR(255) NOT NULL,
          address TEXT NOT NULL,
          city VARCHAR(100) NOT NULL,
          province VARCHAR(100) NOT NULL,
          postal_code VARCHAR(10),
          phone VARCHAR(20),
          email VARCHAR(255),
          location JSONB,
          operating_hours JSONB,
          is_active BOOLEAN DEFAULT true,
          created_at TIMESTAMP DEFAULT NOW(),
          updated_at TIMESTAMP DEFAULT NOW()
        )`,`CREATE TABLE IF NOT EXISTS customers (
          id TEXT PRIMARY KEY,
          name VARCHAR(255) NOT NULL,
          email VARCHAR(255) UNIQUE,
          phone VARCHAR(20),
          address TEXT,
          date_of_birth DATE,
          join_date TIMESTAMP DEFAULT NOW(),
          allergies JSONB,
          prescription_history JSONB,
          order_history JSONB,
          health_status JSONB,
          created_at TIMESTAMP DEFAULT NOW(),
          updated_at TIMESTAMP DEFAULT NOW()
        )`];for(const v of m)try{await ce.execute(v),o("✅ Table structure verified/created")}catch(w){o(`⚠️ Table creation note: ${w.message}`)}o("🎉 Database migration completed successfully!"),o("📊 All required columns for shipping functionality have been added."),o("🔄 You may need to refresh the page to see the changes.")}catch(h){o(`❌ Migration failed: ${h.message}`)}finally{e(!1)}};return s.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[s.jsx(br,{className:"h-6 w-6 mr-3 text-blue-500"}),"Database Migration - Fix Missing Columns"]}),s.jsx("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(Rn,{className:"h-5 w-5 text-yellow-600 mt-0.5 mr-2 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-yellow-800",children:"Database Schema Update Required"}),s.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"The orders table is missing columns for shipping functionality. This migration will add:"}),s.jsxs("ul",{className:"text-yellow-700 text-sm mt-2 ml-4 list-disc",children:[s.jsx("li",{children:"assigned_shipper_id, assigned_at, assigned_by"}),s.jsx("li",{children:"origin_branch_id, destination_location, route_data"}),s.jsx("li",{children:"shipping_info, tracking_history, delivery_proof"}),s.jsx("li",{children:"And other shipping-related columns"})]})]})]})}),s.jsxs("div",{className:"mb-4 p-3 bg-gray-100 rounded",children:[s.jsx("p",{className:"font-medium",children:"Database Status:"}),s.jsx("div",{className:"flex items-center mt-2",children:a?s.jsxs(s.Fragment,{children:[s.jsx(Lt,{className:"h-4 w-4 text-green-500 mr-2"}),s.jsx("span",{className:"text-green-700",children:"Connected to Neon PostgreSQL"})]}):s.jsxs(s.Fragment,{children:[s.jsx(Rn,{className:"h-4 w-4 text-red-500 mr-2"}),s.jsx("span",{className:"text-red-700",children:"Not connected to database"})]})})]}),s.jsx("div",{className:"mb-4",children:s.jsx("button",{onClick:c,disabled:t||!a,className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center",children:t?s.jsxs(s.Fragment,{children:[s.jsx(fs,{className:"h-5 w-5 mr-2 animate-spin"}),"Running Migration..."]}):s.jsxs(s.Fragment,{children:[s.jsx(br,{className:"h-5 w-5 mr-2"}),"Run Database Migration"]})})}),s.jsxs("div",{className:"bg-black text-green-400 p-4 rounded font-mono text-sm max-h-96 overflow-y-auto",children:[s.jsx("div",{className:"text-white mb-2",children:"Migration Output:"}),r.map((u,h)=>s.jsx("div",{children:u},h)),r.length===0&&s.jsx("div",{className:"text-gray-500",children:"Ready to run migration..."})]}),s.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[s.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:"After Migration:"}),s.jsxs("ol",{className:"text-blue-700 text-sm space-y-1 ml-4 list-decimal",children:[s.jsx("li",{children:"Refresh the application page"}),s.jsx("li",{children:"The orders should load without column errors"}),s.jsx("li",{children:"Shipper assignment and tracking features will work"}),s.jsx("li",{children:"Vietnam map with address lookup will be functional"})]})]})]})}function Vg(){const[t,e]=R.useState("Ready to test"),[r,n]=R.useState([]),{isConnectedToDatabase:a}=lt(),o=h=>{n(f=>[...f,`${new Date().toLocaleTimeString()}: ${h}`])},c=async()=>{var f,m;e("Testing database connection..."),n([]),o(`Database connected: ${a}`);try{o("Creating admin account...");const v=await on.createUser({email:"admin@longchau.com",password:"admin123",name:"Admin User",role:"manager"});v.success?o(`✅ Admin created: ${(f=v.user)==null?void 0:f.id}`):o(`⚠️ Admin creation failed: ${v.error}`)}catch(v){o(`❌ Admin creation error: ${v}`)}const h=[{email:"shipper1@longchau.com",name:"Nguyen Van Duc"},{email:"shipper2@longchau.com",name:"Tran Van Minh"},{email:"shipper3@longchau.com",name:"Le Van Nam"}];for(const v of h)try{o(`Creating ${v.email}...`);const w=await on.createUser({email:v.email,password:"shipper123",name:v.name,role:"shipper"});w.success?o(`✅ ${v.email} created: ${(m=w.user)==null?void 0:m.id}`):o(`⚠️ ${v.email} failed: ${w.error}`)}catch(w){o(`❌ ${v.email} error: ${w}`)}e("Test completed")},u=async()=>{var h,f;e("Testing login...");try{o("Testing shipper1 login...");const m=await on.loginUser("shipper1@longchau.com","shipper123");m.success?o(`✅ Login successful: ${(h=m.user)==null?void 0:h.name} (${(f=m.user)==null?void 0:f.role})`):o(`❌ Login failed: ${m.error}`)}catch(m){o(`❌ Login error: ${m}`)}e("Login test completed")};return s.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-lg shadow-lg",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Database Connection Test"}),s.jsxs("div",{className:"mb-4 flex gap-4",children:[s.jsx("button",{onClick:c,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Test User Creation"}),s.jsx("button",{onClick:u,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",children:"Test Login"})]}),s.jsxs("div",{className:"mb-4 p-3 bg-gray-100 rounded",children:[s.jsxs("p",{className:"font-medium",children:["Status: ",t]}),s.jsxs("p",{className:"text-sm",children:["Database Connected: ",a?"✅ Yes":"❌ No"]})]}),s.jsxs("div",{className:"bg-black text-green-400 p-4 rounded font-mono text-sm max-h-96 overflow-y-auto",children:[s.jsx("div",{className:"text-white mb-2",children:"Console Output:"}),r.map((h,f)=>s.jsx("div",{children:h},f)),r.length===0&&s.jsx("div",{className:"text-gray-500",children:"No output yet..."})]})]})}function r6(){const[t,e]=R.useState(""),[r,n]=R.useState([]),[a,o]=R.useState(!1),[c,u]=R.useState(null),[h,f]=R.useState(null),[m,v]=R.useState({lat:"",lng:""}),w=async()=>{if(t.trim()){o(!0);try{const j=await Vt.geocode(t);if(j.success&&j.address)n([j.address]),u(j.address);else{const _=Vt.getAddressesByCity(t);n(_),_.length>0&&u(_[0])}}catch(j){console.error("Search failed:",j)}finally{o(!1)}}},N=async()=>{const j=parseFloat(m.lat),_=parseFloat(m.lng);if(!(isNaN(j)||isNaN(_))){o(!0);try{const b=await Vt.reverseGeocode(j,_);b.success&&b.address&&f(b.address)}catch(b){console.error("Reverse geocoding failed:",b)}finally{o(!1)}}},g=()=>{const j=Vt.getRandomVietnameseAddress();u(j),e(j.fullAddress)},y=j=>Vt.validateVietnamesePhone(j);return s.jsx("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-lg border",children:[s.jsxs("div",{className:"p-6 border-b",children:[s.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[s.jsx(VT,{className:"h-6 w-6 mr-3 text-blue-500"}),"Vietnam Address Lookup API"]}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Search Vietnamese addresses, reverse geocoding, and address validation"})]}),s.jsxs("div",{className:"p-6 space-y-6",children:[s.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-blue-900 mb-3 flex items-center",children:[s.jsx(dn,{className:"h-5 w-5 mr-2"}),"Address Search (Forward Geocoding)"]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("input",{type:"text",placeholder:"Search: Ho Chi Minh City, Nguyen Hue Street, District 1...",value:t,onChange:j=>e(j.target.value),onKeyPress:j=>j.key==="Enter"&&w(),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),s.jsxs("button",{onClick:w,disabled:a||!t.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center",children:[a?s.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full mr-2"}):s.jsx(dn,{className:"h-4 w-4 mr-2"}),"Search"]}),s.jsx("button",{onClick:g,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Random"})]}),r.length>0&&s.jsxs("div",{className:"mt-4 space-y-2",children:[s.jsx("h4",{className:"font-medium text-blue-800",children:"Search Results:"}),r.map((j,_)=>s.jsx("div",{onClick:()=>u(j),className:"p-3 bg-white border border-blue-200 rounded-lg cursor-pointer hover:bg-blue-50 transition-colors",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(vt,{className:"h-4 w-4 text-blue-600 mt-0.5 mr-2 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:j.street}),s.jsxs("p",{className:"text-sm text-gray-600",children:[j.ward,", ",j.district]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[j.city,", ",j.province]}),s.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["📍 ",j.coordinates.latitude.toFixed(4),", ",j.coordinates.longitude.toFixed(4)]})]})]})},_))]})]}),s.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-green-900 mb-3 flex items-center",children:[s.jsx(qi,{className:"h-5 w-5 mr-2"}),"Reverse Geocoding (Coordinates to Address)"]}),s.jsxs("div",{className:"flex gap-3 mb-4",children:[s.jsx("input",{type:"number",placeholder:"Latitude (e.g., 10.8231)",value:m.lat,onChange:j=>v({...m,lat:j.target.value}),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",step:"0.0001"}),s.jsx("input",{type:"number",placeholder:"Longitude (e.g., 106.6297)",value:m.lng,onChange:j=>v({...m,lng:j.target.value}),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",step:"0.0001"}),s.jsxs("button",{onClick:N,disabled:a||!m.lat||!m.lng,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center",children:[a?s.jsx("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full mr-2"}):s.jsx(qi,{className:"h-4 w-4 mr-2"}),"Lookup"]})]}),s.jsxs("div",{className:"flex gap-2 mb-4",children:[s.jsx("button",{onClick:()=>v({lat:"10.8231",lng:"106.6297"}),className:"px-3 py-1 bg-green-100 text-green-800 rounded text-sm hover:bg-green-200",children:"Ho Chi Minh City"}),s.jsx("button",{onClick:()=>v({lat:"21.0285",lng:"105.8542"}),className:"px-3 py-1 bg-green-100 text-green-800 rounded text-sm hover:bg-green-200",children:"Hanoi"}),s.jsx("button",{onClick:()=>v({lat:"16.0471",lng:"108.2068"}),className:"px-3 py-1 bg-green-100 text-green-800 rounded text-sm hover:bg-green-200",children:"Da Nang"})]}),h&&s.jsxs("div",{className:"p-3 bg-white border border-green-200 rounded-lg",children:[s.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Address Found:"}),s.jsxs("div",{className:"flex items-start",children:[s.jsx(vt,{className:"h-4 w-4 text-green-600 mt-0.5 mr-2 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-gray-900",children:h.street}),s.jsxs("p",{className:"text-sm text-gray-600",children:[h.ward,", ",h.district]}),s.jsxs("p",{className:"text-sm text-gray-500",children:[h.city,", ",h.province]})]})]})]})]}),s.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-purple-900 mb-3 flex items-center",children:[s.jsx(pc,{className:"h-5 w-5 mr-2"}),"Vietnamese Phone Validation"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:["+84901234567","0901234567","84901234567","+84281234567","0281234567","1234567890","+1234567890"].map((j,_)=>s.jsxs("div",{className:"flex items-center justify-between p-2 bg-white border border-purple-200 rounded",children:[s.jsx("span",{className:"font-mono text-sm",children:j}),s.jsxs("div",{className:"flex items-center",children:[y(j)?s.jsx(Lt,{className:"h-4 w-4 text-green-500"}):s.jsx("div",{className:"h-4 w-4 rounded-full bg-red-500"}),s.jsx("span",{className:"ml-2 text-xs font-medium",children:y(j)?"Valid":"Invalid"})]})]},_))})]}),c&&s.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-yellow-900 mb-3 flex items-center",children:[s.jsx(vt,{className:"h-5 w-5 mr-2"}),"Selected Address Details"]}),s.jsx("div",{className:"bg-white border border-yellow-200 rounded-lg p-4",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Address Components"}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Street:"})," ",c.street]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Ward:"})," ",c.ward]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"District:"})," ",c.district]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"City:"})," ",c.city]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Province:"})," ",c.province]})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Coordinates & Format"}),s.jsxs("div",{className:"space-y-1 text-sm",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Latitude:"})," ",c.coordinates.latitude]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Longitude:"})," ",c.coordinates.longitude]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Formatted:"})," ",Vt.formatAddress(c)]}),s.jsxs("p",{children:[s.jsx("span",{className:"font-medium",children:"Full:"})," ",c.fullAddress]})]})]})]})})]})]})]})})}function n6(){const{user:t}=pt(),r=[{name:"Dashboard",href:"/",icon:KT,roles:["pharmacist","manager","customer"]},{name:"Prescriptions",href:"/prescriptions",icon:Jn,roles:["pharmacist","manager","customer"]},{name:"Inventory",href:"/inventory",icon:Ot,roles:["pharmacist","manager"]},{name:"Orders",href:"/orders",icon:kn,roles:["pharmacist","manager","customer"]},{name:"Track Orders",href:"/shipping/track",icon:vt,roles:["customer"]},{name:"Manage Shipping",href:"/shipping/manage",icon:ur,roles:["pharmacist","manager"]},{name:"Shop",href:"/customers",icon:_h,roles:["customer"]},{name:"Customers",href:"/customers",icon:Yt,roles:["pharmacist","manager"]},{name:"Reports",href:"/reports",icon:jj,roles:["manager"]},{name:"Create Shippers",href:"/admin/create-shippers",icon:nm,roles:["manager"]},{name:"Create Profiles",href:"/admin/create-profiles",icon:ur,roles:["manager"]},{name:"Migrate Database",href:"/admin/migrate-db",icon:br,roles:["manager"]},{name:"Test Database",href:"/admin/test-db",icon:XT,roles:["manager"]},{name:"Address Lookup",href:"/admin/address-lookup",icon:vt,roles:["manager"]},{name:"Database Setup",href:"/setup",icon:br,roles:["manager"]}].filter(n=>n.roles.includes((t==null?void 0:t.role)||""));return s.jsxs("div",{className:"bg-white w-64 border-r border-gray-200 flex flex-col",children:[s.jsx("div",{className:"p-6 border-b border-gray-200",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"h-10 w-10 bg-gradient-to-r from-blue-600 to-green-600 rounded-lg flex items-center justify-center",children:s.jsx(Tj,{className:"h-6 w-6 text-white"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Long Chau"}),s.jsx("p",{className:"text-sm text-gray-500",children:"PMS"})]})]})}),s.jsx("nav",{className:"flex-1 p-4 space-y-2",children:r.map(n=>s.jsxs(w_,{to:n.href,className:({isActive:a})=>`flex items-center space-x-3 px-4 py-3 rounded-lg text-sm font-medium transition-colors ${a?"bg-blue-50 text-blue-700 border-r-2 border-blue-700":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[s.jsx(n.icon,{className:"h-5 w-5"}),s.jsx("span",{children:n.name})]},n.name))}),s.jsx("div",{className:"p-4 border-t border-gray-200",children:s.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 p-4 rounded-lg",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-900 mb-1",children:"Need Help?"}),s.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Contact system administrator for assistance"}),s.jsx("button",{className:"text-xs bg-blue-600 text-white px-3 py-1 rounded-md hover:bg-blue-700 transition-colors",children:"Get Support"})]})})]})}function s6(){const{notifications:t,unreadCount:e,markAsRead:r,markAllAsRead:n,removeNotification:a,clearAllNotifications:o}=ws(),[c,u]=R.useState(!1),h=v=>{switch(v){case"success":return s.jsx(Lt,{className:"h-4 w-4 text-green-500"});case"error":return s.jsx(Qc,{className:"h-4 w-4 text-red-500"});case"warning":return s.jsx(Rn,{className:"h-4 w-4 text-yellow-500"});case"info":return s.jsx(Og,{className:"h-4 w-4 text-blue-500"});default:return s.jsx(Og,{className:"h-4 w-4 text-gray-500"})}},f=v=>{const w=new Date,N=new Date(v),g=w.getTime()-N.getTime(),y=Math.floor(g/6e4),j=Math.floor(g/36e5),_=Math.floor(g/864e5);return y<1?"Just now":y<60?`${y}m ago`:j<24?`${j}h ago`:_<7?`${_}d ago`:N.toLocaleDateString()},m=v=>{v.read||r(v.id),v.actionUrl&&(window.location.hash=v.actionUrl)};return s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>u(!c),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:[e>0?s.jsx(BT,{className:"h-6 w-6"}):s.jsx(Ig,{className:"h-6 w-6"}),e>0&&s.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center font-medium",children:e>99?"99+":e})]}),c&&s.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-lg border border-gray-200 z-50",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notifications"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[e>0&&s.jsx("button",{onClick:n,className:"text-xs text-blue-600 hover:text-blue-800 font-medium",children:"Mark all read"}),s.jsx("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-600",children:s.jsx(Rr,{className:"h-4 w-4"})})]})]}),s.jsx("div",{className:"max-h-96 overflow-y-auto",children:t.length===0?s.jsxs("div",{className:"p-8 text-center",children:[s.jsx(Ig,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),s.jsx("p",{className:"text-gray-500",children:"No notifications yet"})]}):t.map(v=>s.jsx("div",{onClick:()=>m(v),className:`p-4 border-b border-gray-50 hover:bg-gray-50 cursor-pointer transition-colors ${v.read?"":"bg-blue-50"}`,children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0 mt-1",children:h(v.type)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("p",{className:`text-sm font-medium ${v.read?"text-gray-700":"text-gray-900"}`,children:v.title}),s.jsxs("div",{className:"flex items-center space-x-2",children:[!v.read&&s.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),s.jsx("button",{onClick:w=>{w.stopPropagation(),a(v.id)},className:"text-gray-400 hover:text-gray-600",children:s.jsx(Rr,{className:"h-3 w-3"})})]})]}),s.jsx("p",{className:"text-sm text-gray-600 mt-1",children:v.message}),s.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[s.jsx(Bn,{className:"h-3 w-3 text-gray-400"}),s.jsx("span",{className:"text-xs text-gray-500",children:f(v.timestamp)})]})]})]})},v.id))}),t.length>0&&s.jsx("div",{className:"p-3 border-t border-gray-100",children:s.jsx("button",{onClick:o,className:"w-full text-center text-sm text-gray-600 hover:text-gray-800 font-medium",children:"Clear all notifications"})})]}),c&&s.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>u(!1)})]})}function i6(){const{user:t,logout:e}=pt(),r=Nf(),[n,a]=R.useState(!1),o=R.useRef(null),c=()=>{window.dispatchEvent(new CustomEvent("showProfile")),a(!1)},u=()=>{r("/change-password"),a(!1)};return R.useEffect(()=>{function h(f){o.current&&!o.current.contains(f.target)&&a(!1)}return document.addEventListener("mousedown",h),()=>{document.removeEventListener("mousedown",h)}},[]),s.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center space-x-4",children:s.jsxs("div",{className:"relative",children:[s.jsx(dn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),s.jsx("input",{type:"text",placeholder:"Search prescriptions, orders, products...",className:"pl-10 pr-4 py-2 w-96 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx(s6,{}),s.jsxs("div",{className:"relative",ref:o,children:[s.jsxs("button",{onClick:()=>a(!n),className:"flex items-center space-x-3 hover:bg-gray-50 rounded-lg p-2 transition-colors",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:t==null?void 0:t.name}),s.jsx("div",{className:"text-xs text-gray-500 capitalize",children:t==null?void 0:t.role})]}),s.jsx("div",{className:"h-8 w-8 bg-gradient-to-r from-blue-600 to-green-600 rounded-full flex items-center justify-center",children:s.jsx($n,{className:"h-4 w-4 text-white"})}),s.jsx(zT,{className:"h-4 w-4 text-gray-400"})]}),n&&s.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:s.jsxs("div",{className:"py-1",children:[s.jsxs("button",{onClick:c,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[s.jsx($n,{className:"h-4 w-4"}),s.jsx("span",{children:"View Profile"})]}),(t==null?void 0:t.role)==="customer"&&s.jsxs("button",{onClick:u,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[s.jsx(ZT,{className:"h-4 w-4"}),s.jsx("span",{children:"Change Password"})]}),s.jsx("hr",{className:"my-1"}),s.jsxs("button",{onClick:e,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 flex items-center space-x-2",children:[s.jsx(kj,{className:"h-4 w-4"}),s.jsx("span",{children:"Logout"})]})]})})]})]})]})})}function a6({customer:t,isOwnProfile:e=!1}){var N,g,y,j,_,b,P,B,$,k;const[r,n]=R.useState(!1),[a,o]=R.useState(t),c=()=>{var I,T;if((I=t.healthStatus)!=null&&I.height&&((T=t.healthStatus)!=null&&T.weight)){const D=t.healthStatus.height/100;return(t.healthStatus.weight/(D*D)).toFixed(1)}return"N/A"},u=I=>{const T=parseFloat(I);return T<18.5?{status:"Underweight",color:"text-blue-600"}:T<25?{status:"Normal",color:"text-green-600"}:T<30?{status:"Overweight",color:"text-yellow-600"}:{status:"Obese",color:"text-red-600"}},h=I=>{switch(I){case"bronze":return"text-amber-600 bg-amber-50";case"silver":return"text-gray-600 bg-gray-50";case"gold":return"text-yellow-600 bg-yellow-50";case"platinum":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}},f=I=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(I),m=I=>{const T=new Date,D=new Date(I);let U=T.getFullYear()-D.getFullYear();const V=T.getMonth()-D.getMonth();return(V<0||V===0&&T.getDate()<D.getDate())&&U--,U},v=c(),w=u(v);return s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-xl font-bold",children:t.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.name}),s.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${h(t.membershipTier)}`,children:[s.jsx(Zc,{className:"h-4 w-4 mr-1"}),t.membershipTier.toUpperCase()," MEMBER"]})]})]}),e&&s.jsxs("button",{onClick:()=>n(!r),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(ea,{className:"h-4 w-4"}),s.jsx("span",{children:"Edit Profile"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx($n,{className:"h-5 w-5 mr-2 text-blue-600"}),"Personal Information"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(mc,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:t.email})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(pc,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:t.phone})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(vt,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:t.address})]}),s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(Zs,{className:"h-4 w-4 text-gray-500"}),s.jsxs("span",{className:"text-gray-700",children:[new Date(t.dateOfBirth).toLocaleDateString("vi-VN"),s.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",m(t.dateOfBirth)," years old)"]})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(rm,{className:"h-5 w-5 mr-2 text-red-600"}),"Health Information"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[((N=t.healthStatus)==null?void 0:N.bloodType)&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Blood Type:"}),s.jsx("span",{className:"font-medium text-red-600",children:t.healthStatus.bloodType})]}),((g=t.healthStatus)==null?void 0:g.height)&&((y=t.healthStatus)==null?void 0:y.weight)&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Height:"}),s.jsxs("span",{className:"font-medium",children:[t.healthStatus.height," cm"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Weight:"}),s.jsxs("span",{className:"font-medium",children:[t.healthStatus.weight," kg"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"BMI:"}),s.jsxs("span",{className:`font-medium ${w.color}`,children:[v," (",w.status,")"]})]})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(Rn,{className:"h-5 w-5 mr-2 text-yellow-600"}),"Medical Alerts"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600 block mb-2",children:"Allergies:"}),((j=t.allergies)==null?void 0:j.length)>0?s.jsx("div",{className:"flex flex-wrap gap-2",children:t.allergies.map((I,T)=>s.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-800 text-xs rounded-full",children:I},T))}):s.jsx("span",{className:"text-gray-500 text-sm",children:"No known allergies"})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-sm font-medium text-gray-600 block mb-2",children:"Chronic Conditions:"}),((b=(_=t.healthStatus)==null?void 0:_.chronicConditions)==null?void 0:b.length)>0?s.jsx("div",{className:"flex flex-wrap gap-2",children:t.healthStatus.chronicConditions.map((I,T)=>s.jsx("span",{className:"px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full",children:I},T))}):s.jsx("span",{className:"text-gray-500 text-sm",children:"No chronic conditions"})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(bh,{className:"h-5 w-5 mr-2 text-green-600"}),"Emergency Contact"]}),(P=t.healthStatus)!=null&&P.emergencyContact?s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Name:"}),s.jsx("span",{className:"font-medium",children:t.healthStatus.emergencyContact.name})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Phone:"}),s.jsx("span",{className:"font-medium",children:t.healthStatus.emergencyContact.phone})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Relationship:"}),s.jsx("span",{className:"font-medium",children:t.healthStatus.emergencyContact.relationship})]})]}):s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:s.jsx("span",{className:"text-gray-500 text-sm",children:"No emergency contact information"})})]}),((B=t.healthStatus)==null?void 0:B.insurance)&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(bh,{className:"h-5 w-5 mr-2 text-blue-600"}),"Insurance Information"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Provider:"}),s.jsx("span",{className:"font-medium",children:t.healthStatus.insurance.provider})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Policy Number:"}),s.jsx("span",{className:"font-medium",children:t.healthStatus.insurance.policyNumber})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Expiry Date:"}),s.jsx("span",{className:"font-medium",children:new Date(t.healthStatus.insurance.expiryDate).toLocaleDateString("vi-VN")})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(Kc,{className:"h-5 w-5 mr-2 text-purple-600"}),"Membership Statistics"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Member Since:"}),s.jsx("span",{className:"font-medium",children:new Date(t.joinDate).toLocaleDateString("vi-VN")})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Total Spent:"}),s.jsx("span",{className:"font-medium text-green-600",children:f(t.totalSpent)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Orders:"}),s.jsx("span",{className:"font-medium",children:(($=t.orderHistory)==null?void 0:$.length)||0})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Prescriptions:"}),s.jsx("span",{className:"font-medium",children:((k=t.prescriptionHistory)==null?void 0:k.length)||0})]})]})]})]})]})}function o6({user:t,isOwnProfile:e=!1}){const[r,n]=R.useState(!1),a=()=>{var c,u;if((c=t.professionalInfo)!=null&&c.hireDate){const h=new Date(t.professionalInfo.hireDate);return new Date().getFullYear()-h.getFullYear()}return((u=t.professionalInfo)==null?void 0:u.yearsOfExperience)||0},o=c=>{switch(c){case"pharmacist":return"text-blue-600 bg-blue-50";case"manager":return"text-purple-600 bg-purple-50";default:return"text-gray-600 bg-gray-50"}};return s.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6 space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-green-500 to-blue-600 rounded-full flex items-center justify-center text-white text-xl font-bold",children:t.name.charAt(0)}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:t.name}),s.jsxs("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${o(t.role)}`,children:[s.jsx(Dg,{className:"h-4 w-4 mr-1"}),t.role.toUpperCase()]})]})]}),e&&s.jsxs("button",{onClick:()=>n(!r),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx(ea,{className:"h-4 w-4"}),s.jsx("span",{children:"Edit Profile"})]})]}),t.professionalInfo&&s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(Dg,{className:"h-5 w-5 mr-2 text-blue-600"}),"Professional Information"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Position:"}),s.jsx("span",{className:"font-medium",children:t.professionalInfo.position})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"License Number:"}),s.jsx("span",{className:"font-medium",children:t.professionalInfo.licenseNumber})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Department:"}),s.jsx("span",{className:"font-medium",children:t.professionalInfo.department||"N/A"})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Experience:"}),s.jsxs("span",{className:"font-medium text-green-600",children:[a()," years"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Hire Date:"}),s.jsx("span",{className:"font-medium",children:new Date(t.professionalInfo.hireDate).toLocaleDateString("vi-VN")})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx($T,{className:"h-5 w-5 mr-2 text-green-600"}),"Branch Information"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Branch:"}),s.jsx("span",{className:"font-medium",children:t.professionalInfo.branch.name})]}),s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Address:"}),s.jsx("span",{className:"font-medium text-right max-w-xs",children:t.professionalInfo.branch.address})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Phone:"}),s.jsx("span",{className:"font-medium",children:t.professionalInfo.branch.phone})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(QT,{className:"h-5 w-5 mr-2 text-purple-600"}),"Education"]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Degree:"}),s.jsx("span",{className:"font-medium",children:t.professionalInfo.education.degree})]}),s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Institution:"}),s.jsx("span",{className:"font-medium text-right max-w-xs",children:t.professionalInfo.education.institution})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:"Graduation:"}),s.jsx("span",{className:"font-medium",children:t.professionalInfo.education.graduationYear})]})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(Mg,{className:"h-5 w-5 mr-2 text-yellow-600"}),"Specializations"]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:s.jsx("div",{className:"flex flex-wrap gap-2",children:t.professionalInfo.specializations.map((c,u)=>s.jsx("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:c},u))})})]}),s.jsxs("div",{className:"space-y-4 lg:col-span-2",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx(Mg,{className:"h-5 w-5 mr-2 text-green-600"}),"Certifications"]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:s.jsx("div",{className:"flex flex-wrap gap-2",children:t.professionalInfo.certifications.map((c,u)=>s.jsx("span",{className:"px-3 py-1 bg-green-100 text-green-800 text-sm rounded-full",children:c},u))})})]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[s.jsx($n,{className:"h-5 w-5 mr-2 text-gray-600"}),"Contact Information"]}),s.jsx("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(mc,{className:"h-4 w-4 text-gray-500"}),s.jsx("span",{className:"text-gray-700",children:t.email})]})})]})]})}function l6(){const{user:t}=pt(),{customers:e}=lt();if(!t)return s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-gray-500",children:"Please log in to view your profile."})});if(t.role==="customer"){const r=e.find(n=>n.id===t.id);return r?s.jsx(a6,{customer:r,isOwnProfile:!0}):s.jsx("div",{className:"text-center py-12",children:s.jsx("p",{className:"text-gray-500",children:"Customer profile not found."})})}return s.jsx(o6,{user:t,isOwnProfile:!0})}function c6({isOpen:t,onClose:e}){return t?s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-auto",children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Profile"}),s.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsx(Rr,{className:"h-5 w-5 text-gray-500"})})]}),s.jsx("div",{className:"p-6",children:s.jsx(l6,{})})]})}):null}function u6({children:t}){const{user:e}=pt(),[r,n]=R.useState(!1);return R.useEffect(()=>{const a=()=>{n(!0)};return window.addEventListener("showProfile",a),()=>window.removeEventListener("showProfile",a)},[]),s.jsxs("div",{className:"flex h-screen bg-gray-50",children:[s.jsx(n6,{}),s.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[s.jsx(i6,{}),s.jsx("main",{className:"flex-1 overflow-y-auto p-6",children:t})]}),s.jsx(c6,{isOpen:r,onClose:()=>n(!1)})]})}function d6(){const{isConnectedToDatabase:t}=lt();return s.jsx("div",{className:"fixed bottom-4 right-4 z-50",children:s.jsx("div",{className:`flex items-center space-x-2 px-3 py-2 rounded-lg shadow-lg ${t?"bg-green-500 text-white":"bg-orange-500 text-white"}`,children:t?s.jsxs(s.Fragment,{children:[s.jsx(br,{className:"h-4 w-4"}),s.jsx(sm,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Neon DB Connected"})]}):s.jsxs(s.Fragment,{children:[s.jsx(br,{className:"h-4 w-4"}),s.jsx(Il,{className:"h-4 w-4"}),s.jsx("span",{className:"text-sm font-medium",children:"Using Mock Data"})]})})})}function h6({message:t="Loading data from database..."}){return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-gray-100 p-8 max-w-md w-full mx-4",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"relative mb-6",children:[s.jsx(br,{className:"h-16 w-16 text-blue-600 mx-auto"}),s.jsx(Po,{className:"h-6 w-6 text-blue-400 absolute top-0 right-6 animate-spin"})]}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Long Chau PMS"}),s.jsx("p",{className:"text-gray-600 mb-6",children:t}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:s.jsx("div",{className:"bg-blue-600 h-2 rounded-full animate-pulse",style:{width:"60%"}})}),s.jsx("p",{className:"text-sm text-gray-500",children:"Connecting to Neon PostgreSQL database..."}),s.jsxs("div",{className:"flex justify-center mt-4 space-x-1",children:[s.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),s.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),s.jsx("div",{className:"w-2 h-2 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})})})}function f6({onRetry:t,error:e}){return s.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:s.jsx("div",{className:"bg-white rounded-xl shadow-lg border border-red-200 p-8 max-w-md w-full mx-4",children:s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"relative mb-6",children:[s.jsx(br,{className:"h-16 w-16 text-gray-400 mx-auto"}),s.jsx(Rn,{className:"h-6 w-6 text-red-500 absolute top-0 right-6"})]}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Database Connection Failed"}),s.jsx("p",{className:"text-gray-600 mb-6",children:"Unable to connect to the database. The application requires a database connection to function."}),e&&s.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-6",children:s.jsx("p",{className:"text-sm text-red-700 font-mono",children:e})}),s.jsxs("button",{onClick:t,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center justify-center space-x-2 mb-4",children:[s.jsx(fs,{className:"h-4 w-4"}),s.jsx("span",{children:"Retry Connection"})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-left",children:[s.jsxs("h3",{className:"font-medium text-gray-900 mb-2 flex items-center",children:[s.jsx(sm,{className:"h-4 w-4 mr-2"}),"Troubleshooting"]}),s.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[s.jsx("li",{children:"• Check your internet connection"}),s.jsx("li",{children:"• Verify database credentials"}),s.jsx("li",{children:"• Ensure database server is running"}),s.jsx("li",{children:"• Contact administrator if problem persists"})]})]})]})})})}function m6(){const[t,e]=R.useState(null),r=(a,o)=>{navigator.clipboard.writeText(a),e(o),setTimeout(()=>e(null),2e3)},n=[{id:1,title:"Create a Neon Account",description:"Sign up for a free Neon database account",action:"Go to neon.tech",url:"https://neon.tech",copyText:null},{id:2,title:"Create a New Project",description:"Create a new PostgreSQL project in your Neon dashboard",action:'Click "Create Project"',copyText:null},{id:3,title:"Get Connection String",description:"Copy your database connection string from the dashboard",action:"Copy the connection string",copyText:"postgresql://username:password@ep-example.us-east-2.aws.neon.tech/dbname?sslmode=require"},{id:4,title:"Update Environment Variables",description:"Add your connection string to the .env file",action:"Update VITE_DATABASE_URL",copyText:"VITE_DATABASE_URL=your_neon_connection_string_here"},{id:5,title:"Generate and Push Schema",description:"Create database tables using Drizzle migrations",action:"Run migration commands",copyText:"npm run db:generate && npm run db:push"}];return s.jsxs("div",{className:"max-w-4xl mx-auto p-6 bg-white rounded-xl shadow-lg",children:[s.jsxs("div",{className:"text-center mb-8",children:[s.jsxs("div",{className:"flex items-center justify-center mb-4",children:[s.jsx(br,{className:"h-12 w-12 text-blue-600 mr-3"}),s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Neon Database Setup"})]}),s.jsx("p",{className:"text-gray-600 text-lg",children:"Connect your Long Châu PMS to Neon PostgreSQL database in 5 easy steps"})]}),s.jsx("div",{className:"space-y-6",children:n.map((a,o)=>s.jsxs("div",{className:"flex items-start space-x-4 p-6 border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold",children:a.id})}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:a.title}),s.jsx("p",{className:"text-gray-600 mb-4",children:a.description}),s.jsxs("div",{className:"flex items-center space-x-3",children:[a.url&&s.jsxs("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[s.jsx("span",{children:a.action}),s.jsx(HT,{className:"h-4 w-4 ml-2"})]}),a.copyText&&s.jsx("button",{onClick:()=>r(a.copyText,a.id),className:"inline-flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",children:t===a.id?s.jsxs(s.Fragment,{children:[s.jsx(Pj,{className:"h-4 w-4 mr-2 text-green-600"}),s.jsx("span",{children:"Copied!"})]}):s.jsxs(s.Fragment,{children:[s.jsx(FT,{className:"h-4 w-4 mr-2"}),s.jsx("span",{children:a.action})]})})]}),a.copyText&&s.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:s.jsx("code",{className:"text-sm text-gray-800 font-mono break-all",children:a.copyText})})]}),o<n.length-1&&s.jsx("div",{className:"flex-shrink-0 mt-4",children:s.jsx(tm,{className:"h-5 w-5 text-gray-400"})})]},a.id))}),s.jsxs("div",{className:"mt-8 p-6 bg-blue-50 rounded-lg",children:[s.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"After Setup"}),s.jsx("p",{className:"text-blue-800 mb-4",children:"Once connected, your Long Châu PMS will automatically:"}),s.jsxs("ul",{className:"list-disc list-inside text-blue-800 space-y-1",children:[s.jsx("li",{children:"Store all customer data securely in Neon PostgreSQL"}),s.jsx("li",{children:"Persist prescriptions, orders, and inventory data"}),s.jsx("li",{children:"Enable real-time data synchronization"}),s.jsx("li",{children:"Provide automatic backups and scaling"})]})]}),s.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:s.jsxs("p",{className:"text-yellow-800 text-sm",children:[s.jsx("strong",{children:"Note:"})," The application will work with mock data until the database is properly configured. Look for the connection indicator in the bottom-right corner."]})})]})}function Qg(){const{addOrder:t,addCustomer:e,addShipper:r,addBranch:n,customers:a,orders:o,shippers:c,branches:u}=lt(),[h,f]=R.useState(!1),[m,v]=R.useState(""),w=async()=>{var g,y,j,_,b,P,B,$,k;f(!0),v("Starting initialization...");try{v("Creating admin and shipper user accounts...");const I=[{email:"admin@longchau.com",password:"admin123",name:"Admin User",role:"manager"},{email:"shipper1@longchau.com",password:"shipper123",name:"Nguyen Van Duc",role:"shipper"},{email:"shipper2@longchau.com",password:"shipper123",name:"Tran Van Minh",role:"shipper"},{email:"shipper3@longchau.com",password:"shipper123",name:"Le Van Nam",role:"shipper"}],T=[];for(const z of I)try{const q=await on.createUser(z);q.success&&q.user?(console.log(`✅ Created user: ${z.email} (${z.role})`),z.role==="shipper"&&T.push(q.user.id)):(console.log(`⚠️ User ${z.email} might already exist`),z.role==="shipper"&&T.push(`shipper-user-${T.length+1}`))}catch(q){console.log(`⚠️ Error creating user ${z.email}:`,q),z.role==="shipper"&&T.push(`shipper-user-${T.length+1}`)}if(u.length===0){v("Creating pharmacy branches...");const z=[{name:"Long Chau District 1",address:"123 Nguyen Hue Street, District 1, Ho Chi Minh City",city:"Ho Chi Minh City",province:"Ho Chi Minh",postalCode:"700000",phone:"+84 28 1234 5678",email:"district1@longchau.com",location:{latitude:10.8231,longitude:106.6297},operatingHours:{monday:{open:"08:00",close:"22:00"},tuesday:{open:"08:00",close:"22:00"},wednesday:{open:"08:00",close:"22:00"},thursday:{open:"08:00",close:"22:00"},friday:{open:"08:00",close:"22:00"},saturday:{open:"08:00",close:"22:00"},sunday:{open:"08:00",close:"22:00"}},isActive:!0},{name:"Long Chau District 3",address:"456 Vo Van Tan Street, District 3, Ho Chi Minh City",city:"Ho Chi Minh City",province:"Ho Chi Minh",postalCode:"700000",phone:"+84 28 1234 5679",email:"district3@longchau.com",location:{latitude:10.7892,longitude:106.6762},operatingHours:{monday:{open:"08:00",close:"22:00"},tuesday:{open:"08:00",close:"22:00"},wednesday:{open:"08:00",close:"22:00"},thursday:{open:"08:00",close:"22:00"},friday:{open:"08:00",close:"22:00"},saturday:{open:"08:00",close:"22:00"},sunday:{open:"08:00",close:"22:00"}},isActive:!0},{name:"Long Chau Thu Duc",address:"789 Vo Van Ngan Street, Thu Duc City, Ho Chi Minh City",city:"Ho Chi Minh City",province:"Ho Chi Minh",postalCode:"700000",phone:"+84 28 1234 5680",email:"thuduc@longchau.com",location:{latitude:10.8503,longitude:106.7719},operatingHours:{monday:{open:"08:00",close:"22:00"},tuesday:{open:"08:00",close:"22:00"},wednesday:{open:"08:00",close:"22:00"},thursday:{open:"08:00",close:"22:00"},friday:{open:"08:00",close:"22:00"},saturday:{open:"08:00",close:"22:00"},sunday:{open:"08:00",close:"22:00"}},isActive:!0}];for(const q of z)await n(q)}if(c.length===0){v("Creating shipper accounts...");const z=[{userId:T[0]||"shipper-user-1",name:"Nguyen Van Duc",email:"shipper1@longchau.com",phone:"+84 90 123 4567",vehicleType:"motorcycle",vehicleNumber:"59X1-12345",licenseNumber:"DL123456789",currentLocation:{latitude:10.8231,longitude:106.6297,address:"District 1, Ho Chi Minh City",timestamp:new Date().toISOString()},isAvailable:!0,rating:4.8,totalDeliveries:245,branchId:(g=u[0])==null?void 0:g.id,emergencyContact:{name:"Nguyen Thi Mai",phone:"+84 90 987 6543",relationship:"spouse"}},{userId:T[1]||"shipper-user-2",name:"Tran Van Minh",email:"shipper2@longchau.com",phone:"+84 91 234 5678",vehicleType:"motorcycle",vehicleNumber:"59X1-67890",licenseNumber:"DL987654321",currentLocation:{latitude:10.7892,longitude:106.6762,address:"District 3, Ho Chi Minh City",timestamp:new Date().toISOString()},isAvailable:!0,rating:4.6,totalDeliveries:189,branchId:(y=u[1])==null?void 0:y.id,emergencyContact:{name:"Tran Van Nam",phone:"+84 91 876 5432",relationship:"father"}},{userId:T[2]||"shipper-user-3",name:"Le Van Nam",email:"shipper3@longchau.com",phone:"+84 92 345 6789",vehicleType:"car",vehicleNumber:"59X1-54321",licenseNumber:"DL555666777",currentLocation:{latitude:10.8503,longitude:106.7719,address:"Thu Duc City, Ho Chi Minh City",timestamp:new Date().toISOString()},isAvailable:!0,rating:4.9,totalDeliveries:312,branchId:(j=u[2])==null?void 0:j.id,emergencyContact:{name:"Le Van Long",phone:"+84 92 876 5432",relationship:"brother"}}];for(const q of z)await r(q)}v("Creating customer accounts...");const D=[{name:"Nguyen Thi Lan",email:"lan.nguyen@email.com",phone:"+84 90 111 2222",address:"45 Le Loi Street, District 1, Ho Chi Minh City",dateOfBirth:"1985-03-15",joinDate:new Date().toISOString(),allergies:[],prescriptionHistory:[],orderHistory:[],healthStatus:{bloodType:"O+",height:165,weight:58,chronicConditions:[],emergencyContact:{name:"Nguyen Van Duc",phone:"+84 90 111 1111",relationship:"husband"},insurance:{provider:"Bao Viet Insurance",policyNumber:"BV-2024-001",expiryDate:"2025-12-31"}},membershipTier:"gold",totalSpent:125e4},{name:"Pham Van Minh",email:"minh.pham@email.com",phone:"+84 91 333 4444",address:"78 Pasteur Street, District 3, Ho Chi Minh City",dateOfBirth:"1978-11-22",joinDate:new Date().toISOString(),allergies:["penicillin"],prescriptionHistory:[],orderHistory:[],healthStatus:{bloodType:"A+",height:172,weight:68,chronicConditions:["hypertension"],emergencyContact:{name:"Pham Thi Hoa",phone:"+84 91 333 3333",relationship:"wife"}},membershipTier:"silver",totalSpent:875e3},{name:"Tran Thi Hong",email:"hong.tran@email.com",phone:"+84 92 555 6666",address:"156 Vo Van Ngan Street, Thu Duc City, Ho Chi Minh City",dateOfBirth:"1992-07-08",joinDate:new Date().toISOString(),allergies:[],prescriptionHistory:[],orderHistory:[],healthStatus:{bloodType:"B+",height:160,weight:52,chronicConditions:[],emergencyContact:{name:"Le Van Quan",phone:"+84 92 555 5555",relationship:"brother"},insurance:{provider:"PJICO Insurance",policyNumber:"PJ-2024-002",expiryDate:"2025-06-30"}},membershipTier:"platinum",totalSpent:21e5},{name:"Le Van Nam",email:"nam.le@email.com",phone:"+84 93 777 8888",address:"234 Nguyen Van Cu Street, District 5, Ho Chi Minh City",dateOfBirth:"1989-12-03",joinDate:new Date().toISOString(),allergies:["sulfa"],prescriptionHistory:[],orderHistory:[],healthStatus:{bloodType:"AB+",height:175,weight:75,chronicConditions:["diabetes"],emergencyContact:{name:"Le Thi Nga",phone:"+84 93 777 7777",relationship:"mother"}},membershipTier:"bronze",totalSpent:45e4},{name:"Vo Thi Mai",email:"mai.vo@email.com",phone:"+84 94 999 0000",address:"67 Dien Bien Phu Street, Binh Thanh District, Ho Chi Minh City",dateOfBirth:"1995-05-20",joinDate:new Date().toISOString(),allergies:[],prescriptionHistory:[],orderHistory:[],healthStatus:{bloodType:"O-",height:158,weight:48,chronicConditions:[],emergencyContact:{name:"Vo Van Tai",phone:"+84 94 999 9999",relationship:"father"}},membershipTier:"silver",totalSpent:68e4}];for(const z of D)await e(z);v("Creating sample orders with delivery tracking...");const U=[{customerId:(_=a[0])==null?void 0:_.id,customerName:"Nguyen Thi Lan",address:"45 Le Loi Street, District 1, Ho Chi Minh City",latitude:10.823,longitude:106.6297},{customerId:(b=a[1])==null?void 0:b.id,customerName:"Pham Van Minh",address:"78 Pasteur Street, District 3, Ho Chi Minh City",latitude:10.7869,longitude:106.6831},{customerId:(P=a[2])==null?void 0:P.id,customerName:"Tran Thi Hong",address:"156 Vo Van Ngan Street, Thu Duc City, Ho Chi Minh City",latitude:10.8485,longitude:106.7734},{customerId:(B=a[3])==null?void 0:B.id,customerName:"Le Van Nam",address:"234 Nguyen Van Cu Street, District 5, Ho Chi Minh City",latitude:10.7594,longitude:106.6672},{customerId:($=a[4])==null?void 0:$.id,customerName:"Vo Thi Mai",address:"67 Dien Bien Phu Street, Binh Thanh District, Ho Chi Minh City",latitude:10.8014,longitude:106.7109}],V=["confirmed","assigned","picked_up","in_transit","delivered"];for(let z=0;z<U.length;z++){const q=U[z],Q=u[z%u.length],te=V[z%V.length];if(!q.customerId||!Q)continue;const de={customerId:q.customerId,customerName:q.customerName,items:[{productId:`med-${z+1}`,productName:z===0?"Paracetamol 500mg":z===1?"Vitamin C 1000mg":z===2?"Omega-3 Fish Oil":z===3?"Aspirin 100mg":"Multivitamin",quantity:Math.floor(Math.random()*3)+1,price:Math.floor(Math.random()*1e5)+5e4}],total:Math.floor(Math.random()*5e5)+1e5,status:te,orderDate:new Date(Date.now()-Math.random()*7*24*60*60*1e3).toISOString(),shippingAddress:q.address,paymentMethod:"cod",paymentStatus:"pending",originBranch:Q,destinationLocation:{latitude:q.latitude,longitude:q.longitude,address:q.address,city:"Ho Chi Minh City",province:"Ho Chi Minh"},estimatedDelivery:new Date(Date.now()+Math.random()*2*24*60*60*1e3).toISOString(),...te!=="confirmed"&&c.length>0?{assignedShipperId:(k=c[z%c.length])==null?void 0:k.id,assignedShipper:c[z%c.length]}:{},...te==="delivered"?{actualDelivery:new Date(Date.now()-Math.random()*24*60*60*1e3).toISOString(),deliveryProof:{photos:["delivered-photo.jpg"],signature:"Customer signature",recipientName:q.customerName,notes:"Package delivered successfully"}}:{}};await t(de)}v("Sample data initialized successfully!")}catch(I){console.error("Error initializing sample data:",I),v("Error initializing sample data")}finally{f(!1)}},N=a.length>0||o.length>0||c.length>0||u.length>0;return s.jsxs("div",{className:"bg-white rounded-lg border shadow-sm p-6",children:[s.jsxs("div",{className:"flex items-center mb-4",children:[s.jsx(br,{className:"h-6 w-6 text-blue-600 mr-3"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Sample Data Initializer"})]}),s.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[s.jsx(Sj,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:u.length}),s.jsx("p",{className:"text-xs text-gray-600",children:"Branches"})]}),s.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[s.jsx(Yt,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:c.length}),s.jsx("p",{className:"text-xs text-gray-600",children:"Shippers"})]}),s.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[s.jsx(Yt,{className:"h-8 w-8 text-purple-600 mx-auto mb-2"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:a.length}),s.jsx("p",{className:"text-xs text-gray-600",children:"Customers"})]}),s.jsxs("div",{className:"text-center p-3 bg-orange-50 rounded-lg",children:[s.jsx(Ot,{className:"h-8 w-8 text-orange-600 mx-auto mb-2"}),s.jsx("p",{className:"text-sm font-medium text-gray-900",children:o.length}),s.jsx("p",{className:"text-xs text-gray-600",children:"Orders"})]})]}),m&&s.jsxs("div",{className:`flex items-center p-3 rounded-lg mb-4 ${m.includes("Error")?"bg-red-50 text-red-700":m.includes("successfully")?"bg-green-50 text-green-700":"bg-blue-50 text-blue-700"}`,children:[m.includes("Error")?s.jsx(Qc,{className:"h-4 w-4 mr-2"}):m.includes("successfully")?s.jsx(Lt,{className:"h-4 w-4 mr-2"}):s.jsx(vt,{className:"h-4 w-4 mr-2 animate-spin"}),m]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("p",{className:"text-sm text-gray-600",children:"Initialize the system with sample pharmacy branches, shippers, customers, and orders with Vietnam map locations."}),N&&s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx("strong",{children:"Note:"})," Sample data already exists. Initializing will add additional sample data."]})}),s.jsx("button",{onClick:w,disabled:h,className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:h?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Initializing..."]}):s.jsxs(s.Fragment,{children:[s.jsx(br,{className:"h-4 w-4 mr-2"}),"Initialize Sample Data"]})})]})]})}function p6(){const{user:t}=pt(),{isLoading:e,isConnectedToDatabase:r,forceReconnectDatabase:n}=lt();return window.location.pathname==="/test-db-public"?s.jsx(Vg,{}):window.location.pathname==="/init-data-public"?s.jsx(Qg,{}):window.location.pathname==="/create-profiles-public"?s.jsx(qg,{}):window.location.pathname==="/migrate-db-public"?s.jsx(Hg,{}):e?s.jsx(h6,{message:"Loading pharmacy data from database..."}):r?t?t.role==="shipper"?s.jsx(XE,{}):s.jsxs(u6,{children:[s.jsx(Qg,{}),s.jsxs(v5,{children:[s.jsx(Ct,{path:"/",element:s.jsx(uE,{})}),s.jsx(Ct,{path:"/prescriptions",element:s.jsx(dE,{})}),s.jsx(Ct,{path:"/inventory",element:s.jsx(hE,{})}),s.jsx(Ct,{path:"/orders",element:s.jsx(bE,{})}),s.jsx(Ct,{path:"/shipping/track",element:s.jsx(kE,{})}),s.jsx(Ct,{path:"/shipping/manage",element:s.jsx(TE,{})}),s.jsx(Ct,{path:"/customers",element:s.jsx(SE,{})}),s.jsx(Ct,{path:"/reports",element:s.jsx(PE,{})}),s.jsx(Ct,{path:"/admin/create-shippers",element:s.jsx(e6,{})}),s.jsx(Ct,{path:"/admin/create-profiles",element:s.jsx(qg,{})}),s.jsx(Ct,{path:"/admin/seed-products",element:s.jsx(t6,{})}),s.jsx(Ct,{path:"/admin/migrate-db",element:s.jsx(Hg,{})}),s.jsx(Ct,{path:"/admin/test-db",element:s.jsx(Vg,{})}),s.jsx(Ct,{path:"/admin/address-lookup",element:s.jsx(r6,{})}),s.jsx(Ct,{path:"/change-password",element:s.jsx(oE,{})}),s.jsx(Ct,{path:"/setup",element:s.jsx(m6,{})}),s.jsx(Ct,{path:"*",element:s.jsx(y5,{to:"/",replace:!0})})]}),s.jsx(d6,{})]}):s.jsx(aE,{}):s.jsx(f6,{onRetry:n,error:"Failed to connect to Neon PostgreSQL database"})}function g6(){return s.jsx(PT,{children:s.jsx(AT,{children:s.jsx(IT,{children:s.jsx(MT,{children:s.jsx(U5,{children:s.jsx("div",{className:"App",children:s.jsx(p6,{})})})})})})})}a_(document.getElementById("root")).render(s.jsx(R.StrictMode,{children:s.jsx(g6,{})}));
